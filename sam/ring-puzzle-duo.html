<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>ring-puzzle-duo</title>

  <style>
    body {
      background-color: #666;
    }
  </style>
</head>
<body>
  <script type="text/javascript">
!function(){"use strict";window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(t,e){if(!t){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(i){e=e+", stack=\n"+i.stack}const t=e?"Assertion failed: "+e:"Assertion failed";throw console&&console.log&&console.log(t),new Error(t)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")}}(),function(){"use strict";window.phetio=window.phetio||{};window.phetio.PhetioIDUtils={append:function(t,...e){return e.forEach(e=>{t+="."+e}),t},getComponentName:function(t){const e=t.lastIndexOf(".");return-1===e?t:t.substring(e+1,t.length)},getParentID:function(t){const e=t.lastIndexOf(".");return-1===e?null:t.substring(0,e)},getDOMElementID:function(t){return"phetioID:"+t},getGeneralID:function(t,...e){return window.phetio.PhetioIDUtils.append(t.CAMEL_CASE_SIMULATION_NAME,"general",...e)},getScreenID:function(t){const e=[],i=t.split(".");for(let n=0;n<i.length;n++){const t=i[n];e.push(t);const s="Screen",r=t.indexOf(s);if(r>0&&r+s.length===t.length)return e.join(".")}return null},getGroupElementIndex:function(t){return parseInt(t.split(window.phetio.PhetioIDUtils.GROUP_SEPARATOR)[1],10)},SEPARATOR:".",GROUP_SEPARATOR:"_",GENERAL_COMPONENT_NAME:"general",GLOBAL_COMPONENT_NAME:"global",HOME_SCREEN_COMPONENT_NAME:"homeScreen",MODEL_COMPONENT_NAME:"model",VIEW_COMPONENT_NAME:"view"}}(),
/*!
 * jQuery JavaScript Library v2.1.0
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-23T21:10Z
 */
function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var i=[],n=i.slice,s=i.concat,r=i.push,o=i.indexOf,a={},l=a.toString,h=a.hasOwnProperty,u="".trim,c={},d=t.document,f=function(t,e){return new f.fn.init(t,e)},p=/^-ms-/,m=/-([\da-z])/gi,g=function(t,e){return e.toUpperCase()};function y(t){var e=t.length,i=f.type(t);return"function"!==i&&!f.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t))}f.fn=f.prototype={jquery:"2.1.0",constructor:f,selector:"",length:0,toArray:function(){return n.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:n.call(this)},pushStack:function(t){var e=f.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return f.each(this,t,e)},map:function(t){return this.pushStack(f.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(n.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:r,sort:i.sort,splice:i.splice},f.extend=f.fn.extend=function(){var t,e,i,n,s,r,o=arguments[0]||{},a=1,l=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[a]||{},a++),"object"==typeof o||f.isFunction(o)||(o={}),a===l&&(o=this,a--);a<l;a++)if(null!=(t=arguments[a]))for(e in t)i=o[e],o!==(n=t[e])&&(h&&n&&(f.isPlainObject(n)||(s=f.isArray(n)))?(s?(s=!1,r=i&&f.isArray(i)?i:[]):r=i&&f.isPlainObject(i)?i:{},o[e]=f.extend(h,r,n)):void 0!==n&&(o[e]=n));return o},f.extend({expando:"jQuery"+("2.1.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===f.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return t-parseFloat(t)>=0},isPlainObject:function(t){if("object"!==f.type(t)||t.nodeType||f.isWindow(t))return!1;try{if(t.constructor&&!h.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?a[l.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;(t=f.trim(t))&&(1===t.indexOf("use strict")?((e=d.createElement("script")).text=t,d.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(p,"ms-").replace(m,g)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var n=0,s=t.length,r=y(t);if(i){if(r)for(;n<s&&!1!==e.apply(t[n],i);n++);else for(n in t)if(!1===e.apply(t[n],i))break}else if(r)for(;n<s&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":u.call(t)},makeArray:function(t,e){var i=e||[];return null!=t&&(y(Object(t))?f.merge(i,"string"==typeof t?[t]:t):r.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:o.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,s=t.length;n<i;n++)t[s++]=e[n];return t.length=s,t},grep:function(t,e,i){for(var n=[],s=0,r=t.length,o=!i;s<r;s++)!e(t[s],s)!==o&&n.push(t[s]);return n},map:function(t,e,i){var n,r=0,o=t.length,a=[];if(y(t))for(;r<o;r++)null!=(n=e(t[r],r,i))&&a.push(n);else for(r in t)null!=(n=e(t[r],r,i))&&a.push(n);return s.apply([],a)},guid:1,proxy:function(t,e){var i,s,r;if("string"==typeof e&&(i=t[e],e=t,t=i),f.isFunction(t))return s=n.call(arguments,2),(r=function(){return t.apply(e||this,s.concat(n.call(arguments)))}).guid=t.guid=t.guid||f.guid++,r},now:Date.now,support:c}),f.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(t,e){a["[object "+e+"]"]=e.toLowerCase()}));var b=
/*!
 * Sizzle CSS Selector Engine v1.10.16
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-13
 */
function(t){var e,i,n,s,r,o,a,l,h,u,c,d,f,p,m,g,y,b="sizzle"+-new Date,v=t.document,_=0,w=0,A=et(),x=et(),T=et(),S=function(t,e){return t===e&&(h=!0),0},D={}.hasOwnProperty,E=[],C=E.pop,I=E.push,P=E.push,k=E.slice,L=E.indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(this[e]===t)return e;return-1},O="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",M=R.replace("w","w#"),B="\\["+N+"*("+R+")"+N+"*(?:([*^$|!~]?=)"+N+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+M+")|)|)"+N+"*\\]",F=":("+R+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",V=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),H=new RegExp("^"+N+"*,"+N+"*"),z=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),G=new RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),q=new RegExp(F),Y=new RegExp("^"+M+"$"),U={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R.replace("w","w*")+")"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+O+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},j=/^(?:input|select|textarea|button)$/i,W=/^h\d$/i,X=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,Z=/'|\\/g,$=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),J=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{P.apply(E=k.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(bt){P={apply:E.length?function(t,e){I.apply(t,k.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function tt(t,e,s,r){var a,l,h,d,m,g,_,w,A,x;if((e?e.ownerDocument||e:v)!==c&&u(e),s=s||[],!t||"string"!=typeof t)return s;if(1!==(d=(e=e||c).nodeType)&&9!==d)return[];if(f&&!r){if(a=K.exec(t))if(h=a[1]){if(9===d){if(!(l=e.getElementById(h))||!l.parentNode)return s;if(l.id===h)return s.push(l),s}else if(e.ownerDocument&&(l=e.ownerDocument.getElementById(h))&&y(e,l)&&l.id===h)return s.push(l),s}else{if(a[2])return P.apply(s,e.getElementsByTagName(t)),s;if((h=a[3])&&i.getElementsByClassName&&e.getElementsByClassName)return P.apply(s,e.getElementsByClassName(h)),s}if(i.qsa&&(!p||!p.test(t))){if(w=_=b,A=e,x=9===d&&t,1===d&&"object"!==e.nodeName.toLowerCase()){for(g=ct(t),(_=e.getAttribute("id"))?w=_.replace(Z,"\\$&"):e.setAttribute("id",w),w="[id='"+w+"'] ",m=g.length;m--;)g[m]=w+dt(g[m]);A=Q.test(t)&&ht(e.parentNode)||e,x=g.join(",")}if(x)try{return P.apply(s,A.querySelectorAll(x)),s}catch(T){}finally{_||e.removeAttribute("id")}}}return function(t,e,s,r){var a,l,h,u,c,d=ct(t);if(!r&&1===d.length){if((l=d[0]=d[0].slice(0)).length>2&&"ID"===(h=l[0]).type&&i.getById&&9===e.nodeType&&f&&n.relative[l[1].type]){if(!(e=(n.find.ID(h.matches[0].replace($,J),e)||[])[0]))return s;t=t.slice(l.shift().value.length)}for(a=U.needsContext.test(t)?0:l.length;a--&&(h=l[a],!n.relative[u=h.type]);)if((c=n.find[u])&&(r=c(h.matches[0].replace($,J),Q.test(l[0].type)&&ht(e.parentNode)||e))){if(l.splice(a,1),!(t=r.length&&dt(l)))return P.apply(s,r),s;break}}return o(t,d)(r,e,!f,s,Q.test(t)&&ht(e.parentNode)||e),s}(t.replace(V,"$1"),e,s,r)}function et(){var t=[];return function e(i,s){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=s}}function it(t){return t[b]=!0,t}function nt(t){var e=c.createElement("div");try{return!!t(e)}catch(bt){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function st(t,e){for(var i=t.split("|"),s=t.length;s--;)n.attrHandle[i[s]]=e}function rt(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ot(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function at(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function lt(t){return it((function(e){return e=+e,it((function(i,n){for(var s,r=t([],i.length,e),o=r.length;o--;)i[s=r[o]]&&(i[s]=!(n[s]=i[s]))}))}))}function ht(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=tt.support={},r=tt.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},u=tt.setDocument=function(t){var e,s=t?t.ownerDocument||t:v,o=s.defaultView;return s!==c&&9===s.nodeType&&s.documentElement?(c=s,d=s.documentElement,f=!r(s),o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",(function(){u()}),!1):o.attachEvent&&o.attachEvent("onunload",(function(){u()}))),i.attributes=nt((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=nt((function(t){return t.appendChild(s.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=X.test(s.getElementsByClassName)&&nt((function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length})),i.getById=nt((function(t){return d.appendChild(t).id=b,!s.getElementsByName||!s.getElementsByName(b).length})),i.getById?(n.find.ID=function(t,e){if(void 0!==e.getElementById&&f){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},n.filter.ID=function(t){var e=t.replace($,J);return function(t){return t.getAttribute("id")===e}}):(delete n.find.ID,n.filter.ID=function(t){var e=t.replace($,J);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),n.find.TAG=i.getElementsByTagName?function(t,e){if(void 0!==e.getElementsByTagName)return e.getElementsByTagName(t)}:function(t,e){var i,n=[],s=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[s++];)1===i.nodeType&&n.push(i);return n}return r},n.find.CLASS=i.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&f)return e.getElementsByClassName(t)},m=[],p=[],(i.qsa=X.test(s.querySelectorAll))&&(nt((function(t){t.innerHTML="<select t=''><option selected=''></option></select>",t.querySelectorAll("[t^='']").length&&p.push("[*^$]="+N+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||p.push("\\["+N+"*(?:value|"+O+")"),t.querySelectorAll(":checked").length||p.push(":checked")})),nt((function(t){var e=s.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&p.push("name"+N+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||p.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),p.push(",.*:")}))),(i.matchesSelector=X.test(g=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&nt((function(t){i.disconnectedMatch=g.call(t,"div"),g.call(t,"[s!='']:x"),m.push("!=",F)})),p=p.length&&new RegExp(p.join("|")),m=m.length&&new RegExp(m.join("|")),e=X.test(d.compareDocumentPosition),y=e||X.test(d.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},S=e?function(t,e){if(t===e)return h=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t===s||t.ownerDocument===v&&y(v,t)?-1:e===s||e.ownerDocument===v&&y(v,e)?1:l?L.call(l,t)-L.call(l,e):0:4&n?-1:1)}:function(t,e){if(t===e)return h=!0,0;var i,n=0,r=t.parentNode,o=e.parentNode,a=[t],u=[e];if(!r||!o)return t===s?-1:e===s?1:r?-1:o?1:l?L.call(l,t)-L.call(l,e):0;if(r===o)return rt(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)u.unshift(i);for(;a[n]===u[n];)n++;return n?rt(a[n],u[n]):a[n]===v?-1:u[n]===v?1:0},s):c},tt.matches=function(t,e){return tt(t,null,null,e)},tt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==c&&u(t),e=e.replace(G,"='$1']"),i.matchesSelector&&f&&(!m||!m.test(e))&&(!p||!p.test(e)))try{var n=g.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(bt){}return tt(e,c,null,[t]).length>0},tt.contains=function(t,e){return(t.ownerDocument||t)!==c&&u(t),y(t,e)},tt.attr=function(t,e){(t.ownerDocument||t)!==c&&u(t);var s=n.attrHandle[e.toLowerCase()],r=s&&D.call(n.attrHandle,e.toLowerCase())?s(t,e,!f):void 0;return void 0!==r?r:i.attributes||!f?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},tt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},tt.uniqueSort=function(t){var e,n=[],s=0,r=0;if(h=!i.detectDuplicates,l=!i.sortStable&&t.slice(0),t.sort(S),h){for(;e=t[r++];)e===t[r]&&(s=n.push(r));for(;s--;)t.splice(n[s],1)}return l=null,t},s=tt.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=s(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=s(e);return i},(n=tt.selectors={cacheLength:50,createPseudo:it,match:U,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace($,J),t[3]=(t[4]||t[5]||"").replace($,J),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||tt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&tt.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return U.CHILD.test(t[0])?null:(t[3]&&void 0!==t[4]?t[2]=t[4]:i&&q.test(i)&&(e=ct(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace($,J).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=A[t+" "];return e||(e=new RegExp("(^|"+N+")"+t+"("+N+"|$)"))&&A(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var s=tt.attr(n,t);return null==s?"!="===e:!e||(s+="","="===e?s===i:"!="===e?s!==i:"^="===e?i&&0===s.indexOf(i):"*="===e?i&&s.indexOf(i)>-1:"$="===e?i&&s.slice(-i.length)===i:"~="===e?(" "+s+" ").indexOf(i)>-1:"|="===e&&(s===i||s.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,s){var r="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,l){var h,u,c,d,f,p,m=r!==o?"nextSibling":"previousSibling",g=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!l&&!a;if(g){if(r){for(;m;){for(c=e;c=c[m];)if(a?c.nodeName.toLowerCase()===y:1===c.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[o?g.firstChild:g.lastChild],o&&v){for(f=(h=(u=g[b]||(g[b]={}))[t]||[])[0]===_&&h[1],d=h[0]===_&&h[2],c=f&&g.childNodes[f];c=++f&&c&&c[m]||(d=f=0)||p.pop();)if(1===c.nodeType&&++d&&c===e){u[t]=[_,f,d];break}}else if(v&&(h=(e[b]||(e[b]={}))[t])&&h[0]===_)d=h[1];else for(;(c=++f&&c&&c[m]||(d=f=0)||p.pop())&&((a?c.nodeName.toLowerCase()!==y:1!==c.nodeType)||!++d||(v&&((c[b]||(c[b]={}))[t]=[_,d]),c!==e)););return(d-=s)===n||d%n==0&&d/n>=0}}},PSEUDO:function(t,e){var i,s=n.pseudos[t]||n.setFilters[t.toLowerCase()]||tt.error("unsupported pseudo: "+t);return s[b]?s(e):s.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?it((function(t,i){for(var n,r=s(t,e),o=r.length;o--;)t[n=L.call(t,r[o])]=!(i[n]=r[o])})):function(t){return s(t,0,i)}):s}},pseudos:{not:it((function(t){var e=[],i=[],n=o(t.replace(V,"$1"));return n[b]?it((function(t,e,i,s){for(var r,o=n(t,null,s,[]),a=t.length;a--;)(r=o[a])&&(t[a]=!(e[a]=r))})):function(t,s,r){return e[0]=t,n(e,null,r,i),!i.pop()}})),has:it((function(t){return function(e){return tt(t,e).length>0}})),contains:it((function(t){return function(e){return(e.textContent||e.innerText||s(e)).indexOf(t)>-1}})),lang:it((function(t){return Y.test(t||"")||tt.error("unsupported lang: "+t),t=t.replace($,J).toLowerCase(),function(e){var i;do{if(i=f?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return W.test(t.nodeName)},input:function(t){return j.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:lt((function(){return[0]})),last:lt((function(t,e){return[e-1]})),eq:lt((function(t,e,i){return[i<0?i+e:i]})),even:lt((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:lt((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:lt((function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t})),gt:lt((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=ot(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=at(e);function ut(){}function ct(t,e){var i,s,r,o,a,l,h,u=x[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],h=n.preFilter;a;){for(o in i&&!(s=H.exec(a))||(s&&(a=a.slice(s[0].length)||a),l.push(r=[])),i=!1,(s=z.exec(a))&&(i=s.shift(),r.push({value:i,type:s[0].replace(V," ")}),a=a.slice(i.length)),n.filter)!(s=U[o].exec(a))||h[o]&&!(s=h[o](s))||(i=s.shift(),r.push({value:i,type:o,matches:s}),a=a.slice(i.length));if(!i)break}return e?a.length:a?tt.error(t):x(t,l).slice(0)}function dt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function ft(t,e,i){var n=e.dir,s=i&&"parentNode"===n,r=w++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r)}:function(e,i,o){var a,l,h=[_,r];if(o){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||s){if((a=(l=e[b]||(e[b]={}))[n])&&a[0]===_&&a[1]===r)return h[2]=a[2];if(l[n]=h,h[2]=t(e,i,o))return!0}}}function pt(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function mt(t,e,i,n,s){for(var r,o=[],a=0,l=t.length,h=null!=e;a<l;a++)(r=t[a])&&(i&&!i(r,n,s)||(o.push(r),h&&e.push(a)));return o}function gt(t,e,i,n,s,r){return n&&!n[b]&&(n=gt(n)),s&&!s[b]&&(s=gt(s,r)),it((function(r,o,a,l){var h,u,c,d=[],f=[],p=o.length,m=r||function(t,e,i){for(var n=0,s=e.length;n<s;n++)tt(t,e[n],i);return i}(e||"*",a.nodeType?[a]:a,[]),g=!t||!r&&e?m:mt(m,d,t,a,l),y=i?s||(r?t:p||n)?[]:o:g;if(i&&i(g,y,a,l),n)for(h=mt(y,f),n(h,[],a,l),u=h.length;u--;)(c=h[u])&&(y[f[u]]=!(g[f[u]]=c));if(r){if(s||t){if(s){for(h=[],u=y.length;u--;)(c=y[u])&&h.push(g[u]=c);s(null,y=[],h,l)}for(u=y.length;u--;)(c=y[u])&&(h=s?L.call(r,c):d[u])>-1&&(r[h]=!(o[h]=c))}}else y=mt(y===o?y.splice(p,y.length):y),s?s(null,o,y,l):P.apply(o,y)}))}function yt(t){for(var e,i,s,r=t.length,o=n.relative[t[0].type],l=o||n.relative[" "],h=o?1:0,u=ft((function(t){return t===e}),l,!0),c=ft((function(t){return L.call(e,t)>-1}),l,!0),d=[function(t,i,n){return!o&&(n||i!==a)||((e=i).nodeType?u(t,i,n):c(t,i,n))}];h<r;h++)if(i=n.relative[t[h].type])d=[ft(pt(d),i)];else{if((i=n.filter[t[h].type].apply(null,t[h].matches))[b]){for(s=++h;s<r&&!n.relative[t[s].type];s++);return gt(h>1&&pt(d),h>1&&dt(t.slice(0,h-1).concat({value:" "===t[h-2].type?"*":""})).replace(V,"$1"),i,h<s&&yt(t.slice(h,s)),s<r&&yt(t=t.slice(s)),s<r&&dt(t))}d.push(i)}return pt(d)}return ut.prototype=n.filters=n.pseudos,n.setFilters=new ut,o=tt.compile=function(t,e){var i,s=[],r=[],o=T[t+" "];if(!o){for(e||(e=ct(t)),i=e.length;i--;)(o=yt(e[i]))[b]?s.push(o):r.push(o);o=T(t,function(t,e){var i=e.length>0,s=t.length>0,r=function(r,o,l,h,u){var d,f,p,m=0,g="0",y=r&&[],b=[],v=a,w=r||s&&n.find.TAG("*",u),A=_+=null==v?1:Math.random()||.1,x=w.length;for(u&&(a=o!==c&&o);g!==x&&null!=(d=w[g]);g++){if(s&&d){for(f=0;p=t[f++];)if(p(d,o,l)){h.push(d);break}u&&(_=A)}i&&((d=!p&&d)&&m--,r&&y.push(d))}if(m+=g,i&&g!==m){for(f=0;p=e[f++];)p(y,b,o,l);if(r){if(m>0)for(;g--;)y[g]||b[g]||(b[g]=C.call(h));b=mt(b)}P.apply(h,b),u&&!r&&b.length>0&&m+e.length>1&&tt.uniqueSort(h)}return u&&(_=A,a=v),y};return i?it(r):r}(r,s))}return o},i.sortStable=b.split("").sort(S).join("")===b,i.detectDuplicates=!!h,u(),i.sortDetached=nt((function(t){return 1&t.compareDocumentPosition(c.createElement("div"))})),nt((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||st("type|href|height|width",(function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&nt((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||st("value",(function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),nt((function(t){return null==t.getAttribute("disabled")}))||st(O,(function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null})),tt}(t);f.find=b,f.expr=b.selectors,f.expr[":"]=f.expr.pseudos,f.unique=b.uniqueSort,f.text=b.getText,f.isXMLDoc=b.isXML,f.contains=b.contains;var v=f.expr.match.needsContext,_=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function A(t,e,i){if(f.isFunction(e))return f.grep(t,(function(t,n){return!!e.call(t,n,t)!==i}));if(e.nodeType)return f.grep(t,(function(t){return t===e!==i}));if("string"==typeof e){if(w.test(e))return f.filter(e,t,i);e=f.filter(e,t)}return f.grep(t,(function(t){return o.call(e,t)>=0!==i}))}f.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?f.find.matchesSelector(n,t)?[n]:[]:f.find.matches(t,f.grep(e,(function(t){return 1===t.nodeType})))},f.fn.extend({find:function(t){var e,i=this.length,n=[],s=this;if("string"!=typeof t)return this.pushStack(f(t).filter((function(){for(e=0;e<i;e++)if(f.contains(s[e],this))return!0})));for(e=0;e<i;e++)f.find(t,s[e],n);return(n=this.pushStack(i>1?f.unique(n):n)).selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(A(this,t||[],!1))},not:function(t){return this.pushStack(A(this,t||[],!0))},is:function(t){return!!A(this,"string"==typeof t&&v.test(t)?f(t):t||[],!1).length}});var x,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(f.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:T.exec(t))||!i[1]&&e)return!e||e.jquery?(e||x).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof f?e[0]:e,f.merge(this,f.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:d,!0)),_.test(i[1])&&f.isPlainObject(e))for(i in e)f.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(n=d.getElementById(i[2]))&&n.parentNode&&(this.length=1,this[0]=n),this.context=d,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):f.isFunction(t)?void 0!==x.ready?x.ready(t):t(f):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),f.makeArray(t,this))}).prototype=f.fn,x=f(d);var S=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};function E(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}f.extend({dir:function(t,e,i){for(var n=[],s=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(s&&f(t).is(i))break;n.push(t)}return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),f.fn.extend({has:function(t){var e=f(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(f.contains(this,e[t]))return!0}))},closest:function(t,e){for(var i,n=0,s=this.length,r=[],o=v.test(t)||"string"!=typeof t?f(t,e||this.context):0;n<s;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&f.find.matchesSelector(i,t))){r.push(i);break}return this.pushStack(r.length>1?f.unique(r):r)},index:function(t){return t?"string"==typeof t?o.call(f(t),this[0]):o.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(f.unique(f.merge(this.get(),f(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),f.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return f.dir(t,"parentNode")},parentsUntil:function(t,e,i){return f.dir(t,"parentNode",i)},next:function(t){return E(t,"nextSibling")},prev:function(t){return E(t,"previousSibling")},nextAll:function(t){return f.dir(t,"nextSibling")},prevAll:function(t){return f.dir(t,"previousSibling")},nextUntil:function(t,e,i){return f.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return f.dir(t,"previousSibling",i)},siblings:function(t){return f.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return f.sibling(t.firstChild)},contents:function(t){return t.contentDocument||f.merge([],t.childNodes)}},(function(t,e){f.fn[t]=function(i,n){var s=f.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=f.filter(n,s)),this.length>1&&(D[t]||f.unique(s),S.test(t)&&s.reverse()),this.pushStack(s)}}));var C,I=/\S+/g,P={};function k(){d.removeEventListener("DOMContentLoaded",k,!1),t.removeEventListener("load",k,!1),f.ready()}f.Callbacks=function(t){t="string"==typeof t?P[t]||function(t){var e=P[t]={};return f.each(t.match(I)||[],(function(t,i){e[i]=!0})),e}(t):f.extend({},t);var e,i,n,s,r,o,a=[],l=!t.once&&[],h=function(c){for(e=t.memory&&c,i=!0,o=s||0,s=0,r=a.length,n=!0;a&&o<r;o++)if(!1===a[o].apply(c[0],c[1])&&t.stopOnFalse){e=!1;break}n=!1,a&&(l?l.length&&h(l.shift()):e?a=[]:u.disable())},u={add:function(){if(a){var i=a.length;!function e(i){f.each(i,(function(i,n){var s=f.type(n);"function"===s?t.unique&&u.has(n)||a.push(n):n&&n.length&&"string"!==s&&e(n)}))}(arguments),n?r=a.length:e&&(s=i,h(e))}return this},remove:function(){return a&&f.each(arguments,(function(t,e){for(var i;(i=f.inArray(e,a,i))>-1;)a.splice(i,1),n&&(i<=r&&r--,i<=o&&o--)})),this},has:function(t){return t?f.inArray(t,a)>-1:!(!a||!a.length)},empty:function(){return a=[],r=0,this},disable:function(){return a=l=e=void 0,this},disabled:function(){return!a},lock:function(){return l=void 0,e||u.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!a||i&&!l||(e=[t,(e=e||[]).slice?e.slice():e],n?l.push(e):h(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},f.extend({Deferred:function(t){var e=[["resolve","done",f.Callbacks("once memory"),"resolved"],["reject","fail",f.Callbacks("once memory"),"rejected"],["notify","progress",f.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return f.Deferred((function(i){f.each(e,(function(e,r){var o=f.isFunction(t[e])&&t[e];s[r[1]]((function(){var t=o&&o.apply(this,arguments);t&&f.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r[0]+"With"](this===n?i.promise():this,o?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?f.extend(t,n):n}},s={};return n.pipe=n.then,f.each(e,(function(t,r){var o=r[2],a=r[3];n[r[1]]=o.add,a&&o.add((function(){i=a}),e[1^t][2].disable,e[2][2].lock),s[r[0]]=function(){return s[r[0]+"With"](this===s?n:this,arguments),this},s[r[0]+"With"]=o.fireWith})),n.promise(s),t&&t.call(s,s),s},when:function(t){var e,i,s,r=0,o=n.call(arguments),a=o.length,l=1!==a||t&&f.isFunction(t.promise)?a:0,h=1===l?t:f.Deferred(),u=function(t,i,s){return function(r){i[t]=this,s[t]=arguments.length>1?n.call(arguments):r,s===e?h.notifyWith(i,s):--l||h.resolveWith(i,s)}};if(a>1)for(e=new Array(a),i=new Array(a),s=new Array(a);r<a;r++)o[r]&&f.isFunction(o[r].promise)?o[r].promise().done(u(r,s,o)).fail(h.reject).progress(u(r,i,e)):--l;return l||h.resolveWith(s,o),h.promise()}}),f.fn.ready=function(t){return f.ready.promise().done(t),this},f.extend({isReady:!1,readyWait:1,holdReady:function(t){t?f.readyWait++:f.ready(!0)},ready:function(t){(!0===t?--f.readyWait:f.isReady)||(f.isReady=!0,!0!==t&&--f.readyWait>0||(C.resolveWith(d,[f]),f.fn.trigger&&f(d).trigger("ready").off("ready")))}}),f.ready.promise=function(e){return C||(C=f.Deferred(),"complete"===d.readyState?setTimeout(f.ready):(d.addEventListener("DOMContentLoaded",k,!1),t.addEventListener("load",k,!1))),C.promise(e)},f.ready.promise();var L=f.access=function(t,e,i,n,s,r,o){var a=0,l=t.length,h=null==i;if("object"===f.type(i))for(a in s=!0,i)f.access(t,e,a,i[a],!0,r,o);else if(void 0!==n&&(s=!0,f.isFunction(n)||(o=!0),h&&(o?(e.call(t,n),e=null):(h=e,e=function(t,e,i){return h.call(f(t),i)})),e))for(;a<l;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return s?t:h?e.call(t):l?e(t[0],i):r};function O(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=f.expando+Math.random()}f.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},O.uid=1,O.accepts=f.acceptData,O.prototype={key:function(t){if(!O.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=O.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(n){e[this.expando]=i,f.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var n,s=this.key(t),r=this.cache[s];if("string"==typeof e)r[e]=i;else if(f.isEmptyObject(r))f.extend(this.cache[s],e);else for(n in e)r[n]=e[n];return r},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?void 0!==(n=this.get(t,e))?n:this.get(t,f.camelCase(e)):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,s,r=this.key(t),o=this.cache[r];if(void 0===e)this.cache[r]={};else{f.isArray(e)?n=e.concat(e.map(f.camelCase)):(s=f.camelCase(e),n=e in o?[e,s]:(n=s)in o?[n]:n.match(I)||[]),i=n.length;for(;i--;)delete o[n[i]]}},hasData:function(t){return!f.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var N=new O,R=new O,M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,B=/([A-Z])/g;function F(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(B,"-$1").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:M.test(i)?f.parseJSON(i):i)}catch(s){}R.set(t,e,i)}else i=void 0;return i}f.extend({hasData:function(t){return R.hasData(t)||N.hasData(t)},data:function(t,e,i){return R.access(t,e,i)},removeData:function(t,e){R.remove(t,e)},_data:function(t,e,i){return N.access(t,e,i)},_removeData:function(t,e){N.remove(t,e)}}),f.fn.extend({data:function(t,e){var i,n,s,r=this[0],o=r&&r.attributes;if(void 0===t){if(this.length&&(s=R.get(r),1===r.nodeType&&!N.get(r,"hasDataAttrs"))){for(i=o.length;i--;)0===(n=o[i].name).indexOf("data-")&&(n=f.camelCase(n.slice(5)),F(r,n,s[n]));N.set(r,"hasDataAttrs",!0)}return s}return"object"==typeof t?this.each((function(){R.set(this,t)})):L(this,(function(e){var i,n=f.camelCase(t);if(r&&void 0===e)return void 0!==(i=R.get(r,t))||void 0!==(i=R.get(r,n))||void 0!==(i=F(r,n,void 0))?i:void 0;this.each((function(){var i=R.get(this,n);R.set(this,n,e),-1!==t.indexOf("-")&&void 0!==i&&R.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){R.remove(this,t)}))}}),f.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=N.get(t,e),i&&(!n||f.isArray(i)?n=N.access(t,e,f.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=f.queue(t,e),n=i.length,s=i.shift(),r=f._queueHooks(t,e);"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete r.stop,s.call(t,(function(){f.dequeue(t,e)}),r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return N.get(t,i)||N.access(t,i,{empty:f.Callbacks("once memory").add((function(){N.remove(t,[e+"queue",i])}))})}}),f.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?f.queue(this[0],t):void 0===e?this:this.each((function(){var i=f.queue(this,t,e);f._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&f.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){f.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,s=f.Deferred(),r=this,o=this.length,a=function(){--n||s.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(i=N.get(r[o],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),s.promise(e)}});var V,H=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,z=["Top","Right","Bottom","Left"],G=function(t,e){return t=e||t,"none"===f.css(t,"display")||!f.contains(t.ownerDocument,t)},q=/^(?:checkbox|radio)$/i;(V=d.createDocumentFragment().appendChild(d.createElement("div"))).innerHTML="<input type='radio' checked='checked' name='t'/>",c.checkClone=V.cloneNode(!0).cloneNode(!0).lastChild.checked,V.innerHTML="<textarea>x</textarea>",c.noCloneChecked=!!V.cloneNode(!0).lastChild.defaultValue;c.focusinBubbles="onfocusin"in t;var Y=/^key/,U=/^(?:mouse|contextmenu)|click/,j=/^(?:focusinfocus|focusoutblur)$/,W=/^([^.]*)(?:\.(.+)|)$/;function X(){return!0}function K(){return!1}function Q(){try{return d.activeElement}catch(t){}}f.event={global:{},add:function(t,e,i,n,s){var r,o,a,l,h,u,c,d,p,m,g,y=N.get(t);if(y)for(i.handler&&(i=(r=i).handler,s=r.selector),i.guid||(i.guid=f.guid++),(l=y.events)||(l=y.events={}),(o=y.handle)||(o=y.handle=function(e){return void 0!==f&&f.event.triggered!==e.type?f.event.dispatch.apply(t,arguments):void 0}),h=(e=(e||"").match(I)||[""]).length;h--;)p=g=(a=W.exec(e[h])||[])[1],m=(a[2]||"").split(".").sort(),p&&(c=f.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,c=f.event.special[p]||{},u=f.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&f.expr.match.needsContext.test(s),namespace:m.join(".")},r),(d=l[p])||((d=l[p]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(t,n,m,o)||t.addEventListener&&t.addEventListener(p,o,!1)),c.add&&(c.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),s?d.splice(d.delegateCount++,0,u):d.push(u),f.event.global[p]=!0)},remove:function(t,e,i,n,s){var r,o,a,l,h,u,c,d,p,m,g,y=N.hasData(t)&&N.get(t);if(y&&(l=y.events)){for(h=(e=(e||"").match(I)||[""]).length;h--;)if(p=g=(a=W.exec(e[h])||[])[1],m=(a[2]||"").split(".").sort(),p){for(c=f.event.special[p]||{},d=l[p=(n?c.delegateType:c.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=d.length;r--;)u=d[r],!s&&g!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(r,1),u.selector&&d.delegateCount--,c.remove&&c.remove.call(t,u));o&&!d.length&&(c.teardown&&!1!==c.teardown.call(t,m,y.handle)||f.removeEvent(t,p,y.handle),delete l[p])}else for(p in l)f.event.remove(t,p+e[h],i,n,!0);f.isEmptyObject(l)&&(delete y.handle,N.remove(t,"events"))}},trigger:function(e,i,n,s){var r,o,a,l,u,c,p,m=[n||d],g=h.call(e,"type")?e.type:e,y=h.call(e,"namespace")?e.namespace.split("."):[];if(o=a=n=n||d,3!==n.nodeType&&8!==n.nodeType&&!j.test(g+f.event.triggered)&&(g.indexOf(".")>=0&&(y=g.split("."),g=y.shift(),y.sort()),u=g.indexOf(":")<0&&"on"+g,(e=e[f.expando]?e:new f.Event(g,"object"==typeof e&&e)).isTrigger=s?2:3,e.namespace=y.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:f.makeArray(i,[e]),p=f.event.special[g]||{},s||!p.trigger||!1!==p.trigger.apply(n,i))){if(!s&&!p.noBubble&&!f.isWindow(n)){for(l=p.delegateType||g,j.test(l+g)||(o=o.parentNode);o;o=o.parentNode)m.push(o),a=o;a===(n.ownerDocument||d)&&m.push(a.defaultView||a.parentWindow||t)}for(r=0;(o=m[r++])&&!e.isPropagationStopped();)e.type=r>1?l:p.bindType||g,(c=(N.get(o,"events")||{})[e.type]&&N.get(o,"handle"))&&c.apply(o,i),(c=u&&o[u])&&c.apply&&f.acceptData(o)&&(e.result=c.apply(o,i),!1===e.result&&e.preventDefault());return e.type=g,s||e.isDefaultPrevented()||p._default&&!1!==p._default.apply(m.pop(),i)||!f.acceptData(n)||u&&f.isFunction(n[g])&&!f.isWindow(n)&&((a=n[u])&&(n[u]=null),f.event.triggered=g,n[g](),f.event.triggered=void 0,a&&(n[u]=a)),e.result}},dispatch:function(t){t=f.event.fix(t);var e,i,s,r,o,a=[],l=n.call(arguments),h=(N.get(this,"events")||{})[t.type]||[],u=f.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(a=f.event.handlers.call(this,t,h),e=0;(r=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!t.isImmediatePropagationStopped();)t.namespace_re&&!t.namespace_re.test(o.namespace)||(t.handleObj=o,t.data=o.data,void 0!==(s=((f.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,l))&&!1===(t.result=s)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,s,r,o=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==t.type){for(n=[],i=0;i<a;i++)void 0===n[s=(r=e[i]).selector+" "]&&(n[s]=r.needsContext?f(s,this).index(l)>=0:f.find(s,this,null,[l]).length),n[s]&&n.push(r);n.length&&o.push({elem:l,handlers:n})}return a<e.length&&o.push({elem:this,handlers:e.slice(a)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,s,r=e.button;return null==t.pageX&&null!=e.clientX&&(n=(i=t.target.ownerDocument||d).documentElement,s=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[f.expando])return t;var e,i,n,s=t.type,r=t,o=this.fixHooks[s];for(o||(this.fixHooks[s]=o=U.test(s)?this.mouseHooks:Y.test(s)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new f.Event(r),e=n.length;e--;)t[i=n[e]]=r[i];return t.target||(t.target=d),3===t.target.nodeType&&(t.target=t.target.parentNode),o.filter?o.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Q()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Q()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&f.nodeName(this,"input"))return this.click(),!1},_default:function(t){return f.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var s=f.extend(new f.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?f.event.trigger(s,null,e):f.event.dispatch.call(e,s),s.isDefaultPrevented()&&i.preventDefault()}},f.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},f.Event=function(t,e){if(!(this instanceof f.Event))return new f.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.getPreventDefault&&t.getPreventDefault()?X:K):this.type=t,e&&f.extend(this,e),this.timeStamp=t&&t.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={isDefaultPrevented:K,isPropagationStopped:K,isImmediatePropagationStopped:K,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=X,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=X,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=X,this.stopPropagation()}},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},(function(t,e){f.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,s=t.relatedTarget,r=t.handleObj;return s&&(s===n||f.contains(n,s))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}})),c.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){f.event.simulate(e,t.target,f.event.fix(t),!0)};f.event.special[e]={setup:function(){var n=this.ownerDocument||this,s=N.access(n,e);s||n.addEventListener(t,i,!0),N.access(n,e,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=N.access(n,e)-1;s?N.access(n,e,s):(n.removeEventListener(t,i,!0),N.remove(n,e))}}})),f.fn.extend({on:function(t,e,i,n,s){var r,o;if("object"==typeof t){for(o in"string"!=typeof e&&(i=i||e,e=void 0),t)this.on(o,e,i,t[o],s);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),!1===n)n=K;else if(!n)return this;return 1===s&&(r=n,(n=function(t){return f().off(t),r.apply(this,arguments)}).guid=r.guid||(r.guid=f.guid++)),this.each((function(){f.event.add(this,t,n,i,e)}))},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,s;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,f(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(s in t)this.off(s,e,t[s]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=K),this.each((function(){f.event.remove(this,t,i,e)}))},trigger:function(t,e){return this.each((function(){f.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return f.event.trigger(t,e,i,!0)}});var Z=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,$=/<([\w:]+)/,J=/<|&#?\w+;/,tt=/<(?:script|style|link)/i,et=/checked\s*(?:[^=]|=\s*.checked.)/i,it=/^$|\/(?:java|ecma)script/i,nt=/^true\/(.*)/,st=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ot(t,e){return f.nodeName(t,"table")&&f.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function at(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function lt(t){var e=nt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function ht(t,e){for(var i=0,n=t.length;i<n;i++)N.set(t[i],"globalEval",!e||N.get(e[i],"globalEval"))}function ut(t,e){var i,n,s,r,o,a,l,h;if(1===e.nodeType){if(N.hasData(t)&&(r=N.access(t),o=N.set(e,r),h=r.events))for(s in delete o.handle,o.events={},h)for(i=0,n=h[s].length;i<n;i++)f.event.add(e,s,h[s][i]);R.hasData(t)&&(a=R.access(t),l=f.extend({},a),R.set(e,l))}}function ct(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&f.nodeName(t,e)?f.merge([t],i):i}rt.optgroup=rt.option,rt.tbody=rt.tfoot=rt.colgroup=rt.caption=rt.thead,rt.th=rt.td,f.extend({clone:function(t,e,i){var n,s,r,o,a,l,h,u=t.cloneNode(!0),d=f.contains(t.ownerDocument,t);if(!(c.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||f.isXMLDoc(t)))for(o=ct(u),n=0,s=(r=ct(t)).length;n<s;n++)a=r[n],l=o[n],h=void 0,"input"===(h=l.nodeName.toLowerCase())&&q.test(a.type)?l.checked=a.checked:"input"!==h&&"textarea"!==h||(l.defaultValue=a.defaultValue);if(e)if(i)for(r=r||ct(t),o=o||ct(u),n=0,s=r.length;n<s;n++)ut(r[n],o[n]);else ut(t,u);return(o=ct(u,"script")).length>0&&ht(o,!d&&ct(t,"script")),u},buildFragment:function(t,e,i,n){for(var s,r,o,a,l,h,u=e.createDocumentFragment(),c=[],d=0,p=t.length;d<p;d++)if((s=t[d])||0===s)if("object"===f.type(s))f.merge(c,s.nodeType?[s]:s);else if(J.test(s)){for(r=r||u.appendChild(e.createElement("div")),o=($.exec(s)||["",""])[1].toLowerCase(),a=rt[o]||rt._default,r.innerHTML=a[1]+s.replace(Z,"<$1></$2>")+a[2],h=a[0];h--;)r=r.lastChild;f.merge(c,r.childNodes),(r=u.firstChild).textContent=""}else c.push(e.createTextNode(s));for(u.textContent="",d=0;s=c[d++];)if((!n||-1===f.inArray(s,n))&&(l=f.contains(s.ownerDocument,s),r=ct(u.appendChild(s),"script"),l&&ht(r),i))for(h=0;s=r[h++];)it.test(s.type||"")&&i.push(s);return u},cleanData:function(t){for(var e,i,n,s,r,o,a=f.event.special,l=0;void 0!==(i=t[l]);l++){if(f.acceptData(i)&&(r=i[N.expando])&&(e=N.cache[r])){if((n=Object.keys(e.events||{})).length)for(o=0;void 0!==(s=n[o]);o++)a[s]?f.event.remove(i,s):f.removeEvent(i,s,e.handle);N.cache[r]&&delete N.cache[r]}delete R.cache[i[R.expando]]}}}),f.fn.extend({text:function(t){return L(this,(function(t){return void 0===t?f.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return this.domManip(arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ot(this,t).appendChild(t)}))},prepend:function(){return this.domManip(arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=ot(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return this.domManip(arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return this.domManip(arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},remove:function(t,e){for(var i,n=t?f.filter(t,this):this,s=0;null!=(i=n[s]);s++)e||1!==i.nodeType||f.cleanData(ct(i)),i.parentNode&&(e&&f.contains(i.ownerDocument,i)&&ht(ct(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(f.cleanData(ct(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return f.clone(this,t,e)}))},html:function(t){return L(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!tt.test(t)&&!rt[($.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Z,"<$1></$2>");try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(f.cleanData(ct(e,!1)),e.innerHTML=t);e=0}catch(s){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,(function(e){t=this.parentNode,f.cleanData(ct(this)),t&&t.replaceChild(e,this)})),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=s.apply([],t);var i,n,r,o,a,l,h=0,u=this.length,d=this,p=u-1,m=t[0],g=f.isFunction(m);if(g||u>1&&"string"==typeof m&&!c.checkClone&&et.test(m))return this.each((function(i){var n=d.eq(i);g&&(t[0]=m.call(this,i,n.html())),n.domManip(t,e)}));if(u&&(n=(i=f.buildFragment(t,this[0].ownerDocument,!1,this)).firstChild,1===i.childNodes.length&&(i=n),n)){for(o=(r=f.map(ct(i,"script"),at)).length;h<u;h++)a=i,h!==p&&(a=f.clone(a,!0,!0),o&&f.merge(r,ct(a,"script"))),e.call(this[h],a,h);if(o)for(l=r[r.length-1].ownerDocument,f.map(r,lt),h=0;h<o;h++)a=r[h],it.test(a.type||"")&&!N.access(a,"globalEval")&&f.contains(l,a)&&(a.src?f._evalUrl&&f._evalUrl(a.src):f.globalEval(a.textContent.replace(st,"")))}return this}}),f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){f.fn[t]=function(t){for(var i,n=[],s=f(t),o=s.length-1,a=0;a<=o;a++)i=a===o?this:this.clone(!0),f(s[a])[e](i),r.apply(n,i.get());return this.pushStack(n)}}));var dt,ft={};function pt(e,i){var n=f(i.createElement(e)).appendTo(i.body),s=t.getDefaultComputedStyle?t.getDefaultComputedStyle(n[0]).display:f.css(n[0],"display");return n.detach(),s}function mt(t){var e=d,i=ft[t];return i||("none"!==(i=pt(t,e))&&i||((e=(dt=(dt||f("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),i=pt(t,e),dt.detach()),ft[t]=i),i}var gt=/^margin/,yt=new RegExp("^("+H+")(?!px)[a-z%]+$","i"),bt=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)};function vt(t,e,i){var n,s,r,o,a=t.style;return(i=i||bt(t))&&(o=i.getPropertyValue(e)||i[e]),i&&(""!==o||f.contains(t.ownerDocument,t)||(o=f.style(t,e)),yt.test(o)&&gt.test(e)&&(n=a.width,s=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=s,a.maxWidth=r)),void 0!==o?o+"":o}function _t(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){var e,i,n=d.documentElement,s=d.createElement("div"),r=d.createElement("div");function o(){r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",n.appendChild(s);var o=t.getComputedStyle(r,null);e="1%"!==o.top,i="4px"===o.width,n.removeChild(s)}r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",c.clearCloneStyle="content-box"===r.style.backgroundClip,s.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(r),t.getComputedStyle&&f.extend(c,{pixelPosition:function(){return o(),e},boxSizingReliable:function(){return null==i&&o(),i},reliableMarginRight:function(){var e,i=r.appendChild(d.createElement("div"));return i.style.cssText=r.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",i.style.marginRight=i.style.width="0",r.style.width="1px",n.appendChild(s),e=!parseFloat(t.getComputedStyle(i,null).marginRight),n.removeChild(s),r.innerHTML="",e}})}(),f.swap=function(t,e,i,n){var s,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in s=i.apply(t,n||[]),e)t.style[r]=o[r];return s};var wt=/^(none|table(?!-c[ea]).+)/,At=new RegExp("^("+H+")(.*)$","i"),xt=new RegExp("^([+-])=("+H+")","i"),Tt={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},Dt=["Webkit","O","Moz","ms"];function Et(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),n=e,s=Dt.length;s--;)if((e=Dt[s]+i)in t)return e;return n}function Ct(t,e,i){var n=At.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function It(t,e,i,n,s){for(var r=i===(n?"border":"content")?4:"width"===e?1:0,o=0;r<4;r+=2)"margin"===i&&(o+=f.css(t,i+z[r],!0,s)),n?("content"===i&&(o-=f.css(t,"padding"+z[r],!0,s)),"margin"!==i&&(o-=f.css(t,"border"+z[r]+"Width",!0,s))):(o+=f.css(t,"padding"+z[r],!0,s),"padding"!==i&&(o+=f.css(t,"border"+z[r]+"Width",!0,s)));return o}function Pt(t,e,i){var n=!0,s="width"===e?t.offsetWidth:t.offsetHeight,r=bt(t),o="border-box"===f.css(t,"boxSizing",!1,r);if(s<=0||null==s){if(((s=vt(t,e,r))<0||null==s)&&(s=t.style[e]),yt.test(s))return s;n=o&&(c.boxSizingReliable()||s===t.style[e]),s=parseFloat(s)||0}return s+It(t,e,i||(o?"border":"content"),n,r)+"px"}function kt(t,e){for(var i,n,s,r=[],o=0,a=t.length;o<a;o++)(n=t[o]).style&&(r[o]=N.get(n,"olddisplay"),i=n.style.display,e?(r[o]||"none"!==i||(n.style.display=""),""===n.style.display&&G(n)&&(r[o]=N.access(n,"olddisplay",mt(n.nodeName)))):r[o]||(s=G(n),(i&&"none"!==i||!s)&&N.set(n,"olddisplay",s?i:f.css(n,"display"))));for(o=0;o<a;o++)(n=t[o]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[o]||"":"none"));return t}function Lt(t,e,i,n,s){return new Lt.prototype.init(t,e,i,n,s)}f.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=vt(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,r,o,a=f.camelCase(e),l=t.style;if(e=f.cssProps[a]||(f.cssProps[a]=Et(l,a)),o=f.cssHooks[e]||f.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(s=o.get(t,!1,n))?s:l[e];"string"===(r=typeof i)&&(s=xt.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(f.css(t,e)),r="number"),null!=i&&i==i&&("number"!==r||f.cssNumber[a]||(i+="px"),c.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,n))||(l[e]="",l[e]=i))}},css:function(t,e,i,n){var s,r,o,a=f.camelCase(e);return e=f.cssProps[a]||(f.cssProps[a]=Et(t.style,a)),(o=f.cssHooks[e]||f.cssHooks[a])&&"get"in o&&(s=o.get(t,!0,i)),void 0===s&&(s=vt(t,e,n)),"normal"===s&&e in St&&(s=St[e]),""===i||i?(r=parseFloat(s),!0===i||f.isNumeric(r)?r||0:s):s}}),f.each(["height","width"],(function(t,e){f.cssHooks[e]={get:function(t,i,n){if(i)return 0===t.offsetWidth&&wt.test(f.css(t,"display"))?f.swap(t,Tt,(function(){return Pt(t,e,n)})):Pt(t,e,n)},set:function(t,i,n){var s=n&&bt(t);return Ct(0,i,n?It(t,e,n,"border-box"===f.css(t,"boxSizing",!1,s),s):0)}}})),f.cssHooks.marginRight=_t(c.reliableMarginRight,(function(t,e){if(e)return f.swap(t,{display:"inline-block"},vt,[t,"marginRight"])})),f.each({margin:"",padding:"",border:"Width"},(function(t,e){f.cssHooks[t+e]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];n<4;n++)s[t+z[n]+e]=r[n]||r[n-2]||r[0];return s}},gt.test(t)||(f.cssHooks[t+e].set=Ct)})),f.fn.extend({css:function(t,e){return L(this,(function(t,e,i){var n,s,r={},o=0;if(f.isArray(e)){for(n=bt(t),s=e.length;o<s;o++)r[e[o]]=f.css(t,e[o],!1,n);return r}return void 0!==i?f.style(t,e,i):f.css(t,e)}),t,e,arguments.length>1)},show:function(){return kt(this,!0)},hide:function(){return kt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){G(this)?f(this).show():f(this).hide()}))}}),f.Tween=Lt,Lt.prototype={constructor:Lt,init:function(t,e,i,n,s,r){this.elem=t,this.prop=i,this.easing=s||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(f.cssNumber[i]?"":"px")},cur:function(){var t=Lt.propHooks[this.prop];return t&&t.get?t.get(this):Lt.propHooks._default.get(this)},run:function(t){var e,i=Lt.propHooks[this.prop];return this.options.duration?this.pos=e=f.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Lt.propHooks._default.set(this),this}},Lt.prototype.init.prototype=Lt.prototype,Lt.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=f.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){f.fx.step[t.prop]?f.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[f.cssProps[t.prop]]||f.cssHooks[t.prop])?f.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},Lt.propHooks.scrollTop=Lt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},f.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},f.fx=Lt.prototype.init,f.fx.step={};var Ot,Nt,Rt,Mt,Bt,Ft=/^(?:toggle|show|hide)$/,Vt=new RegExp("^(?:([+-])=|)("+H+")([a-z%]*)$","i"),Ht=/queueHooks$/,zt=[function(t,e,i){var n,s,r,o,a,l,h,u=this,c={},d=t.style,p=t.nodeType&&G(t),m=N.get(t,"fxshow");i.queue||(null==(a=f._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always((function(){u.always((function(){a.unqueued--,f.queue(t,"fx").length||a.empty.fire()}))})));1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],"none"===(h=f.css(t,"display"))&&(h=mt(t.nodeName)),"inline"===h&&"none"===f.css(t,"float")&&(d.display="inline-block"));i.overflow&&(d.overflow="hidden",u.always((function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]})));for(n in e)if(s=e[n],Ft.exec(s)){if(delete e[n],r=r||"toggle"===s,s===(p?"hide":"show")){if("show"!==s||!m||void 0===m[n])continue;p=!0}c[n]=m&&m[n]||f.style(t,n)}if(!f.isEmptyObject(c))for(n in m?"hidden"in m&&(p=m.hidden):m=N.access(t,"fxshow",{}),r&&(m.hidden=!p),p?f(t).show():u.done((function(){f(t).hide()})),u.done((function(){var e;for(e in N.remove(t,"fxshow"),c)f.style(t,e,c[e])})),c)o=Ut(p?m[n]:0,n,u),n in m||(m[n]=o.start,p&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}],Gt={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),s=Vt.exec(e),r=s&&s[3]||(f.cssNumber[t]?"":"px"),o=(f.cssNumber[t]||"px"!==r&&+n)&&Vt.exec(f.css(i.elem,t)),a=1,l=20;if(o&&o[3]!==r){r=r||o[3],s=s||[],o=+n||1;do{o/=a=a||".5",f.style(i.elem,t,o+r)}while(a!==(a=i.cur()/n)&&1!==a&&--l)}return s&&(o=i.start=+o||+n||0,i.unit=r,i.end=s[1]?o+(s[1]+1)*s[2]:+s[2]),i}]};function qt(){return setTimeout((function(){Ot=void 0})),Ot=f.now()}function Yt(t,e){var i,n=0,s={height:t};for(e=e?1:0;n<4;n+=2-e)s["margin"+(i=z[n])]=s["padding"+i]=t;return e&&(s.opacity=s.width=t),s}function Ut(t,e,i){for(var n,s=(Gt[e]||[]).concat(Gt["*"]),r=0,o=s.length;r<o;r++)if(n=s[r].call(i,e,t))return n}function jt(t,e,i){var n,s,r=0,o=zt.length,a=f.Deferred().always((function(){delete l.elem})),l=function(){if(s)return!1;for(var e=Ot||qt(),i=Math.max(0,h.startTime+h.duration-e),n=1-(i/h.duration||0),r=0,o=h.tweens.length;r<o;r++)h.tweens[r].run(n);return a.notifyWith(t,[h,n,i]),n<1&&o?i:(a.resolveWith(t,[h]),!1)},h=a.promise({elem:t,props:f.extend({},e),opts:f.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Ot||qt(),duration:i.duration,tweens:[],createTween:function(e,i){var n=f.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(s)return this;for(s=!0;i<n;i++)h.tweens[i].run(1);return e?a.resolveWith(t,[h,e]):a.rejectWith(t,[h,e]),this}}),u=h.props;for(!function(t,e){var i,n,s,r,o;for(i in t)if(s=e[n=f.camelCase(i)],r=t[i],f.isArray(r)&&(s=r[1],r=t[i]=r[0]),i!==n&&(t[n]=r,delete t[i]),(o=f.cssHooks[n])&&"expand"in o)for(i in r=o.expand(r),delete t[n],r)i in t||(t[i]=r[i],e[i]=s);else e[n]=s}(u,h.opts.specialEasing);r<o;r++)if(n=zt[r].call(h,t,u,h.opts))return n;return f.map(u,Ut,h),f.isFunction(h.opts.start)&&h.opts.start.call(t,h),f.fx.timer(f.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}f.Animation=f.extend(jt,{tweener:function(t,e){f.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,s=t.length;n<s;n++)i=t[n],Gt[i]=Gt[i]||[],Gt[i].unshift(e)},prefilter:function(t,e){e?zt.unshift(t):zt.push(t)}}),f.speed=function(t,e,i){var n=t&&"object"==typeof t?f.extend({},t):{complete:i||!i&&e||f.isFunction(t)&&t,duration:t,easing:i&&e||e&&!f.isFunction(e)&&e};return n.duration=f.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in f.fx.speeds?f.fx.speeds[n.duration]:f.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){f.isFunction(n.old)&&n.old.call(this),n.queue&&f.dequeue(this,n.queue)},n},f.fn.extend({fadeTo:function(t,e,i,n){return this.filter(G).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=f.isEmptyObject(t),r=f.speed(e,i,n),o=function(){var e=jt(this,f.extend({},t),r);(s||N.get(this,"finish"))&&e.stop(!0)};return o.finish=o,s||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,s=null!=t&&t+"queueHooks",r=f.timers,o=N.get(this);if(s)o[s]&&o[s].stop&&n(o[s]);else for(s in o)o[s]&&o[s].stop&&Ht.test(s)&&n(o[s]);for(s=r.length;s--;)r[s].elem!==this||null!=t&&r[s].queue!==t||(r[s].anim.stop(i),e=!1,r.splice(s,1));!e&&i||f.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=N.get(this),n=i[t+"queue"],s=i[t+"queueHooks"],r=f.timers,o=n?n.length:0;for(i.finish=!0,f.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),f.each(["toggle","show","hide"],(function(t,e){var i=f.fn[e];f.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(Yt(e,!0),t,n,s)}})),f.each({slideDown:Yt("show"),slideUp:Yt("hide"),slideToggle:Yt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){f.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),f.timers=[],f.fx.tick=function(){var t,e=0,i=f.timers;for(Ot=f.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||f.fx.stop(),Ot=void 0},f.fx.timer=function(t){f.timers.push(t),t()?f.fx.start():f.timers.pop()},f.fx.interval=13,f.fx.start=function(){Nt||(Nt=setInterval(f.fx.tick,f.fx.interval))},f.fx.stop=function(){clearInterval(Nt),Nt=null},f.fx.speeds={slow:600,fast:200,_default:400},f.fn.delay=function(t,e){return t=f.fx&&f.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}}))},Rt=d.createElement("input"),Mt=d.createElement("select"),Bt=Mt.appendChild(d.createElement("option")),Rt.type="checkbox",c.checkOn=""!==Rt.value,c.optSelected=Bt.selected,Mt.disabled=!0,c.optDisabled=!Bt.disabled,(Rt=d.createElement("input")).value="t",Rt.type="radio",c.radioValue="t"===Rt.value;var Wt,Xt=f.expr.attrHandle;f.fn.extend({attr:function(t,e){return L(this,f.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){f.removeAttr(this,t)}))}}),f.extend({attr:function(t,e,i){var n,s,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return void 0===t.getAttribute?f.prop(t,e,i):(1===r&&f.isXMLDoc(t)||(e=e.toLowerCase(),n=f.attrHooks[e]||(f.expr.match.bool.test(e)?Wt:void 0)),void 0===i?n&&"get"in n&&null!==(s=n.get(t,e))?s:null==(s=f.find.attr(t,e))?void 0:s:null!==i?n&&"set"in n&&void 0!==(s=n.set(t,i,e))?s:(t.setAttribute(e,i+""),i):void f.removeAttr(t,e))},removeAttr:function(t,e){var i,n,s=0,r=e&&e.match(I);if(r&&1===t.nodeType)for(;i=r[s++];)n=f.propFix[i]||i,f.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!c.radioValue&&"radio"===e&&f.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),Wt={set:function(t,e,i){return!1===e?f.removeAttr(t,i):t.setAttribute(i,i),i}},f.each(f.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=Xt[e]||f.find.attr;Xt[e]=function(t,e,n){var s,r;return n||(r=Xt[e],Xt[e]=s,s=null!=i(t,e,n)?e.toLowerCase():null,Xt[e]=r),s}}));var Kt=/^(?:input|select|textarea|button)$/i;f.fn.extend({prop:function(t,e){return L(this,f.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[f.propFix[t]||t]}))}}),f.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,i){var n,s,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return(1!==r||!f.isXMLDoc(t))&&(e=f.propFix[e]||e,s=f.propHooks[e]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:t[e]=i:s&&"get"in s&&null!==(n=s.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||Kt.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),c.optSelected||(f.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),f.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){f.propFix[this.toLowerCase()]=this}));var Qt=/[\t\r\n\f]/g;f.fn.extend({addClass:function(t){var e,i,n,s,r,o,a="string"==typeof t&&t,l=0,h=this.length;if(f.isFunction(t))return this.each((function(e){f(this).addClass(t.call(this,e,this.className))}));if(a)for(e=(t||"").match(I)||[];l<h;l++)if(n=1===(i=this[l]).nodeType&&(i.className?(" "+i.className+" ").replace(Qt," "):" ")){for(r=0;s=e[r++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");o=f.trim(n),i.className!==o&&(i.className=o)}return this},removeClass:function(t){var e,i,n,s,r,o,a=0===arguments.length||"string"==typeof t&&t,l=0,h=this.length;if(f.isFunction(t))return this.each((function(e){f(this).removeClass(t.call(this,e,this.className))}));if(a)for(e=(t||"").match(I)||[];l<h;l++)if(n=1===(i=this[l]).nodeType&&(i.className?(" "+i.className+" ").replace(Qt," "):"")){for(r=0;s=e[r++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");o=t?f.trim(n):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):f.isFunction(t)?this.each((function(i){f(this).toggleClass(t.call(this,i,this.className,e),e)})):this.each((function(){if("string"===i)for(var e,n=0,s=f(this),r=t.match(I)||[];e=r[n++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else"undefined"!==i&&"boolean"!==i||(this.className&&N.set(this,"__className__",this.className),this.className=this.className||!1===t?"":N.get(this,"__className__")||"")}))},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Qt," ").indexOf(e)>=0)return!0;return!1}});var Zt=/\r/g;f.fn.extend({val:function(t){var e,i,n,s=this[0];return arguments.length?(n=f.isFunction(t),this.each((function(i){var s;1===this.nodeType&&(null==(s=n?t.call(this,i,f(this).val()):t)?s="":"number"==typeof s?s+="":f.isArray(s)&&(s=f.map(s,(function(t){return null==t?"":t+""}))),(e=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,s,"value")||(this.value=s))}))):s?(e=f.valHooks[s.type]||f.valHooks[s.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(s,"value"))?i:"string"==typeof(i=s.value)?i.replace(Zt,""):null==i?"":i:void 0}}),f.extend({valHooks:{select:{get:function(t){for(var e,i,n=t.options,s=t.selectedIndex,r="select-one"===t.type||s<0,o=r?null:[],a=r?s+1:n.length,l=s<0?a:r?s:0;l<a;l++)if(((i=n[l]).selected||l===s)&&(c.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!f.nodeName(i.parentNode,"optgroup"))){if(e=f(i).val(),r)return e;o.push(e)}return o},set:function(t,e){for(var i,n,s=t.options,r=f.makeArray(e),o=s.length;o--;)((n=s[o]).selected=f.inArray(f(n).val(),r)>=0)&&(i=!0);return i||(t.selectedIndex=-1),r}}}}),f.each(["radio","checkbox"],(function(){f.valHooks[this]={set:function(t,e){if(f.isArray(e))return t.checked=f.inArray(f(t).val(),e)>=0}},c.checkOn||(f.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){f.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}})),f.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var $t=f.now(),Jt=/\?/;f.parseJSON=function(t){return JSON.parse(t+"")},f.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(i){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||f.error("Invalid XML: "+t),e};var te,ee,ie=/#.*$/,ne=/([?&])_=[^&]*/,se=/^(.*?):[ \t]*([^\r\n]*)$/gm,re=/^(?:GET|HEAD)$/,oe=/^\/\//,ae=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,le={},he={},ue="*/".concat("*");try{ee=location.href}catch(ke){(ee=d.createElement("a")).href="",ee=ee.href}function ce(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,r=e.toLowerCase().match(I)||[];if(f.isFunction(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function de(t,e,i,n){var s={},r=t===he;function o(a){var l;return s[a]=!0,f.each(t[a]||[],(function(t,a){var h=a(e,i,n);return"string"!=typeof h||r||s[h]?r?!(l=h):void 0:(e.dataTypes.unshift(h),o(h),!1)})),l}return o(e.dataTypes[0])||!s["*"]&&o("*")}function fe(t,e){var i,n,s=f.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((s[i]?t:n||(n={}))[i]=e[i]);return n&&f.extend(!0,t,n),t}te=ae.exec(ee.toLowerCase())||[],f.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ee,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(te[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ue,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?fe(fe(t,f.ajaxSettings),e):fe(f.ajaxSettings,t)},ajaxPrefilter:ce(le),ajaxTransport:ce(he),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,n,s,r,o,a,l,h,u=f.ajaxSetup({},e),c=u.context||u,d=u.context&&(c.nodeType||c.jquery)?f(c):f.event,p=f.Deferred(),m=f.Callbacks("once memory"),g=u.statusCode||{},y={},b={},v=0,_="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===v){if(!r)for(r={};e=se.exec(s);)r[e[1].toLowerCase()]=e[2];e=r[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===v?s:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return v||(t=b[i]=b[i]||t,y[t]=e),this},overrideMimeType:function(t){return v||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(v<2)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||_;return i&&i.abort(e),A(0,e),this}};if(p.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,u.url=((t||u.url||ee)+"").replace(ie,"").replace(oe,te[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=f.trim(u.dataType||"*").toLowerCase().match(I)||[""],null==u.crossDomain&&(a=ae.exec(u.url.toLowerCase()),u.crossDomain=!(!a||a[1]===te[1]&&a[2]===te[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(te[3]||("http:"===te[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=f.param(u.data,u.traditional)),de(le,u,e,w),2===v)return w;for(h in(l=u.global)&&0==f.active++&&f.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!re.test(u.type),n=u.url,u.hasContent||(u.data&&(n=u.url+=(Jt.test(n)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=ne.test(n)?n.replace(ne,"$1_="+$t++):n+(Jt.test(n)?"&":"?")+"_="+$t++)),u.ifModified&&(f.lastModified[n]&&w.setRequestHeader("If-Modified-Since",f.lastModified[n]),f.etag[n]&&w.setRequestHeader("If-None-Match",f.etag[n])),(u.data&&u.hasContent&&!1!==u.contentType||e.contentType)&&w.setRequestHeader("Content-Type",u.contentType),w.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+ue+"; q=0.01":""):u.accepts["*"]),u.headers)w.setRequestHeader(h,u.headers[h]);if(u.beforeSend&&(!1===u.beforeSend.call(c,w,u)||2===v))return w.abort();for(h in _="abort",{success:1,error:1,complete:1})w[h](u[h]);if(i=de(he,u,e,w)){w.readyState=1,l&&d.trigger("ajaxSend",[w,u]),u.async&&u.timeout>0&&(o=setTimeout((function(){w.abort("timeout")}),u.timeout));try{v=1,i.send(y,A)}catch(ke){if(!(v<2))throw ke;A(-1,ke)}}else A(-1,"No Transport");function A(t,e,r,a){var h,y,b,_,A,x=e;2!==v&&(v=2,o&&clearTimeout(o),i=void 0,s=a||"",w.readyState=t>0?4:0,h=t>=200&&t<300||304===t,r&&(_=function(t,e,i){for(var n,s,r,o,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(s in a)if(a[s]&&a[s].test(n)){l.unshift(s);break}if(l[0]in i)r=l[0];else{for(s in i){if(!l[0]||t.converters[s+" "+l[0]]){r=s;break}o||(o=s)}r=r||o}if(r)return r!==l[0]&&l.unshift(r),i[r]}(u,w,r)),_=function(t,e,i,n){var s,r,o,a,l,h={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)h[o.toLowerCase()]=t.converters[o];for(r=u.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(o=h[l+" "+r]||h["* "+r]))for(s in h)if((a=s.split(" "))[1]===r&&(o=h[l+" "+a[0]]||h["* "+a[0]])){!0===o?o=h[s]:!0!==h[s]&&(r=a[0],u.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(ke){return{state:"parsererror",error:o?ke:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}(u,_,w,h),h?(u.ifModified&&((A=w.getResponseHeader("Last-Modified"))&&(f.lastModified[n]=A),(A=w.getResponseHeader("etag"))&&(f.etag[n]=A)),204===t||"HEAD"===u.type?x="nocontent":304===t?x="notmodified":(x=_.state,y=_.data,h=!(b=_.error))):(b=x,!t&&x||(x="error",t<0&&(t=0))),w.status=t,w.statusText=(e||x)+"",h?p.resolveWith(c,[y,x,w]):p.rejectWith(c,[w,x,b]),w.statusCode(g),g=void 0,l&&d.trigger(h?"ajaxSuccess":"ajaxError",[w,u,h?y:b]),m.fireWith(c,[w,x]),l&&(d.trigger("ajaxComplete",[w,u]),--f.active||f.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,i){return f.get(t,e,i,"json")},getScript:function(t,e){return f.get(t,void 0,e,"script")}}),f.each(["get","post"],(function(t,e){f[e]=function(t,i,n,s){return f.isFunction(i)&&(s=s||n,n=i,i=void 0),f.ajax({url:t,type:e,dataType:s,data:i,success:n})}})),f.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){f.fn[e]=function(t){return this.on(e,t)}})),f._evalUrl=function(t){return f.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},f.fn.extend({wrapAll:function(t){var e;return f.isFunction(t)?this.each((function(e){f(this).wrapAll(t.call(this,e))})):(this[0]&&(e=f(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this)},wrapInner:function(t){return f.isFunction(t)?this.each((function(e){f(this).wrapInner(t.call(this,e))})):this.each((function(){var e=f(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=f.isFunction(t);return this.each((function(i){f(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(){return this.parent().each((function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)})).end()}}),f.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},f.expr.filters.visible=function(t){return!f.expr.filters.hidden(t)};var pe=/%20/g,me=/\[\]$/,ge=/\r?\n/g,ye=/^(?:submit|button|image|reset|file)$/i,be=/^(?:input|select|textarea|keygen)/i;function ve(t,e,i,n){var s;if(f.isArray(e))f.each(e,(function(e,s){i||me.test(t)?n(t,s):ve(t+"["+("object"==typeof s?e:"")+"]",s,i,n)}));else if(i||"object"!==f.type(e))n(t,e);else for(s in e)ve(t+"["+s+"]",e[s],i,n)}f.param=function(t,e){var i,n=[],s=function(t,e){e=f.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=f.ajaxSettings&&f.ajaxSettings.traditional),f.isArray(t)||t.jquery&&!f.isPlainObject(t))f.each(t,(function(){s(this.name,this.value)}));else for(i in t)ve(i,t[i],e,s);return n.join("&").replace(pe,"+")},f.fn.extend({serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=f.prop(this,"elements");return t?f.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!f(this).is(":disabled")&&be.test(this.nodeName)&&!ye.test(t)&&(this.checked||!q.test(t))})).map((function(t,e){var i=f(this).val();return null==i?null:f.isArray(i)?f.map(i,(function(t){return{name:e.name,value:t.replace(ge,"\r\n")}})):{name:e.name,value:i.replace(ge,"\r\n")}})).get()}}),f.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(ke){}};var _e=0,we={},Ae={0:200,1223:204},xe=f.ajaxSettings.xhr();t.ActiveXObject&&f(t).on("unload",(function(){for(var t in we)we[t]()})),c.cors=!!xe&&"withCredentials"in xe,c.ajax=xe=!!xe,f.ajaxTransport((function(t){var e;if(c.cors||xe&&!t.crossDomain)return{send:function(i,n){var s,r=t.xhr(),o=++_e;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)r[s]=t.xhrFields[s];for(s in t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)r.setRequestHeader(s,i[s]);e=function(t){return function(){e&&(delete we[o],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?n(r.status,r.statusText):n(Ae[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=we[o]=e("abort"),r.send(t.hasContent&&t.data||null)},abort:function(){e&&e()}}})),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return f.globalEval(t),t}}}),f.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),f.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain)return{send:function(n,s){e=f("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&s("error"===t.type?404:200,t.type)}),d.head.appendChild(e[0])},abort:function(){i&&i()}}}));var Te=[],Se=/(=)\?(?=&|$)|\?\?/;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Te.pop()||f.expando+"_"+$t++;return this[t]=!0,t}}),f.ajaxPrefilter("json jsonp",(function(e,i,n){var s,r,o,a=!1!==e.jsonp&&(Se.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Se.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return s=e.jsonpCallback=f.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Se,"$1"+s):!1!==e.jsonp&&(e.url+=(Jt.test(e.url)?"&":"?")+e.jsonp+"="+s),e.converters["script json"]=function(){return o||f.error(s+" was not called"),o[0]},e.dataTypes[0]="json",r=t[s],t[s]=function(){o=arguments},n.always((function(){t[s]=r,e[s]&&(e.jsonpCallback=i.jsonpCallback,Te.push(s)),o&&f.isFunction(r)&&r(o[0]),o=r=void 0})),"script"})),f.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||d;var n=_.exec(t),s=!i&&[];return n?[e.createElement(n[1])]:(n=f.buildFragment([t],e,s),s&&s.length&&f(s).remove(),f.merge([],n.childNodes))};var De=f.fn.load;f.fn.load=function(t,e,i){if("string"!=typeof t&&De)return De.apply(this,arguments);var n,s,r,o=this,a=t.indexOf(" ");return a>=0&&(n=t.slice(a),t=t.slice(0,a)),f.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(s="POST"),o.length>0&&f.ajax({url:t,type:s,dataType:"html",data:e}).done((function(t){r=arguments,o.html(n?f("<div>").append(f.parseHTML(t)).find(n):t)})).complete(i&&function(t,e){o.each(i,r||[t.responseText,e,t])}),this},f.expr.filters.animated=function(t){return f.grep(f.timers,(function(e){return t===e.elem})).length};var Ee=t.document.documentElement;function Ce(t){return f.isWindow(t)?t:9===t.nodeType&&t.defaultView}f.offset={setOffset:function(t,e,i){var n,s,r,o,a,l,h=f.css(t,"position"),u=f(t),c={};"static"===h&&(t.style.position="relative"),a=u.offset(),r=f.css(t,"top"),l=f.css(t,"left"),("absolute"===h||"fixed"===h)&&(r+l).indexOf("auto")>-1?(o=(n=u.position()).top,s=n.left):(o=parseFloat(r)||0,s=parseFloat(l)||0),f.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(c.top=e.top-a.top+o),null!=e.left&&(c.left=e.left-a.left+s),"using"in e?e.using.call(t,c):u.css(c)}},f.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){f.offset.setOffset(this,t,e)}));var e,i,n=this[0],s={top:0,left:0},r=n&&n.ownerDocument;return r?(e=r.documentElement,f.contains(e,n)?(void 0!==n.getBoundingClientRect&&(s=n.getBoundingClientRect()),i=Ce(r),{top:s.top+i.pageYOffset-e.clientTop,left:s.left+i.pageXOffset-e.clientLeft}):s):void 0},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===f.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),f.nodeName(t[0],"html")||(n=t.offset()),n.top+=f.css(t[0],"borderTopWidth",!0),n.left+=f.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-f.css(i,"marginTop",!0),left:e.left-n.left-f.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent||Ee;t&&!f.nodeName(t,"html")&&"static"===f.css(t,"position");)t=t.offsetParent;return t||Ee}))}}),f.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,i){var n="pageYOffset"===i;f.fn[e]=function(s){return L(this,(function(e,s,r){var o=Ce(e);if(void 0===r)return o?o[i]:e[s];o?o.scrollTo(n?t.pageXOffset:r,n?r:t.pageYOffset):e[s]=r}),e,s,arguments.length,null)}})),f.each(["top","left"],(function(t,e){f.cssHooks[e]=_t(c.pixelPosition,(function(t,i){if(i)return i=vt(t,e),yt.test(i)?f(t).position()[e]+"px":i}))})),f.each({Height:"height",Width:"width"},(function(t,e){f.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){f.fn[n]=function(n,s){var r=arguments.length&&(i||"boolean"!=typeof n),o=i||(!0===n||!0===s?"margin":"border");return L(this,(function(e,i,n){var s;return f.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===n?f.css(e,i,o):f.style(e,i,n,o)}),e,r?n:void 0,r,null)}}))})),f.fn.size=function(){return this.length},f.fn.andSelf=f.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],(function(){return f}));var Ie=t.jQuery,Pe=t.$;return f.noConflict=function(e){return t.$===f&&(t.$=Pe),e&&t.jQuery===f&&(t.jQuery=Ie),f},void 0===e&&(t.jQuery=t.$=f),f})),function(){function t(t,e){return t.set(e[0],e[1]),t}function e(t,e){return t.add(e),t}function i(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function n(t,e,i,n){for(var s=-1,r=null==t?0:t.length;++s<r;){var o=t[s];e(n,o,i(o),t)}return n}function s(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}function r(t,e){for(var i=null==t?0:t.length;i--&&!1!==e(t[i],i,t););return t}function o(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function a(t,e){for(var i=-1,n=null==t?0:t.length,s=0,r=[];++i<n;){var o=t[i];e(o,i,t)&&(r[s++]=o)}return r}function l(t,e){return!(null==t||!t.length)&&-1<y(t,e,0)}function h(t,e,i){for(var n=-1,s=null==t?0:t.length;++n<s;)if(i(e,t[n]))return!0;return!1}function u(t,e){for(var i=-1,n=null==t?0:t.length,s=Array(n);++i<n;)s[i]=e(t[i],i,t);return s}function c(t,e){for(var i=-1,n=e.length,s=t.length;++i<n;)t[s+i]=e[i];return t}function d(t,e,i,n){var s=-1,r=null==t?0:t.length;for(n&&r&&(i=t[++s]);++s<r;)i=e(i,t[s],s,t);return i}function f(t,e,i,n){var s=null==t?0:t.length;for(n&&s&&(i=t[--s]);s--;)i=e(i,t[s],s,t);return i}function p(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}function m(t,e,i){var n;return i(t,(function(t,i,s){if(e(t,i,s))return n=i,!1})),n}function g(t,e,i,n){var s=t.length;for(i+=n?1:-1;n?i--:++i<s;)if(e(t[i],i,t))return i;return-1}function y(t,e,i){if(e==e)t:{--i;for(var n=t.length;++i<n;)if(t[i]===e){t=i;break t}t=-1}else t=g(t,v,i);return t}function b(t,e,i,n){--i;for(var s=t.length;++i<s;)if(n(t[i],e))return i;return-1}function v(t){return t!=t}function _(t,e){var i=null==t?0:t.length;return i?T(t,e)/i:H}function w(t){return function(e){return null==e?F:e[t]}}function A(t){return function(e){return null==t?F:t[e]}}function x(t,e,i,n,s){return s(t,(function(t,s,r){i=n?(n=!1,t):e(i,t,s,r)})),i}function T(t,e){for(var i,n=-1,s=t.length;++n<s;){var r=e(t[n]);r!==F&&(i=i===F?r:i+r)}return i}function S(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function D(t){return function(e){return t(e)}}function E(t,e){return u(e,(function(e){return t[e]}))}function C(t,e){return t.has(e)}function I(t,e){for(var i=-1,n=t.length;++i<n&&-1<y(e,t[i],0););return i}function P(t,e){for(var i=t.length;i--&&-1<y(e,t[i],0););return i}function k(t){return"\\"+Nt[t]}function L(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}function O(t,e){return function(i){return t(e(i))}}function N(t,e){for(var i=-1,n=t.length,s=0,r=[];++i<n;){var o=t[i];o!==e&&"__lodash_placeholder__"!==o||(t[i]="__lodash_placeholder__",r[s++]=i)}return r}function R(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}function M(t){if(Ct.test(t)){for(var e=Dt.lastIndex=0;Dt.test(t);)++e;t=e}else t=Qt(t);return t}function B(t){return Ct.test(t)?t.match(Dt)||[]:t.split("")}var F,V=1/0,H=NaN,z=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],G=/\b__p\+='';/g,q=/\b(__p\+=)''\+/g,Y=/(__e\(.*?\)|\b__t\))\+'';/g,U=/&(?:amp|lt|gt|quot|#39);/g,j=/[&<>"']/g,W=RegExp(U.source),X=RegExp(j.source),K=/<%-([\s\S]+?)%>/g,Q=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,tt=/^\./,et=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(it.source),st=/^\s+|\s+$/g,rt=/^\s+/,ot=/\s+$/,at=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,ht=/,? & /,ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/\\(\\)?/g,dt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,pt=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,yt=/^0o[0-7]+$/i,bt=/^(?:0|[1-9]\d*)$/,vt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,wt=/['\n\r\u2028\u2029\\]/g,At="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?)*",xt="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+At,Tt=RegExp("['’]","g"),St=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),Dt=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]?|[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])"+At,"g"),Et=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)|\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)|\\d+",xt].join("|"),"g"),Ct=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),It=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Pt="Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),kt={};kt["[object Float32Array]"]=kt["[object Float64Array]"]=kt["[object Int8Array]"]=kt["[object Int16Array]"]=kt["[object Int32Array]"]=kt["[object Uint8Array]"]=kt["[object Uint8ClampedArray]"]=kt["[object Uint16Array]"]=kt["[object Uint32Array]"]=!0,kt["[object Arguments]"]=kt["[object Array]"]=kt["[object ArrayBuffer]"]=kt["[object Boolean]"]=kt["[object DataView]"]=kt["[object Date]"]=kt["[object Error]"]=kt["[object Function]"]=kt["[object Map]"]=kt["[object Number]"]=kt["[object Object]"]=kt["[object RegExp]"]=kt["[object Set]"]=kt["[object String]"]=kt["[object WeakMap]"]=!1;var Lt={};Lt["[object Arguments]"]=Lt["[object Array]"]=Lt["[object ArrayBuffer]"]=Lt["[object DataView]"]=Lt["[object Boolean]"]=Lt["[object Date]"]=Lt["[object Float32Array]"]=Lt["[object Float64Array]"]=Lt["[object Int8Array]"]=Lt["[object Int16Array]"]=Lt["[object Int32Array]"]=Lt["[object Map]"]=Lt["[object Number]"]=Lt["[object Object]"]=Lt["[object RegExp]"]=Lt["[object Set]"]=Lt["[object String]"]=Lt["[object Symbol]"]=Lt["[object Uint8Array]"]=Lt["[object Uint8ClampedArray]"]=Lt["[object Uint16Array]"]=Lt["[object Uint32Array]"]=!0,Lt["[object Error]"]=Lt["[object Function]"]=Lt["[object WeakMap]"]=!1;var Ot,Nt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Rt=parseFloat,Mt=parseInt,Bt="object"==typeof global&&global&&global.Object===Object&&global,Ft="object"==typeof self&&self&&self.Object===Object&&self,Vt=Bt||Ft||Function("return this")(),Ht="object"==typeof exports&&exports&&!exports.nodeType&&exports,zt=Ht&&"object"==typeof module&&module&&!module.nodeType&&module,Gt=zt&&zt.exports===Ht,qt=Gt&&Bt.process;t:{try{Ot=qt&&qt.binding&&qt.binding("util");break t}catch(t){}Ot=void 0}var Yt=Ot&&Ot.isArrayBuffer,Ut=Ot&&Ot.isDate,jt=Ot&&Ot.isMap,Wt=Ot&&Ot.isRegExp,Xt=Ot&&Ot.isSet,Kt=Ot&&Ot.isTypedArray,Qt=w("length"),Zt=A({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),$t=A({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Jt=A({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),te=function A(At){function xt(t){if($n(t)&&!Ho(t)&&!(t instanceof Nt)){if(t instanceof Ot)return t;if(Hs.call(t,"__wrapped__"))return Tn(t)}return new Ot(t)}function Dt(){}function Ot(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=F}function Nt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Bt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Ft(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Ht(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function zt(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new Ht;++e<i;)this.add(t[e])}function qt(t){this.size=(this.__data__=new Ft(t)).size}function Qt(t,e){var i,n=Ho(t),s=!n&&Vo(t),r=!n&&!s&&Go(t),o=!n&&!s&&!r&&Wo(t),a=(s=(n=n||s||r||o)?S(t.length,Ns):[]).length;for(i in t)!e&&!Hs.call(t,i)||n&&("length"==i||r&&("offset"==i||"parent"==i)||o&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||cn(i,a))||s.push(i);return s}function ee(t){var e=t.length;return e?t[We(0,e-1)]:F}function ie(t,e){return _n(xi(t),ce(e,0,t.length))}function ne(t){return _n(xi(t))}function se(t,e,i){(i===F||Yn(t[e],i))&&(i!==F||e in t)||he(t,e,i)}function re(t,e,i){var n=t[e];Hs.call(t,e)&&Yn(n,i)&&(i!==F||e in t)||he(t,e,i)}function oe(t,e){for(var i=t.length;i--;)if(Yn(t[i][0],e))return i;return-1}function ae(t,e,i,n){return Fr(t,(function(t,s,r){e(n,t,i(t),r)})),n}function le(t,e){return t&&Ti(e,ds(e),t)}function he(t,e,i){"__proto__"==e&&sr?sr(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function ue(t,e){for(var i=-1,n=e.length,s=Es(n),r=null==t;++i<n;)s[i]=r?F:us(t,e[i]);return s}function ce(t,e,i){return t==t&&(i!==F&&(t=t<=i?t:i),e!==F&&(t=t>=e?t:e)),t}function de(t,e,i,n,r,o){var a,l=1&e,h=2&e,u=4&e;if(i&&(a=r?i(t,n,r,o):i(t)),a!==F)return a;if(!Zn(t))return t;if(n=Ho(t)){if(a=function(t){var e=t.length,i=t.constructor(e);return e&&"string"==typeof t[0]&&Hs.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!l)return xi(t,a)}else{var c=Kr(t),d="[object Function]"==c||"[object GeneratorFunction]"==c;if(Go(t))return yi(t,l);if("[object Object]"==c||"[object Arguments]"==c||d&&!r){if(a=h||d?{}:ln(t),!l)return h?function(t,e){return Ti(t,Xr(t),e)}(t,function(t,e){return t&&Ti(e,fs(e),t)}(a,t)):function(t,e){return Ti(t,Wr(t),e)}(t,le(a,t))}else{if(!Lt[c])return r?t:{};a=hn(t,c,de,l)}}if(o||(o=new qt),r=o.get(t))return r;o.set(t,a);h=u?h?Ji:$i:h?fs:ds;var f=n?F:h(t);return s(f||t,(function(n,s){f&&(n=t[s=n]),re(a,s,de(n,e,i,s,t,o))})),a}function fe(t,e,i){var n=i.length;if(null==t)return!n;for(t=Ls(t);n--;){var s=i[n],r=e[s],o=t[s];if(o===F&&!(s in t)||!r(o))return!1}return!0}function pe(t,e,i){if("function"!=typeof t)throw new Rs("Expected a function");return $r((function(){t.apply(F,i)}),e)}function me(t,e,i,n){var s=-1,r=l,o=!0,a=t.length,c=[],d=e.length;if(!a)return c;i&&(e=u(e,D(i))),n?(r=h,o=!1):200<=e.length&&(r=C,o=!1,e=new zt(e));t:for(;++s<a;){var f=t[s],p=null==i?f:i(f);f=n||0!==f?f:0;if(o&&p==p){for(var m=d;m--;)if(e[m]===p)continue t;c.push(f)}else r(e,p,n)||c.push(f)}return c}function ge(t,e){var i=!0;return Fr(t,(function(t,n,s){return i=!!e(t,n,s)})),i}function ye(t,e,i){for(var n=-1,s=t.length;++n<s;){var r=t[n],o=e(r);if(null!=o&&(a===F?o==o&&!is(o):i(o,a)))var a=o,l=r}return l}function be(t,e){var i=[];return Fr(t,(function(t,n,s){e(t,n,s)&&i.push(t)})),i}function ve(t,e,i,n,s){var r=-1,o=t.length;for(i||(i=un),s||(s=[]);++r<o;){var a=t[r];0<e&&i(a)?1<e?ve(a,e-1,i,n,s):c(s,a):n||(s[s.length]=a)}return s}function _e(t,e){return t&&Hr(t,e,ds)}function we(t,e){return t&&zr(t,e,ds)}function Ae(t,e){return a(e,(function(e){return Xn(t[e])}))}function xe(t,e){for(var i=0,n=(e=mi(e,t)).length;null!=t&&i<n;)t=t[wn(e[i++])];return i&&i==n?t:F}function Te(t,e,i){return e=e(t),Ho(t)?e:c(e,i(t))}function Se(t){if(null==t)t=t===F?"[object Undefined]":"[object Null]";else if(nr&&nr in Ls(t)){var e=Hs.call(t,nr),i=t[nr];try{t[nr]=F;var n=!0}catch(t){}var s=qs.call(t);n&&(e?t[nr]=i:delete t[nr]),t=s}else t=qs.call(t);return t}function De(t,e){return t>e}function Ee(t,e){return null!=t&&Hs.call(t,e)}function Ce(t,e){return null!=t&&e in Ls(t)}function Ie(t,e,i){for(var n=i?h:l,s=t[0].length,r=t.length,o=r,a=Es(r),c=1/0,d=[];o--;){var f=t[o];o&&e&&(f=u(f,D(e))),c=gr(f.length,c),a[o]=!i&&(e||120<=s&&120<=f.length)?new zt(o&&f):F}f=t[0];var p=-1,m=a[0];t:for(;++p<s&&d.length<c;){var g=f[p],y=e?e(g):g;g=i||0!==g?g:0;if(m?!C(m,y):!n(d,y,i)){for(o=r;--o;){var b=a[o];if(b?!C(b,y):!n(t[o],y,i))continue t}m&&m.push(y),d.push(g)}}return d}function Pe(t,e,n){return null==(e=null==(t=2>(e=mi(e,t)).length?t:xe(t,ti(e,0,-1)))?t:t[wn(In(e))])?F:i(e,t,n)}function ke(t){return $n(t)&&"[object Arguments]"==Se(t)}function Le(t,e,i,n,s){if(t===e)e=!0;else if(null==t||null==e||!$n(t)&&!$n(e))e=t!=t&&e!=e;else t:{var r,o,a=Ho(t),l=Ho(e),h="[object Object]"==(r="[object Arguments]"==(r=a?"[object Array]":Kr(t))?"[object Object]":r);l="[object Object]"==(o="[object Arguments]"==(o=l?"[object Array]":Kr(e))?"[object Object]":o);if((o=r==o)&&Go(t)){if(!Go(e)){e=!1;break t}a=!0,h=!1}if(o&&!h)s||(s=new qt),e=a||Wo(t)?Qi(t,e,i,n,Le,s):function(t,e,i,n,s,r,o){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)break;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":if(t.byteLength!=e.byteLength||!r(new Ks(t),new Ks(e)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return Yn(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=L;case"[object Set]":if(a||(a=R),t.size!=e.size&&!(1&n))break;return(i=o.get(t))?i==e:(n|=2,o.set(t,e),e=Qi(a(t),a(e),n,s,r,o),o.delete(t),e);case"[object Symbol]":if(Rr)return Rr.call(t)==Rr.call(e)}return!1}(t,e,r,i,n,Le,s);else{if(!(1&i)&&(a=h&&Hs.call(t,"__wrapped__"),r=l&&Hs.call(e,"__wrapped__"),a||r)){t=a?t.value():t,e=r?e.value():e,s||(s=new qt),e=Le(t,e,i,n,s);break t}if(o)e:if(s||(s=new qt),a=1&i,r=$i(t),l=r.length,o=$i(e).length,l==o||a){for(h=l;h--;){var u=r[h];if(!(a?u in e:Hs.call(e,u))){e=!1;break e}}if((o=s.get(t))&&s.get(e))e=o==e;else{o=!0,s.set(t,e),s.set(e,t);for(var c=a;++h<l;){var d=t[u=r[h]],f=e[u];if(n)var p=a?n(f,d,u,e,t,s):n(d,f,u,t,e,s);if(p===F?d!==f&&!Le(d,f,i,n,s):!p){o=!1;break}c||(c="constructor"==u)}o&&!c&&((i=t.constructor)!=(n=e.constructor)&&"constructor"in t&&"constructor"in e&&!("function"==typeof i&&i instanceof i&&"function"==typeof n&&n instanceof n)&&(o=!1)),s.delete(t),s.delete(e),e=o}}else e=!1;else e=!1}}return e}function Oe(t,e,i,n){var s=i.length,r=s,o=!n;if(null==t)return!r;for(t=Ls(t);s--;){var a=i[s];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++s<r;){var l=(a=i[s])[0],h=t[l],u=a[1];if(o&&a[2]){if(h===F&&!(l in t))return!1}else{if(a=new qt,n)var c=n(h,u,l,t,e,a);if(c===F?!Le(u,h,3,n,a):!c)return!1}}return!0}function Ne(t){return!(!Zn(t)||Gs&&Gs in t)&&(Xn(t)?js:gt).test(An(t))}function Re(t){return"function"==typeof t?t:null==t?_s:"object"==typeof t?Ho(t)?He(t[0],t[1]):Ve(t):Ts(t)}function Me(t){if(!mn(t))return pr(t);var e,i=[];for(e in Ls(t))Hs.call(t,e)&&"constructor"!=e&&i.push(e);return i}function Be(t,e){return t<e}function Fe(t,e){var i=-1,n=Un(t)?Es(t.length):[];return Fr(t,(function(t,s,r){n[++i]=e(t,s,r)})),n}function Ve(t){var e=rn(t);return 1==e.length&&e[0][2]?gn(e[0][0],e[0][1]):function(i){return i===t||Oe(i,t,e)}}function He(t,e){return fn(t)&&e==e&&!Zn(e)?gn(wn(t),e):function(i){var n=us(i,t);return n===F&&n===e?cs(i,t):Le(e,n,3)}}function ze(t,e,i,n,s){t!==e&&Hr(e,(function(r,o){if(Zn(r)){s||(s=new qt);var a=s,l=t[o],h=e[o];if(p=a.get(h))se(t,o,p);else{var u=(p=n?n(l,h,o+"",t,e,a):F)===F;if(u){var c=Ho(h),d=!c&&Go(h),f=!c&&!d&&Wo(h),p=h;c||d||f?Ho(l)?p=l:jn(l)?p=xi(l):d?(u=!1,p=yi(h,!0)):f?(u=!1,p=vi(h,!0)):p=[]:ts(h)||Vo(h)?(p=l,Vo(l)?p=ls(l):(!Zn(l)||i&&Xn(l))&&(p=ln(h))):u=!1}u&&(a.set(h,p),ze(p,h,i,n,a),a.delete(h)),se(t,o,p)}}else(a=n?n(t[o],r,o+"",t,e,s):F)===F&&(a=r),se(t,o,a)}),fs)}function Ge(t,e){var i=t.length;if(i)return cn(e+=0>e?i:0,i)?t[e]:F}function qe(t,e,i){var n=-1;return e=u(e.length?e:[_s],D(nn())),function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].c;return t}(t=Fe(t,(function(t){return{a:u(e,(function(e){return e(t)})),b:++n,c:t}})),(function(t,e){var n;t:{n=-1;for(var s=t.a,r=e.a,o=s.length,a=i.length;++n<o;){var l=_i(s[n],r[n]);if(l){n=n>=a?l:l*("desc"==i[n]?-1:1);break t}}n=t.b-e.b}return n}))}function Ye(t,e,i){for(var n=-1,s=e.length,r={};++n<s;){var o=e[n],a=xe(t,o);i(a,o)&&$e(r,mi(o,t),a)}return r}function Ue(t,e,i,n){var s=n?b:y,r=-1,o=e.length,a=t;for(t===e&&(e=xi(e)),i&&(a=u(t,D(i)));++r<o;){var l=0,h=e[r];for(h=i?i(h):h;-1<(l=s(a,h,l,n));)a!==t&&tr.call(a,l,1),tr.call(t,l,1)}return t}function je(t,e){for(var i=t?e.length:0,n=i-1;i--;){var s=e[i];if(i==n||s!==r){var r=s;cn(s)?tr.call(t,s,1):li(t,s)}}}function We(t,e){return t+hr(vr()*(e-t+1))}function Xe(t,e){var i="";if(!t||1>e||9007199254740991<e)return i;do{e%2&&(i+=t),(e=hr(e/2))&&(t+=t)}while(e);return i}function Ke(t,e){return Jr(yn(t,e,_s),t+"")}function Qe(t){return ee(ms(t))}function Ze(t,e){var i=ms(t);return _n(i,ce(e,0,i.length))}function $e(t,e,i,n){if(!Zn(t))return t;for(var s=-1,r=(e=mi(e,t)).length,o=r-1,a=t;null!=a&&++s<r;){var l=wn(e[s]),h=i;if(s!=o){var u=a[l];(h=n?n(u,l,a):F)===F&&(h=Zn(u)?u:cn(e[s+1])?[]:{})}re(a,l,h),a=a[l]}return t}function Je(t){return _n(ms(t))}function ti(t,e,i){var n=-1,s=t.length;for(0>e&&(e=-e>s?0:s+e),0>(i=i>s?s:i)&&(i+=s),s=e>i?0:i-e>>>0,e>>>=0,i=Es(s);++n<s;)i[n]=t[n+e];return i}function ei(t,e){var i;return Fr(t,(function(t,n,s){return!(i=e(t,n,s))})),!!i}function ii(t,e,i){var n=0,s=null==t?n:t.length;if("number"==typeof e&&e==e&&2147483647>=s){for(;n<s;){var r=n+s>>>1,o=t[r];null!==o&&!is(o)&&(i?o<=e:o<e)?n=r+1:s=r}return s}return ni(t,e,_s,i)}function ni(t,e,i,n){e=i(e);for(var s=0,r=null==t?0:t.length,o=e!=e,a=null===e,l=is(e),h=e===F;s<r;){var u=hr((s+r)/2),c=i(t[u]),d=c!==F,f=null===c,p=c==c,m=is(c);(o?n||p:h?p&&(n||d):a?p&&d&&(n||!f):l?p&&d&&!f&&(n||!m):!f&&!m&&(n?c<=e:c<e))?s=u+1:r=u}return gr(r,4294967294)}function si(t,e){for(var i=-1,n=t.length,s=0,r=[];++i<n;){var o=t[i],a=e?e(o):o;if(!i||!Yn(a,l)){var l=a;r[s++]=0===o?0:o}}return r}function ri(t){return"number"==typeof t?t:is(t)?H:+t}function oi(t){if("string"==typeof t)return t;if(Ho(t))return u(t,oi)+"";if(is(t))return Mr?Mr.call(t):"";var e=t+"";return"0"==e&&1/t==-V?"-0":e}function ai(t,e,i){var n=-1,s=l,r=t.length,o=!0,a=[],u=a;if(i)o=!1,s=h;else if(200<=r){if(s=e?null:Ur(t))return R(s);o=!1,s=C,u=new zt}else u=e?[]:a;t:for(;++n<r;){var c=t[n],d=e?e(c):c;c=i||0!==c?c:0;if(o&&d==d){for(var f=u.length;f--;)if(u[f]===d)continue t;e&&u.push(d),a.push(c)}else s(u,d,i)||(u!==a&&u.push(d),a.push(c))}return a}function li(t,e){return null==(t=2>(e=mi(e,t)).length?t:xe(t,ti(e,0,-1)))||delete t[wn(In(e))]}function hi(t,e,i,n){for(var s=t.length,r=n?s:-1;(n?r--:++r<s)&&e(t[r],r,t););return i?ti(t,n?0:r,n?r+1:s):ti(t,n?r+1:0,n?s:r)}function ui(t,e){var i=t;return i instanceof Nt&&(i=i.value()),d(e,(function(t,e){return e.func.apply(e.thisArg,c([t],e.args))}),i)}function ci(t,e,i){var n=t.length;if(2>n)return n?ai(t[0]):[];for(var s=-1,r=Es(n);++s<n;)for(var o=t[s],a=-1;++a<n;)a!=s&&(r[s]=me(r[s]||o,t[a],e,i));return ai(ve(r,1),e,i)}function di(t,e,i){for(var n=-1,s=t.length,r=e.length,o={};++n<s;)i(o,t[n],n<r?e[n]:F);return o}function fi(t){return jn(t)?t:[]}function pi(t){return"function"==typeof t?t:_s}function mi(t,e){return Ho(t)?t:fn(t,e)?[t]:to(hs(t))}function gi(t,e,i){var n=t.length;return i=i===F?n:i,!e&&i>=n?t:ti(t,e,i)}function yi(t,e){if(e)return t.slice();var i=t.length;i=Qs?Qs(i):new t.constructor(i);return t.copy(i),i}function bi(t){var e=new t.constructor(t.byteLength);return new Ks(e).set(new Ks(t)),e}function vi(t,e){return new t.constructor(e?bi(t.buffer):t.buffer,t.byteOffset,t.length)}function _i(t,e){if(t!==e){var i=t!==F,n=null===t,s=t==t,r=is(t),o=e!==F,a=null===e,l=e==e,h=is(e);if(!a&&!h&&!r&&t>e||r&&o&&l&&!a&&!h||n&&o&&l||!i&&l||!s)return 1;if(!n&&!r&&!h&&t<e||h&&i&&s&&!n&&!r||a&&i&&s||!o&&s||!l)return-1}return 0}function wi(t,e,i,n){var s=-1,r=t.length,o=i.length,a=-1,l=e.length,h=mr(r-o,0),u=Es(l+h);for(n=!n;++a<l;)u[a]=e[a];for(;++s<o;)(n||s<r)&&(u[i[s]]=t[s]);for(;h--;)u[a++]=t[s++];return u}function Ai(t,e,i,n){var s=-1,r=t.length,o=-1,a=i.length,l=-1,h=e.length,u=mr(r-a,0),c=Es(u+h);for(n=!n;++s<u;)c[s]=t[s];for(u=s;++l<h;)c[u+l]=e[l];for(;++o<a;)(n||s<r)&&(c[u+i[o]]=t[s++]);return c}function xi(t,e){var i=-1,n=t.length;for(e||(e=Es(n));++i<n;)e[i]=t[i];return e}function Ti(t,e,i,n){var s=!i;i||(i={});for(var r=-1,o=e.length;++r<o;){var a=e[r],l=n?n(i[a],t[a],a,i,t):F;l===F&&(l=t[a]),s?he(i,a,l):re(i,a,l)}return i}function Si(t,e){return function(i,s){var r=Ho(i)?n:ae,o=e?e():{};return r(i,t,nn(s,2),o)}}function Di(t){return Ke((function(e,i){var n=-1,s=i.length,r=1<s?i[s-1]:F,o=2<s?i[2]:F;r=3<t.length&&"function"==typeof r?(s--,r):F;for(o&&dn(i[0],i[1],o)&&(r=3>s?F:r,s=1),e=Ls(e);++n<s;)(o=i[n])&&t(e,o,n,r);return e}))}function Ei(t,e){return function(i,n){if(null==i)return i;if(!Un(i))return t(i,n);for(var s=i.length,r=e?s:-1,o=Ls(i);(e?r--:++r<s)&&!1!==n(o[r],r,o););return i}}function Ci(t){return function(e,i,n){for(var s=-1,r=Ls(e),o=(n=n(e)).length;o--;){var a=n[t?o:++s];if(!1===i(r[a],a,r))break}return e}}function Ii(t){return function(e){e=hs(e);var i=Ct.test(e)?B(e):F,n=i?i[0]:e.charAt(0);return e=i?gi(i,1).join(""):e.slice(1),n[t]()+e}}function Pi(t){return function(e){return d(bs(ys(e).replace(Tt,"")),t,"")}}function ki(t){return function(){switch((e=arguments).length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var e,i=Br(t.prototype);return Zn(e=t.apply(i,e))?e:i}}function Li(t,e,n){var s=ki(t);return function r(){for(var o=arguments.length,a=Es(o),l=o,h=en(r);l--;)a[l]=arguments[l];return(o-=(l=3>o&&a[0]!==h&&a[o-1]!==h?[]:N(a,h)).length)<n?qi(t,e,Ri,r.placeholder,F,a,l,F,F,n-o):i(this&&this!==Vt&&this instanceof r?s:t,this,a)}}function Oi(t){return function(e,i,n){var s=Ls(e);if(!Un(e)){var r=nn(i,3);e=ds(e),i=function(t){return r(s[t],t,s)}}return-1<(i=t(e,i,n))?s[r?e[i]:i]:F}}function Ni(t){return Zi((function(e){var i=e.length,n=i,s=Ot.prototype.thru;for(t&&e.reverse();n--;){if("function"!=typeof(o=e[n]))throw new Rs("Expected a function");if(s&&!r&&"wrapper"==tn(o))var r=new Ot([],!0)}for(n=r?n:i;++n<i;){var o,a="wrapper"==(s=tn(o=e[n]))?jr(o):F;r=a&&pn(a[0])&&424==a[1]&&!a[4].length&&1==a[9]?r[tn(a[0])].apply(r,a[3]):1==o.length&&pn(o)?r[s]():r.thru(o)}return function(){var t=(s=arguments)[0];if(r&&1==s.length&&Ho(t))return r.plant(t).value();for(var n=0,s=i?e[n].apply(this,s):t;++n<i;)s=e[n].call(this,s);return s}}))}function Ri(t,e,i,n,s,r,o,a,l,h){var u=128&e,c=1&e,d=2&e,f=24&e,p=512&e,m=d?F:ki(t);return function g(){for(var y=arguments.length,b=Es(y),v=y;v--;)b[v]=arguments[v];if(f){var _,w=en(g);v=b.length;for(_=0;v--;)b[v]===w&&++_}if(n&&(b=wi(b,n,s,f)),r&&(b=Ai(b,r,o,f)),y-=_,f&&y<h)return w=N(b,w),qi(t,e,Ri,g.placeholder,i,b,w,a,l,h-y);if(w=c?i:this,v=d?w[t]:t,y=b.length,a){_=b.length;for(var A=gr(a.length,_),x=xi(b);A--;){var T=a[A];b[A]=cn(T,_)?x[T]:F}}else p&&1<y&&b.reverse();return u&&l<y&&(b.length=l),this&&this!==Vt&&this instanceof g&&(v=m||ki(v)),v.apply(w,b)}}function Mi(t,e){return function(i,n){return function(t,e,i){var n={};return _e(t,(function(t,s,r){e(n,i(t),s,r)})),n}(i,t,e(n))}}function Bi(t,e){return function(i,n){var s;if(i===F&&n===F)return e;if(i!==F&&(s=i),n!==F){if(s===F)return n;"string"==typeof i||"string"==typeof n?(i=oi(i),n=oi(n)):(i=ri(i),n=ri(n)),s=t(i,n)}return s}}function Fi(t){return Zi((function(e){return e=u(e,D(nn())),Ke((function(n){var s=this;return t(e,(function(t){return i(t,s,n)}))}))}))}function Vi(t,e){var i=(e=e===F?" ":oi(e)).length;return 2>i?i?Xe(e,t):e:(i=Xe(e,lr(t/M(e))),Ct.test(e)?gi(B(i),0,t).join(""):i.slice(0,t))}function Hi(t,e,n,s){var r=1&e,o=ki(t);return function e(){for(var a=-1,l=arguments.length,h=-1,u=s.length,c=Es(u+l),d=this&&this!==Vt&&this instanceof e?o:t;++h<u;)c[h]=s[h];for(;l--;)c[h++]=arguments[++a];return i(d,r?n:this,c)}}function zi(t){return function(e,i,n){n&&"number"!=typeof n&&dn(e,i,n)&&(i=n=F),e=ss(e),i===F?(i=e,e=0):i=ss(i),n=n===F?e<i?1:-1:ss(n);var s=-1;i=mr(lr((i-e)/(n||1)),0);for(var r=Es(i);i--;)r[t?i:++s]=e,e+=n;return r}}function Gi(t){return function(e,i){return"string"==typeof e&&"string"==typeof i||(e=as(e),i=as(i)),t(e,i)}}function qi(t,e,i,n,s,r,o,a,l,h){var u=8&e;return 4&(e=(e|(u?32:64))&~(u?64:32))||(e&=-4),s=[t,e,s,u?r:F,u?o:F,r=u?F:r,o=u?F:o,a,l,h],i=i.apply(F,s),pn(t)&&Zr(i,s),i.placeholder=n,bn(i,t,e)}function Yi(t){var e=ks[t];return function(t,i){if(t=as(t),i=null==i?0:gr(rs(i),292)){var n=(hs(t)+"e").split("e");return+((n=(hs(n=e(n[0]+"e"+(+n[1]+i)))+"e").split("e"))[0]+"e"+(+n[1]-i))}return e(t)}}function Ui(t){return function(e){var i=Kr(e);return"[object Map]"==i?L(e):"[object Set]"==i?function(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=[t,t]})),i}(e):function(t,e){return u(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function ji(t,e,i,n,s,r,o,a){var l=2&e;if(!l&&"function"!=typeof t)throw new Rs("Expected a function");var h=n?n.length:0;if(h||(e&=-97,n=s=F),o=o===F?o:mr(rs(o),0),a=a===F?a:rs(a),h-=s?s.length:0,64&e){var u=n,c=s;n=s=F}var d=l?F:jr(t);return r=[t,e,i,n,s,u,c,r,o,a],d&&(e=(i=r[1])|(t=d[1]),n=128==t&&8==i||128==t&&256==i&&r[7].length<=d[8]||384==t&&d[7].length<=d[8]&&8==i,131>e||n)&&(1&t&&(r[2]=d[2],e|=1&i?0:4),(i=d[3])&&(n=r[3],r[3]=n?wi(n,i,d[4]):i,r[4]=n?N(r[3],"__lodash_placeholder__"):d[4]),(i=d[5])&&(n=r[5],r[5]=n?Ai(n,i,d[6]):i,r[6]=n?N(r[5],"__lodash_placeholder__"):d[6]),(i=d[7])&&(r[7]=i),128&t&&(r[8]=null==r[8]?d[8]:gr(r[8],d[8])),null==r[9]&&(r[9]=d[9]),r[0]=d[0],r[1]=e),t=r[0],e=r[1],i=r[2],n=r[3],s=r[4],!(a=r[9]=r[9]===F?l?0:t.length:mr(r[9]-h,0))&&24&e&&(e&=-25),bn((d?Gr:Zr)(e&&1!=e?8==e||16==e?Li(t,e,a):32!=e&&33!=e||s.length?Ri.apply(F,r):Hi(t,e,i,n):function(t,e,i){var n=1&e,s=ki(t);return function e(){return(this&&this!==Vt&&this instanceof e?s:t).apply(n?i:this,arguments)}}(t,e,i),r),t,e)}function Wi(t,e,i,n){return t===F||Yn(t,Bs[i])&&!Hs.call(n,i)?e:t}function Xi(t,e,i,n,s,r){return Zn(t)&&Zn(e)&&(r.set(e,t),ze(t,e,F,Xi,r),r.delete(e)),t}function Ki(t){return ts(t)?F:t}function Qi(t,e,i,n,s,r){var o=1&i,a=t.length;if(a!=(l=e.length)&&!(o&&l>a))return!1;if((l=r.get(t))&&r.get(e))return l==e;var l=-1,h=!0,u=2&i?new zt:F;for(r.set(t,e),r.set(e,t);++l<a;){var c=t[l],d=e[l];if(n)var f=o?n(d,c,l,e,t,r):n(c,d,l,t,e,r);if(f!==F){if(f)continue;h=!1;break}if(u){if(!p(e,(function(t,e){if(!C(u,e)&&(c===t||s(c,t,i,n,r)))return u.push(e)}))){h=!1;break}}else if(c!==d&&!s(c,d,i,n,r)){h=!1;break}}return r.delete(t),r.delete(e),h}function Zi(t){return Jr(yn(t,F,En),t+"")}function $i(t){return Te(t,ds,Wr)}function Ji(t){return Te(t,fs,Xr)}function tn(t){for(var e=t.name+"",i=Cr[e],n=Hs.call(Cr,e)?i.length:0;n--;){var s=i[n],r=s.func;if(null==r||r==t)return s.name}return e}function en(t){return(Hs.call(xt,"placeholder")?xt:t).placeholder}function nn(){var t=(t=xt.iteratee||ws)===ws?Re:t;return arguments.length?t(arguments[0],arguments[1]):t}function sn(t,e){var i=t.__data__,n=typeof e;return("string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?i["string"==typeof e?"string":"hash"]:i.map}function rn(t){for(var e=ds(t),i=e.length;i--;){var n=e[i],s=t[n];e[i]=[n,s,s==s&&!Zn(s)]}return e}function on(t,e){var i=null==t?F:t[e];return Ne(i)?i:F}function an(t,e,i){for(var n=-1,s=(e=mi(e,t)).length,r=!1;++n<s;){var o=wn(e[n]);if(!(r=null!=t&&i(t,o)))break;t=t[o]}return r||++n!=s?r:!!(s=null==t?0:t.length)&&Qn(s)&&cn(o,s)&&(Ho(t)||Vo(t))}function ln(t){return"function"!=typeof t.constructor||mn(t)?{}:Br(Zs(t))}function hn(i,n,s,r){var o=i.constructor;switch(n){case"[object ArrayBuffer]":return bi(i);case"[object Boolean]":case"[object Date]":return new o(+i);case"[object DataView]":return n=r?bi(i.buffer):i.buffer,new i.constructor(n,i.byteOffset,i.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return vi(i,r);case"[object Map]":return d(n=r?s(L(i),1):L(i),t,new i.constructor);case"[object Number]":case"[object String]":return new o(i);case"[object RegExp]":return(n=new i.constructor(i.source,ft.exec(i))).lastIndex=i.lastIndex,n;case"[object Set]":return d(n=r?s(R(i),1):R(i),e,new i.constructor);case"[object Symbol]":return Rr?Ls(Rr.call(i)):{}}}function un(t){return Ho(t)||Vo(t)||!!(er&&t&&t[er])}function cn(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||bt.test(t))&&-1<t&&0==t%1&&t<e}function dn(t,e,i){if(!Zn(i))return!1;var n=typeof e;return!!("number"==n?Un(i)&&cn(e,i.length):"string"==n&&e in i)&&Yn(i[e],t)}function fn(t,e){if(Ho(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!is(t))||J.test(t)||!$.test(t)||null!=e&&t in Ls(e)}function pn(t){var e=tn(t),i=xt[e];return"function"==typeof i&&e in Nt.prototype&&(t===i||!!(e=jr(i))&&t===e[0])}function mn(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Bs)}function gn(t,e){return function(i){return null!=i&&i[t]===e&&(e!==F||t in Ls(i))}}function yn(t,e,n){return e=mr(e===F?t.length-1:e,0),function(){for(var s=arguments,r=-1,o=mr(s.length-e,0),a=Es(o);++r<o;)a[r]=s[e+r];for(r=-1,o=Es(e+1);++r<e;)o[r]=s[r];return o[e]=n(a),i(t,this,o)}}function bn(t,e,i){var n=e+"";e=Jr;var s,r=xn;return i=r(s=(s=n.match(lt))?s[1].split(ht):[],i),(r=i.length)&&(i[s=r-1]=(1<r?"& ":"")+i[s],i=i.join(2<r?", ":" "),n=n.replace(at,"{\n/* [wrapped with "+i+"] */\n")),e(t,n)}function vn(t){var e=0,i=0;return function(){var n=yr(),s=16-(n-i);if(i=n,0<s){if(800<=++e)return arguments[0]}else e=0;return t.apply(F,arguments)}}function _n(t,e){var i=-1,n=(s=t.length)-1;for(e=e===F?s:e;++i<e;){var s,r=t[s=We(i,n)];t[s]=t[i],t[i]=r}return t.length=e,t}function wn(t){if("string"==typeof t||is(t))return t;var e=t+"";return"0"==e&&1/t==-V?"-0":e}function An(t){if(null!=t){try{return Vs.call(t)}catch(t){}return t+""}return""}function xn(t,e){return s(z,(function(i){var n="_."+i[0];e&i[1]&&!l(t,n)&&t.push(n)})),t.sort()}function Tn(t){if(t instanceof Nt)return t.clone();var e=new Ot(t.__wrapped__,t.__chain__);return e.__actions__=xi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function Sn(t,e,i){var n=null==t?0:t.length;return n?(0>(i=null==i?0:rs(i))&&(i=mr(n+i,0)),g(t,nn(e,3),i)):-1}function Dn(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=n-1;return i!==F&&(s=rs(i),s=0>i?mr(n+s,0):gr(s,n-1)),g(t,nn(e,3),s,!0)}function En(t){return null!=t&&t.length?ve(t,1):[]}function Cn(t){return t&&t.length?t[0]:F}function In(t){var e=null==t?0:t.length;return e?t[e-1]:F}function Pn(t,e){return t&&t.length&&e&&e.length?Ue(t,e):t}function kn(t){return null==t?t:_r.call(t)}function Ln(t){if(!t||!t.length)return[];var e=0;return t=a(t,(function(t){if(jn(t))return e=mr(t.length,e),!0})),S(e,(function(e){return u(t,w(e))}))}function On(t,e){if(!t||!t.length)return[];var n=Ln(t);return null==e?n:u(n,(function(t){return i(e,F,t)}))}function Nn(t){return(t=xt(t)).__chain__=!0,t}function Rn(t,e){return e(t)}function Mn(t,e){return(Ho(t)?s:Fr)(t,nn(e,3))}function Bn(t,e){return(Ho(t)?r:Vr)(t,nn(e,3))}function Fn(t,e){return(Ho(t)?u:Fe)(t,nn(e,3))}function Vn(t,e,i){return e=i?F:e,e=t&&null==e?t.length:e,ji(t,128,F,F,F,F,e)}function Hn(t,e){var i;if("function"!=typeof e)throw new Rs("Expected a function");return t=rs(t),function(){return 0<--t&&(i=e.apply(this,arguments)),1>=t&&(e=F),i}}function zn(t,e,i){function n(e){var i=l,n=h;return l=h=F,p=e,c=t.apply(n,i)}function s(t){var i=t-f;return t-=p,f===F||i>=e||0>i||g&&t>=u}function r(){var t=Co();if(s(t))return o(t);var i,n=$r;i=t-p,t=e-(t-f),i=g?gr(t,u-i):t,d=n(r,i)}function o(t){return d=F,y&&l?n(t):(l=h=F,c)}function a(){var t=Co(),i=s(t);if(l=arguments,h=this,f=t,i){if(d===F)return p=t=f,d=$r(r,e),m?n(t):c;if(g)return d=$r(r,e),n(f)}return d===F&&(d=$r(r,e)),c}var l,h,u,c,d,f,p=0,m=!1,g=!1,y=!0;if("function"!=typeof t)throw new Rs("Expected a function");return e=as(e)||0,Zn(i)&&(m=!!i.leading,u=(g="maxWait"in i)?mr(as(i.maxWait)||0,e):u,y="trailing"in i?!!i.trailing:y),a.cancel=function(){d!==F&&Yr(d),p=0,l=f=h=d=F},a.flush=function(){return d===F?c:o(Co())},a}function Gn(t,e){function i(){var n=arguments,s=e?e.apply(this,n):n[0],r=i.cache;return r.has(s)?r.get(s):(n=t.apply(this,n),i.cache=r.set(s,n)||r,n)}if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Rs("Expected a function");return i.cache=new(Gn.Cache||Ht),i}function qn(t){if("function"!=typeof t)throw new Rs("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Yn(t,e){return t===e||t!=t&&e!=e}function Un(t){return null!=t&&Qn(t.length)&&!Xn(t)}function jn(t){return $n(t)&&Un(t)}function Wn(t){if(!$n(t))return!1;var e=Se(t);return"[object Error]"==e||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ts(t)}function Xn(t){return!!Zn(t)&&("[object Function]"==(t=Se(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}function Kn(t){return"number"==typeof t&&t==rs(t)}function Qn(t){return"number"==typeof t&&-1<t&&0==t%1&&9007199254740991>=t}function Zn(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function $n(t){return null!=t&&"object"==typeof t}function Jn(t){return"number"==typeof t||$n(t)&&"[object Number]"==Se(t)}function ts(t){return!(!$n(t)||"[object Object]"!=Se(t))&&(null===(t=Zs(t))||"function"==typeof(t=Hs.call(t,"constructor")&&t.constructor)&&t instanceof t&&Vs.call(t)==Ys)}function es(t){return"string"==typeof t||!Ho(t)&&$n(t)&&"[object String]"==Se(t)}function is(t){return"symbol"==typeof t||$n(t)&&"[object Symbol]"==Se(t)}function ns(t){if(!t)return[];if(Un(t))return es(t)?B(t):xi(t);if(ir&&t[ir]){t=t[ir]();for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}return("[object Map]"==(e=Kr(t))?L:"[object Set]"==e?R:ms)(t)}function ss(t){return t?(t=as(t))===V||t===-V?17976931348623157e292*(0>t?-1:1):t==t?t:0:0===t?t:0}function rs(t){var e=(t=ss(t))%1;return t==t?e?t-e:t:0}function os(t){return t?ce(rs(t),0,4294967295):0}function as(t){if("number"==typeof t)return t;if(is(t))return H;if(Zn(t)&&(t=Zn(t="function"==typeof t.valueOf?t.valueOf():t)?t+"":t),"string"!=typeof t)return 0===t?t:+t;t=t.replace(st,"");var e=mt.test(t);return e||yt.test(t)?Mt(t.slice(2),e?2:8):pt.test(t)?H:+t}function ls(t){return Ti(t,fs(t))}function hs(t){return null==t?"":oi(t)}function us(t,e,i){return(t=null==t?F:xe(t,e))===F?i:t}function cs(t,e){return null!=t&&an(t,e,Ce)}function ds(t){return Un(t)?Qt(t):Me(t)}function fs(t){if(Un(t))t=Qt(t,!0);else if(Zn(t)){var e,i=mn(t),n=[];for(e in t)("constructor"!=e||!i&&Hs.call(t,e))&&n.push(e);t=n}else{if(e=[],null!=t)for(i in Ls(t))e.push(i);t=e}return t}function ps(t,e){if(null==t)return{};var i=u(Ji(t),(function(t){return[t]}));return e=nn(e),Ye(t,i,(function(t,i){return e(t,i[0])}))}function ms(t){return null==t?[]:E(t,ds(t))}function gs(t){return va(hs(t).toLowerCase())}function ys(t){return(t=hs(t))&&t.replace(vt,Zt).replace(St,"")}function bs(t,e,i){return t=hs(t),(e=i?F:e)===F?It.test(t)?t.match(Et)||[]:t.match(ut)||[]:t.match(e)||[]}function vs(t){return function(){return t}}function _s(t){return t}function ws(t){return Re("function"==typeof t?t:de(t,1))}function As(t,e,i){var n=ds(e),r=Ae(e,n);null!=i||Zn(e)&&(r.length||!n.length)||(i=e,e=t,t=this,r=Ae(e,ds(e)));var o=!(Zn(i)&&"chain"in i&&!i.chain),a=Xn(t);return s(r,(function(i){var n=e[i];t[i]=n,a&&(t.prototype[i]=function(){var e=this.__chain__;if(o||e){var i=t(this.__wrapped__);return(i.__actions__=xi(this.__actions__)).push({func:n,args:arguments,thisArg:t}),i.__chain__=e,i}return n.apply(t,c([this.value()],arguments))})})),t}function xs(){}function Ts(t){return fn(t)?w(wn(t)):function(t){return function(e){return xe(e,t)}}(t)}function Ss(){return[]}function Ds(){return!1}var Es=(At=null==At?Vt:te.defaults(Vt.Object(),At,te.pick(Vt,Pt))).Array,Cs=At.Date,Is=At.Error,Ps=At.Function,ks=At.Math,Ls=At.Object,Os=At.RegExp,Ns=At.String,Rs=At.TypeError,Ms=Es.prototype,Bs=Ls.prototype,Fs=At["__core-js_shared__"],Vs=Ps.prototype.toString,Hs=Bs.hasOwnProperty,zs=0,Gs=function(){var t=/[^.]+$/.exec(Fs&&Fs.keys&&Fs.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),qs=Bs.toString,Ys=Vs.call(Ls),Us=Vt._,js=Os("^"+Vs.call(Hs).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ws=Gt?At.Buffer:F,Xs=At.Symbol,Ks=At.Uint8Array,Qs=Ws?Ws.f:F,Zs=O(Ls.getPrototypeOf,Ls),$s=Ls.create,Js=Bs.propertyIsEnumerable,tr=Ms.splice,er=Xs?Xs.isConcatSpreadable:F,ir=Xs?Xs.iterator:F,nr=Xs?Xs.toStringTag:F,sr=function(){try{var t=on(Ls,"defineProperty");return t({},"",{}),t}catch(t){}}(),rr=At.clearTimeout!==Vt.clearTimeout&&At.clearTimeout,or=Cs&&Cs.now!==Vt.Date.now&&Cs.now,ar=At.setTimeout!==Vt.setTimeout&&At.setTimeout,lr=ks.ceil,hr=ks.floor,ur=Ls.getOwnPropertySymbols,cr=Ws?Ws.isBuffer:F,dr=At.isFinite,fr=Ms.join,pr=O(Ls.keys,Ls),mr=ks.max,gr=ks.min,yr=Cs.now,br=At.parseInt,vr=ks.random,_r=Ms.reverse,wr=on(At,"DataView"),Ar=on(At,"Map"),xr=on(At,"Promise"),Tr=on(At,"Set"),Sr=on(At,"WeakMap"),Dr=on(Ls,"create"),Er=Sr&&new Sr,Cr={},Ir=An(wr),Pr=An(Ar),kr=An(xr),Lr=An(Tr),Or=An(Sr),Nr=Xs?Xs.prototype:F,Rr=Nr?Nr.valueOf:F,Mr=Nr?Nr.toString:F,Br=function(){function t(){}return function(e){return Zn(e)?$s?$s(e):(t.prototype=e,e=new t,t.prototype=F,e):{}}}();xt.templateSettings={escape:K,evaluate:Q,interpolate:Z,variable:"",imports:{_:xt}},xt.prototype=Dt.prototype,xt.prototype.constructor=xt,Ot.prototype=Br(Dt.prototype),Ot.prototype.constructor=Ot,Nt.prototype=Br(Dt.prototype),Nt.prototype.constructor=Nt,Bt.prototype.clear=function(){this.__data__=Dr?Dr(null):{},this.size=0},Bt.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},Bt.prototype.get=function(t){var e=this.__data__;return Dr?"__lodash_hash_undefined__"===(t=e[t])?F:t:Hs.call(e,t)?e[t]:F},Bt.prototype.has=function(t){var e=this.__data__;return Dr?e[t]!==F:Hs.call(e,t)},Bt.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Dr&&e===F?"__lodash_hash_undefined__":e,this},Ft.prototype.clear=function(){this.__data__=[],this.size=0},Ft.prototype.delete=function(t){var e=this.__data__;return!(0>(t=oe(e,t))||(t==e.length-1?e.pop():tr.call(e,t,1),--this.size,0))},Ft.prototype.get=function(t){var e=this.__data__;return 0>(t=oe(e,t))?F:e[t][1]},Ft.prototype.has=function(t){return-1<oe(this.__data__,t)},Ft.prototype.set=function(t,e){var i=this.__data__,n=oe(i,t);return 0>n?(++this.size,i.push([t,e])):i[n][1]=e,this},Ht.prototype.clear=function(){this.size=0,this.__data__={hash:new Bt,map:new(Ar||Ft),string:new Bt}},Ht.prototype.delete=function(t){return t=sn(this,t).delete(t),this.size-=t?1:0,t},Ht.prototype.get=function(t){return sn(this,t).get(t)},Ht.prototype.has=function(t){return sn(this,t).has(t)},Ht.prototype.set=function(t,e){var i=sn(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},zt.prototype.add=zt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},zt.prototype.has=function(t){return this.__data__.has(t)},qt.prototype.clear=function(){this.__data__=new Ft,this.size=0},qt.prototype.delete=function(t){var e=this.__data__;return t=e.delete(t),this.size=e.size,t},qt.prototype.get=function(t){return this.__data__.get(t)},qt.prototype.has=function(t){return this.__data__.has(t)},qt.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Ft){var n=i.__data__;if(!Ar||199>n.length)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new Ht(n)}return i.set(t,e),this.size=i.size,this};var Fr=Ei(_e),Vr=Ei(we,!0),Hr=Ci(),zr=Ci(!0),Gr=Er?function(t,e){return Er.set(t,e),t}:_s,qr=sr?function(t,e){return sr(t,"toString",{configurable:!0,enumerable:!1,value:vs(e),writable:!0})}:_s,Yr=rr||function(t){return Vt.clearTimeout(t)},Ur=Tr&&1/R(new Tr([,-0]))[1]==V?function(t){return new Tr(t)}:xs,jr=Er?function(t){return Er.get(t)}:xs,Wr=ur?function(t){return null==t?[]:(t=Ls(t),a(ur(t),(function(e){return Js.call(t,e)})))}:Ss,Xr=ur?function(t){for(var e=[];t;)c(e,Wr(t)),t=Zs(t);return e}:Ss,Kr=Se;(wr&&"[object DataView]"!=Kr(new wr(new ArrayBuffer(1)))||Ar&&"[object Map]"!=Kr(new Ar)||xr&&"[object Promise]"!=Kr(xr.resolve())||Tr&&"[object Set]"!=Kr(new Tr)||Sr&&"[object WeakMap]"!=Kr(new Sr))&&(Kr=function(t){var e=Se(t);if(t=(t="[object Object]"==e?t.constructor:F)?An(t):"")switch(t){case Ir:return"[object DataView]";case Pr:return"[object Map]";case kr:return"[object Promise]";case Lr:return"[object Set]";case Or:return"[object WeakMap]"}return e});var Qr=Fs?Xn:Ds,Zr=vn(Gr),$r=ar||function(t,e){return Vt.setTimeout(t,e)},Jr=vn(qr),to=function(t){var e=(t=Gn(t,(function(t){return 500===e.size&&e.clear(),t}))).cache;return t}((function(t){var e=[];return tt.test(t)&&e.push(""),t.replace(et,(function(t,i,n,s){e.push(n?s.replace(ct,"$1"):i||t)})),e})),eo=Ke((function(t,e){return jn(t)?me(t,ve(e,1,jn,!0)):[]})),io=Ke((function(t,e){var i=In(e);return jn(i)&&(i=F),jn(t)?me(t,ve(e,1,jn,!0),nn(i,2)):[]})),no=Ke((function(t,e){var i=In(e);return jn(i)&&(i=F),jn(t)?me(t,ve(e,1,jn,!0),F,i):[]})),so=Ke((function(t){var e=u(t,fi);return e.length&&e[0]===t[0]?Ie(e):[]})),ro=Ke((function(t){var e=In(t),i=u(t,fi);return e===In(i)?e=F:i.pop(),i.length&&i[0]===t[0]?Ie(i,nn(e,2)):[]})),oo=Ke((function(t){var e=In(t),i=u(t,fi);return(e="function"==typeof e?e:F)&&i.pop(),i.length&&i[0]===t[0]?Ie(i,F,e):[]})),ao=Ke(Pn),lo=Zi((function(t,e){var i=null==t?0:t.length,n=ue(t,e);return je(t,u(e,(function(t){return cn(t,i)?+t:t})).sort(_i)),n})),ho=Ke((function(t){return ai(ve(t,1,jn,!0))})),uo=Ke((function(t){var e=In(t);return jn(e)&&(e=F),ai(ve(t,1,jn,!0),nn(e,2))})),co=Ke((function(t){var e="function"==typeof(e=In(t))?e:F;return ai(ve(t,1,jn,!0),F,e)})),fo=Ke((function(t,e){return jn(t)?me(t,e):[]})),po=Ke((function(t){return ci(a(t,jn))})),mo=Ke((function(t){var e=In(t);return jn(e)&&(e=F),ci(a(t,jn),nn(e,2))})),go=Ke((function(t){var e="function"==typeof(e=In(t))?e:F;return ci(a(t,jn),F,e)})),yo=Ke(Ln),bo=Ke((function(t){var e="function"==typeof(e=1<(e=t.length)?t[e-1]:F)?(t.pop(),e):F;return On(t,e)})),vo=Zi((function(t){function e(e){return ue(e,t)}var i=t.length,n=i?t[0]:0,s=this.__wrapped__;return!(1<i||this.__actions__.length)&&s instanceof Nt&&cn(n)?((s=s.slice(n,+n+(i?1:0))).__actions__.push({func:Rn,args:[e],thisArg:F}),new Ot(s,this.__chain__).thru((function(t){return i&&!t.length&&t.push(F),t}))):this.thru(e)})),_o=Si((function(t,e,i){Hs.call(t,i)?++t[i]:he(t,i,1)})),wo=Oi(Sn),Ao=Oi(Dn),xo=Si((function(t,e,i){Hs.call(t,i)?t[i].push(e):he(t,i,[e])})),To=Ke((function(t,e,n){var s=-1,r="function"==typeof e,o=Un(t)?Es(t.length):[];return Fr(t,(function(t){o[++s]=r?i(e,t,n):Pe(t,e,n)})),o})),So=Si((function(t,e,i){he(t,i,e)})),Do=Si((function(t,e,i){t[i?0:1].push(e)}),(function(){return[[],[]]})),Eo=Ke((function(t,e){if(null==t)return[];var i=e.length;return 1<i&&dn(t,e[0],e[1])?e=[]:2<i&&dn(e[0],e[1],e[2])&&(e=[e[0]]),qe(t,ve(e,1),[])})),Co=or||function(){return Vt.Date.now()},Io=Ke((function(t,e,i){var n=1;if(i.length){var s=N(i,en(Io));n=32|n}return ji(t,n,e,i,s)})),Po=Ke((function(t,e,i){var n=3;if(i.length){var s=N(i,en(Po));n=32|n}return ji(e,n,t,i,s)})),ko=Ke((function(t,e){return pe(t,1,e)})),Lo=Ke((function(t,e,i){return pe(t,as(e)||0,i)}));Gn.Cache=Ht;var Oo=Ke((function(t,e){var n=(e=1==e.length&&Ho(e[0])?u(e[0],D(nn())):u(ve(e,1),D(nn()))).length;return Ke((function(s){for(var r=-1,o=gr(s.length,n);++r<o;)s[r]=e[r].call(this,s[r]);return i(t,this,s)}))})),No=Ke((function(t,e){return ji(t,32,F,e,N(e,en(No)))})),Ro=Ke((function(t,e){return ji(t,64,F,e,N(e,en(Ro)))})),Mo=Zi((function(t,e){return ji(t,256,F,F,F,e)})),Bo=Gi(De),Fo=Gi((function(t,e){return t>=e})),Vo=ke(function(){return arguments}())?ke:function(t){return $n(t)&&Hs.call(t,"callee")&&!Js.call(t,"callee")},Ho=Es.isArray,zo=Yt?D(Yt):function(t){return $n(t)&&"[object ArrayBuffer]"==Se(t)},Go=cr||Ds,qo=Ut?D(Ut):function(t){return $n(t)&&"[object Date]"==Se(t)},Yo=jt?D(jt):function(t){return $n(t)&&"[object Map]"==Kr(t)},Uo=Wt?D(Wt):function(t){return $n(t)&&"[object RegExp]"==Se(t)},jo=Xt?D(Xt):function(t){return $n(t)&&"[object Set]"==Kr(t)},Wo=Kt?D(Kt):function(t){return $n(t)&&Qn(t.length)&&!!kt[Se(t)]},Xo=Gi(Be),Ko=Gi((function(t,e){return t<=e})),Qo=Di((function(t,e){if(mn(e)||Un(e))Ti(e,ds(e),t);else for(var i in e)Hs.call(e,i)&&re(t,i,e[i])})),Zo=Di((function(t,e){Ti(e,fs(e),t)})),$o=Di((function(t,e,i,n){Ti(e,fs(e),t,n)})),Jo=Di((function(t,e,i,n){Ti(e,ds(e),t,n)})),ta=Zi(ue),ea=Ke((function(t){return t.push(F,Wi),i($o,F,t)})),ia=Ke((function(t){return t.push(F,Xi),i(aa,F,t)})),na=Mi((function(t,e,i){t[e]=i}),vs(_s)),sa=Mi((function(t,e,i){Hs.call(t,e)?t[e].push(i):t[e]=[i]}),nn),ra=Ke(Pe),oa=Di((function(t,e,i){ze(t,e,i)})),aa=Di((function(t,e,i,n){ze(t,e,i,n)})),la=Zi((function(t,e){var i={};if(null==t)return i;var n=!1;e=u(e,(function(e){return e=mi(e,t),n||(n=1<e.length),e})),Ti(t,Ji(t),i),n&&(i=de(i,7,Ki));for(var s=e.length;s--;)li(i,e[s]);return i})),ha=Zi((function(t,e){return null==t?{}:function(t,e){return Ye(t,e,(function(e,i){return cs(t,i)}))}(t,e)})),ua=Ui(ds),ca=Ui(fs),da=Pi((function(t,e,i){return e=e.toLowerCase(),t+(i?gs(e):e)})),fa=Pi((function(t,e,i){return t+(i?"-":"")+e.toLowerCase()})),pa=Pi((function(t,e,i){return t+(i?" ":"")+e.toLowerCase()})),ma=Ii("toLowerCase"),ga=Pi((function(t,e,i){return t+(i?"_":"")+e.toLowerCase()})),ya=Pi((function(t,e,i){return t+(i?" ":"")+va(e)})),ba=Pi((function(t,e,i){return t+(i?" ":"")+e.toUpperCase()})),va=Ii("toUpperCase"),_a=Ke((function(t,e){try{return i(t,F,e)}catch(t){return Wn(t)?t:new Is(t)}})),wa=Zi((function(t,e){return s(e,(function(e){e=wn(e),he(t,e,Io(t[e],t))})),t})),Aa=Ni(),xa=Ni(!0),Ta=Ke((function(t,e){return function(i){return Pe(i,t,e)}})),Sa=Ke((function(t,e){return function(i){return Pe(t,i,e)}})),Da=Fi(u),Ea=Fi(o),Ca=Fi(p),Ia=zi(),Pa=zi(!0),ka=Bi((function(t,e){return t+e}),0),La=Yi("ceil"),Oa=Bi((function(t,e){return t/e}),1),Na=Yi("floor"),Ra=Bi((function(t,e){return t*e}),1),Ma=Yi("round"),Ba=Bi((function(t,e){return t-e}),0);return xt.after=function(t,e){if("function"!=typeof e)throw new Rs("Expected a function");return t=rs(t),function(){if(1>--t)return e.apply(this,arguments)}},xt.ary=Vn,xt.assign=Qo,xt.assignIn=Zo,xt.assignInWith=$o,xt.assignWith=Jo,xt.at=ta,xt.before=Hn,xt.bind=Io,xt.bindAll=wa,xt.bindKey=Po,xt.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ho(t)?t:[t]},xt.chain=Nn,xt.chunk=function(t,e,i){if(e=(i?dn(t,e,i):e===F)?1:mr(rs(e),0),!(i=null==t?0:t.length)||1>e)return[];for(var n=0,s=0,r=Es(lr(i/e));n<i;)r[s++]=ti(t,n,n+=e);return r},xt.compact=function(t){for(var e=-1,i=null==t?0:t.length,n=0,s=[];++e<i;){var r=t[e];r&&(s[n++]=r)}return s},xt.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Es(t-1),i=arguments[0];t--;)e[t-1]=arguments[t];return c(Ho(i)?xi(i):[i],ve(e,1))},xt.cond=function(t){var e=null==t?0:t.length,n=nn();return t=e?u(t,(function(t){if("function"!=typeof t[1])throw new Rs("Expected a function");return[n(t[0]),t[1]]})):[],Ke((function(n){for(var s=-1;++s<e;){var r=t[s];if(i(r[0],this,n))return i(r[1],this,n)}}))},xt.conforms=function(t){return function(t){var e=ds(t);return function(i){return fe(i,t,e)}}(de(t,1))},xt.constant=vs,xt.countBy=_o,xt.create=function(t,e){var i=Br(t);return null==e?i:le(i,e)},xt.curry=function t(e,i,n){return(e=ji(e,8,F,F,F,F,F,i=n?F:i)).placeholder=t.placeholder,e},xt.curryRight=function t(e,i,n){return(e=ji(e,16,F,F,F,F,F,i=n?F:i)).placeholder=t.placeholder,e},xt.debounce=zn,xt.defaults=ea,xt.defaultsDeep=ia,xt.defer=ko,xt.delay=Lo,xt.difference=eo,xt.differenceBy=io,xt.differenceWith=no,xt.drop=function(t,e,i){var n=null==t?0:t.length;return n?ti(t,0>(e=i||e===F?1:rs(e))?0:e,n):[]},xt.dropRight=function(t,e,i){var n=null==t?0:t.length;return n?ti(t,0,0>(e=n-(e=i||e===F?1:rs(e)))?0:e):[]},xt.dropRightWhile=function(t,e){return t&&t.length?hi(t,nn(e,3),!0,!0):[]},xt.dropWhile=function(t,e){return t&&t.length?hi(t,nn(e,3),!0):[]},xt.fill=function(t,e,i,n){var s=null==t?0:t.length;if(!s)return[];for(i&&"number"!=typeof i&&dn(t,e,i)&&(i=0,n=s),s=t.length,0>(i=rs(i))&&(i=-i>s?0:s+i),0>(n=n===F||n>s?s:rs(n))&&(n+=s),n=i>n?0:os(n);i<n;)t[i++]=e;return t},xt.filter=function(t,e){return(Ho(t)?a:be)(t,nn(e,3))},xt.flatMap=function(t,e){return ve(Fn(t,e),1)},xt.flatMapDeep=function(t,e){return ve(Fn(t,e),V)},xt.flatMapDepth=function(t,e,i){return i=i===F?1:rs(i),ve(Fn(t,e),i)},xt.flatten=En,xt.flattenDeep=function(t){return null!=t&&t.length?ve(t,V):[]},xt.flattenDepth=function(t,e){return null!=t&&t.length?ve(t,e=e===F?1:rs(e)):[]},xt.flip=function(t){return ji(t,512)},xt.flow=Aa,xt.flowRight=xa,xt.fromPairs=function(t){for(var e=-1,i=null==t?0:t.length,n={};++e<i;){var s=t[e];n[s[0]]=s[1]}return n},xt.functions=function(t){return null==t?[]:Ae(t,ds(t))},xt.functionsIn=function(t){return null==t?[]:Ae(t,fs(t))},xt.groupBy=xo,xt.initial=function(t){return null!=t&&t.length?ti(t,0,-1):[]},xt.intersection=so,xt.intersectionBy=ro,xt.intersectionWith=oo,xt.invert=na,xt.invertBy=sa,xt.invokeMap=To,xt.iteratee=ws,xt.keyBy=So,xt.keys=ds,xt.keysIn=fs,xt.map=Fn,xt.mapKeys=function(t,e){var i={};return e=nn(e,3),_e(t,(function(t,n,s){he(i,e(t,n,s),t)})),i},xt.mapValues=function(t,e){var i={};return e=nn(e,3),_e(t,(function(t,n,s){he(i,n,e(t,n,s))})),i},xt.matches=function(t){return Ve(de(t,1))},xt.matchesProperty=function(t,e){return He(t,de(e,1))},xt.memoize=Gn,xt.merge=oa,xt.mergeWith=aa,xt.method=Ta,xt.methodOf=Sa,xt.mixin=As,xt.negate=qn,xt.nthArg=function(t){return t=rs(t),Ke((function(e){return Ge(e,t)}))},xt.omit=la,xt.omitBy=function(t,e){return ps(t,qn(nn(e)))},xt.once=function(t){return Hn(2,t)},xt.orderBy=function(t,e,i,n){return null==t?[]:(Ho(e)||(e=null==e?[]:[e]),Ho(i=n?F:i)||(i=null==i?[]:[i]),qe(t,e,i))},xt.over=Da,xt.overArgs=Oo,xt.overEvery=Ea,xt.overSome=Ca,xt.partial=No,xt.partialRight=Ro,xt.partition=Do,xt.pick=ha,xt.pickBy=ps,xt.property=Ts,xt.propertyOf=function(t){return function(e){return null==t?F:xe(t,e)}},xt.pull=ao,xt.pullAll=Pn,xt.pullAllBy=function(t,e,i){return t&&t.length&&e&&e.length?Ue(t,e,nn(i,2)):t},xt.pullAllWith=function(t,e,i){return t&&t.length&&e&&e.length?Ue(t,e,F,i):t},xt.pullAt=lo,xt.range=Ia,xt.rangeRight=Pa,xt.rearg=Mo,xt.reject=function(t,e){return(Ho(t)?a:be)(t,qn(nn(e,3)))},xt.remove=function(t,e){var i=[];if(!t||!t.length)return i;var n=-1,s=[],r=t.length;for(e=nn(e,3);++n<r;){var o=t[n];e(o,n,t)&&(i.push(o),s.push(n))}return je(t,s),i},xt.rest=function(t,e){if("function"!=typeof t)throw new Rs("Expected a function");return Ke(t,e=e===F?e:rs(e))},xt.reverse=kn,xt.sampleSize=function(t,e,i){return e=(i?dn(t,e,i):e===F)?1:rs(e),(Ho(t)?ie:Ze)(t,e)},xt.set=function(t,e,i){return null==t?t:$e(t,e,i)},xt.setWith=function(t,e,i,n){return n="function"==typeof n?n:F,null==t?t:$e(t,e,i,n)},xt.shuffle=function(t){return(Ho(t)?ne:Je)(t)},xt.slice=function(t,e,i){var n=null==t?0:t.length;return n?(i&&"number"!=typeof i&&dn(t,e,i)?(e=0,i=n):(e=null==e?0:rs(e),i=i===F?n:rs(i)),ti(t,e,i)):[]},xt.sortBy=Eo,xt.sortedUniq=function(t){return t&&t.length?si(t):[]},xt.sortedUniqBy=function(t,e){return t&&t.length?si(t,nn(e,2)):[]},xt.split=function(t,e,i){return i&&"number"!=typeof i&&dn(t,e,i)&&(e=i=F),(i=i===F?4294967295:i>>>0)?(t=hs(t))&&("string"==typeof e||null!=e&&!Uo(e))&&(!(e=oi(e))&&Ct.test(t))?gi(B(t),0,i):t.split(e,i):[]},xt.spread=function(t,e){if("function"!=typeof t)throw new Rs("Expected a function");return e=null==e?0:mr(rs(e),0),Ke((function(n){var s=n[e];return n=gi(n,0,e),s&&c(n,s),i(t,this,n)}))},xt.tail=function(t){var e=null==t?0:t.length;return e?ti(t,1,e):[]},xt.take=function(t,e,i){return t&&t.length?ti(t,0,0>(e=i||e===F?1:rs(e))?0:e):[]},xt.takeRight=function(t,e,i){var n=null==t?0:t.length;return n?ti(t,0>(e=n-(e=i||e===F?1:rs(e)))?0:e,n):[]},xt.takeRightWhile=function(t,e){return t&&t.length?hi(t,nn(e,3),!1,!0):[]},xt.takeWhile=function(t,e){return t&&t.length?hi(t,nn(e,3)):[]},xt.tap=function(t,e){return e(t),t},xt.throttle=function(t,e,i){var n=!0,s=!0;if("function"!=typeof t)throw new Rs("Expected a function");return Zn(i)&&(n="leading"in i?!!i.leading:n,s="trailing"in i?!!i.trailing:s),zn(t,e,{leading:n,maxWait:e,trailing:s})},xt.thru=Rn,xt.toArray=ns,xt.toPairs=ua,xt.toPairsIn=ca,xt.toPath=function(t){return Ho(t)?u(t,wn):is(t)?[t]:xi(to(hs(t)))},xt.toPlainObject=ls,xt.transform=function(t,e,i){var n=Ho(t),r=n||Go(t)||Wo(t);if(e=nn(e,4),null==i){var o=t&&t.constructor;i=r?n?new o:[]:Zn(t)&&Xn(o)?Br(Zs(t)):{}}return(r?s:_e)(t,(function(t,n,s){return e(i,t,n,s)})),i},xt.unary=function(t){return Vn(t,1)},xt.union=ho,xt.unionBy=uo,xt.unionWith=co,xt.uniq=function(t){return t&&t.length?ai(t):[]},xt.uniqBy=function(t,e){return t&&t.length?ai(t,nn(e,2)):[]},xt.uniqWith=function(t,e){return e="function"==typeof e?e:F,t&&t.length?ai(t,F,e):[]},xt.unset=function(t,e){return null==t||li(t,e)},xt.unzip=Ln,xt.unzipWith=On,xt.update=function(t,e,i){return null==t?t:$e(t,e,pi(i)(xe(t,e)),void 0)},xt.updateWith=function(t,e,i,n){return n="function"==typeof n?n:F,null!=t&&(t=$e(t,e,pi(i)(xe(t,e)),n)),t},xt.values=ms,xt.valuesIn=function(t){return null==t?[]:E(t,fs(t))},xt.without=fo,xt.words=bs,xt.wrap=function(t,e){return No(pi(e),t)},xt.xor=po,xt.xorBy=mo,xt.xorWith=go,xt.zip=yo,xt.zipObject=function(t,e){return di(t||[],e||[],re)},xt.zipObjectDeep=function(t,e){return di(t||[],e||[],$e)},xt.zipWith=bo,xt.entries=ua,xt.entriesIn=ca,xt.extend=Zo,xt.extendWith=$o,As(xt,xt),xt.add=ka,xt.attempt=_a,xt.camelCase=da,xt.capitalize=gs,xt.ceil=La,xt.clamp=function(t,e,i){return i===F&&(i=e,e=F),i!==F&&(i=(i=as(i))==i?i:0),e!==F&&(e=(e=as(e))==e?e:0),ce(as(t),e,i)},xt.clone=function(t){return de(t,4)},xt.cloneDeep=function(t){return de(t,5)},xt.cloneDeepWith=function(t,e){return de(t,5,e="function"==typeof e?e:F)},xt.cloneWith=function(t,e){return de(t,4,e="function"==typeof e?e:F)},xt.conformsTo=function(t,e){return null==e||fe(t,e,ds(e))},xt.deburr=ys,xt.defaultTo=function(t,e){return null==t||t!=t?e:t},xt.divide=Oa,xt.endsWith=function(t,e,i){t=hs(t),e=oi(e);var n=t.length;n=i=i===F?n:ce(rs(i),0,n);return 0<=(i-=e.length)&&t.slice(i,n)==e},xt.eq=Yn,xt.escape=function(t){return(t=hs(t))&&X.test(t)?t.replace(j,$t):t},xt.escapeRegExp=function(t){return(t=hs(t))&&nt.test(t)?t.replace(it,"\\$&"):t},xt.every=function(t,e,i){var n=Ho(t)?o:ge;return i&&dn(t,e,i)&&(e=F),n(t,nn(e,3))},xt.find=wo,xt.findIndex=Sn,xt.findKey=function(t,e){return m(t,nn(e,3),_e)},xt.findLast=Ao,xt.findLastIndex=Dn,xt.findLastKey=function(t,e){return m(t,nn(e,3),we)},xt.floor=Na,xt.forEach=Mn,xt.forEachRight=Bn,xt.forIn=function(t,e){return null==t?t:Hr(t,nn(e,3),fs)},xt.forInRight=function(t,e){return null==t?t:zr(t,nn(e,3),fs)},xt.forOwn=function(t,e){return t&&_e(t,nn(e,3))},xt.forOwnRight=function(t,e){return t&&we(t,nn(e,3))},xt.get=us,xt.gt=Bo,xt.gte=Fo,xt.has=function(t,e){return null!=t&&an(t,e,Ee)},xt.hasIn=cs,xt.head=Cn,xt.identity=_s,xt.includes=function(t,e,i,n){return t=Un(t)?t:ms(t),i=i&&!n?rs(i):0,n=t.length,0>i&&(i=mr(n+i,0)),es(t)?i<=n&&-1<t.indexOf(e,i):!!n&&-1<y(t,e,i)},xt.indexOf=function(t,e,i){var n=null==t?0:t.length;return n?(0>(i=null==i?0:rs(i))&&(i=mr(n+i,0)),y(t,e,i)):-1},xt.inRange=function(t,e,i){return e=ss(e),i===F?(i=e,e=0):i=ss(i),(t=as(t))>=gr(e,i)&&t<mr(e,i)},xt.invoke=ra,xt.isArguments=Vo,xt.isArray=Ho,xt.isArrayBuffer=zo,xt.isArrayLike=Un,xt.isArrayLikeObject=jn,xt.isBoolean=function(t){return!0===t||!1===t||$n(t)&&"[object Boolean]"==Se(t)},xt.isBuffer=Go,xt.isDate=qo,xt.isElement=function(t){return $n(t)&&1===t.nodeType&&!ts(t)},xt.isEmpty=function(t){if(null==t)return!0;if(Un(t)&&(Ho(t)||"string"==typeof t||"function"==typeof t.splice||Go(t)||Wo(t)||Vo(t)))return!t.length;var e=Kr(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(mn(t))return!Me(t).length;for(var i in t)if(Hs.call(t,i))return!1;return!0},xt.isEqual=function(t,e){return Le(t,e)},xt.isEqualWith=function(t,e,i){var n=(i="function"==typeof i?i:F)?i(t,e):F;return n===F?Le(t,e,F,i):!!n},xt.isError=Wn,xt.isFinite=function(t){return"number"==typeof t&&dr(t)},xt.isFunction=Xn,xt.isInteger=Kn,xt.isLength=Qn,xt.isMap=Yo,xt.isMatch=function(t,e){return t===e||Oe(t,e,rn(e))},xt.isMatchWith=function(t,e,i){return i="function"==typeof i?i:F,Oe(t,e,rn(e),i)},xt.isNaN=function(t){return Jn(t)&&t!=+t},xt.isNative=function(t){if(Qr(t))throw new Is("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ne(t)},xt.isNil=function(t){return null==t},xt.isNull=function(t){return null===t},xt.isNumber=Jn,xt.isObject=Zn,xt.isObjectLike=$n,xt.isPlainObject=ts,xt.isRegExp=Uo,xt.isSafeInteger=function(t){return Kn(t)&&-9007199254740991<=t&&9007199254740991>=t},xt.isSet=jo,xt.isString=es,xt.isSymbol=is,xt.isTypedArray=Wo,xt.isUndefined=function(t){return t===F},xt.isWeakMap=function(t){return $n(t)&&"[object WeakMap]"==Kr(t)},xt.isWeakSet=function(t){return $n(t)&&"[object WeakSet]"==Se(t)},xt.join=function(t,e){return null==t?"":fr.call(t,e)},xt.kebabCase=fa,xt.last=In,xt.lastIndexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var s=n;if(i!==F&&(s=0>(s=rs(i))?mr(n+s,0):gr(s,n-1)),e==e){for(i=s+1;i--&&t[i]!==e;);t=i}else t=g(t,v,s,!0);return t},xt.lowerCase=pa,xt.lowerFirst=ma,xt.lt=Xo,xt.lte=Ko,xt.max=function(t){return t&&t.length?ye(t,_s,De):F},xt.maxBy=function(t,e){return t&&t.length?ye(t,nn(e,2),De):F},xt.mean=function(t){return _(t,_s)},xt.meanBy=function(t,e){return _(t,nn(e,2))},xt.min=function(t){return t&&t.length?ye(t,_s,Be):F},xt.minBy=function(t,e){return t&&t.length?ye(t,nn(e,2),Be):F},xt.stubArray=Ss,xt.stubFalse=Ds,xt.stubObject=function(){return{}},xt.stubString=function(){return""},xt.stubTrue=function(){return!0},xt.multiply=Ra,xt.nth=function(t,e){return t&&t.length?Ge(t,rs(e)):F},xt.noConflict=function(){return Vt._===this&&(Vt._=Us),this},xt.noop=xs,xt.now=Co,xt.pad=function(t,e,i){t=hs(t);var n=(e=rs(e))?M(t):0;return!e||n>=e?t:Vi(hr(e=(e-n)/2),i)+t+Vi(lr(e),i)},xt.padEnd=function(t,e,i){t=hs(t);var n=(e=rs(e))?M(t):0;return e&&n<e?t+Vi(e-n,i):t},xt.padStart=function(t,e,i){t=hs(t);var n=(e=rs(e))?M(t):0;return e&&n<e?Vi(e-n,i)+t:t},xt.parseInt=function(t,e,i){return i||null==e?e=0:e&&(e=+e),br(hs(t).replace(rt,""),e||0)},xt.random=function(t,e,i){if(i&&"boolean"!=typeof i&&dn(t,e,i)&&(e=i=F),i===F&&("boolean"==typeof e?(i=e,e=F):"boolean"==typeof t&&(i=t,t=F)),t===F&&e===F?(t=0,e=1):(t=ss(t),e===F?(e=t,t=0):e=ss(e)),t>e){var n=t;t=e,e=n}return i||t%1||e%1?(i=vr(),gr(t+i*(e-t+Rt("1e-"+((i+"").length-1))),e)):We(t,e)},xt.reduce=function(t,e,i){var n=Ho(t)?d:x,s=3>arguments.length;return n(t,nn(e,4),i,s,Fr)},xt.reduceRight=function(t,e,i){var n=Ho(t)?f:x,s=3>arguments.length;return n(t,nn(e,4),i,s,Vr)},xt.repeat=function(t,e,i){return e=(i?dn(t,e,i):e===F)?1:rs(e),Xe(hs(t),e)},xt.replace=function(){var t=arguments,e=hs(t[0]);return 3>t.length?e:e.replace(t[1],t[2])},xt.result=function(t,e,i){var n=-1,s=(e=mi(e,t)).length;for(s||(s=1,t=F);++n<s;){var r=null==t?F:t[wn(e[n])];r===F&&(n=s,r=i),t=Xn(r)?r.call(t):r}return t},xt.round=Ma,xt.runInContext=A,xt.sample=function(t){return(Ho(t)?ee:Qe)(t)},xt.size=function(t){if(null==t)return 0;if(Un(t))return es(t)?M(t):t.length;var e=Kr(t);return"[object Map]"==e||"[object Set]"==e?t.size:Me(t).length},xt.snakeCase=ga,xt.some=function(t,e,i){var n=Ho(t)?p:ei;return i&&dn(t,e,i)&&(e=F),n(t,nn(e,3))},xt.sortedIndex=function(t,e){return ii(t,e)},xt.sortedIndexBy=function(t,e,i){return ni(t,e,nn(i,2))},xt.sortedIndexOf=function(t,e){var i=null==t?0:t.length;if(i){var n=ii(t,e);if(n<i&&Yn(t[n],e))return n}return-1},xt.sortedLastIndex=function(t,e){return ii(t,e,!0)},xt.sortedLastIndexBy=function(t,e,i){return ni(t,e,nn(i,2),!0)},xt.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var i=ii(t,e,!0)-1;if(Yn(t[i],e))return i}return-1},xt.startCase=ya,xt.startsWith=function(t,e,i){return t=hs(t),i=null==i?0:ce(rs(i),0,t.length),e=oi(e),t.slice(i,i+e.length)==e},xt.subtract=Ba,xt.sum=function(t){return t&&t.length?T(t,_s):0},xt.sumBy=function(t,e){return t&&t.length?T(t,nn(e,2)):0},xt.template=function(t,e,i){var n=xt.templateSettings;i&&dn(t,e,i)&&(e=F),t=hs(t),e=$o({},e,n,Wi);var s,r,o=ds(i=$o({},e.imports,n.imports,Wi)),a=E(i,o),l=0;i=e.interpolate||_t;var h="__p+='";i=Os((e.escape||_t).source+"|"+i.source+"|"+(i===Z?dt:_t).source+"|"+(e.evaluate||_t).source+"|$","g");var u="sourceURL"in e?"//# sourceURL="+e.sourceURL+"\n":"";if(t.replace(i,(function(e,i,n,o,a,u){return n||(n=o),h+=t.slice(l,u).replace(wt,k),i&&(s=!0,h+="'+__e("+i+")+'"),a&&(r=!0,h+="';"+a+";\n__p+='"),n&&(h+="'+((__t=("+n+"))==null?'':__t)+'"),l=u+e.length,e})),h+="';",(e=e.variable)||(h="with(obj){"+h+"}"),h=(r?h.replace(G,""):h).replace(q,"$1").replace(Y,"$1;"),h="function("+(e||"obj")+"){"+(e?"":"obj||(obj={});")+"var __t,__p=''"+(s?",__e=_.escape":"")+(r?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+h+"return __p}",(e=_a((function(){return Ps(o,u+"return "+h).apply(F,a)}))).source=h,Wn(e))throw e;return e},xt.times=function(t,e){if(1>(t=rs(t))||9007199254740991<t)return[];var i=4294967295,n=gr(t,4294967295);for(t-=4294967295,n=S(n,e=nn(e));++i<t;)e(i);return n},xt.toFinite=ss,xt.toInteger=rs,xt.toLength=os,xt.toLower=function(t){return hs(t).toLowerCase()},xt.toNumber=as,xt.toSafeInteger=function(t){return t?ce(rs(t),-9007199254740991,9007199254740991):0===t?t:0},xt.toString=hs,xt.toUpper=function(t){return hs(t).toUpperCase()},xt.trim=function(t,e,i){return(t=hs(t))&&(i||e===F)?t.replace(st,""):t&&(e=oi(e))?gi(t=B(t),e=I(t,i=B(e)),i=P(t,i)+1).join(""):t},xt.trimEnd=function(t,e,i){return(t=hs(t))&&(i||e===F)?t.replace(ot,""):t&&(e=oi(e))?gi(t=B(t),0,e=P(t,B(e))+1).join(""):t},xt.trimStart=function(t,e,i){return(t=hs(t))&&(i||e===F)?t.replace(rt,""):t&&(e=oi(e))?gi(t=B(t),e=I(t,B(e))).join(""):t},xt.truncate=function(t,e){var i=30,n="...";if(Zn(e)){var s="separator"in e?e.separator:s;i="length"in e?rs(e.length):i,n="omission"in e?oi(e.omission):n}var r=(t=hs(t)).length;if(Ct.test(t)){var o=B(t);r=o.length}if(i>=r)return t;if(1>(r=i-M(n)))return n;if(i=o?gi(o,0,r).join(""):t.slice(0,r),s===F)return i+n;if(o&&(r+=i.length-r),Uo(s)){if(t.slice(r).search(s)){var a=i;for(s.global||(s=Os(s.source,hs(ft.exec(s))+"g")),s.lastIndex=0;o=s.exec(a);)var l=o.index;i=i.slice(0,l===F?r:l)}}else t.indexOf(oi(s),r)!=r&&(-1<(s=i.lastIndexOf(s))&&(i=i.slice(0,s)));return i+n},xt.unescape=function(t){return(t=hs(t))&&W.test(t)?t.replace(U,Jt):t},xt.uniqueId=function(t){var e=++zs;return hs(t)+e},xt.upperCase=ba,xt.upperFirst=va,xt.each=Mn,xt.eachRight=Bn,xt.first=Cn,As(xt,function(){var t={};return _e(xt,(function(e,i){Hs.call(xt.prototype,i)||(t[i]=e)})),t}(),{chain:!1}),xt.VERSION="4.17.4",s("bind bindKey curry curryRight partial partialRight".split(" "),(function(t){xt[t].placeholder=xt})),s(["drop","take"],(function(t,e){Nt.prototype[t]=function(i){i=i===F?1:mr(rs(i),0);var n=this.__filtered__&&!e?new Nt(this):this.clone();return n.__filtered__?n.__takeCount__=gr(i,n.__takeCount__):n.__views__.push({size:gr(i,4294967295),type:t+(0>n.__dir__?"Right":"")}),n},Nt.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),s(["filter","map","takeWhile"],(function(t,e){var i=e+1,n=1==i||3==i;Nt.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:nn(t,3),type:i}),e.__filtered__=e.__filtered__||n,e}})),s(["head","last"],(function(t,e){var i="take"+(e?"Right":"");Nt.prototype[t]=function(){return this[i](1).value()[0]}})),s(["initial","tail"],(function(t,e){var i="drop"+(e?"":"Right");Nt.prototype[t]=function(){return this.__filtered__?new Nt(this):this[i](1)}})),Nt.prototype.compact=function(){return this.filter(_s)},Nt.prototype.find=function(t){return this.filter(t).head()},Nt.prototype.findLast=function(t){return this.reverse().find(t)},Nt.prototype.invokeMap=Ke((function(t,e){return"function"==typeof t?new Nt(this):this.map((function(i){return Pe(i,t,e)}))})),Nt.prototype.reject=function(t){return this.filter(qn(nn(t)))},Nt.prototype.slice=function(t,e){t=rs(t);var i=this;return i.__filtered__&&(0<t||0>e)?new Nt(i):(0>t?i=i.takeRight(-t):t&&(i=i.drop(t)),e!==F&&(i=0>(e=rs(e))?i.dropRight(-e):i.take(e-t)),i)},Nt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Nt.prototype.toArray=function(){return this.take(4294967295)},_e(Nt.prototype,(function(t,e){var i=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),s=xt[n?"take"+("last"==e?"Right":""):e],r=n||/^find/.test(e);s&&(xt.prototype[e]=function(){function e(t){return t=s.apply(xt,c([t],a)),n&&d?t[0]:t}var o=this.__wrapped__,a=n?[1]:arguments,l=o instanceof Nt,h=a[0],u=l||Ho(o);u&&i&&"function"==typeof h&&1!=h.length&&(l=u=!1);var d=this.__chain__,f=!!this.__actions__.length;h=r&&!d,l=l&&!f;return!r&&u?(o=l?o:new Nt(this),(o=t.apply(o,a)).__actions__.push({func:Rn,args:[e],thisArg:F}),new Ot(o,d)):h&&l?t.apply(this,a):(o=this.thru(e),h?n?o.value()[0]:o.value():o)})})),s("pop push shift sort splice unshift".split(" "),(function(t){var e=Ms[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);xt.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var s=this.value();return e.apply(Ho(s)?s:[],t)}return this[i]((function(i){return e.apply(Ho(i)?i:[],t)}))}})),_e(Nt.prototype,(function(t,e){var i=xt[e];if(i){var n=i.name+"";(Cr[n]||(Cr[n]=[])).push({name:e,func:i})}})),Cr[Ri(F,2).name]=[{name:"wrapper",func:F}],Nt.prototype.clone=function(){var t=new Nt(this.__wrapped__);return t.__actions__=xi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=xi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=xi(this.__views__),t},Nt.prototype.reverse=function(){if(this.__filtered__){var t=new Nt(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Nt.prototype.value=function(){var t,e=this.__wrapped__.value(),i=this.__dir__,n=Ho(e),s=0>i,r=n?e.length:0;t=r;for(var o=this.__views__,a=0,l=-1,h=o.length;++l<h;){var u=o[l],c=u.size;switch(u.type){case"drop":a+=c;break;case"dropRight":t-=c;break;case"take":t=gr(t,a+c);break;case"takeRight":a=mr(a,t-c)}}if(o=(t={start:a,end:t}).start,t=(a=t.end)-o,o=s?a:o-1,l=(a=this.__iteratees__).length,h=0,u=gr(t,this.__takeCount__),!n||!s&&r==t&&u==t)return ui(e,this.__actions__);n=[];t:for(;t--&&h<u;){for(s=-1,r=e[o+=i];++s<l;){c=(d=a[s]).type;var d=(0,d.iteratee)(r);if(2==c)r=d;else if(!d){if(1==c)continue t;break t}}n[h++]=r}return n},xt.prototype.at=vo,xt.prototype.chain=function(){return Nn(this)},xt.prototype.commit=function(){return new Ot(this.value(),this.__chain__)},xt.prototype.next=function(){this.__values__===F&&(this.__values__=ns(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?F:this.__values__[this.__index__++]}},xt.prototype.plant=function(t){for(var e,i=this;i instanceof Dt;){var n=Tn(i);n.__index__=0,n.__values__=F,e?s.__wrapped__=n:e=n;var s=n;i=i.__wrapped__}return s.__wrapped__=t,e},xt.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof Nt?(this.__actions__.length&&(t=new Nt(this)),(t=t.reverse()).__actions__.push({func:Rn,args:[kn],thisArg:F}),new Ot(t,this.__chain__)):this.thru(kn)},xt.prototype.toJSON=xt.prototype.valueOf=xt.prototype.value=function(){return ui(this.__wrapped__,this.__actions__)},xt.prototype.first=xt.prototype.head,ir&&(xt.prototype[ir]=function(){return this}),xt}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Vt._=te,define((function(){return te}))):zt?((zt.exports=te)._=te,Ht._=te):Vt._=te}.call(this),function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).himalaya=t()}}((function(){return function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[o]={exports:{}};e[o][0].call(u.exports,(function(t){var i=e[o][1][t];return s(i||t)}),u,u.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){"use strict";function n(t){return"number"==typeof t&&isNaN(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.startsWith=function(t,e,i){return t.substr(i||0,e.length)===e},i.endsWith=function(t,e,i){var n=(i||t.length)-e.length,s=t.lastIndexOf(e,n);return-1!==s&&s===n},i.stringIncludes=function(t,e,i){return-1!==t.indexOf(e,i||0)},i.isRealNaN=n,i.arrayIncludes=function(t,e,i){var s=t.length;if(0===s)return!1;var r=0|i,o=n(e),a=r>=0?r:s+r;for(;a<s;){var l=t[a++];if(l===e)return!0;if(o&&n(l))return!0}return!1}},{}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(l){s=!0,r=l}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};i.default=function t(e){return e.map((function(e){var i=r(e.type);return"Element"===i?{type:i,tagName:e.tagName.toLowerCase(),attributes:u(e.attributes),children:t(e.children)}:{type:i,content:e.content}}))},i.capitialize=r,i.camelCase=o,i.castValue=a,i.unquote=l,i.splitHead=h,i.formatAttributes=u,i.formatStyles=c;var s=t("../compat");function r(t){return t.charAt(0).toUpperCase()+t.slice(1)}function o(t){return t.split("-").reduce((function(t,e){return t+e.charAt(0).toUpperCase()+e.slice(1)}))}function a(t){if("string"!=typeof t)return t;if(""===t)return t;var e=+t;return isNaN(e)?t:e}function l(t){var e=t.charAt(0),i=t.length-1;return'"'===e||"'"===e&&e===t.charAt(i)?t.slice(1,i):t}function h(t,e){var i=t.indexOf(e);return-1===i?[t]:[t.slice(0,i),t.slice(i+e.length)]}function u(t){return t.reduce((function(t,e){var i=h(e.trim(),"="),r=n(i,2),u=r[0],d=r[1];if(d=d?l(d):u,"class"===u)t.className=d.split(" ");else if("style"===u)t.style=c(d);else if((0,s.startsWith)(u,"data-")){t.dataset=t.dataset||{};var f=o(u.slice(5));t.dataset[f]=a(d)}else t[o(u)]=a(d);return t}),{})}function c(t){return t.trim().split(";").map((function(t){return t.trim().split(":")})).reduce((function(t,e){var i=n(e,2),s=i[0],r=i[1];if(r){var l=o(s.trim()),h=a(r.trim());t[l]=h}return t}),{})}},{"../compat":1}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.parseDefaults=void 0,i.parse=l;var n=o(t("./lexer")),s=o(t("./parser")),r=o(t("./formats/v0"));function o(t){return t&&t.__esModule?t:{default:t}}var a=i.parseDefaults={voidTags:["!doctype","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],closingTags:["html","head","body","p","dt","dd","li","option","thead","th","tbody","tr","td","tfoot","colgroup"],childlessTags:["style","script","template"],format:r.default};function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,i=(0,n.default)(t,e),o=(0,s.default)(i,e);return(0,r.default)(o,e)}i.default={parse:l,parseDefaults:a}},{"./formats/v0":2,"./lexer":4,"./parser":5}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t,e){var i={str:t,options:e,cursor:0,tokens:[]};return r(i),i.tokens},i.lex=r,i.lexText=o,i.lexComment=a,i.lexTag=l,i.lexTagName=h,i.lexTagAttributes=u,i.lexSkipTag=c;var n=t("./compat");function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function r(t){for(var e=t.str,i=e.length;t.cursor<i;){if("<"!==e.charAt(t.cursor))o(t);else if((0,n.startsWith)(e,"!--",t.cursor+1))a(t);else{var s=l(t);if(s){var r=s.toLowerCase(),h=t.options.childlessTags;(0,n.arrayIncludes)(h,r)&&c(s,t)}}}}function o(t){var e=t.str,i=t.cursor,n=e.indexOf("<",i);if(-1===n){var s=e.slice(i);return t.cursor=e.length,void t.tokens.push({type:"text",content:s})}if(n!==i){var r=e.slice(i,n);t.cursor=n,t.tokens.push({type:"text",content:r})}}function a(t){t.cursor+=4;var e=t.str,i=t.cursor,n=e.indexOf("--\x3e",i);if(-1===n){var s=e.slice(i);return t.cursor=e.length,void t.tokens.push({type:"comment",content:s})}var r=e.slice(i,n);t.cursor=n+3,t.tokens.push({type:"comment",content:r})}function l(t){var e=t.str,i="/"===e.charAt(t.cursor+1);t.tokens.push({type:"tag-start",close:i}),t.cursor+=i?2:1;var n=h(t);u(t);var s="/"===e.charAt(t.cursor);return t.tokens.push({type:"tag-end",close:s}),t.cursor+=s?2:1,n}function h(t){for(var e=t.str,i=t.cursor,n=e.length,s=i;s<n;){var r=e.charAt(s);if(!(" "===r||"/"===r||">"===r))break;s++}for(var o=s+1;o<n;){var a=e.charAt(o);if(!!(" "===a||"/"===a||">"===a))break;o++}t.cursor=o;var l=e.slice(s,o);return t.tokens.push({type:"tag",content:l}),l}function u(t){for(var e=t.str,i=t.tokens,s=t.cursor,r=null,o=s,a=[],l=e.length;s<l;){var h=e.charAt(s);if(r){h===r&&(r=null),s++}else{if("/"===h||">"===h){s!==o&&a.push(e.slice(o,s));break}if(" "===h)s!==o&&a.push(e.slice(o,s)),o=s+1,s++;else"'"===h||'"'===h?(r=h,s++):s++}}t.cursor=s;for(var u=a.length,c="attribute",d=0;d<u;d++){var f=a[d];if(f&&f.length){if(-1===f.indexOf("=")){var p=a[d+1];if(p&&(0,n.startsWith)(p,"=")){if(p.length>1){var m=f+p;i.push({type:c,content:m}),d+=1;continue}var g=a[d+2];if(d+=1,g){var y=f+"="+g;i.push({type:c,content:y}),d+=1;continue}}}if((0,n.endsWith)(f,"=")){var b=a[d+1];if(b&&!(0,n.stringIncludes)(b,"=")){var v=f+b;i.push({type:c,content:v}),d+=1;continue}var _=f.slice(0,-1);i.push({type:c,content:_})}else i.push({type:c,content:f})}}}function c(t,e){for(var i=e.str,n=e.cursor,r=e.tokens,a=i.length,l=n;l<a;){var c=i.indexOf("</",l);if(-1===c){o(e);break}var d={str:i,cursor:c+2,tokens:[]},f=h(d);if(t.toLowerCase()===f.toLowerCase()){var p=i.slice(n,c);r.push({type:"text",content:p});u(d),r.push.apply(r,[{type:"tag-start",close:!0}].concat(s(d.tokens),[{type:"tag-end",close:!1}])),e.cursor=d.cursor+1;break}l=d.cursor}}},{"./compat":1}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t,e){var i={tagName:null,children:[]};return s({tokens:t,options:e,cursor:0,stack:[i]}),i.children},i.parse=s;var n=t("./compat");function s(t){for(var e=t.tokens,i=t.options,r=t.stack,o=r[r.length-1].children,a=e.length,l=t.cursor;l<a;){var h=e[l];if("tag-start"===h.type){var u=e[++l];l++;var c=u.content.toLowerCase();if(h.close){for(var d=void 0;(d=r.pop())&&c!==d.tagName;);for(;l<a;){if("tag-end"!==e[l].type)break;l++}break}if((0,n.arrayIncludes)(i.closingTags,c))for(var f=r.length-1;f>0;){if(c===r[f].tagName){o=(r=r.slice(0,f))[f-1].children;break}f-=1}for(var p=[],m=void 0;l<a&&"tag-end"!==(m=e[l]).type;)p.push(m.content),l++;l++;var g=[];if(o.push({type:"element",tagName:u.content,attributes:p,children:g}),!(m.close||(0,n.arrayIncludes)(i.voidTags,c))){r.push({tagName:c,children:g});var y={tokens:e,options:i,cursor:l,stack:r};s(y),l=y.cursor}}else o.push(h),l++}t.cursor=l}},{"./compat":1}]},{},[3])(3)})),function(t){var e="object"==typeof exports&&exports,i="object"==typeof module&&module&&module.exports==e&&module,n="object"==typeof global&&global;n.global!==n&&n.window!==n||(t=n);var s=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r=/[\x01-\x7F]/g,o=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,a=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,l={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","\t":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr","ª":"ordf","á":"aacute","Á":"Aacute","à":"agrave","À":"Agrave","ă":"abreve","Ă":"Abreve","â":"acirc","Â":"Acirc","å":"aring","Å":"angst","ä":"auml","Ä":"Auml","ã":"atilde","Ã":"Atilde","ą":"aogon","Ą":"Aogon","ā":"amacr","Ā":"Amacr","æ":"aelig","Æ":"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf","ℬ":"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf","ℭ":"Cfr","𝒞":"Cscr","ℂ":"Copf","ć":"cacute","Ć":"Cacute","ĉ":"ccirc","Ĉ":"Ccirc","č":"ccaron","Č":"Ccaron","ċ":"cdot","Ċ":"Cdot","ç":"ccedil","Ç":"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf","ď":"dcaron","Ď":"Dcaron","đ":"dstrok","Đ":"Dstrok","ð":"eth","Ð":"ETH","ⅇ":"ee","ℯ":"escr","𝔢":"efr","𝕖":"eopf","ℰ":"Escr","𝔈":"Efr","𝔼":"Eopf","é":"eacute","É":"Eacute","è":"egrave","È":"Egrave","ê":"ecirc","Ê":"Ecirc","ě":"ecaron","Ě":"Ecaron","ë":"euml","Ë":"Euml","ė":"edot","Ė":"Edot","ę":"eogon","Ę":"Eogon","ē":"emacr","Ē":"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf","ℱ":"Fscr","ﬀ":"fflig","ﬃ":"ffilig","ﬄ":"ffllig","ﬁ":"filig",fj:"fjlig","ﬂ":"fllig","ƒ":"fnof","ℊ":"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr","ǵ":"gacute","ğ":"gbreve","Ğ":"Gbreve","ĝ":"gcirc","Ĝ":"Gcirc","ġ":"gdot","Ġ":"Gdot","Ģ":"Gcedil","𝔥":"hfr","ℎ":"planckh","𝒽":"hscr","𝕙":"hopf","ℋ":"Hscr","ℌ":"Hfr","ℍ":"Hopf","ĥ":"hcirc","Ĥ":"Hcirc","ℏ":"hbar","ħ":"hstrok","Ħ":"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf","ℐ":"Iscr","ℑ":"Im","í":"iacute","Í":"Iacute","ì":"igrave","Ì":"Igrave","î":"icirc","Î":"Icirc","ï":"iuml","Ï":"Iuml","ĩ":"itilde","Ĩ":"Itilde","İ":"Idot","į":"iogon","Į":"Iogon","ī":"imacr","Ī":"Imacr","ĳ":"ijlig","Ĳ":"IJlig","ı":"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf","ĵ":"jcirc","Ĵ":"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr","ķ":"kcedil","Ķ":"Kcedil","𝔩":"lfr","𝓁":"lscr","ℓ":"ell","𝕝":"lopf","ℒ":"Lscr","𝔏":"Lfr","𝕃":"Lopf","ĺ":"lacute","Ĺ":"Lacute","ľ":"lcaron","Ľ":"Lcaron","ļ":"lcedil","Ļ":"Lcedil","ł":"lstrok","Ł":"Lstrok","ŀ":"lmidot","Ŀ":"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf","ℳ":"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr","ℕ":"Nopf","𝒩":"Nscr","𝔑":"Nfr","ń":"nacute","Ń":"Nacute","ň":"ncaron","Ň":"Ncaron","ñ":"ntilde","Ñ":"Ntilde","ņ":"ncedil","Ņ":"Ncedil","№":"numero","ŋ":"eng","Ŋ":"ENG","𝕠":"oopf","𝔬":"ofr","ℴ":"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf","º":"ordm","ó":"oacute","Ó":"Oacute","ò":"ograve","Ò":"Ograve","ô":"ocirc","Ô":"Ocirc","ö":"ouml","Ö":"Ouml","ő":"odblac","Ő":"Odblac","õ":"otilde","Õ":"Otilde","ø":"oslash","Ø":"Oslash","ō":"omacr","Ō":"Omacr","œ":"oelig","Œ":"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf","ℙ":"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr","ℚ":"Qopf","ĸ":"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr","ℛ":"Rscr","ℜ":"Re","ℝ":"Ropf","ŕ":"racute","Ŕ":"Racute","ř":"rcaron","Ř":"Rcaron","ŗ":"rcedil","Ŗ":"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS","ś":"sacute","Ś":"Sacute","ŝ":"scirc","Ŝ":"Scirc","š":"scaron","Š":"Scaron","ş":"scedil","Ş":"Scedil","ß":"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf","ť":"tcaron","Ť":"Tcaron","ţ":"tcedil","Ţ":"Tcedil","™":"trade","ŧ":"tstrok","Ŧ":"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr","ú":"uacute","Ú":"Uacute","ù":"ugrave","Ù":"Ugrave","ŭ":"ubreve","Ŭ":"Ubreve","û":"ucirc","Û":"Ucirc","ů":"uring","Ů":"Uring","ü":"uuml","Ü":"Uuml","ű":"udblac","Ű":"Udblac","ũ":"utilde","Ũ":"Utilde","ų":"uogon","Ų":"Uogon","ū":"umacr","Ū":"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr","ŵ":"wcirc","Ŵ":"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf","ý":"yacute","Ý":"Yacute","ŷ":"ycirc","Ŷ":"Ycirc","ÿ":"yuml","Ÿ":"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf","ℨ":"Zfr","ℤ":"Zopf","𝒵":"Zscr","ź":"zacute","Ź":"Zacute","ž":"zcaron","Ž":"Zcaron","ż":"zdot","Ż":"Zdot","Ƶ":"imped","þ":"thorn","Þ":"THORN","ŉ":"napos","α":"alpha","Α":"Alpha","β":"beta","Β":"Beta","γ":"gamma","Γ":"Gamma","δ":"delta","Δ":"Delta","ε":"epsi","ϵ":"epsiv","Ε":"Epsilon","ϝ":"gammad","Ϝ":"Gammad","ζ":"zeta","Ζ":"Zeta","η":"eta","Η":"Eta","θ":"theta","ϑ":"thetav","Θ":"Theta","ι":"iota","Ι":"Iota","κ":"kappa","ϰ":"kappav","Κ":"Kappa","λ":"lambda","Λ":"Lambda","μ":"mu","µ":"micro","Μ":"Mu","ν":"nu","Ν":"Nu","ξ":"xi","Ξ":"Xi","ο":"omicron","Ο":"Omicron","π":"pi","ϖ":"piv","Π":"Pi","ρ":"rho","ϱ":"rhov","Ρ":"Rho","σ":"sigma","Σ":"Sigma","ς":"sigmaf","τ":"tau","Τ":"Tau","υ":"upsi","Υ":"Upsilon","ϒ":"Upsi","φ":"phi","ϕ":"phiv","Φ":"Phi","χ":"chi","Χ":"Chi","ψ":"psi","Ψ":"Psi","ω":"omega","Ω":"ohm","а":"acy","А":"Acy","б":"bcy","Б":"Bcy","в":"vcy","В":"Vcy","г":"gcy","Г":"Gcy","ѓ":"gjcy","Ѓ":"GJcy","д":"dcy","Д":"Dcy","ђ":"djcy","Ђ":"DJcy","е":"iecy","Е":"IEcy","ё":"iocy","Ё":"IOcy","є":"jukcy","Є":"Jukcy","ж":"zhcy","Ж":"ZHcy","з":"zcy","З":"Zcy","ѕ":"dscy","Ѕ":"DScy","и":"icy","И":"Icy","і":"iukcy","І":"Iukcy","ї":"yicy","Ї":"YIcy","й":"jcy","Й":"Jcy","ј":"jsercy","Ј":"Jsercy","к":"kcy","К":"Kcy","ќ":"kjcy","Ќ":"KJcy","л":"lcy","Л":"Lcy","љ":"ljcy","Љ":"LJcy","м":"mcy","М":"Mcy","н":"ncy","Н":"Ncy","њ":"njcy","Њ":"NJcy","о":"ocy","О":"Ocy","п":"pcy","П":"Pcy","р":"rcy","Р":"Rcy","с":"scy","С":"Scy","т":"tcy","Т":"Tcy","ћ":"tshcy","Ћ":"TSHcy","у":"ucy","У":"Ucy","ў":"ubrcy","Ў":"Ubrcy","ф":"fcy","Ф":"Fcy","х":"khcy","Х":"KHcy","ц":"tscy","Ц":"TScy","ч":"chcy","Ч":"CHcy","џ":"dzcy","Џ":"DZcy","ш":"shcy","Ш":"SHcy","щ":"shchcy","Щ":"SHCHcy","ъ":"hardcy","Ъ":"HARDcy","ы":"ycy","Ы":"Ycy","ь":"softcy","Ь":"SOFTcy","э":"ecy","Э":"Ecy","ю":"yucy","Ю":"YUcy","я":"yacy","Я":"YAcy","ℵ":"aleph","ℶ":"beth","ℷ":"gimel","ℸ":"daleth"},h=/["&'<>`]/g,u={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},c=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,d=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,f=/&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)([=a-zA-Z0-9])?/g,p={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},m={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},g={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},y=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],b=String.fromCharCode,v={}.hasOwnProperty,_=function(t,e){return v.call(t,e)},w=function(t,e){if(!t)return e;var i,n={};for(i in e)n[i]=_(t,i)?t[i]:e[i];return n},A=function(t,e){var i="";return t>=55296&&t<=57343||t>1114111?(e&&S("character reference outside the permissible Unicode range"),"�"):_(g,t)?(e&&S("disallowed character reference"),g[t]):(e&&function(t,e){for(var i=-1,n=t.length;++i<n;)if(t[i]==e)return!0;return!1}(y,t)&&S("disallowed character reference"),t>65535&&(i+=b((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=b(t))},x=function(t){return"&#x"+t.toString(16).toUpperCase()+";"},T=function(t){return"&#"+t+";"},S=function(t){throw Error("Parse error: "+t)},D=function(t,e){(e=w(e,D.options)).strict&&d.test(t)&&S("forbidden code point");var i=e.encodeEverything,n=e.useNamedReferences,u=e.allowUnsafeSymbols,c=e.decimal?T:x,f=function(t){return c(t.charCodeAt(0))};return i?(t=t.replace(r,(function(t){return n&&_(l,t)?"&"+l[t]+";":f(t)})),n&&(t=t.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),n&&(t=t.replace(a,(function(t){return"&"+l[t]+";"})))):n?(u||(t=t.replace(h,(function(t){return"&"+l[t]+";"}))),t=(t=t.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;")).replace(a,(function(t){return"&"+l[t]+";"}))):u||(t=t.replace(h,f)),t.replace(s,(function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1);return c(1024*(e-55296)+i-56320+65536)})).replace(o,f)};D.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var E=function(t,e){var i=(e=w(e,E.options)).strict;return i&&c.test(t)&&S("malformed character reference"),t.replace(f,(function(t,n,s,r,o,a,l,h){var u,c,d,f,g,y;return n?(d=n,c=s,i&&!c&&S("character reference was not terminated by a semicolon"),u=parseInt(d,10),A(u,i)):r?(f=r,c=o,i&&!c&&S("character reference was not terminated by a semicolon"),u=parseInt(f,16),A(u,i)):a?_(p,g=a)?p[g]:(i&&S("named character reference was not terminated by a semicolon"),t):(g=l,(y=h)&&e.isAttributeValue?(i&&"="==y&&S("`&` did not start a character reference"),t):(i&&S("named character reference was not terminated by a semicolon"),m[g]+(y||"")))}))};E.options={isAttributeValue:!1,strict:!1};var C={version:"1.1.1",encode:D,decode:E,escape:function(t){return t.replace(h,(function(t){return u[t]}))},unescape:E};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define((function(){return C}));else if(e&&!e.nodeType)if(i)i.exports=C;else for(var I in C)_(C,I)&&(e[I]=C[I]);else t.he=C}(this),function(t,e){"use strict";"function"==typeof window.define&&window.define.amd?window.define([],e):"object"==typeof module&&module.exports?module.exports=e():t.QueryStringMachine=e()}(this,(function(){"use strict";const t=t=>0===t.length||0===t.indexOf("?");return function(){const e=(t,e,n,s,r)=>(t||(s.public?(i.addWarning(e,n,r),n=s.defaultValue):l(t,r)),n),i={warnings:[],get:function(t,e){return this.getForString(t,e,window.location.search)},getAll:function(t){return this.getAllForString(t,window.location.search)},getForString:function(i,r,l){if(!t(l))throw new Error('Query strings should be either the empty string or start with a "?": '+l);const u=r.private&&!(()=>{try{return"true"===localStorage.getItem("phetTeamMember")}catch(t){return!1}})()?[]:n(i,l);s(i,r);let c=o(i,r,u);return r.hasOwnProperty("validValues")?c=e(a(c,r.validValues),i,c,r,`Invalid value supplied for key "${i}": ${c} is not a member of valid values: ${r.validValues.join(", ")}`):r.hasOwnProperty("isValidValue")&&(c=e(r.isValidValue(c),i,c,r,`Invalid value supplied for key "${i}": ${c}`)),c=e(h[r.type].isValidValue(c),i,c,r,"Invalid value for type, key: "+i),c},getAllForString:function(t,e){const i={};for(const n in t)t.hasOwnProperty(n)&&(i[n]=this.getForString(n,t[n],e));return i},containsKey:function(t){return this.containsKeyForString(t,window.location.search)},containsKeyForString:function(e,i){if(!t(i))throw new Error('Query strings should be either the empty string or start with a "?": '+i);return n(e,i).length>0},deepEquals:function(t,e){if(typeof t!=typeof e)return!1;if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return t===e;if(null===t&&null===e)return!0;if(void 0===t&&void 0===e)return!0;if(null===t&&void 0===e)return!1;if(void 0===t&&null===e)return!1;const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;if(0===n.length)return t===e;for(let r=0;r<n.length;r++){if(n[r]!==s[r])return!1;const o=t[n[r]],a=e[n[r]];if(!i.deepEquals(o,a))return!1}return!0},removeKeyValuePair:function(t,e){if(0===t.indexOf("?")){const i=[],n=t.substring(1).split("&");for(let t=0;t<n.length;t++){const s=n[t],r=s.split("=");decodeURIComponent(r[0])!==e&&i.push(s)}return i.length>0?"?"+i.join("&"):""}return t},appendQueryString:function(t,e){if(0!==e.indexOf("?")&&0!==e.indexOf("&")||(e=e.substring(1)),0===e.length)return t;const i=t.indexOf("?")>=0?"&":"?";return t+i+e},appendQueryStringArray:function(t,e){for(let i=0;i<e.length;i++)t=this.appendQueryString(t,e[i]);return t},addWarning:function(t,e,i){console.warn(i),this.warnings.push({key:t,value:e,message:i})},hasWarning:function(t){let e=!1;for(let i=0;i<this.warnings.length&&!e;i++)e=this.warnings[i].key===t;return e}},n=function(t,e){const i=[],n=e.slice(1).split("&");for(let s=0;s<n.length;s++){const e=n[s].split("="),r=e[0],o=e.slice(1).join("=");r===t&&(o?i.push(decodeURIComponent(o)):i.push(null))}return i},s=function(t,e){l(e.hasOwnProperty("type"),"type field is required for key: "+t),l(h.hasOwnProperty(e.type),"invalid type: "+e.type+" for key: "+t),e.hasOwnProperty("parse")&&l("function"==typeof e.parse,"parse must be a function for key: "+t),l(!(e.hasOwnProperty("validValues")&&e.hasOwnProperty("isValidValue")),e,t,"validValues and isValidValue are mutually exclusive for key: "+t),e.hasOwnProperty("validValues")&&l(Array.isArray(e.validValues),"isValidValue must be an array for key: "+t),e.hasOwnProperty("isValidValue")&&l("function"==typeof e.isValidValue,"isValidValue must be a function for key: "+t),e.hasOwnProperty("defaultValue")&&l(h[e.type].isValidValue(e.defaultValue),"defaultValue incorrect type: "+t),e.hasOwnProperty("validValues")&&e.validValues.forEach(i=>l(h[e.type].isValidValue(i),"validValue incorrect type for key: "+t)),e.hasOwnProperty("defaultValue")&&e.hasOwnProperty("validValues")&&l(a(e.defaultValue,e.validValues),e,t,"defaultValue must be a member of validValues, for key: "+t),e.hasOwnProperty("public")&&e.public&&"flag"!==e.type&&l(e.hasOwnProperty("defaultValue"),"defaultValue is required when public: true for key: "+t),r(t,e,h[e.type].required,h[e.type].optional),h[e.type].validateSchema&&h[e.type].validateSchema(t,e)},r=function(t,e,i,n){const s=Object.getOwnPropertyNames(e);i.forEach((function(e){l(-1!==s.indexOf(e),"missing required property: "+e+" for key: "+t)}));const r=i.concat(n);s.forEach((function(e){l("type"===e||-1!==r.indexOf(e),"unsupported property: "+e+" for key: "+t)}))},o=function(t,e,i){let n;return l(i.length<=1,"query parameter cannot occur multiple times"),"flag"===e.type?n=h[e.type].parse(t,e,i[0]):(l(void 0!==i[0]||e.hasOwnProperty("defaultValue"),"missing required query parameter: "+t),n=void 0===i[0]?e.defaultValue:h[e.type].parse(t,e,i[0])),n},a=function(t,e){let n=!1;for(let s=0;s<e.length&&!n;s++)n=i.deepEquals(e[s],t);return n},l=function(t,e){if(!t)throw console&&console.log&&console.log(e),new Error("Query String Machine Assertion failed: "+e)},h={flag:{required:[],optional:["private","public"],validateSchema:null,parse:function(t,e,i){return l(null==i,"flag type does not support a value: "+i),void 0!==i},isValidValue:t=>!0===t||!1===t},boolean:{required:[],optional:["defaultValue","private","public"],validateSchema:null,parse:function(t,i,n){const s="true"===n||"false"===n;return e(s,t,s?"true"===n:n,i,`Value was not true|false for key "${t}"`)},isValidValue:t=>!0===t||!1===t},number:{required:[],optional:["defaultValue","validValues","isValidValue","private","public"],validateSchema:null,parse:function(t,i,n){const s=Number(n),r=!isNaN(s);return e(r,t,r?s:n,i,`value must be a number for key "${t}"`)},isValidValue:t=>"number"==typeof t&&!isNaN(t)},string:{required:[],optional:["defaultValue","validValues","isValidValue","private","public"],validateSchema:null,parse:(t,e,i)=>i,isValidValue:t=>null===t||"string"==typeof t},array:{required:["elementSchema"],optional:["defaultValue","validValues","isValidValue","separator","validValues","private","public"],validateSchema:function(t,e){e.hasOwnProperty("separator")&&l("string"==typeof e.separator&&1===e.separator.length,"invalid separator: "+e.separator+", for key: "+t),s(t+".element",e.elementSchema)},parse:function(t,e,i){let n;return n=null===i?[]:i.split(e.separator||",").map(i=>o(t,e.elementSchema,[i])),n},isValidValue:t=>Array.isArray(t)||null===t},custom:{required:["parse"],optional:["defaultValue","validValues","isValidValue","private","public"],validateSchema:null,parse:function(t,e,i){return e.parse(i)},isValidValue:t=>!0}};return i}()})),function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var i=this||e;if(t=parseFloat(t),i.ctx||h(),void 0!==t&&t>=0&&t<=1){if(i._volume=t,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var s=i._howls[n]._getSoundIds(),r=0;r<s.length;r++){var o=i._howls[n]._soundById(s[r]);o&&o._node&&(o._node.volume=o._volume*t)}return i}return i._volume},mute:function(t){var i=this||e;i.ctx||h(),i._muted=t,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(t?0:i._volume,e.ctx.currentTime);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var s=i._howls[n]._getSoundIds(),r=0;r<s.length;r++){var o=i._howls[n]._soundById(s[r]);o&&o._node&&(o._node.muted=!!t||o._muted)}return i},stop:function(){for(var t=this||e,i=0;i<t._howls.length;i++)t._howls[i].stop();return t},unload:function(){for(var t=this||e,i=t._howls.length-1;i>=0;i--)t._howls[i].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,h()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,i=null;try{i="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!i||"function"!=typeof i.canPlayType)return t;var n=i.canPlayType("audio/mpeg;").replace(/^no$/,""),s=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),r=s&&parseInt(s[0].split("/")[1],10)<33;return t._codecs={mp3:!(r||!n&&!i.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var i=function(e){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,t._releaseHtml5Audio(n)}catch(e){t.noAudio=!0;break}for(var s=0;s<t._howls.length;s++)if(!t._howls[s]._webAudio)for(var r=t._howls[s]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[s]._soundById(r[o]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0);for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var i=(new Audio).play();return i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)&&i.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var i=this||e;return t._unlocked&&i._html5AudioPool.push(t),i},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var i=0;i<t._howls.length;i++)if(t._howls[i]._webAudio)for(var n=0;n<t._howls[i]._sounds.length;n++)if(!t._howls[i]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,i=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(t){var i=this;return e.ctx||h(),i._autoplay=t.autoplay||!1,i._format="string"!=typeof t.format?t.format:[t.format],i._html5=t.html5||!1,i._muted=t.mute||!1,i._loop=t.loop||!1,i._pool=t.pool||5,i._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,i._rate=t.rate||1,i._sprite=t.sprite||{},i._src="string"!=typeof t.src?t.src:[t.src],i._volume=void 0!==t.volume?t.volume:1,i._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=t.onend?[{fn:t.onend}]:[],i._onfade=t.onfade?[{fn:t.onfade}]:[],i._onload=t.onload?[{fn:t.onload}]:[],i._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],i._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],i._onpause=t.onpause?[{fn:t.onpause}]:[],i._onplay=t.onplay?[{fn:t.onplay}]:[],i._onstop=t.onstop?[{fn:t.onstop}]:[],i._onmute=t.onmute?[{fn:t.onmute}]:[],i._onvolume=t.onvolume?[{fn:t.onvolume}]:[],i._onrate=t.onrate?[{fn:t.onrate}]:[],i._onseek=t.onseek?[{fn:t.onseek}]:[],i._onunlock=t.onunlock?[{fn:t.onunlock}]:[],i._onresume=[],i._webAudio=e.usingWebAudio&&!i._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&"none"!==i._preload&&i.load(),i},load:function(){var t=this,i=null;if(!e.noAudio){"string"==typeof t._src&&(t._src=[t._src]);for(var s=0;s<t._src.length;s++){var o,a;if(t._format&&t._format[s])o=t._format[s];else{if("string"!=typeof(a=t._src[s])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(o=/^data:audio\/([^;,]+);/i.exec(a))||(o=/\.([^.]+)$/.exec(a.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&e.codecs(o)){i=t._src[s];break}}return i?(t._src=i,t._state="loading","https:"===window.location.protocol&&"http:"===i.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new n(t),t._webAudio&&r(t),t):void t._emit("loaderror",null,"No codec support for selected audio sources.")}t._emit("loaderror",null,"No audio support.")},play:function(t,i){var n=this,s=null;if("number"==typeof t)s=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if(void 0===t&&(t="__default",!n._playLock)){for(var r=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(r++,s=n._sounds[o]._id);1===r?t=null:s=null}}var a=s?n._soundById(s):n._inactiveSound();if(!a)return null;if(s&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state){a._sprite=t,a._ended=!1;var l=a._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(s&&!a._paused)return i||n._loadQueue("play"),a._id;n._webAudio&&e._autoResume();var h=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),u=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-h),c=1e3*u/Math.abs(a._rate),d=n._sprite[t][0]/1e3,f=(n._sprite[t][0]+n._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var p=function(){a._paused=!1,a._seek=h,a._start=d,a._stop=f,a._loop=!(!a._loop&&!n._sprite[t][2])};if(!(h>=f)){var m=a._node;if(n._webAudio){var g=function(){n._playLock=!1,p(),n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;m.gain.setValueAtTime(t,e.ctx.currentTime),a._playStart=e.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,h,86400):m.bufferSource.noteGrainOn(0,h,u):a._loop?m.bufferSource.start(0,h,86400):m.bufferSource.start(0,h,u),c!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),c)),i||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===e.state&&"interrupted"!==e.ctx.state?g():(n._playLock=!0,n.once("resume",g),n._clearTimer(a._id))}else{var y=function(){m.currentTime=h,m.muted=a._muted||n._muted||e._muted||m.muted,m.volume=a._volume*e.volume(),m.playbackRate=a._rate;try{var s=m.play();if(s&&"undefined"!=typeof Promise&&(s instanceof Promise||"function"==typeof s.then)?(n._playLock=!0,p(),s.then((function(){n._playLock=!1,m._unlocked=!0,i||(n._emit("play",a._id),n._loadQueue())})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):i||(n._playLock=!1,p(),n._emit("play",a._id),n._loadQueue()),m.playbackRate=a._rate,m.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),c):(n._endTimers[a._id]=function(){n._ended(a),m.removeEventListener("ended",n._endTimers[a._id],!1)},m.addEventListener("ended",n._endTimers[a._id],!1))}catch(t){n._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var b=window&&window.ejecta||!m.readyState&&e._navigator.isCocoonJS;if(m.readyState>=3||b)y();else{n._playLock=!0;var v=function(){y(),m.removeEventListener(e._canPlayEvent,v,!1)};m.addEventListener(e._canPlayEvent,v,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),n=0;n<i.length;n++){e._clearTimer(i[n]);var s=e._soundById(i[n]);if(s&&!s._paused&&(s._seek=e.seek(i[n]),s._rateSeek=0,s._paused=!0,e._stopFade(i[n]),s._node))if(e._webAudio){if(!s._node.bufferSource)continue;void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),e._cleanBuffer(s._node)}else isNaN(s._node.duration)&&s._node.duration!==1/0||s._node.pause();arguments[1]||e._emit("pause",s?s._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var n=i._getSoundIds(t),s=0;s<n.length;s++){i._clearTimer(n[s]);var r=i._soundById(n[s]);r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,i._stopFade(n[s]),r._node&&(i._webAudio?r._node.bufferSource&&(void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),i._cleanBuffer(r._node)):isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause(),r._node.duration===1/0&&i._clearSound(r._node))),e||i._emit("stop",r._id))}return i},mute:function(t,i){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,i)}}),n;if(void 0===i){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var s=n._getSoundIds(i),r=0;r<s.length;r++){var o=n._soundById(s[r]);o&&(o._muted=t,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(t?0:o._volume,e.ctx.currentTime):o._node&&(o._node.muted=!!e._muted||t),n._emit("mute",o._id))}return n},volume:function(){var t,i,n,s=this,r=arguments;if(0===r.length)return s._volume;if(1===r.length||2===r.length&&void 0===r[1]?s._getSoundIds().indexOf(r[0])>=0?i=parseInt(r[0],10):t=parseFloat(r[0]):r.length>=2&&(t=parseFloat(r[0]),i=parseInt(r[1],10)),!(void 0!==t&&t>=0&&t<=1))return(n=i?s._soundById(i):s._sounds[0])?n._volume:0;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"volume",action:function(){s.volume.apply(s,r)}}),s;void 0===i&&(s._volume=t),i=s._getSoundIds(i);for(var o=0;o<i.length;o++)(n=s._soundById(i[o]))&&(n._volume=t,r[2]||s._stopFade(i[o]),s._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,e.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*e.volume()),s._emit("volume",n._id));return s},fade:function(t,i,n,s){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(t,i,n,s)}}),r;t=Math.min(Math.max(0,parseFloat(t)),1),i=Math.min(Math.max(0,parseFloat(i)),1),n=parseFloat(n),r.volume(t,s);for(var o=r._getSoundIds(s),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l){if(s||r._stopFade(o[a]),r._webAudio&&!l._muted){var h=e.ctx.currentTime,u=h+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,h),l._node.gain.linearRampToValueAtTime(i,u)}r._startFadeInterval(l,t,i,n,o[a],void 0===s)}}return r},_startFadeInterval:function(t,e,i,n,s,r){var o=this,a=e,l=i-e,h=Math.abs(l/.01),u=Math.max(4,h>0?n/h:n),c=Date.now();t._fadeTo=i,t._interval=setInterval((function(){var s=(Date.now()-c)/n;c=Date.now(),a+=l*s,a=l<0?Math.max(i,a):Math.min(i,a),a=Math.round(100*a)/100,o._webAudio?t._volume=a:o.volume(a,t._id,!0),r&&(o._volume=a),(i<e&&a<=i||i>e&&a>=i)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,o.volume(i,t._id),o._emit("fade",t._id))}),u)},_stopFade:function(t){var i=this,n=i._soundById(t);return n&&n._interval&&(i._webAudio&&n._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(n._interval),n._interval=null,i.volume(n._fadeTo,t),n._fadeTo=null,i._emit("fade",t)),i},loop:function(){var t,e,i,n=this,s=arguments;if(0===s.length)return n._loop;if(1===s.length){if("boolean"!=typeof s[0])return!!(i=n._soundById(parseInt(s[0],10)))&&i._loop;t=s[0],n._loop=t}else 2===s.length&&(t=s[0],e=parseInt(s[1],10));for(var r=n._getSoundIds(e),o=0;o<r.length;o++)(i=n._soundById(r[o]))&&(i._loop=t,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=t,t&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var t,i,n,s=this,r=arguments;if(0===r.length)i=s._sounds[0]._id;else if(1===r.length){var o=s._getSoundIds(),a=o.indexOf(r[0]);a>=0?i=parseInt(r[0],10):t=parseFloat(r[0])}else 2===r.length&&(t=parseFloat(r[0]),i=parseInt(r[1],10));if("number"!=typeof t)return(n=s._soundById(i))?n._rate:s._rate;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"rate",action:function(){s.rate.apply(s,r)}}),s;void 0===i&&(s._rate=t),i=s._getSoundIds(i);for(var l=0;l<i.length;l++)if(n=s._soundById(i[l])){s.playing(i[l])&&(n._rateSeek=s.seek(i[l]),n._playStart=s._webAudio?e.ctx.currentTime:n._playStart),n._rate=t,s._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):n._node&&(n._node.playbackRate=t);var h=s.seek(i[l]),u=(s._sprite[n._sprite][0]+s._sprite[n._sprite][1])/1e3-h,c=1e3*u/Math.abs(n._rate);!s._endTimers[i[l]]&&n._paused||(s._clearTimer(i[l]),s._endTimers[i[l]]=setTimeout(s._ended.bind(s,n),c)),s._emit("rate",n._id)}return s},seek:function(){var t,i,n=this,s=arguments;if(0===s.length)i=n._sounds[0]._id;else if(1===s.length){var r=n._getSoundIds(),o=r.indexOf(s[0]);o>=0?i=parseInt(s[0],10):n._sounds.length&&(i=n._sounds[0]._id,t=parseFloat(s[0]))}else 2===s.length&&(t=parseFloat(s[0]),i=parseInt(s[1],10));if(void 0===i)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,s)}}),n;var a=n._soundById(i);if(a){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var l=n.playing(i)?e.ctx.currentTime-a._playStart:0,h=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(h+l*Math.abs(a._rate))}return a._node.currentTime}var u=n.playing(i);u&&n.pause(i,!0),a._seek=t,a._ended=!1,n._clearTimer(i),n._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=t);var c=function(){n._emit("seek",i),u&&n.play(i,!0)};if(u&&!n._webAudio){var d=function(){n._playLock?setTimeout(d,0):c()};setTimeout(d,0)}else c()}return n},playing:function(t){var e=this;if("number"==typeof t){var i=e._soundById(t);return!!i&&!i._paused}for(var n=0;n<e._sounds.length;n++)if(!e._sounds[n]._paused)return!0;return!1},duration:function(t){var e=this,i=e._duration,n=e._soundById(t);return n&&(i=e._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var t=this,i=t._sounds,n=0;n<i.length;n++)i[n]._paused||t.stop(i[n]._id),t._webAudio||(t._clearSound(i[n]._node),i[n]._node.removeEventListener("error",i[n]._errorFn,!1),i[n]._node.removeEventListener(e._canPlayEvent,i[n]._loadFn,!1),e._releaseHtml5Audio(i[n]._node)),delete i[n]._node,t._clearTimer(i[n]._id);var r=e._howls.indexOf(t);r>=0&&e._howls.splice(r,1);var o=!0;for(n=0;n<e._howls.length;n++)if(e._howls[n]._src===t._src||t._src.indexOf(e._howls[n]._src)>=0){o=!1;break}return s&&o&&delete s[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,i,n){var s=this["_on"+t];return"function"==typeof e&&s.push(n?{id:i,fn:e,once:n}:{id:i,fn:e}),this},off:function(t,e,i){var n=this,s=n["_on"+t],r=0;if("number"==typeof e&&(i=e,e=null),e||i)for(r=0;r<s.length;r++){var o=i===s[r].id;if(e===s[r].fn&&o||!e&&o){s.splice(r,1);break}}else if(t)n["_on"+t]=[];else{var a=Object.keys(n);for(r=0;r<a.length;r++)0===a[r].indexOf("_on")&&Array.isArray(n[a[r]])&&(n[a[r]]=[])}return n},once:function(t,e,i){return this.on(t,e,i,1),this},_emit:function(t,e,i){for(var n=this,s=n["_on"+t],r=s.length-1;r>=0;r--)s[r].id&&s[r].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(n,s[r].fn),0),s[r].once&&n.off(t,s[r].fn,s[r].id));return n._loadQueue(t),n},_loadQueue:function(t){var e=this;if(e._queue.length>0){var i=e._queue[0];i.event===t&&(e._queue.shift(),e._loadQueue()),t||i.action()}return e},_ended:function(t){var i=this,n=t._sprite;if(!i._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(i._ended.bind(i,t),100),i;var s=!(!t._loop&&!i._sprite[n][2]);if(i._emit("end",t._id),!i._webAudio&&s&&i.stop(t._id,!0).play(t._id),i._webAudio&&s){i._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);i._endTimers[t._id]=setTimeout(i._ended.bind(i,t),r)}return i._webAudio&&!s&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,i._clearTimer(t._id),i._cleanBuffer(t._node),e._autoSuspend()),i._webAudio||s||i.stop(t._id,!0),i},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var i=e._soundById(t);i&&i._node&&i._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,i=0;i<e._sounds.length;i++)if(t===e._sounds[i]._id)return e._sounds[i];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new n(t)},_drain:function(){var t=this,e=t._pool,i=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&i++;for(n=t._sounds.length-1;n>=0;n--){if(i<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),i--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],i=0;i<this._sounds.length;i++)e.push(this._sounds[i]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=s[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var i=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),i))try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(t){this._parent=t,this.init()};n.prototype={init:function(){var t=this,i=t._parent;return t._muted=i._muted,t._loop=i._loop,t._volume=i._volume,t._rate=i._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,i._sounds.push(t),t.create(),t},create:function(){var t=this,i=t._parent,n=e._muted||t._muted||t._parent._muted?0:t._volume;return i._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(n,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._node.src=i._src,t._node.preload=!0===i._preload?"auto":i._preload,t._node.volume=n*e.volume(),t._node.load()),t},reset:function(){var t=this,i=t._parent;return t._muted=i._muted,t._loop=i._loop,t._volume=i._volume,t._rate=i._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,i=t._parent;i._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)}};var s={},r=function(t){var e=t._src;if(s[e])return t._duration=s[e].duration,void l(t);if(/^data:[^;]+;base64,/.test(e)){for(var i=atob(e.split(",")[1]),n=new Uint8Array(i.length),r=0;r<i.length;++r)n[r]=i.charCodeAt(r);a(n.buffer,t)}else{var h=new XMLHttpRequest;h.open(t._xhr.method,e,!0),h.withCredentials=t._xhr.withCredentials,h.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){h.setRequestHeader(e,t._xhr.headers[e])})),h.onload=function(){var e=(h.status+"")[0];"0"===e||"2"===e||"3"===e?a(h.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+h.status+".")},h.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete s[e],t.load())},o(h)}},o=function(t){try{t.send()}catch(e){t.onerror()}},a=function(t,i){var n=function(){i._emit("loaderror",null,"Decoding audio data failed.")},r=function(t){t&&i._sounds.length>0?(s[i._src]=t,l(i,t)):n()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(r).catch(n):e.ctx.decodeAudioData(t,r,n)},l=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},h=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),i=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=i?parseInt(i[1],10):null;if(t&&n&&n<9){var s=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!s&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:e,Howl:i}})),"undefined"!=typeof exports&&(exports.Howler=e,exports.Howl=i),"undefined"!=typeof global?(global.HowlerGlobal=t,global.Howler=e,global.Howl=i,global.Sound=n):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=i,window.Sound=n)}(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var i=e._howls.length-1;i>=0;i--)e._howls[i].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,i){var n=this;return n.ctx&&n.ctx.listener?(e="number"!=typeof e?n._pos[1]:e,i="number"!=typeof i?n._pos[2]:i,"number"!=typeof t?n._pos:(n._pos=[t,e,i],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(t,e,i,n,s,r){var o=this;if(!o.ctx||!o.ctx.listener)return o;var a=o._orientation;return e="number"!=typeof e?a[1]:e,i="number"!=typeof i?a[2]:i,n="number"!=typeof n?a[3]:n,s="number"!=typeof s?a[4]:s,r="number"!=typeof r?a[5]:r,"number"!=typeof t?a:(o._orientation=[t,e,i,n,s,r],void 0!==o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(r,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(t,e,i,n,s,r),o)},Howl.prototype.init=function(t){return function(e){var i=this;return i._orientation=e.orientation||[1,0,0],i._stereo=e.stereo||null,i._pos=e.pos||null,i._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},i._onstereo=e.onstereo?[{fn:e.onstereo}]:[],i._onpos=e.onpos?[{fn:e.onpos}]:[],i._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var s=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var r=n._getSoundIds(i),o=0;o<r.length;o++){var a=n._soundById(r[o]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,s),"spatial"===s?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",a._id)}}return n},Howl.prototype.pos=function(e,i,n,s){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(e,i,n,s)}}),r;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,void 0===s){if("number"!=typeof e)return r._pos;r._pos=[e,i,n]}for(var o=r._getSoundIds(s),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,i,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,i,n)),r._emit("pos",l._id)}}return r},Howl.prototype.orientation=function(e,i,n,s){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(e,i,n,s)}}),r;if(i="number"!=typeof i?r._orientation[1]:i,n="number"!=typeof n?r._orientation[2]:n,void 0===s){if("number"!=typeof e)return r._orientation;r._orientation=[e,i,n]}for(var o=r._getSoundIds(s),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,i,n],l._node&&(l._panner||(l._pos||(l._pos=r._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,i,n)),r._emit("orientation",l._id)}}return r},Howl.prototype.pannerAttr=function(){var e,i,n,s=this,r=arguments;if(!s._webAudio)return s;if(0===r.length)return s._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return(n=s._soundById(parseInt(r[0],10)))?n._pannerAttr:s._pannerAttr;e=r[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),s._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:s._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:s._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:s._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:s._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:s._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:s._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:s._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:s._panningModel})}else 2===r.length&&(e=r[0],i=parseInt(r[1],10));for(var o=s._getSoundIds(i),a=0;a<o.length;a++)if(n=s._soundById(o[a])){var l=n._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var h=n._panner;h?(h.coneInnerAngle=l.coneInnerAngle,h.coneOuterAngle=l.coneOuterAngle,h.coneOuterGain=l.coneOuterGain,h.distanceModel=l.distanceModel,h.maxDistance=l.maxDistance,h.refDistance=l.refDistance,h.rolloffFactor=l.rolloffFactor,h.panningModel=l.panningModel):(n._pos||(n._pos=s._pos||[0,0,-.5]),t(n,"spatial"))}return s},Sound.prototype.init=function(t){return function(){var e=this,i=e._parent;e._orientation=i._orientation,e._stereo=i._stereo,e._pos=i._pos,e._pannerAttr=i._pannerAttr,t.call(this),e._stereo?i.stereo(e._stereo):e._pos&&i.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,i=e._parent;return e._orientation=i._orientation,e._stereo=i._stereo,e._pos=i._pos,e._pannerAttr=i._pannerAttr,e._stereo?i.stereo(e._stereo):e._pos?i.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,i._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var t=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}(),window.phet=window.phet||{},window.phet.chipper=window.phet.chipper||{},window.phet.chipper.shas={axon:"9a02dec232e5344824337be385c15a042e1b5022",dot:"ecaa90f14199cffc426cc9098fcfeb69a086b982",kite:"ed0c49f276c62558ca1d695362807ee4dcaed80c",miscworks:"cc999774efd26dc9fe9379575b50798e98ca6b46","phet-core":"5f73ea3056fbe8d852f9aca0328e26c75d458467","scenery-phet":"585f2761800e47c05be03fa547d9c0371cc6dbf6",scenery:"372ff80d9f33eb44af2edce380e6cc2767a3de50",tandem:"6fddb61195a44ba31c825191f0fb2addd768d6df",twixt:"1cb642f8035d28a723a961510a13b3c32f871e20","utterance-queue":"c2b44d1ca355707b2c2bae2a173c6ad26b5e6613"},window.phet.chipper.packageObject={name:"miscworks",version:"1.0.0-dev.0"},window.phet.chipper.stringRepos=[{repo:"joist",requirejsNamespace:"JOIST"},{repo:"scenery-phet",requirejsNamespace:"SCENERY_PHET"},{repo:"sun",requirejsNamespace:"SUN"},{repo:"tambo",requirejsNamespace:"TAMBO"}],phet.chipper.locale="en",phet.chipper.strings={en:{"SCENERY_PHET/symbol.ohms":"HI","SCENERY_PHET/symbol.resistivity":"HI"}},function(){"use strict";const t={allowLinks:{type:"boolean",defaultValue:!0,public:!0},audioVolume:{type:"number",defaultValue:1,isValidValue:function(t){return t>=0&&t<=1}},binder:{type:"flag"},brand:{type:"string",defaultValue:"adapted-from-phet",validValues:["phet","phet-io","adapted-from-phet"]},buildCompatible:{type:"flag"},continuousTest:{type:"string",defaultValue:""},colorProfile:{type:"string",defaultValue:"default"},deprecationWarnings:{type:"flag"},dev:{type:"flag"},ea:{type:"flag"},eall:{type:"flag"},enhancedSoundInitiallyEnabled:{type:"boolean",defaultValue:!1},fuzz:{type:"flag"},fuzzBoard:{type:"flag"},fuzzMouse:{type:"flag"},fuzzPointers:{type:"number",defaultValue:1},fuzzTouch:{type:"flag"},fuzzRate:{type:"number",defaultValue:100,isValidValue:function(t){return t>0}},ga:{type:"string",defaultValue:null},gameUp:{type:"flag"},gameUpLogging:{type:"flag"},gaPage:{type:"string",defaultValue:null},homeScreen:{type:"boolean",defaultValue:!0,public:!0},initialScreen:{type:"number",defaultValue:0,public:!0},legendsOfLearning:{type:"flag"},locale:{type:"string",defaultValue:"en"},log:{type:"flag"},memoryLimit:{type:"number",defaultValue:0},mobileA11yTest:{type:"flag"},"phet-android-app":{type:"flag"},"phet-app":{type:"flag"},playbackInputEventLog:{type:"flag"},playbackMode:{type:"boolean",defaultValue:!1},postMessageOnBeforeUnload:{type:"flag"},postMessageOnError:{type:"flag"},postMessageOnLoad:{type:"flag"},postMessageOnReady:{type:"flag"},preserveDrawingBuffer:{type:"flag"},profiler:{type:"flag"},qrCode:{type:"flag"},randomSeed:{type:"number",defaultValue:Math.random()},recordInputEventLog:{type:"flag"},rootRenderer:{type:"string",defaultValue:null,validValues:[null,"canvas","svg","dom","webgl"]},sceneryLog:{type:"array",elementSchema:{type:"string"},defaultValue:null},sceneryStringLog:{type:"flag"},screens:{type:"array",elementSchema:{type:"number"},defaultValue:null,isValidValue:function(t){return null===t||t.length===_.uniq(t).length},public:!0},showAnswers:{type:"flag",private:!0},showCanvasNodeBounds:{type:"flag"},showFittedBlockBounds:{type:"flag"},showHitAreas:{type:"flag"},showPointerAreas:{type:"flag"},showPointers:{type:"flag"},showVisibleBounds:{type:"flag"},shuffleListeners:{type:"flag"},sound:{type:"string",defaultValue:"enabled",validValues:["enabled","disabled","muted"]},speed:{type:"number",defaultValue:1,isValidValue:function(t){return t>0}},strings:{type:"string",defaultValue:null},stringTest:{type:"string",defaultValue:null},supportsDescriptions:{type:"flag"},supportsEnhancedSound:{type:"flag"},supportsSound:{type:"flag"},vibration:{type:"string",defaultValue:null,validValues:[null,"objects","manipulation","interaction-changes","result"]},webgl:{type:"boolean",defaultValue:!0},supportsZoom:{type:"string",validValues:[null,"true","false"],defaultValue:null}};function e(t){const e=new Date;let i;do{i=new Date}while(i-e<t)}!function(){window.phet=window.phet||{},window.phet.chipper=window.phet.chipper||{},window.phet.chipper.queryParameters=QueryStringMachine.getAll(t),window.phet.chipper.queryParameters.log&&(window.phet.log=function(t,e){e=_.assignIn({color:"#009900"},e),console.log("%c"+t,"color: "+e.color)}),window.phet.chipper.brand=window.phet.chipper.brand||phet.chipper.queryParameters.brand||"adapted-from-phet";const e="undefined"!=typeof window&&phet.chipper.queryParameters.stringTest?phet.chipper.queryParameters.stringTest:null;window.phet.chipper.mapString=function(t){return null===e?t:"double"===e?t+":"+t:"long"===e?"12345678901234567890123456789012345678901234567890":"rtl"===e?"‫تست (زبان)‬":"xss"===e?t+'<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2NkYGD4DwABCQEBtxmN7wAAAABJRU5ErkJggg==" onload="window.location.href=atob(\'aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1kUXc0dzlXZ1hjUQ==\')" />':"none"===e?t:e},QueryStringMachine.containsKey("locale")?window.phet.chipper.locale=phet.chipper.queryParameters.locale:window.phet.chipper.locale||(window.phet.chipper.locale="en");const i=JSON.parse(phet.chipper.queryParameters.strings||"{}");phet.chipper.getStringForBuiltSim=t=>{if(i[t])return i[t];let e=phet.chipper.strings[phet.chipper.locale];return e||(e=phet.chipper.strings[phet.chipper.locale.slice(0,2)],e||(e=phet.chipper.strings.en)),phet.chipper.mapString(e[t])}}(),window.phet.chipper.randomSeed=phet.chipper.queryParameters.randomSeed,window.phet.chipper.makeEverythingSlow=function(){window.setInterval((function(){e(64)}),16)},window.phet.chipper.makeRandomSlowness=function(){window.setInterval((function(){e(Math.ceil(100+200*Math.random()))}),Math.ceil(100+200*Math.random()))},window.phet.chipper.isProduction="production"===$("meta[name=phet-sim-level]").attr("content"),window.phet.chipper.isApp=phet.chipper.queryParameters["phet-app"]||phet.chipper.queryParameters["phet-android-app"],function(){const t=!phet.chipper.isProduction&&phet.chipper.queryParameters.eall;(t||!phet.chipper.isProduction&&phet.chipper.queryParameters.ea||phet.chipper.isDebugBuild)&&window.assertions.enableAssert(),t&&window.assertions.enableAssertSlow(),window.phet.chipper.reportContinuousTestResult=t=>{window.parent&&window.parent.postMessage(JSON.stringify(_.assignIn({continuousTest:JSON.parse(phet.chipper.queryParameters.continuousTest),url:window.location.href},t)),"*")},phet.chipper.queryParameters.continuousTest&&(window.addEventListener("error",(function(t){let e="",i="";t&&t.message&&(e=t.message),t&&t.error&&t.error.stack&&(i=t.error.stack),phet.chipper.reportContinuousTestResult({type:"continuous-test-error",message:e,stack:i})})),window.addEventListener("beforeunload",(function(t){phet.chipper.reportContinuousTestResult({type:"continuous-test-unload"})})),window.open=()=>({focus:()=>{},blur:()=>{}})),phet.chipper.queryParameters.postMessageOnError&&window.addEventListener("error",(function(t){let e="",i="";t&&t.message&&(e=t.message),t&&t.error&&t.error.stack&&(i=t.error.stack),window.parent&&window.parent.postMessage(JSON.stringify({type:"error",url:window.location.href,message:e,stack:i}),"*")})),phet.chipper.queryParameters.postMessageOnBeforeUnload&&window.addEventListener("beforeunload",(function(t){window.parent&&window.parent.postMessage(JSON.stringify({type:"beforeUnload"}),"*")}))}()}(),function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";(function(t){let i;try{i=t&&t.hot}catch(n){i=!1}e.a=i}).call(this,i(1)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,i){"use strict";i.r(e);var n=i(0);function s(t){this.name=t,window.phet&&(window.phet[t]=this)}s.prototype={constructor:s,register:function(t,e){if(t.indexOf(".")<0)n.a,this[t]=e;else{const i=t.split(".");let s=this;for(let t=0;t<i.length-1;t++)n.a,s=s[i[t]];const r=i[i.length-1];n.a,s[r]=e}return e}};var r=s;const o=new r("phetCore");o.register("Namespace",r);var a=o;function l(t,...e){return _.each(e,e=>{if(e)for(const i in e)if(e.hasOwnProperty(i)){const n=e[i];_.endsWith(i,"Options")&&"Options"!==i?t[i]=l(t[i]||{},n):t[i]=n}}),t}a.register("merge",l);var h=l,u=new r("tandem"),c=new r("axon");class d{constructor(t){t.keys,t.map;const e=t.keys||Object.keys(t.map),i=t.map||{};t=h({phetioDocumentation:null,beforeFreeze:null},t),this.phetioDocumentation=t.phetioDocumentation,this.KEYS=e,this.VALUES=[],e.forEach(t=>{const e=i[t]||{};e.name=t,e.toString=()=>t,this[t]=e,this.VALUES.push(e)}),t.beforeFreeze&&t.beforeFreeze(this)}includes(t){return _.includes(this.VALUES,t)}static byKeys(t,e){return new d(h({keys:t},e))}static byMap(t,e){return new d(h({map:t},e))}}a.register("Enumeration",d);var f=d;const p=["string","number","boolean","function"],m={assertions:!1},g=["valueType","validValues","isValidValue","arrayElementType","phetioType"],y={isValidValidator(t,e){if(e=e||m,!(t instanceof Object))return!1;if(!(t.hasOwnProperty("isValidValue")||t.hasOwnProperty("valueType")||t.hasOwnProperty("arrayElementType")||t.hasOwnProperty("validValues")||t.hasOwnProperty("phetioType")))return!1;if(t.hasOwnProperty("valueType")&&!b(t.valueType,e))return!1;if(t.hasOwnProperty("arrayElementType")){if(t.hasOwnProperty("valueType"))return!1;if(!b(t.arrayElementType,e))return!1}if(t.hasOwnProperty("isValidValue")&&"function"!=typeof t.isValidValue&&null!==t.isValidValue&&void 0!==t.isValidValue)return!1;if(void 0!==t.validValues&&null!==t.validValues){if(!Array.isArray(t.validValues))return!1;const e=_.omit(t,"validValues");if(y.containsValidatorKey(e))for(let i=0;i<t.validValues.length;i++)if(!y.isValueValid(t.validValues[i],e))return!1}return!t.hasOwnProperty("phetioType")||!(!t.phetioType||!t.phetioType.validator)&&y.isValidValidator(t.phetioType.validator,e)},validateValueType:(t,e)=>("function"==typeof t||"string"==typeof t||t instanceof f||null==t)&&!("string"==typeof t&&!_.includes(p,t)),validateValidator(t){0},containsValidatorKey(t){for(let e=0;e<g.length;e++)if(t.hasOwnProperty(g[e]))return!0;return!1},isValueValid(t,e,i){if((i=h({validateValidator:!0,assertions:!1},i)).validateValidator&&!c.ValidatorDef.isValidValidator(e,i))return!1;if(e.hasOwnProperty("valueType")){const n=e.valueType;if(Array.isArray(n)){if(!_.some(n.map(e=>y.isValueValidValueType(t,e,m))))return!1}else if(n&&!y.isValueValidValueType(t,n,i))return!1}if(e.hasOwnProperty("arrayElementType")){const n=e.arrayElementType;if(!y.isValueValid(t,{valueType:Array},i))return!1;if(!_.every(t.map(t=>Array.isArray(n)?!!_.some(n.map(e=>y.isValueValidValueType(t,e,m))):y.isValueValidValueType(t,e.arrayElementType,i))))return!1}return(!e.hasOwnProperty("validValues")||-1!==e.validValues.indexOf(t))&&(!(e.hasOwnProperty("isValidValue")&&!e.isValidValue(t))&&!(e.hasOwnProperty("phetioType")&&!y.isValueValid(t,e.phetioType.validator,m)))},isValueValidValueType:(t,e,i)=>("string"!=typeof e||typeof t===e)&&(!(e===Array&&!Array.isArray(t))&&(!(e instanceof f&&!e.includes(t))&&(("function"!=typeof e||t instanceof e)&&(null!==e||null===t))))},b=(t,e)=>{if(Array.isArray(t)){if(!_.every(t.map(t=>y.validateValueType(t,e))))return!1}else if(t&&!y.validateValueType(t,e))return!1;return!0};y.VALIDATOR_KEYS=g,y.STRING_WITHOUT_TEMPLATE_VARS_VALIDATOR={valueType:"string",isValidValue:t=>!/\{\{\w*\}\}/.test(t)},c.register("ValidatorDef",y);var v=y;const w=(t,e,i)=>t;c.register("validate",w);var A=w;class x{constructor(t,e){this.phetioObject=t,this.phetioID=e,A(t,this.constructor.validator)}static toStateObject(t){return t}static fromStateObject(t){return t}static stateToArgsForConstructor(t){return[]}static applyState(t,e){}static getSupertype(t){const e=Object.getPrototypeOf(t);return e===Object.getPrototypeOf(window.Object)?null:e}static validateSubtype(t){const e=t.typeName;e.indexOf("<")>=0&&t.parameterTypes.forEach(t=>!1);e.split(/[<(]/)[0];t.hasOwnProperty("methods")||(t.methods={});for(const i in t.methods){const e=t.methods[i];"object"==typeof e&&e.parameterTypes.forEach(t=>{})}t.hasOwnProperty("methodOrder")&&t.methodOrder.forEach((function(t){})),t.hasOwnProperty("api")}}x.isIOType=t=>t===x||t.prototype instanceof x,x.methods={},x.documentation="The root of the wrapper object hierarchy.",x.typeName="ObjectIO",x.validator={valueType:Object},x.validateSubtype(x),u.register("ObjectIO",x);var T=x;class S extends T{constructor(){super()}static toStateObject(t){return t}static fromStateObject(t){return t}}S.documentation="IO Type for Javascript's boolean primitive type",S.validator={valueType:"boolean"},S.typeName="BooleanIO",T.validateSubtype(S),u.register("BooleanIO",S);var D=S;_.hasIn(window,"phet.chipper.queryParameters")&&phet.chipper.queryParameters.shuffleListeners;class E{constructor(){this.listeners=[],this.activeListenersStack=[]}dispose(){this.listeners.length=0}emit(){if(this.listeners.length>0){this.activeListenersStack.push(this.listeners);const t=this.activeListenersStack.length-1;for(let e=0;e<this.activeListenersStack[t].length;e++)this.activeListenersStack[t][e].apply(null,arguments);this.activeListenersStack.pop()}}addListener(t){this.defendListeners(),this.listeners.push(t),this.changeCount&&this.changeCount(1)}removeListener(t){const e=this.listeners.indexOf(t);this.defendListeners(),this.listeners.splice(e,1),this.changeCount&&this.changeCount(-1)}removeAllListeners(){const t=this.listeners.length;for(;this.listeners.length>0;)this.removeListener(this.listeners[0]);this.changeCount&&this.changeCount(-t)}defendListeners(){for(let t=this.activeListenersStack.length-1;t>=0&&!this.activeListenersStack[t].defended;t--){const e=this.listeners.slice();e.defended=!0,this.activeListenersStack[t]=e}}hasListener(t){return this.listeners.indexOf(t)>=0}hasListeners(){return this.listeners.length>0}getListenerCount(){return this.listeners.length}}c.register("TinyEmitter",E);var C=E;const I=new class extends C{setTimeout(t,e){let i=0;const n=s=>{i+=s,1e3*i>=e&&this.hasListener(n)&&(t(),this.removeListener(n))};return this.addListener(n),n}clearTimeout(t){this.hasListener(t)&&this.removeListener(t)}setInterval(t,e){let i=0;const n=s=>{for(i+=s;1e3*i>=e&&-1!==this.hasListener(n);)t(),i-=e/1e3};return this.addListener(n),n}clearInterval(t){this.hasListener(t)&&this.removeListener(t)}runOnNextFrame(t){this.setTimeout(t,0)}}({parameters:[{valueType:"number"}]});c.register("timer",I);var P=I;const k=function(t,...e){0};a.register("assertMutuallyExclusiveOptions",k);function L(t){return _.each(Array.prototype.slice.call(arguments,1),(function(e){if(e)for(const i in e)Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})),t}a.register("extend",L);var O=L;function N(t,e,i,n){function s(){}return s.prototype=t.prototype,e.prototype=O(new s,{constructor:e},i),O(e,n),e}a.register("inherit",N);var R=N;const M=new Map;function B(t){return M.has(t)||M.set(t,F(t)),M.get(t)}const F=t=>{class e extends T{constructor(t,e){super(t,e)}static toStateObject(t){return i(t)}static fromStateObject(e){return t[e]}}const i=t=>t.name,n=t.VALUES.map(i),s=t.phetioDocumentation?" "+t.phetioDocumentation:"";return e.validator={valueType:t},e.documentation=`Possible values: ${n}.${s}`,e.typeName=`EnumerationIO(${n.join("|")})`,T.validateSubtype(e),e};a.register("EnumerationIO",B);var V=B;const H=f.byKeys(["USER","MODEL","WRAPPER"],{beforeFreeze:t=>{t.phetioType=V(t)}});u.register("EventType",H);var z=H;function G(t,e){const i=_.indexOf(t,e);t.splice(i,1)}a.register("arrayRemove",G);var q=G;const Y={},U=t=>{window.phet&&window.phet.chipper&&window.phet.chipper.queryParameters&&phet.chipper.queryParameters.deprecationWarnings&&(Y.hasOwnProperty(t)||(Y[t]=!0,console.warn("Deprecation warning: "+t)))};a.register("deprecationWarning",U);const j=JSON.stringify(window.phet&&phet.chipper&&phet.chipper.packageObject?phet.chipper.packageObject:{name:"placeholder"}),W=JSON.parse(j),X=_.hasIn(window,"phet.preloads.phetio"),K=X&&phet.preloads.phetio.queryParameters.phetioPrintMissingTandems,Q=QueryStringMachine.containsKey("phetioValidation"),Z=X&&Q?phet.preloads.phetio.queryParameters.phetioValidation:X&&W.phet["phet-io"].validation,J=X&&Z&&!K,tt={required:[],optional:[]},et=[];let it=!1;const nt=[];class st{constructor(t,e,i){this.parentTandem=t,this.name=e,this.phetioID=this.parentTandem?window.phetio.PhetioIDUtils.append(this.parentTandem.phetioID,this.name):this.name,i=h({required:!0,supplied:!0},i),this.children={},this.parentTandem&&this.parentTandem.addChild(e,this),this.required=i.required,this.supplied=i.supplied}getTermRegex(){return/^[a-zA-Z0-9~[\],]+$/}addPhetioObject(t){if(X){if(K&&this.required&&!this.supplied)return void tt.required.push({phetioID:this.phetioID,stack:(new Error).stack});if(!this.required&&!this.supplied){if(K){const t=(new Error).stack;if(-1===t.indexOf("Font"))return void tt.optional.push({phetioID:this.phetioID,stack:t})}return}if(it)for(let e=0;e<et.length;e++)et[e].addPhetioObject(t);else nt.push(t)}}removePhetioObject(t){if((this.required||this.supplied)&&X)if(it){t.tandem.dispose();for(let e=0;e<et.length;e++)et[e].removePhetioObject(t)}else q(nt,t)}getExtendedOptions(t){return h({supplied:this.supplied,required:this.required},t)}createTandem(t,e){if(e=this.getExtendedOptions(e),this.hasChild(t)){const e=this.children[t];return e}return new st(this,t,e)}hasChild(t){return this.children.hasOwnProperty(t)}addChild(t,e){this.children[t]=e}iterateDescendants(t){for(const e in this.children)this.children.hasOwnProperty(e)&&(t(this.children[e]),this.children[e].iterateDescendants(t))}removeChild(t){delete this.children[t]}dispose(){this.parentTandem.removeChild(this.name)}getConcretePhetioID(){return this.parentTandem?window.phetio.PhetioIDUtils.append(this.parentTandem.getConcretePhetioID(),this.name):this.phetioID}createGroupTandem(t){return this.children[t]?this.children[t]:new rt(this,t)}static addPhetioObjectListener(t){et.push(t)}static launch(){for(it=!0;nt.length>0;){const t=nt.shift();t.tandem.addPhetioObject(t)}}static unlaunch(){it=!1,nt.length=0}static createFromPhetioID(t){return t.split(".").reduce((t,e)=>("string"==typeof t&&(t=st.ROOT),t.createTandem(e)))}}st.ROOT=new class extends st{createTandem(t,e){if(st.VALIDATION){t===window.phetio.PhetioIDUtils.GLOBAL_COMPONENT_NAME||"requiredTandem"===t||"optionalTandem"===t||t===window.phetio.PhetioIDUtils.GENERAL_COMPONENT_NAME||_.endsWith(t,"Screen")}return super.createTandem(t,e)}}(null,_.camelCase(W.name)),st.GENERAL=st.ROOT.createTandem(window.phetio.PhetioIDUtils.GENERAL_COMPONENT_NAME),st.GENERAL_MODEL=st.GENERAL.createTandem(window.phetio.PhetioIDUtils.MODEL_COMPONENT_NAME),st.GENERAL_VIEW=st.GENERAL.createTandem(window.phetio.PhetioIDUtils.VIEW_COMPONENT_NAME),st.GLOBAL=st.ROOT.createTandem(window.phetio.PhetioIDUtils.GLOBAL_COMPONENT_NAME),st.GLOBAL_MODEL=st.GLOBAL.createTandem(window.phetio.PhetioIDUtils.MODEL_COMPONENT_NAME),st.GLOBAL_VIEW=st.GLOBAL.createTandem(window.phetio.PhetioIDUtils.VIEW_COMPONENT_NAME),st.OPTIONAL=st.ROOT.createTandem("optionalTandem",{required:!1,supplied:!1}),st.OPT_OUT=st.OPTIONAL,st.REQUIRED=st.ROOT.createTandem("requiredTandem",{required:J||K,supplied:!1}),st.missingTandems=tt,st.PHET_IO_ENABLED=X,st.VALIDATION=J;class rt extends st{constructor(t,e){super(t,e),this.groupName=e,this.groupMemberIndex=0}createNextTandem(){return this.parentTandem.createTandem(this.groupName+"~"+this.groupMemberIndex++)}}u.register("Tandem",st);var ot=st;class at extends T{static toStateObject(t){return{elementID:t.element.tandem.phetioID}}static fromStateObject(t){return{}}}at.documentation="A LinkedElement",at.validator={isValidValue:()=>!0},at.typeName="LinkedElementIO",T.validateSubtype(at),u.register("LinkedElementIO",at);var lt=at;const ht=t=>{if(Array.isArray(t))return t.map(ht);if("object"!=typeof t||null===t)return t;const e={};return Object.keys(t).sort().forEach((function(i){const n=t[i];e[i]=ht(n)})),e};a.register("copyWithSortedKeys",ht);var ut=ht;class ct extends ot{constructor(t,e,i){super(t,e,i)}getTermRegex(){return/^[a-zA-Z0-9_]+$/}getConcretePhetioID(){return window.phetio.PhetioIDUtils.append(this.parentTandem.getConcretePhetioID(),"archetype")}}ct.DYNAMIC_ARCHETYPE_NAME="archetype",u.register("DynamicTandem",ct);var dt=ct;const ft=["phetioDynamicElement","phetioEventType","phetioIsArchetype","phetioPlayback","phetioReadOnly","phetioState","phetioTypeName"];const pt=new class{constructor(){if(this.apiMismatches=[],this.simHasStarted=!1,this.enabled=!1,this.referenceAPI=this.enabled&&window.phet.preloads.phetio.queryParameters.phetioReferenceAPI,this.everyPhetioType={},this.loadedReferenceAPI=null,this.enabled&&this.referenceAPI){const t=new XMLHttpRequest;t.open("GET",window.phet.preloads.phetio.queryParameters.phetioReferenceAPI),t.send(null),t.onreadystatechange=()=>{4===t.readyState&&200===t.status&&(this.loadedReferenceAPI=JSON.parse(t.responseText))}}}onSimStarted(t){if(!this.enabled)return;if(this.validateOverridesFile(),!this.referenceAPI)return;const e=this.loadedReferenceAPI.phetioElements,i=this.loadedReferenceAPI.phetioTypes,n=t.getPhetioElementsMetadata(),s=t.getPhetioTypes();if(null===phet.chipper.queryParameters.screens&&phet.chipper.queryParameters.homeScreen){for(const t in e)if(e.hasOwnProperty(t)){e[t].phetioDynamicElement&&this.assertAPIError({phetioID:t,ruleInViolation:"10. Dynamic elements should not appear in the API.",message:"dynamic phetioID not expected but found"}),n.hasOwnProperty(t)||this.assertAPIError({phetioID:t,ruleInViolation:"5. When the sim is finished starting up, all non-dynamic schema entries must be registered.",message:"phetioID expected but does not exist"});for(let i=0;i<ft.length;i++){const s=ft[i];e[t][s]!==n[t][s]&&this.assertAPIError({ruleInViolation:"2. Registered PhetioObject baseline must equal baseline schema to ensure that baseline changes are intentional.",phetioID:t,message:`Incompatible value for ${s}, desired=${e[t][s]}, actual=${n[t][s]}`})}}for(const t in i)if(i.hasOwnProperty(t))if(s.hasOwnProperty(t)){const e=i[t].methods,n=s[t].methods;for(const i in e)n.hasOwnProperty(i)||this.assertAPIError({ruleInViolation:`Missing method, type=${t}, method=${i}`})}else this.assertAPIError({ruleInViolation:"Desired type missing: "+t.typeName});if("exact"===window.phet.preloads.phetio.queryParameters.phetioReferenceAPIValidationLevel&&(_.isEqual(e,n)||this.assertAPIError({ruleInViolation:"2. Registered PhetioObject baseline must equal baseline schema to ensure that baseline changes are intentional.",message:"baseline schema does not match PhetioObject computed baseline metadata",phetioElementsBaseline:e,stringifiedBaseline:JSON.stringify(ut(e),null,2),phetioElementsBaselineFromFile:e}),!_.isEqual(i,s))){const t=Object.keys(i),e=Object.keys(window.phet.preloads.phetio.phetioTypes);this.assertAPIError({ruleInViolation:"9. Types in the sim must exactly match types in the types file to ensure that type changes are intentional.",message:"phetioTypes are not equivalent",areKeysEquivalent:_.isEqual(t.sort(),e.sort()),typesNotInSim:e.filter(e=>!t.includes(e)),typesNotInFile:t.filter(t=>!e.includes(t))})}}this.simHasStarted=!0}onPhetioObjectRemoved(t){if(!this.enabled)return;const e=t.tandem.phetioID;t.phetioDynamicElement||-1!==e.indexOf("~")||this.assertAPIError({phetioID:e,ruleInViolation:"6. Any static, registered PhetioObject can never be deregistered."})}onPhetioObjectAdded(t){if(!this.enabled)return;const e=t.phetioType;if(this.everyPhetioType[e.typeName]||(this.everyPhetioType[e.typeName]=e),this.simHasStarted&&-1===t.tandem.phetioID.indexOf("~")){const e=t.tandem.getConcretePhetioID(),i=window.phet.preloads.phetio.phetioElementsBaseline[e];i||this.assertAPIError({phetioID:t.tandem.phetioID,ruleInViolation:"4. After startup, only dynamic instances prescribed by the baseline file can be registered.",message:"element's concrete phetioID was not in the baseline file after being created after startup."}),phet.axon.timer.runOnNextFrame(()=>{i.phetioIsArchetype&&t.phetioDynamicElement||this.assertAPIError({phetioID:t.tandem.phetioID,ruleInViolation:"4. After startup, only dynamic instances prescribed by the baseline file can be registered."})})}}validateOverridesFile(){const t=phet.phetio.phetioEngine.getPhetioElementsBaseline();for(const e in window.phet.preloads.phetio.phetioElementsOverrides){e.indexOf(dt.DYNAMIC_ARCHETYPE_NAME);if(phet.preloads.phetio.createArchetypes||t.hasOwnProperty(e))if(t.hasOwnProperty(e)){const i=window.phet.preloads.phetio.phetioElementsOverrides[e],n=t[e];0===Object.keys(i).length&&this.assertAPIError({phetioID:e,ruleInViolation:"8. Any schema entries in the overrides file must be different from its baseline counterpart.",message:"no metadata keys found for this override."});for(const t in i)n.hasOwnProperty(t)||this.assertAPIError({phetioID:e,ruleInViolation:"8. Any schema entries in the overrides file must be different from its baseline counterpart.",message:"phetioID metadata key not found in the baseline: "+t}),i[t]===n[t]&&this.assertAPIError({phetioID:e,ruleInViolation:"8. Any schema entries in the overrides file must be different from its baseline counterpart.",message:"phetioID metadata override value is the same as the corresponding metadata value in the baseline."})}else this.assertAPIError({phetioID:e,ruleInViolation:"7. Any schema entries in the overrides file must exist in the baseline file.",message:"phetioID expected in the baseline file but does not exist"});else;}}assertAPIError(t){t.phetioID?(t.phetioID,t.ruleInViolation):t.ruleInViolation;console.log("error data:",t)}};u.register("phetioAPIValidation",pt);var mt=pt;const gt=ot.PHET_IO_ENABLED,yt={isValidValue:T.isIOType},bt={valueType:"boolean"},vt={valueType:"string",isValidValue:t=>-1===t.indexOf("\n")},_t={valueType:z},wt={isValidValue:t=>_.every(_.keys(t),t=>Tt.indexOf(t)>=0)},At={valueType:[Object,null]},xt={tandem:ot.OPTIONAL,phetioType:T,phetioDocumentation:"",phetioState:!0,phetioReadOnly:!1,phetioEventType:z.MODEL,phetioHighFrequency:!1,phetioPlayback:!1,phetioStudioControl:!0,phetioComponentOptions:{},phetioFeatured:!1,phetioEventMetadata:null,phetioDynamicElement:!1},Tt=_.keys(xt).concat(["visibleProperty","pickableProperty","opacityProperty","textProperty"]);function St(t){this.tandem=xt.tandem,this.phetioType=xt.phetioType,this.phetioState=xt.phetioState,this.phetioReadOnly=xt.phetioReadOnly,this.phetioDocumentation=xt.phetioDocumentation,this.phetioEventType=xt.phetioEventType,this.phetioHighFrequency=xt.phetioHighFrequency,this.phetioPlayback=xt.phetioPlayback,this.phetioStudioControl=xt.phetioStudioControl,this.phetioDynamicElement=xt.phetioDynamicElement,this.phetioFeatured=xt.phetioFeatured,this.phetioEventMetadata=xt.phetioEventMetadata,this.phetioComponentOptions=xt.phetioComponentOptions,this.phetioWrapper=null,this.phetioObjectInitialized=!1,this.phetioMessageStack=[],this.isDisposed=!1,this.phetioIsArchetype=null,this.phetioBaselineMetadata=null,this.phetioArchetypePhetioID=null,this.linkedElements=[],this.phetioNotifiedObjectCreated=!1,t&&this.initializePhetioObject({},t)}R(Object,St,{initializePhetioObject:function(t,e){if(e.tandem&&e.tandem.supplied){if(A(e.tandem,{valueType:ot}),e=h({},xt,t,e),A(e.phetioType,yt),A(e.phetioState,bt),A(e.phetioReadOnly,bt),A(e.phetioEventType,_t),A(e.phetioDocumentation,vt),A(e.phetioHighFrequency,bt),A(e.phetioPlayback,bt),A(e.phetioStudioControl,bt),A(e.phetioComponentOptions,wt),A(e.phetioFeatured,bt),A(e.phetioEventMetadata,At),A(e.phetioDynamicElement,bt),gt&&e.tandem.supplied&&((mt.enabled||phet.preloads.phetio.queryParameters.studio)&&(this.phetioBaselineMetadata=this.getMetadata(h({phetioIsArchetype:this.phetioIsArchetype},e))),-1===e.tandem.phetioID.indexOf("~"))){const t=e.tandem.getConcretePhetioID();if(window.phet.preloads.phetio.phetioElementsOverrides){const i=window.phet.preloads.phetio.phetioElementsOverrides[t];i&&(e=h(e,i))}}this.tandem=e.tandem,this.phetioType=e.phetioType,this.phetioState=e.phetioState,this.phetioReadOnly=e.phetioReadOnly,this.phetioEventType=e.phetioEventType,this.phetioDocumentation=e.phetioDocumentation,this.phetioHighFrequency=e.phetioHighFrequency,this.phetioPlayback=e.phetioPlayback,this.phetioStudioControl=e.phetioStudioControl,this.phetioComponentOptions=e.phetioComponentOptions,this.phetioFeatured=e.phetioFeatured,this.phetioEventMetadata=e.phetioEventMetadata,this.phetioDynamicElement=e.phetioDynamicElement,this.phetioPlayback&&(this.phetioEventMetadata=this.phetioEventMetadata||{},this.phetioEventMetadata.playback=!0),gt&&this.isPhetioInstrumented()&&(this.phetioWrapper=new this.phetioType(this,this.tandem.phetioID)),this.tandem.addPhetioObject(this),this.phetioObjectInitialized=!0}else e.tandem&&(this.tandem=e.tandem)},phetioStartEvent:function(t,e){if(gt&&this.isPhetioInstrumented()){if(e=h({data:null,getData:null},e),this.phetioHighFrequency&&_.hasIn(window,"phet.preloads.phetio.queryParameters")&&!window.phet.preloads.phetio.queryParameters.phetioEmitHighFrequencyEvents&&!phet.phetio.dataStream.isEmittingLowFrequencyEvent())return void this.phetioMessageStack.push(-1);const i=e.getData?e.getData():e.data;this.phetioMessageStack.push(phet.phetio.dataStream.start(this.phetioEventType,this.tandem.phetioID,this.phetioType,t,i,this.phetioEventMetadata,this.phetioHighFrequency))}},phetioEndEvent:function(){if(gt&&this.isPhetioInstrumented()){const t=this.phetioMessageStack.pop();if(-1===t)return;phet.phetio.dataStream.end(t)}},propagateDynamicFlagsToDescendants:function(){const t=phet.phetio.phetioEngine;this.tandem.iterateDescendants(e=>{if(t.hasPhetioObject(e.phetioID)){const i=t.getPhetioObject(e.phetioID);i.phetioIsArchetype=this.phetioIsArchetype,i.setPhetioDynamicElement(this.phetioDynamicElement),i.phetioBaselineMetadata&&(i.phetioBaselineMetadata.phetioIsArchetype=this.phetioIsArchetype)}})},setPhetioDynamicElement(t){this.phetioDynamicElement=!this.phetioIsArchetype&&t,this.phetioArchetypePhetioID=t?this.tandem.getConcretePhetioID():null,this.phetioBaselineMetadata&&(this.phetioBaselineMetadata.phetioDynamicElement=this.phetioDynamicElement)},markDynamicElementArchetype:function(){this.phetioIsArchetype=!0,this.setPhetioDynamicElement(!1),this.phetioBaselineMetadata&&(this.phetioBaselineMetadata.phetioIsArchetype=this.phetioIsArchetype),ot.PHET_IO_ENABLED&&this.propagateDynamicFlagsToDescendants()},isPhetioInstrumented:function(){return this.tandem&&this.tandem.supplied},addLinkedElement:function(t,e){this.isPhetioInstrumented()?gt&&t.isPhetioInstrumented()&&this.linkedElements.push(new Dt(t,e)):this.linkedElements=null},onSimulationConstructionCompleted:function(){this.phetioBaselineMetadata=null},dispose:function(){this.phetioObjectInitialized&&(this.tandem.removePhetioObject(this),this.phetioWrapper&&this.phetioWrapper.dispose&&this.phetioWrapper.dispose()),this.linkedElements&&(this.linkedElements.forEach(t=>t.dispose()),this.linkedElements.length=0),this.isDisposed=!0},getMetadata:function(t){const e={phetioTypeName:(t=t||this).phetioType.typeName,phetioDocumentation:t.phetioDocumentation,phetioState:t.phetioState,phetioReadOnly:t.phetioReadOnly,phetioEventType:z.phetioType.toStateObject(t.phetioEventType),phetioHighFrequency:t.phetioHighFrequency,phetioPlayback:t.phetioPlayback,phetioStudioControl:t.phetioStudioControl,phetioDynamicElement:t.phetioDynamicElement,phetioIsArchetype:t.phetioIsArchetype,phetioFeatured:t.phetioFeatured};return t.phetioArchetypePhetioID&&(e.phetioArchetypePhetioID=t.phetioArchetypePhetioID),e}},{mergePhetioComponentOptions:function(t,e){e.phetioComponentOptions=_.merge(t,e.phetioComponentOptions)},DEFAULT_OPTIONS:xt,METADATA_KEYS:["phetioTypeName","phetioDocumentation","phetioState","phetioReadOnly","phetioEventType","phetioHighFrequency","phetioPlayback","phetioStudioControl","phetioDynamicElement","phetioIsArchetype","phetioFeatured","phetioArchetypePhetioID"]});class Dt extends St{constructor(t,e){(e=h({phetioType:lt},e)).phetioReadOnly=!0,e.phetioFeatured=t.phetioFeatured,super(e),this.element=t}getMetadata(t){const e=super.getMetadata(t);return delete e.phetioFeatured,e}}u.register("PhetioObject",St);var Et=St;const Ct={};function It(t){return Ct.hasOwnProperty(t.typeName)||(Ct[t.typeName]=Pt(t)),Ct[t.typeName]}const Pt=t=>{class e extends T{static toStateObject(e){return null===e?null:t.toStateObject(e)}static fromStateObject(e){return null===e?null:t.fromStateObject(e)}}return e.documentation="A wrapper to wrap another IOType, adding support for null.",e.validator={isValidValue:e=>null===e||v.isValueValid(e,t.validator)},e.typeName=`NullableIO<${t.typeName}>`,e.parameterTypes=[t],T.validateSubtype(e),e};u.register("NullableIO",It);var kt=It;function Lt(t,e,i){this.dependencies=t;const n=this;this.dependencyListeners=[],t.forEach((function(i,s){const r=function(i){n.isDisposed||e.apply(null,t.map((function(t){return t.get()})))};n.dependencyListeners.push(r),i.lazyLink(r,{phetioDependencies:_.without(t,i)})})),i||e.apply(null,t.map((function(t){return t.get()}))),this.isDisposed=!1}c.register("Multilink",Lt),R(Object,Lt,{dispose:function(){for(let t=0;t<this.dependencies.length;t++){const e=this.dependencies[t];e.isDisposed||e.unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,this.isDisposed=!0}});var Ot=Lt;const Nt=f.byKeys(["UNDEFER","NOTIFY"]);c.register("PropertyStatePhase",Nt);var Rt=Nt;class Mt{constructor(t){this.phaseCallbacks=[],this.propertyOrderDependencies=[],this.propertiesInOrderDependencies={},this.initialized=!1}initialize(t){t.onBeforeSetValueEmitter.addListener(t=>{if(t instanceof Yt&&!t.isDeferred){t.setDeferred(!0);const e=t.tandem.phetioID,i=()=>{const i=t.setDeferred(!1);this.phaseCallbacks.push(new Bt(e,i,Rt.NOTIFY))};this.phaseCallbacks.push(new Bt(e,i,Rt.UNDEFER))}}),t.stateSetEmitter.addListener(t=>{this.undeferAndNotifyProperties(Object.keys(t))}),t.isSettingStateProperty.lazyLink(t=>{}),this.initialized=!0}validateInstrumentedProperty(t){}validatePropertyPhasePair(t,e){this.validateInstrumentedProperty(t)}registerPhetioOrderDependency(t,e,i,n){this.validatePropertyPhasePair(t,e),this.validatePropertyPhasePair(i,n),this.propertiesInOrderDependencies[t.tandem.phetioID]=!0,this.propertiesInOrderDependencies[i.tandem.phetioID]=!0,this.propertyOrderDependencies.push(new Ft(t.tandem.phetioID,e,i.tandem.phetioID,n))}propertyInAnOrderDependency(t){return this.validateInstrumentedProperty(t),!!this.propertiesInOrderDependencies[t.tandem.phetioID]}unregisterOrderDependenciesForProperty(t){this.validateInstrumentedProperty(t);for(let e=0;e<this.propertyOrderDependencies.length;e++){const i=this.propertyOrderDependencies[e];i.usesPhetioID(t.tandem.phetioID)&&(q(this.propertyOrderDependencies,i),e--)}delete this.propertiesInOrderDependencies[t.tandem.phetioID]}undeferAndNotifyProperties(t){const e=[];for(let r=0;r<this.propertyOrderDependencies.length;r++){const i=this.propertyOrderDependencies[r];-1!==t.indexOf(i.beforePhetioID)&&-1!==t.indexOf(i.afterPhetioID)||e.push(i)}const i=_.without(this.propertyOrderDependencies,...e),n={};let s=0;for(;this.phaseCallbacks.length>0;)s++,s>5e3&&this.errorInUndeferAndNotifyStep(n,i),this.attemptToApplyPhases(Rt.UNDEFER,n,i),this.attemptToApplyPhases(Rt.NOTIFY,n,i)}errorInUndeferAndNotifyStep(t,e){const i=this.phaseCallbacks.map(t=>t.phetioID+t.phase),n=e.filter(t=>i.indexOf(t.getBeforeTerm())>=0||i.indexOf(t.getAfterTerm())>=0),s=_.keys(t).filter(t=>{for(let e=0;e<n.length;e++){if(n[e].usesPhetioID(t))return!0}return!1});let r="";console.log("still to be undeferred",this.phaseCallbacks.filter(t=>t.phase===Rt.UNDEFER)),console.log("still to be notified",this.phaseCallbacks.filter(t=>t.phase===Rt.NOTIFY)),console.log("completed phase pairs that share phetioIDs",s),console.log("order dependencies that apply to the still todos",n),n.forEach(t=>{r+=`${t.getBeforeTerm()}\t${t.getAfterTerm()}\n`}),console.log("\n\nin graphable form:\n\n",r);const o="Impossible set state: from undeferAndNotifyProperties; ordering constraints cannot be satisfied";throw new Error(o)}attemptToApplyPhases(t,e,i){for(let n=0;n<this.phaseCallbacks.length;n++){const s=this.phaseCallbacks[n];s.phase===t&&this.phetioIDCanApplyPhase(s.phetioID,t,e,i)&&(s.listener(),q(this.phaseCallbacks,s),e[s.getTerm()]=!0,n--)}}phetioIDCanApplyPhase(t,e,i,n){if(e===Rt.NOTIFY&&!i[t+Rt.UNDEFER])return!1;for(let s=0;s<n.length;s++){const r=n[s];if(r.afterPhetioID===t&&r.afterPhase===e&&!i[r.getBeforeTerm()])return!1}return!0}}class Bt{constructor(t,e,i){this.phetioID=t,this.phase=i,this.listener=e||_.noop}getTerm(){return this.phetioID+this.phase}}class Ft{constructor(t,e,i,n){this.beforePhetioID=t,this.beforePhase=e,this.afterPhetioID=i,this.afterPhase=n}getBeforeTerm(){return this.beforePhetioID+this.beforePhase}getAfterTerm(){return this.afterPhetioID+this.afterPhase}usesPhetioID(t){return this.beforePhetioID===t||this.afterPhetioID===t}}c.register("PropertyStateHandler",Mt);const Vt=new Mt;c.register("propertyStateHandlerSingleton",Vt);var Ht=Vt;const zt={values:["AMU","atm","cm","°C","K","kg","kg/m^3","kPa","m","mm","m/s","m/s^2","nm","nm/ps","Ω","particles/ps","pm","pm/s","pm/s^2","pm/ps","pm^3","ps","s","N","radians","L/s","L","mol/L","mol","amperes","milliamperes","becquerels","centimeters","centimeters-squared","coulombs","degrees Celsius","degrees","farads","kilograms","grams","gray","henrys","henries","hertz","joules","katals","kelvins","liters","liters/second","lumens","lux","meters","meters/second","meters/second/second","moles","moles/liter","nanometers","newtons/meters","newtons-second/meters","ohms","ohm-centimeters","pascals","percent","radians/second","seconds","siemens","sieverts","steradians","tesla","view-coordinates/second","volts","watts","webers"],isValidUnits:function(t){return _.includes(zt.values,t)}};c.register("units",zt);let Gt=0;class qt extends Et{constructor(t,e){e=h({tandem:ot.OPTIONAL,useDeepEquality:!1,units:null,reentrant:!1},e),v.containsValidatorKey(e)||(e.isValidValue=()=>!0),e.units&&(e.phetioEventMetadata=e.phetioEventMetadata||{},e.phetioEventMetadata.units=e.units),super(e),this.id=Gt++,this.units=e.units,this.useDeepEquality=e.useDeepEquality,ot.VALIDATION&&this.isPhetioInstrumented(),this._value=t,this._initialValue=t,this.validValues=e.validValues,this.changedEmitter=new C,this.notifying=!1,this.reentrant=e.reentrant,this.isDeferred=!1,this.deferredValue=null,this.hasDeferredValue=!1}get(){return this._value}set(t){if(!this.isDisposed)if(this.isDeferred)this.deferredValue=t,this.hasDeferredValue=!0;else if(!this.equalsValue(t)){const e=this.get();this.setPropertyValue(t),this._notifyListeners(e)}return this}setPropertyValue(t){this._value=t}setInitialValue(t){this._initialValue=t}equalsValue(t){return this.areValuesEqual(t,this._value)}areValuesEqual(t,e){return this.useDeepEquality&&t&&e&&t.constructor===e.constructor?t.equals(e):t===e}getInitialValue(){return this._initialValue}get initialValue(){return this.getInitialValue()}_notifyListeners(t){this.isPhetioInstrumented()&&this.phetioStartEvent(qt.CHANGED_EVENT_NAME,{getData:()=>{const e=this.phetioType.parameterTypes[0];return{oldValue:kt(e).toStateObject(t),newValue:e.toStateObject(this.get())}}}),this.notifying=!0,this.changedEmitter.emit(this.get(),t,this),this.notifying=!1,this.isPhetioInstrumented()&&this.phetioEndEvent()}notifyListenersStatic(){this._notifyListeners(null)}setDeferred(t){if(t)this.isDeferred=!0;else{this.isDeferred=!1;const t=this._value;if(this.hasDeferredValue&&(this.setPropertyValue(this.deferredValue),this.hasDeferredValue=!1),!this.equalsValue(t))return()=>!this.isDisposed&&this._notifyListeners(t)}return null}reset(){this.set(this._initialValue)}get value(){return this.get()}set value(t){this.set(t)}addPhetioStateDependencies(t){for(let e=0;e<t.length;e++){const i=t[e];ot.PHET_IO_ENABLED&&i instanceof qt&&i.isPhetioInstrumented()&&this.isPhetioInstrumented()&&Ht.registerPhetioOrderDependency(i,Rt.UNDEFER,this,Rt.NOTIFY)}}link(t,e){e&&e.phetioDependencies&&this.addPhetioStateDependencies(e.phetioDependencies),this.changedEmitter.addListener(t),t(this.get(),null,this)}lazyLink(t,e){e&&e.phetioDependencies&&this.addPhetioStateDependencies(e.phetioDependencies),this.changedEmitter.addListener(t)}unlink(t){this.changedEmitter.removeListener(t)}unlinkAll(){this.changedEmitter.removeAllListeners()}linkAttribute(t,e){const i=i=>{t[e]=i};return this.link(i),i}unlinkAttribute(t){this.unlink(t)}toString(){return`Property#${this.id}{${this.get()}}`}valueOf(){return this.toString()}debug(t){const e=e=>console.log(t,e);return this.link(e),e}toggle(){this.value=!this.value}dispose(){this.unlinkAll(),ot.PHET_IO_ENABLED&&this.isPhetioInstrumented()&&Ht.propertyInAnOrderDependency(this)&&Ht.unregisterOrderDependenciesForProperty(this),super.dispose(),this.changedEmitter.dispose()}hasListener(t){return this.changedEmitter.hasListener(t)}hasListeners(){return this.changedEmitter.hasListeners()}static multilink(t,e){return new Ot(t,e,!1)}static lazyMultilink(t,e){return new Ot(t,e,!0)}static unmultilink(t){t.dispose()}}qt.CHANGED_EVENT_NAME="changed",c.register("Property",qt);var Yt=qt;const Ut={};function jt(t,e){for(let n=0;n<e.length;n++);const i=`${t.typeName}.${e.map(t=>t.typeName).join(",")}`;return Ut.hasOwnProperty(i)||(Ut[i]=Wt(t,e)),Ut[i]}const Wt=(t,e)=>{const i=e.map(t=>t.typeName).join(",");class n extends T{}let s=e.map(t=>t.typeName).join(", ");return""===s&&(s="VoidIO"),n.documentation="Wrapper for the built-in JS function type.<br><strong>Arguments:</strong> "+s+"<br><strong>Return Type:</strong> "+t.typeName,n.validator={valueType:"function"},n.returnType=t,n.functionParameterTypes=e,n.wrapForPhetioCommandProcessor=!0,n.typeName=`FunctionIO(${i})=>${t.typeName}`,n.parameterTypes=e.concat([t]),T.validateSubtype(n),n};u.register("FunctionIO",jt);var Xt=jt;class Kt extends T{constructor(t,e){super(t,e)}static toStateObject(t){}}Kt.documentation="Type for which there is no instance, usually to mark functions without a return value",Kt.validator={isValidValue:()=>!0},Kt.typeName="VoidIO",T.validateSubtype(Kt),u.register("VoidIO",Kt);var Qt=Kt;const Zt=new Map;function $t(t){return Zt.has(t)||Zt.set(t,Jt(t)),Zt.get(t)}const Jt=t=>{class e extends T{constructor(t,e){super(t,e)}static toStateObject(e){A(e,this.validator);const i={value:t.toStateObject(e.value)};return e.validValues&&(i.validValues=e.validValues.map((function(e){return t.toStateObject(e)}))),e.units&&(i.units=e.units),i}static applyState(e,i){A(e,this.validator),e.units=i.units,e.set(t.fromStateObject(i.value)),i.validValues&&(e.validValues=i.validValues.map(e=>t.fromStateObject(e)))}}return e.methods={getValue:{returnType:t,parameterTypes:[],implementation:function(){return this.phetioObject.get()},documentation:"Gets the current value."},setValue:{returnType:Qt,parameterTypes:[t],implementation:function(t){this.phetioObject.set(t)},documentation:"Sets the value of the Property. If the value differs from the previous value, listeners are notified with the new value.",invocableForReadOnlyElements:!1},link:{returnType:Qt,parameterTypes:[Xt(Qt,[t,kt(t)])],implementation:function(t){this.phetioObject.link(t)},documentation:"Adds a listener which will be called when the value changes. On registration, the listener is also called with the current value. The listener takes two arguments, the new value and the previous value."},lazyLink:{returnType:Qt,parameterTypes:[Xt(Qt,[t,kt(t)])],implementation:function(t){this.phetioObject.lazyLink(t)},documentation:'Adds a listener which will be called when the value changes. This method is like "link", but without the current-value callback on registration. The listener takes two arguments, the new value and the previous value.'}},e.documentation="Observable values that send out notifications when the value changes. This differs from the traditional listener pattern in that added listeners also receive a callback with the current value when the listeners are registered. This is a widely-used pattern in PhET-iO simulations.",e.methodOrder=["link","lazyLink"],e.validator={valueType:Yt},e.events=["changed"],e.typeName=`PropertyIO<${t.typeName}>`,e.parameterTypes=[t],T.validateSubtype(e),e};c.register("PropertyIO",$t);var te=$t;const ee=te(D);class ie extends Yt{constructor(t,e){super(t,e=h({valueType:"boolean",phetioType:ee},e))}}c.register("BooleanProperty",ie);var ne=ie;const se={isValidValue:t=>t instanceof(window.phet?phet.axon.DerivedProperty:c.DerivedProperty)},re={};function oe(t){return re.hasOwnProperty(t.typeName)||(re[t.typeName]=ae(t)),re[t.typeName]}const ae=t=>{const e=te(t);class i extends e{}return i.methods={setValue:{returnType:Qt,parameterTypes:[t],implementation:function(t){return this.phetioObject.set(t)},documentation:"Errors out when you try to set a derived property.",invocableForReadOnlyElements:!1}},i.documentation="Like PropertyIO, but not settable.  Instead it is derived from other DerivedPropertyIO or PropertyIO instances",i.validator=se,i.typeName=`DerivedPropertyIO<${t.typeName}>`,i.outerType=oe,T.validateSubtype(i),i};c.register("DerivedPropertyIO",oe);class le extends Yt{constructor(t,e,i){i=h({tandem:ot.OPTIONAL,phetioReadOnly:!0},i),super(e.apply(null,t.map(t=>t.get())),i),ot.VALIDATION&&this.isPhetioInstrumented(),this.dependencies=t,this._initialValue=null,this.derivation=e,this.dependencyListeners=[];for(let n=0;n<t.length;n++){(i=>{const n=()=>{this.isDeferred?this.hasDeferredValue=!0:super.set(e.apply(null,t.map(t=>t.get())))};this.dependencyListeners.push(n),i.lazyLink(n),i instanceof Yt&&this.isPhetioInstrumented()&&i.isPhetioInstrumented()&&Ht.registerPhetioOrderDependency(i,Rt.UNDEFER,this,Rt.UNDEFER)})(t[n])}}dispose(){for(let t=0;t<this.dependencies.length;t++){const e=this.dependencies[t];e.isDisposed||e.unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,super.dispose(this)}set(t){throw new Error("Cannot set values directly to a DerivedProperty, tried to set: "+t)}set value(t){throw new Error("Cannot es5-set values directly to a DerivedProperty, tried to set: "+t)}reset(){throw new Error("Cannot reset a DerivedProperty directly")}getInitialValue(){throw new Error("Cannot get the initial value of a DerivedProperty")}setDeferred(t){return this.isDeferred&&!t&&(this.deferredValue=this.derivation.apply(null,this.dependencies.map(t=>t.get()))),super.setDeferred(t)}get value(){return super.get()}static valueEquals(t,e,i){return new le([t,e],he,i)}static and(t,e){return new le(t,_.reduce.bind(null,t,ue,!0),e)}static or(t,e){return new le(t,_.reduce.bind(null,t,ce,!1),e)}static not(t,e){return new le([t],t=>!t,e)}}const he=(t,e)=>t===e,ue=(t,e)=>t&&e.value,ce=(t,e)=>t||e.value;c.register("DerivedProperty",le);var de=le;const fe=new r("dot");fe.register("v2",(function(t,e){return new fe.Vector2(t,e)})),fe.register("v3",(function(t,e,i){return new fe.Vector3(t,e,i)})),fe.register("v4",(function(t,e,i,n){return new fe.Vector4(t,e,i,n)})),fe.register("FastArray",window.Float64Array?window.Float64Array:window.Array);var pe=fe;function me(t,e){this._min=t,this._max=e}pe.register("Range",me),me.prototype={constructor:me,getMin:function(){return this._min},get min(){return this.getMin()},setMin:function(t){this._min=t},set min(t){this.setMin(t)},getMax:function(){return this._max},get max(){return this.getMax()},setMax:function(t){this._max=t},set max(t){this.setMax(t)},setMinMax:function(t,e){this._min=t,this._max=e},copy:function(){return new me(this._min,this._max)},getLength:function(){return this._max-this._min},getCenter:function(){return(this._max+this._min)/2},contains:function(t){return t>=this._min&&t<=this._max},containsRange:function(t){return this._min<=t.min&&this._max>=t.max},intersects:function(t){return this._max>=t.min&&t.max>=this._min},intersectsExclusive:function(t){return this._max>t.min&&t.max>this._min},toString:function(){return"[Range (min:"+this._min+" max:"+this._max+")]"},constrainValue:function(t){return Math.min(Math.max(t,this._min),this._max)},equals:function(t){return this.constructor===t.constructor&&this._min===t.min&&this._max===t.max},getNormalizedValue:function(t){return(t-this.min)/this.getLength()},get defaultValue(){throw new Error("defaultValue is undefined, did you mean to use RangeWithValue?")}};var ge=me;class ye extends T{static toStateObject(t){return A(t,this.validator),{min:t.min,max:t.max}}static fromStateObject(t){return new ge(t.min,t.max)}}ye.documentation='A range with "min" and a "max" members.',ye.validator={valueType:ge},ye.typeName="RangeIO",T.validateSubtype(ye),pe.register("RangeIO",ye);var be=ye;class ve extends T{constructor(){super()}static toStateObject(t){return t===Number.POSITIVE_INFINITY?"POSITIVE_INFINITY":t===Number.NEGATIVE_INFINITY?"NEGATIVE_INFINITY":t}static fromStateObject(t){return"POSITIVE_INFINITY"===t?Number.POSITIVE_INFINITY:"NEGATIVE_INFINITY"===t?Number.NEGATIVE_INFINITY:t}}ve.documentation="IO Type for Javascript's number primitive type",ve.validator={valueType:"number"},ve.typeName="NumberIO",T.validateSubtype(ve),u.register("NumberIO",ve);var _e=ve;class we extends T{constructor(t,e){super(t,e)}static toStateObject(t){return t}static fromStateObject(t){return t}}we.documentation="IO Type for Javascript's string primitive type",we.validator={valueType:"string"},we.typeName="StringIO",T.validateSubtype(we),u.register("StringIO",we);var Ae=we;const xe=te(_e),Te=["FloatingPoint","Integer"];class Se extends xe{static toStateObject(t){A(t,this.validator);const e=xe.toStateObject(t);return t.numberType&&(e.numberType=t.numberType),t.rangeProperty.value&&(e.range=be.toStateObject(t.rangeProperty.value),t.rangeProperty.isPhetioInstrumented()&&(e.rangePhetioID=Ae.toStateObject(t.rangeProperty.tandem.phetioID))),t.step&&(e.step=_e.toStateObject(t.step)),e}static applyState(t,e){A(t,this.validator),xe.applyState(t,e),t.step=e.step,t.numberType=e.numberType}}Se.validator={isValidValue:t=>t instanceof(window.phet?phet.axon.NumberProperty:c.NumberProperty)},Se.typeName="NumberPropertyIO",Se.documentation="Extends PropertyIO to add values for the numeric range ( min, max ) and numberType ( '"+Te.join("' | '")+"' )",Se.VALID_NUMBER_TYPES=Te,T.validateSubtype(Se),c.register("NumberPropertyIO",Se);var De=Se;De.VALID_NUMBER_TYPES;class Ee extends Yt{constructor(t,e){e=h({numberType:"FloatingPoint",range:null,step:null,rangePropertyOptions:{phetioDocumentation:"provides the range of possible values for the parent NumberProperty",phetioType:te(kt(be)),phetioReadOnly:!0},tandem:ot.OPTIONAL},e),(e=h({rangePropertyOptions:{tandem:e.tandem.createTandem("rangeProperty")}},e)).valueType="number",e.phetioType=De;const i=!(e.range&&e.range instanceof Yt);super(t,e),this.numberType=e.numberType,this.step=e.step,this.validateNumberProperty=!1,this.rangeProperty=null,this.rangeProperty=i?new Yt(e.range,e.rangePropertyOptions):e.range;const n=t=>{this.validateNumberProperty&&this.validateNumberProperty(this.value)};this.rangeProperty.link(n),this.rangeProperty.addPhetioStateDependencies([this]),this.addPhetioStateDependencies([this.rangeProperty]),e.validValues&&this.validateNumberProperty&&e.validValues.forEach(t=>this.validateNumberProperty(t)),this.validateNumberProperty&&this.link(t=>{this.validateNumberProperty(t)}),this.disposeNumberProperty=()=>{i?this.rangeProperty.dispose():this.rangeProperty.unlink(n)},this.resetNumberProperty=()=>{i&&this.rangeProperty.reset()}}get range(){return this.rangeProperty.value}set range(t){this.rangeProperty.value=t}reset(){super.reset(),this.resetNumberProperty()}dispose(){this.disposeNumberProperty(),super.dispose()}setValueAndRange(t,e){this.setDeferred(!0),this.rangeProperty.setDeferred(!0),this.set(t),this.rangeProperty.set(e);const i=this.setDeferred(!1),n=this.rangeProperty.setDeferred(!1);i&&i(),n&&n()}resetValueAndRange(){this.setValueAndRange(this.initialValue,this.rangeProperty.initialValue)}}c.register("NumberProperty",Ee);var Ce=Ee;const Ie={mixInto:function(t,e){e=h({defaultArguments:[],initialize:t,maxSize:100,initialSize:0,useDefaultConstruction:!1},e);const i=[],n=Function.prototype.bind.bind(t,t),s=n.apply(null,e.defaultArguments),r=e.initialize,o=e.useDefaultConstruction,a=t.prototype;for(O(t,{pool:i,dirtyFromPool:function(){return i.length?i.pop():new s},createFromPool:function(){let t;return i.length?(t=i.pop(),r.apply(t,arguments)):o?(t=new s,r.apply(t,arguments)):t=new(n.apply(null,arguments)),t}}),O(a,{freeToPool:function(){i.length<e.maxSize&&i.push(this)}});i.length<e.initialSize;)i.push(new s)}};a.register("Poolable",Ie);var Pe=Ie;const ke=Number.MIN_VALUE,Le=2*Math.PI;let Oe,Ne,Re;var Me={clamp:function(t,e,i){return t<e?e:t>i?i:t},moduloBetweenDown:function(t,e,i){const n=i-e;let s=(t-e)%n;return s<0&&(s+=n),s+e},moduloBetweenUp:function(t,e,i){return-Me.moduloBetweenDown(-t,-i,-e)},rangeInclusive:function(t,e){if(e<t)return[];const i=new Array(e-t+1);for(let n=t;n<=e;n++)i[n-t]=n;return i},rangeExclusive:function(t,e){return Me.rangeInclusive(t+1,e-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},mod:function(t,e){return t/e%1==0?0:t%e},gcd:function(t,e){return Math.abs(0===e?t:this.gcd(e,Me.mod(t,e)))},lcm:function(t,e){return Me.roundSymmetric(Math.abs(t*e)/Me.gcd(t,e))},lineLineIntersection:function(t,e,i,n){if(t.equals(e)||i.equals(n))return null;const s=t.x-e.x,r=i.x-n.x,o=t.y-e.y,a=i.y-n.y,l=s*a-o*r;if(Math.abs(l)<1e-10)return null;const h=t.x*e.y-t.y*e.x,u=i.x*n.y-i.y*n.x;return new je((h*r-s*u)/l,(h*a-o*u)/l)},circleCenterFromPoints:function(t,e,i){const n=new je((t.x+e.x)/2,(t.y+e.y)/2),s=new je((e.x+i.x)/2,(e.y+i.y)/2),r=new je(n.x+(e.y-t.y),n.y-(e.x-t.x)),o=new je(s.x+(i.y-e.y),s.y-(i.x-e.x));return Me.lineLineIntersection(n,r,s,o)},pointInCircleFromPoints:function(t,e,i,n){const s=t.x-n.x,r=t.y-n.y,o=(t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y),a=e.x-n.x,l=e.y-n.y,h=(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y),u=i.x-n.x,c=i.y-n.y,d=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y);return s*l*d+r*h*u+o*a*c-o*l*u-r*a*d-s*h*c>0},sphereRayIntersection:function(t,e,i){i=void 0===i?1e-5:i;const n=new pe.Vector3(0,0,0),s=e.direction,r=e.position,o=r.minus(n),a=s.dot(o),l=4*a*a-4*(o.magnitudeSquared-t*t);if(l<i)return null;const h=s.dot(n)-s.dot(r),u=Math.sqrt(l)/2,c=h-u,d=h+u;if(d<i)return null;const f=e.pointAtDistance(d),p=f.minus(n).normalized();if(c<i)return{distance:d,hitPoint:f,normal:p.negated(),fromOutside:!1};{const t=e.pointAtDistance(c),i=t.minus(n).normalized();return{distance:c,hitPoint:t,normal:i,fromOutside:!0}}},solveLinearRootsReal:function(t,e){return 0===t?0===e?null:[]:[-e/t]},solveQuadraticRootsReal:function(t,e,i){if(0===t||Math.abs(e/t)>1e7||Math.abs(i/t)>1e7)return Me.solveLinearRootsReal(e,i);const n=e*e-4*t*i;if(n<0)return[];const s=Math.sqrt(n);return[(-e-s)/(2*t),(-e+s)/(2*t)]},solveCubicRootsReal:function(t,e,i,n){if(0===t)return Me.solveQuadraticRootsReal(e,i,n);if(0===t||Math.abs(e/t)>1e7||Math.abs(i/t)>1e7||Math.abs(n/t)>1e7)return Me.solveQuadraticRootsReal(e,i,n);if(0===n||Math.abs(t/n)>1e7||Math.abs(e/n)>1e7||Math.abs(i/n)>1e7)return[0].concat(Me.solveQuadraticRootsReal(t,e,i));const s=(3*(i/=t)-(e/=t)*e)/9,r=(-27*(n/=t)+e*(9*i-e*e*2))/54,o=s*s*s+r*r,a=e/3;if(o>1e-7){const t=Math.sqrt(o);return[Me.cubeRoot(r+t)+Me.cubeRoot(r-t)-a]}if(0===o){const t=Me.cubeRoot(r),e=-a-t;return[2*t-a,e,e]}{let t=-s*s*s;t=Math.acos(r/Math.sqrt(t));const e=2*Math.sqrt(-s);return[-a+e*Math.cos(t/3),-a+e*Math.cos((t+2*Math.PI)/3),-a+e*Math.cos((t+4*Math.PI)/3)]}},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,e,i,n,s){return(n-i)/(e-t)*(s-t)+i},roundSymmetric:function(t){return(t<0?-1:1)*Math.round(Math.abs(t))},toFixed:function(t,e){const i=Math.pow(10,e);return(Me.roundSymmetric(t*i)/i).toFixed(e)},toFixedNumber:function(t,e){return parseFloat(Me.toFixed(t,e))},isInteger:function(t){return"number"==typeof t&&t%1==0},equalsEpsilon:function(t,e,i){return Math.abs(t-e)<=i},lineSegmentIntersection:function(t,e,i,n,s,r,o,a){const l=function(t,e,i,n,s,r){return(r-e)*(i-t)-(n-e)*(s-t)};if(l(t,e,s,r,o,a)*l(i,n,s,r,o,a)>0||l(s,r,t,e,i,n)*l(o,a,t,e,i,n)>0)return null;const h=(t-i)*(r-a)-(e-n)*(s-o);return Math.abs(h)<1e-10?null:t===s&&e===r||t===o&&e===a?new je(t,e):i===s&&n===r||i===o&&n===a?new je(i,n):new je(((t*n-e*i)*(s-o)-(t-i)*(s*a-r*o))/h,((t*n-e*i)*(r-a)-(e-n)*(s*a-r*o))/h)},distToSegmentSquared:function(t,e,i){const n=e.distanceSquared(i);if(0===n)return t.distanceSquared(e);const s=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;let r;return r=s<0?t.distanceSquared(e):s>1?t.distanceSquared(i):t.distanceSquared(new je(e.x+s*(i.x-e.x),e.y+s*(i.y-e.y))),r},distToSegment:function(t,e,i){return Math.sqrt(this.distToSegmentSquared(t,e,i))},arePointsCollinear:function(t,e,i,n){return void 0===n&&(n=0),Me.triangleArea(t,e,i)<=n},triangleArea:function(t,e,i){return Math.abs(Me.triangleAreaSigned(t,e,i))},triangleAreaSigned:function(t,e,i){return t.x*(e.y-i.y)+e.x*(i.y-t.y)+i.x*(t.y-e.y)},centroidOfPolygon:function(t){const e=new je(0,0);let i=0;return t.forEach((n,s)=>{const r=t[(s+1)%t.length],o=n.x*r.y-r.x*n.y;i+=o/2,e.addXY((n.x+r.x)*o,(n.y+r.y)*o)}),e.divideScalar(6*i),e},cosh:function(t){return(Math.exp(t)+Math.exp(-t))/2},sinh:function(t){return(Math.exp(t)-Math.exp(-t))/2},log10:function(t){return Math.log(t)/Math.LN10},boxMullerTransform:function(t,e,i){if(Oe=!Oe,!Oe)return Re*e+t;let n,s;do{n=i.nextDouble(),s=i.nextDouble()}while(n<=ke);return Ne=Math.sqrt(-2*Math.log(n))*Math.cos(Le*s),Re=Math.sqrt(-2*Math.log(n))*Math.sin(Le*s),Ne*e+t},numberOfDecimalPlaces:function(t){let e=0,i=1;for(;t*i%1!=0;)e++,i*=10;return e},roundToInterval:function(t,e){return Me.toFixedNumber(Me.roundSymmetric(t/e)*e,Me.numberOfDecimalPlaces(e))}};pe.register("Utils",Me),pe.clamp=Me.clamp,pe.moduloBetweenDown=Me.moduloBetweenDown,pe.moduloBetweenUp=Me.moduloBetweenUp,pe.rangeInclusive=Me.rangeInclusive,pe.rangeExclusive=Me.rangeExclusive,pe.toRadians=Me.toRadians,pe.toDegrees=Me.toDegrees,pe.lineLineIntersection=Me.lineLineIntersection,pe.lineSegmentIntersection=Me.lineSegmentIntersection,pe.sphereRayIntersection=Me.sphereRayIntersection,pe.solveQuadraticRootsReal=Me.solveQuadraticRootsReal,pe.solveCubicRootsReal=Me.solveCubicRootsReal,pe.cubeRoot=Me.cubeRoot,pe.linear=Me.linear,pe.boxMullerTransform=Me.boxMullerTransform;var Be=Me;function Fe(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}pe.register("Vector4",Fe),R(Object,Fe,{isVector4:!0,dimension:4,getMagnitude:function(){return Math.sqrt(this.magnitudeSquared)},get magnitude(){return this.getMagnitude()},getMagnitudeSquared:function(){return this.dot(this)},get magnitudeSquared(){return this.getMagnitudeSquared()},distance:function(t){return this.minus(t).magnitude},distanceXYZW:function(t,e,i,n){const s=this.x-t,r=this.y-e,o=this.z-i,a=this.w-n;return Math.sqrt(s*s+r*r+o*o+a*a)},distanceSquared:function(t){return this.minus(t).magnitudeSquared},distanceSquaredXYZW:function(t,e,i,n){const s=this.x-t,r=this.y-e,o=this.z-i,a=this.w-n;return s*s+r*r+o*o+a*a},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},dotXYZW:function(t,e,i,n){return this.x*t+this.y*e+this.z*i+this.w*n},angleBetween:function(t){return Math.acos(pe.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,e){return e||(e=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},copy:function(t){return t?t.set(this):new Fe(this.x,this.y,this.z,this.w)},normalized:function(){const t=this.magnitude;return this.dividedScalar(t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new Fe(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new Fe(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new Fe(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusXYZW:function(t,e,i,n){return new Fe(this.x+t,this.y+e,this.z+i,this.w+n)},plusScalar:function(t){return new Fe(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new Fe(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusXYZW:function(t,e,i,n){return new Fe(this.x-t,this.y-e,this.z-i,this.w-n)},minusScalar:function(t){return new Fe(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new Fe(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new Fe(-this.x,-this.y,-this.z,-this.w)},blend:function(t,e){return this.plus(t.minus(this).times(e))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new qe(this.x,this.y,this.z)},setXYZW:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},set:function(t){return this.setXYZW(t.x,t.y,t.z,t.w)},setMagnitude:function(t){const e=t/this.magnitude;return this.multiplyScalar(e)},add:function(t){return this.setXYZW(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addXYZW:function(t,e,i,n){return this.setXYZW(this.x+t,this.y+e,this.z+i,this.w+n)},addScalar:function(t){return this.setXYZW(this.x+t,this.y+t,this.z+t,this.w+t)},subtract:function(t){return this.setXYZW(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subtractXYZW:function(t,e,i,n){return this.setXYZW(this.x-t,this.y-e,this.z-i,this.w-n)},subtractScalar:function(t){return this.setXYZW(this.x-t,this.y-t,this.z-t,this.w-t)},multiplyScalar:function(t){return this.setXYZW(this.x*t,this.y*t,this.z*t,this.w*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZW(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},divideScalar:function(t){return this.setXYZW(this.x/t,this.y/t,this.z/t,this.w/t)},negate:function(){return this.setXYZW(-this.x,-this.y,-this.z,-this.w)},normalize:function(){const t=this.magnitude;if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXYZW(Be.roundSymmetric(this.x),Be.roundSymmetric(this.y),Be.roundSymmetric(this.z),Be.roundSymmetric(this.w))}}),Pe.mixInto(Fe,{initialize:Fe.prototype.setXYZW,defaultArguments:[0,0,0,0]}),Fe.Immutable=function(t,e,i,n){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0,this.w=void 0!==n?n:1};const Ve=Fe.Immutable;R(Fe,Ve),Ve.mutableOverrideHelper=function(t){Ve.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},Ve.mutableOverrideHelper("setXYZW"),Ve.mutableOverrideHelper("setX"),Ve.mutableOverrideHelper("setY"),Ve.mutableOverrideHelper("setZ"),Ve.mutableOverrideHelper("setW"),Fe.ZERO=new Fe(0,0,0,0),Fe.X_UNIT=new Fe(1,0,0,0),Fe.Y_UNIT=new Fe(0,1,0,0),Fe.Z_UNIT=new Fe(0,0,1,0),Fe.W_UNIT=new Fe(0,0,0,1);var He=Fe;function ze(t,e,i){this.x=t,this.y=e,this.z=i}pe.register("Vector3",ze),R(Object,ze,{isVector3:!0,dimension:3,getMagnitude:function(){return Math.sqrt(this.magnitudeSquared)},get magnitude(){return this.getMagnitude()},getMagnitudeSquared:function(){return this.dot(this)},get magnitudeSquared(){return this.getMagnitudeSquared()},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXYZ:function(t,e,i){const n=this.x-t,s=this.y-e,r=this.z-i;return Math.sqrt(n*n+s*s+r*r)},distanceSquared:function(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},distanceSquaredXYZ:function(t,e,i){const n=this.x-t,s=this.y-e,r=this.z-i;return n*n+s*s+r*r},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},dotXYZ:function(t,e,i){return this.x*t+this.y*e+this.z*i},angleBetween:function(t){return Math.acos(pe.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,e){return e||(e=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},copy:function(t){return t?t.set(this):new ze(this.x,this.y,this.z)},cross:function(t){return new ze(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){const t=this.magnitude;if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new ze(this.x/t,this.y/t,this.z/t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new ze(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new ze(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new ze(this.x+t.x,this.y+t.y,this.z+t.z)},plusXYZ:function(t,e,i){return new ze(this.x+t,this.y+e,this.z+i)},plusScalar:function(t){return new ze(this.x+t,this.y+t,this.z+t)},minus:function(t){return new ze(this.x-t.x,this.y-t.y,this.z-t.z)},minusXYZ:function(t,e,i){return new ze(this.x-t,this.y-e,this.z-i)},minusScalar:function(t){return new ze(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new ze(this.x/t,this.y/t,this.z/t)},negated:function(){return new ze(-this.x,-this.y,-this.z)},blend:function(t,e){return this.plus(t.minus(this).times(e))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new je(this.x,this.y)},toVector4:function(){return new He(this.x,this.y,this.z,1)},setXYZ:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},set:function(t){return this.setXYZ(t.x,t.y,t.z)},setMagnitude:function(t){const e=t/this.magnitude;return this.multiplyScalar(e)},add:function(t){return this.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},addXYZ:function(t,e,i){return this.setXYZ(this.x+t,this.y+e,this.z+i)},addScalar:function(t){return this.setXYZ(this.x+t,this.y+t,this.z+t)},subtract:function(t){return this.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},subtractXYZ:function(t,e,i){return this.setXYZ(this.x-t,this.y-e,this.z-i)},subtractScalar:function(t){return this.setXYZ(this.x-t,this.y-t,this.z-t)},multiplyScalar:function(t){return this.setXYZ(this.x*t,this.y*t,this.z*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZ(this.x*t.x,this.y*t.y,this.z*t.z)},divideScalar:function(t){return this.setXYZ(this.x/t,this.y/t,this.z/t)},negate:function(){return this.setXYZ(-this.x,-this.y,-this.z)},setCross(t){return this.setXYZ(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalize:function(){const t=this.magnitude;if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXYZ(Be.roundSymmetric(this.x),Be.roundSymmetric(this.y),Be.roundSymmetric(this.z))},toStateObject:function(){return{x:this.x,y:this.y,z:this.z}}},{slerp:function(t,e,i){return pe.Quaternion.slerp(new pe.Quaternion,pe.Quaternion.getRotationQuaternion(t,e),i).timesVector3(t)},fromStateObject:function(t){return new ze(t.x,t.y,t.z)}}),Pe.mixInto(ze,{initialize:ze.prototype.setXYZ,defaultArguments:[0,0,0]}),ze.Immutable=function(t,e,i){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==i?i:0};const Ge=ze.Immutable;R(ze,Ge),Ge.mutableOverrideHelper=function(t){Ge.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},Ge.mutableOverrideHelper("setXYZ"),Ge.mutableOverrideHelper("setX"),Ge.mutableOverrideHelper("setY"),Ge.mutableOverrideHelper("setZ"),ze.ZERO=new ze(0,0,0),ze.X_UNIT=new ze(1,0,0),ze.Y_UNIT=new ze(0,1,0),ze.Z_UNIT=new ze(0,0,1);var qe=ze;function Ye(t,e){this.x=t,this.y=e}pe.register("Vector2",Ye),R(Object,Ye,{isVector2:!0,dimension:2,getMagnitude:function(){return Math.sqrt(this.magnitudeSquared)},get magnitude(){return this.getMagnitude()},getMagnitudeSquared:function(){return this.x*this.x+this.y*this.y},get magnitudeSquared(){return this.getMagnitudeSquared()},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,e){const i=this.x-t,n=this.y-e;return Math.sqrt(i*i+n*n)},distanceSquared:function(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i},distanceSquaredXY:function(t,e){const i=this.x-t,n=this.y-e;return i*i+n*n},dot:function(t){return this.x*t.x+this.y*t.y},dotXY:function(t,e){return this.x*t+this.y*e},getAngle:function(){return Math.atan2(this.y,this.x)},get angle(){return this.getAngle()},angleBetween:function(t){const e=this.magnitude,i=t.magnitude;return Math.acos(pe.clamp((this.x*t.x+this.y*t.y)/(e*i),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,e){return e||(e=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=e},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(t){return t?t.set(this):new Ye(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){const t=this.magnitude;if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new Ye(this.x/t,this.y/t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new Ye(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new Ye(this.x*t.x,this.y*t.y)},plus:function(t){return new Ye(this.x+t.x,this.y+t.y)},plusXY:function(t,e){return new Ye(this.x+t,this.y+e)},plusScalar:function(t){return new Ye(this.x+t,this.y+t)},minus:function(t){return new Ye(this.x-t.x,this.y-t.y)},minusXY:function(t,e){return new Ye(this.x-t,this.y-e)},minusScalar:function(t){return new Ye(this.x-t,this.y-t)},dividedScalar:function(t){return new Ye(this.x/t,this.y/t)},negated:function(){return new Ye(-this.x,-this.y)},getPerpendicular:function(){return new Ye(this.y,-this.x)},get perpendicular(){return this.getPerpendicular()},rotated:function(t){const e=this.angle+t,i=this.magnitude;return new Ye(i*Math.cos(e),i*Math.sin(e))},rotateAboutXY:function(t,e,i){const n=this.x-t,s=this.y-e,r=Math.cos(i),o=Math.sin(i);return this.x=t+n*r-s*o,this.y=e+n*o+s*r,this},rotateAboutPoint:function(t,e){return this.rotateAboutXY(t.x,t.y,e)},rotatedAboutXY:function(t,e,i){return new Ye(this.x,this.y).rotateAboutXY(t,e,i)},rotatedAboutPoint:function(t,e){return this.rotatedAboutXY(t.x,t.y,e)},blend:function(t,e){return new Ye(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new qe(this.x,this.y,0)},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},set:function(t){return this.setXY(t.x,t.y)},setMagnitude:function(t){const e=t/this.magnitude;return this.multiplyScalar(e)},add:function(t){return this.setXY(this.x+t.x,this.y+t.y)},addXY:function(t,e){return this.setXY(this.x+t,this.y+e)},addScalar:function(t){return this.setXY(this.x+t,this.y+t)},subtract:function(t){return this.setXY(this.x-t.x,this.y-t.y)},subtractXY:function(t,e){return this.setXY(this.x-t,this.y-e)},subtractScalar:function(t){return this.setXY(this.x-t,this.y-t)},multiplyScalar:function(t){return this.setXY(this.x*t,this.y*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXY(this.x*t.x,this.y*t.y)},divideScalar:function(t){return this.setXY(this.x/t,this.y/t)},negate:function(){return this.setXY(-this.x,-this.y)},normalize:function(){const t=this.magnitude;if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXY(Be.roundSymmetric(this.x),Be.roundSymmetric(this.y))},rotate:function(t){const e=this.angle+t,i=this.magnitude;return this.setXY(i*Math.cos(e),i*Math.sin(e))},setPolar:function(t,e){return this.setXY(t*Math.cos(e),t*Math.sin(e))},toStateObject:function(){return{x:this.x,y:this.y}}},{createPolar:function(t,e){return new Ye(0,0).setPolar(t,e)},fromStateObject:function(t){return new Ye(t.x,t.y)},getAngleBetweenVectors:function(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.atan2(n,i)},getDistanceBetweenVectors:function(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}}),Pe.mixInto(Ye,{initialize:Ye.prototype.setXY,defaultArguments:[0,0]}),Ye.Immutable=function(t,e){Ye.call(this,t,e)};const Ue=Ye.Immutable;R(Ye,Ue),Ue.mutableOverrideHelper=function(t){Ue.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},Ue.mutableOverrideHelper("setXY"),Ue.mutableOverrideHelper("setX"),Ue.mutableOverrideHelper("setY"),Ye.ZERO=new Ye(0,0),Ye.X_UNIT=new Ye(1,0),Ye.Y_UNIT=new Ye(0,1);var je=Ye;const We=new pe.Vector2(0,0);function Xe(t,e,i,n){this.minX=t,this.minY=e,this.maxX=i,this.maxY=n}pe.register("Bounds2",Xe),R(Object,Xe,{isBounds:!0,dimension:2,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getLeftTop:function(){return new pe.Vector2(this.minX,this.minY)},get leftTop(){return this.getLeftTop()},getCenterTop:function(){return new pe.Vector2(this.getCenterX(),this.minY)},get centerTop(){return this.getCenterTop()},getRightTop:function(){return new pe.Vector2(this.maxX,this.minY)},get rightTop(){return this.getRightTop()},getLeftCenter:function(){return new pe.Vector2(this.minX,this.getCenterY())},get leftCenter(){return this.getLeftCenter()},getCenter:function(){return new pe.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getRightCenter:function(){return new pe.Vector2(this.maxX,this.getCenterY())},get rightCenter(){return this.getRightCenter()},getLeftBottom:function(){return new pe.Vector2(this.minX,this.maxY)},get leftBottom(){return this.getLeftBottom()},getCenterBottom:function(){return new pe.Vector2(this.getCenterX(),this.maxY)},get centerBottom(){return this.getCenterBottom()},getRightBottom:function(){return new pe.Vector2(this.maxX,this.maxY)},get rightBottom(){return this.getRightBottom()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},closestPointTo:function(t){if(this.containsCoordinates(t.x,t.y))return t;{const e=Math.max(Math.min(t.x,this.maxX),this.x),i=Math.max(Math.min(t.y,this.maxY),this.y);return new je(e,i)}},containsCoordinates:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){const e=Math.max(this.minX,t.minX),i=Math.max(this.minY,t.minY),n=Math.min(this.maxX,t.maxX),s=Math.min(this.maxY,t.maxY);return n-e>=0&&s-i>=0},minimumDistanceToPointSquared:function(t){const e=t.x<this.minX?this.minX:t.x>this.maxX?this.maxX:null,i=t.y<this.minY?this.minY:t.y>this.maxY?this.maxY:null;let n;if(null===e&&null===i)return 0;if(null===e)return n=i-t.y,n*n;if(null===i)return n=e-t.x,n*n;{const n=e-t.x,s=i-t.y;return n*n+s*s}},maximumDistanceToPointSquared:function(t){let e=t.x>this.getCenterX()?this.minX:this.maxX,i=t.y>this.getCenterY()?this.minY:this.maxY;return e-=t.x,i-=t.y,e*e+i*i},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,e){e=void 0!==e?e:0;const i=this.isFinite(),n=t.isFinite();return i&&n?Math.abs(this.minX-t.minX)<e&&Math.abs(this.minY-t.minY)<e&&Math.abs(this.maxX-t.maxX)<e&&Math.abs(this.maxY-t.maxY)<e:i===n&&(this===t||(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<e:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<e:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<e:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<e:this.maxY===t.maxY))},copy:function(t){return t?t.set(this):new Xe(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new Xe(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new Xe(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,e){return new Xe(Math.min(this.minX,t),Math.min(this.minY,e),Math.max(this.maxX,t),Math.max(this.maxY,e))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withX:function(t){return this.copy().addX(t)},withY:function(t){return this.copy().addY(t)},withMinX:function(t){return new Xe(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new Xe(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new Xe(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new Xe(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new Xe(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new Xe(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new Xe(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilatedX:function(t){return new Xe(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilatedY:function(t){return new Xe(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilatedXY:function(t,e){return new Xe(this.minX-t,this.minY-e,this.maxX+t,this.maxY+e)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedXY:function(t,e){return this.dilatedXY(-t,-e)},withOffsets:function(t,e,i,n){return new Xe(this.minX-t,this.minY-e,this.maxX+i,this.maxY+n)},shiftedX:function(t){return new Xe(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new Xe(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,e){return new Xe(this.minX+t,this.minY+e,this.maxX+t,this.maxY+e)},blend:function(t,e){const i=1-e;return new Xe(i*this.minX+e*t.minX,i*this.minY+e*t.minY,i*this.maxX+e*t.maxX,i*this.maxY+e*t.maxY)},setMinMax:function(t,e,i,n){return this.minX=t,this.minY=e,this.maxX=i,this.maxY=n,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},addCoordinates:function(t,e){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,e),Math.max(this.maxX,t),Math.max(this.maxY,e))},addPoint:function(t){return this.addCoordinates(t.x,t.y)},addX:function(t){return this.minX=Math.min(t,this.minX),this.maxX=Math.max(t,this.maxX),this},addY:function(t){return this.minY=Math.min(t,this.minY),this.maxY=Math.max(t,this.maxY),this},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transform:function(t){if(this.isEmpty())return this;if(t.isIdentity())return this;const e=this.minX,i=this.minY,n=this.maxX,s=this.maxY;return this.set(pe.Bounds2.NOTHING),this.addPoint(t.multiplyVector2(We.setXY(e,i))),this.addPoint(t.multiplyVector2(We.setXY(e,s))),this.addPoint(t.multiplyVector2(We.setXY(n,i))),this.addPoint(t.multiplyVector2(We.setXY(n,s))),this},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilateXY:function(t,e){return this.setMinMax(this.minX-t,this.minY-e,this.maxX+t,this.maxY+e)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeXY:function(t,e){return this.dilateXY(-t,-e)},offset:function(t,e,i,n){return new Xe(this.minX-t,this.minY-e,this.maxX+i,this.maxY+n)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.maxX,this.maxY+t)},shift:function(t,e){return this.setMinMax(this.minX+t,this.minY+e,this.maxX+t,this.maxY+e)},getClosestPoint:function(t,e,i){return i?i.setXY(t,e):i=new pe.Vector2(t,e),i.x<this.minX&&(i.x=this.minX),i.x>this.maxX&&(i.x=this.maxX),i.y<this.minY&&(i.y=this.minY),i.y>this.maxY&&(i.y=this.maxY),i}},{rect:function(t,e,i,n){return new Xe(t,e,t+i,e+n)},point:function(t,e){if(t instanceof pe.Vector2){const e=t;return new Xe(e.x,e.y,e.x,e.y)}return new Xe(t,e,t,e)}}),Xe.NOTHING=new Xe(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),Xe.EVERYTHING=new Xe(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Pe.mixInto(Xe,{initialize:Xe.prototype.setMinMax,defaultArguments:[Xe.NOTHING.minX,Xe.NOTHING.minY,Xe.NOTHING.maxX,Xe.NOTHING.maxY]});var Ke=Xe;function Qe(t,e){this.position=t,this.direction=e}pe.register("Ray2",Qe),Qe.prototype={constructor:Qe,shifted:function(t){return new Qe(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},toString:function(){return this.position.toString()+" => "+this.direction.toString()}};var Ze=Qe;const $e=new r("kite");$e.register("svgNumber",(function(t){return t.toFixed(20)}));var Je=$e;const ti=window.Float32Array||Array;function ei(t,e,i,n,s,r,o,a,l,h,u,c,d,f,p,m,g){this.entries=new ti(16),this.rowMajor(void 0!==t?t:1,void 0!==e?e:0,void 0!==i?i:0,void 0!==n?n:0,void 0!==s?s:0,void 0!==r?r:1,void 0!==o?o:0,void 0!==a?a:0,void 0!==l?l:0,void 0!==h?h:0,void 0!==u?u:1,void 0!==c?c:0,void 0!==d?d:0,void 0!==f?f:0,void 0!==p?p:0,void 0!==m?m:1,g)}pe.register("Matrix4",ei),ei.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3,AFFINE:4};const ii=ei.Types;ei.identity=function(){return new ei(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,ii.IDENTITY)},ei.translation=function(t,e,i){return new ei(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1,ii.TRANSLATION_3D)},ei.translationFromVector=function(t){return ei.translation(t.x,t.y,t.z)},ei.scaling=function(t,e,i){return new ei(t,0,0,0,0,e=void 0===e?t:e,0,0,0,0,i=void 0===i?t:i,0,0,0,0,1,ii.SCALING)},ei.rotationAxisAngle=function(t,e){const i=Math.cos(e),n=Math.sin(e),s=1-i;return new ei(t.x*t.x*s+i,t.x*t.y*s-t.z*n,t.x*t.z*s+t.y*n,0,t.y*t.x*s+t.z*n,t.y*t.y*s+i,t.y*t.z*s-t.x*n,0,t.z*t.x*s-t.y*n,t.z*t.y*s+t.x*n,t.z*t.z*s+i,0,0,0,0,1,ii.AFFINE)},ei.rotationX=function(t){const e=Math.cos(t),i=Math.sin(t);return new ei(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1,ii.AFFINE)},ei.rotationY=function(t){const e=Math.cos(t),i=Math.sin(t);return new ei(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1,ii.AFFINE)},ei.rotationZ=function(t){const e=Math.cos(t),i=Math.sin(t);return new ei(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1,ii.AFFINE)},ei.gluPerspective=function(t,e,i,n){const s=Math.cos(t)/Math.sin(t);return new ei(s/e,0,0,0,0,s,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ei.prototype={constructor:ei,rowMajor:function(t,e,i,n,s,r,o,a,l,h,u,c,d,f,p,m,g){return this.entries[0]=t,this.entries[1]=s,this.entries[2]=l,this.entries[3]=d,this.entries[4]=e,this.entries[5]=r,this.entries[6]=h,this.entries[7]=f,this.entries[8]=i,this.entries[9]=o,this.entries[10]=u,this.entries[11]=p,this.entries[12]=n,this.entries[13]=a,this.entries[14]=c,this.entries[15]=m,this.type=void 0===g?0===d&&0===f&&0===p&&1===m?ii.AFFINE:ii.OTHER:g,this},columnMajor:function(t,e,i,n,s,r,o,a,l,h,u,c,d,f,p,m,g){return this.rowMajor(t,s,l,d,e,r,h,f,i,o,u,p,n,a,c,m,g)},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m03(),t.m10(),t.m11(),t.m12(),t.m13(),t.m20(),t.m21(),t.m22(),t.m23(),t.m30(),t.m31(),t.m32(),t.m33(),t.type)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m03())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m13())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())&&isFinite(this.m23())&&isFinite(this.m30())&&isFinite(this.m31())&&isFinite(this.m32())&&isFinite(this.m33())},getTranslation:function(){return new qe(this.m03(),this.m13(),this.m23())},get translation(){return this.getTranslation()},getScaleVector:function(){const t=this.m00()+this.m03(),e=this.m10()+this.m13(),i=this.m20()+this.m23(),n=this.m30()+this.m33(),s=this.m01()+this.m03(),r=this.m11()+this.m13(),o=this.m21()+this.m23(),a=this.m31()+this.m33(),l=this.m02()+this.m03(),h=this.m12()+this.m13(),u=this.m22()+this.m23(),c=this.m32()+this.m33();return new qe(Math.sqrt(t*t+e*e+i*i+n*n),Math.sqrt(s*s+r*r+o*o+a*a),Math.sqrt(l*l+h*h+u*u+c*c))},get scaleVector(){return this.getScaleVector()},getCSSTransform:function(){return"matrix3d("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[2].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[5].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+","+this.entries[8].toFixed(20)+","+this.entries[9].toFixed(20)+","+this.entries[10].toFixed(20)+","+this.entries[11].toFixed(20)+","+this.entries[12].toFixed(20)+","+this.entries[13].toFixed(20)+","+this.entries[14].toFixed(20)+","+this.entries[15].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m03()===t.m03()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m13()===t.m13()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()&&this.m23()===t.m23()&&this.m30()===t.m30()&&this.m31()===t.m31()&&this.m32()===t.m32()&&this.m33()===t.m33()},equalsEpsilon:function(t,e){return Math.abs(this.m00()-t.m00())<e&&Math.abs(this.m01()-t.m01())<e&&Math.abs(this.m02()-t.m02())<e&&Math.abs(this.m03()-t.m03())<e&&Math.abs(this.m10()-t.m10())<e&&Math.abs(this.m11()-t.m11())<e&&Math.abs(this.m12()-t.m12())<e&&Math.abs(this.m13()-t.m13())<e&&Math.abs(this.m20()-t.m20())<e&&Math.abs(this.m21()-t.m21())<e&&Math.abs(this.m22()-t.m22())<e&&Math.abs(this.m23()-t.m23())<e&&Math.abs(this.m30()-t.m30())<e&&Math.abs(this.m31()-t.m31())<e&&Math.abs(this.m32()-t.m32())<e&&Math.abs(this.m33()-t.m33())<e},copy:function(){return new ei(this.m00(),this.m01(),this.m02(),this.m03(),this.m10(),this.m11(),this.m12(),this.m13(),this.m20(),this.m21(),this.m22(),this.m23(),this.m30(),this.m31(),this.m32(),this.m33(),this.type)},plus:function(t){return new ei(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new ei(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new ei(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new ei(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){switch(this.type){case ii.IDENTITY:return this;case ii.TRANSLATION_3D:return new ei(1,0,0,-this.m03(),0,1,0,-this.m13(),0,0,1,-this.m23(),0,0,0,1,ii.TRANSLATION_3D);case ii.SCALING:return new ei(1/this.m00(),0,0,0,0,1/this.m11(),0,0,0,0,1/this.m22(),0,0,0,0,1/this.m33(),ii.SCALING);case ii.AFFINE:case ii.OTHER:var t=this.getDeterminant();if(0!==t)return new ei((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===ii.IDENTITY||t.type===ii.IDENTITY)return this.type===ii.IDENTITY?t:this;if(this.type===t.type){if(this.type===ii.TRANSLATION_3D)return new ei(1,0,0,this.m03()+t.m02(),0,1,0,this.m13()+t.m12(),0,0,1,this.m23()+t.m23(),0,0,0,1,ii.TRANSLATION_3D);if(this.type===ii.SCALING)return new ei(this.m00()*t.m00(),0,0,0,0,this.m11()*t.m11(),0,0,0,0,this.m22()*t.m22(),0,0,0,0,1,ii.SCALING)}return this.type!==ii.OTHER&&t.type!==ii.OTHER?new ei(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23(),0,0,0,1,ii.AFFINE):new ei(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33())},timesVector4:function(t){const e=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,i=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,n=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,s=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new He(e,i,n,s)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){const e=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,i=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,n=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,s=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new He(e,i,n,s)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){const e=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,i=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,n=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new qe(e,i,n)},getDeterminant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},get determinant(){return this.getDeterminant()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}},copyToArray:function(t){return t[0]=this.m00(),t[1]=this.m10(),t[2]=this.m20(),t[3]=this.m30(),t[4]=this.m01(),t[5]=this.m11(),t[6]=this.m21(),t[7]=this.m31(),t[8]=this.m02(),t[9]=this.m12(),t[10]=this.m22(),t[11]=this.m32(),t[12]=this.m03(),t[13]=this.m13(),t[14]=this.m23(),t[15]=this.m33(),t}},ei.IDENTITY=new ei,ei.IDENTITY.makeImmutable();var ni=ei;function si(t){this.entries=[1,0,0,0,1,0,0,0,1],this.type=ri.IDENTITY}pe.register("Matrix3",si),si.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var ri=si.Types;si.identity=function(){return si.dirtyFromPool().setToIdentity()},si.translation=function(t,e){return si.dirtyFromPool().setToTranslation(t,e)},si.translationFromVector=function(t){return si.translation(t.x,t.y)},si.scaling=function(t,e){return si.dirtyFromPool().setToScale(t,e)},si.scale=si.scaling,si.affine=function(t,e,i,n,s,r){return si.dirtyFromPool().setToAffine(t,e,i,n,s,r)},si.rowMajor=function(t,e,i,n,s,r,o,a,l,h){return si.dirtyFromPool().rowMajor(t,e,i,n,s,r,o,a,l,h)},si.rotationAxisAngle=function(t,e){return si.dirtyFromPool().setToRotationAxisAngle(t,e)},si.rotationX=function(t){return si.dirtyFromPool().setToRotationX(t)},si.rotationY=function(t){return si.dirtyFromPool().setToRotationY(t)},si.rotationZ=function(t){return si.dirtyFromPool().setToRotationZ(t)},si.translationRotation=function(t,e,i){return si.dirtyFromPool().setToTranslationRotation(t,e,i)},si.rotation2=si.rotationZ,si.rotationAround=function(t,e,i){return si.translation(e,i).timesMatrix(si.rotation2(t)).timesMatrix(si.translation(-e,-i))},si.rotationAroundPoint=function(t,e){return si.rotationAround(t,e.x,e.y)},si.fromSVGMatrix=function(t){return si.dirtyFromPool().setToSVGMatrix(t)},si.rotateAToB=function(t,e){return si.dirtyFromPool().setRotationAToB(t,e)},si.prototype={constructor:si,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isIdentity:function(){return this.type===ri.IDENTITY||this.equals(si.IDENTITY)},isFastIdentity:function(){return this.type===ri.IDENTITY},isAffine:function(){return this.type===ri.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isAligned:function(){return this.isAffine()&&0===this.m01()&&0===this.m10()},isAxisAligned:function(){return this.isAffine()&&(0===this.m01()&&0===this.m10()||0===this.m00()&&0===this.m11())},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new je(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new je(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){return Math.atan2(this.m10(),this.m00())},get rotation(){return this.getRotation()},toMatrix4:function(){return new ni(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toAffineMatrix4:function(){return new ni(this.m00(),this.m01(),0,this.m02(),this.m10(),this.m11(),0,this.m12(),0,0,1,0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case ri.IDENTITY:return"";case ri.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+t(this.entries[7])+")";case ri.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){const t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,e){return Math.abs(this.m00()-t.m00())<e&&Math.abs(this.m01()-t.m01())<e&&Math.abs(this.m02()-t.m02())<e&&Math.abs(this.m10()-t.m10())<e&&Math.abs(this.m11()-t.m11())<e&&Math.abs(this.m12()-t.m12())<e&&Math.abs(this.m20()-t.m20())<e&&Math.abs(this.m21()-t.m21())<e&&Math.abs(this.m22()-t.m22())<e},copy:function(){return si.createFromPool(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return si.createFromPool(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return si.createFromPool(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return si.createFromPool(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===ri.IDENTITY||this.type===ri.SCALING?this.type:void 0)},negated:function(){return si.createFromPool(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){let t;switch(this.type){case ri.IDENTITY:return this;case ri.TRANSLATION_2D:return si.createFromPool(1,0,-this.m02(),0,1,-this.m12(),0,0,1,ri.TRANSLATION_2D);case ri.SCALING:return si.createFromPool(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),ri.SCALING);case ri.AFFINE:if(t=this.getDeterminant(),0!==t)return si.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,ri.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case ri.OTHER:if(t=this.getDeterminant(),0!==t)return si.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,ri.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===ri.IDENTITY||t.type===ri.IDENTITY)return this.type===ri.IDENTITY?t:this;if(this.type===t.type){if(this.type===ri.TRANSLATION_2D)return si.createFromPool(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,ri.TRANSLATION_2D);if(this.type===ri.SCALING)return si.createFromPool(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,ri.SCALING)}return this.type!==ri.OTHER&&t.type!==ri.OTHER?si.createFromPool(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,ri.AFFINE):si.createFromPool(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){const e=this.m00()*t.x+this.m01()*t.y+this.m02(),i=this.m10()*t.x+this.m11()*t.y+this.m12();return new je(e,i)},timesVector3:function(t){const e=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,i=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,n=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new qe(e,i,n)},timesTransposeVector2:function(t){const e=this.m00()*t.x+this.m10()*t.y,i=this.m01()*t.x+this.m11()*t.y;return new je(e,i)},timesRelativeVector2:function(t){const e=this.m00()*t.x+this.m01()*t.y,i=this.m10()*t.y+this.m11()*t.y;return new je(e,i)},rowMajor:function(t,e,i,n,s,r,o,a,l,h){return this.entries[0]=t,this.entries[1]=n,this.entries[2]=o,this.entries[3]=e,this.entries[4]=s,this.entries[5]=a,this.entries[6]=i,this.entries[7]=r,this.entries[8]=l,this.type=void 0===h?0===o&&0===a&&1===l?ri.AFFINE:ri.OTHER:h,this},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m10(),t.m11(),t.m12(),t.m20(),t.m21(),t.m22(),t.type)},setArray:function(t){return this.rowMajor(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])},set00:function(t){return this.entries[0]=t,this},set01:function(t){return this.entries[3]=t,this},set02:function(t){return this.entries[6]=t,this},set10:function(t){return this.entries[1]=t,this},set11:function(t){return this.entries[4]=t,this},set12:function(t){return this.entries[7]=t,this},set20:function(t){return this.entries[2]=t,this},set21:function(t){return this.entries[5]=t,this},set22:function(t){return this.entries[8]=t,this},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},columnMajor:function(t,e,i,n,s,r,o,a,l,h){return this.rowMajor(t,n,o,e,s,a,i,r,l,h)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===ri.IDENTITY||this.type===ri.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){let t;switch(this.type){case ri.IDENTITY:return this;case ri.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,ri.TRANSLATION_2D);case ri.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),ri.SCALING);case ri.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,ri.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case ri.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,ri.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(t.type===ri.IDENTITY)return this;if(this.type===ri.IDENTITY)return this.set(t);if(this.type===t.type){if(this.type===ri.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,ri.TRANSLATION_2D);if(this.type===ri.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,ri.SCALING)}return this.type!==ri.OTHER&&t.type!==ri.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,ri.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},prependTranslation:function(t,e){return this.set02(this.m02()+t),this.set12(this.m12()+e),this.type===ri.IDENTITY||this.type===ri.TRANSLATION_2D?this.type=ri.TRANSLATION_2D:this.type===ri.OTHER?this.type=ri.OTHER:this.type=ri.AFFINE,this},setToIdentity:function(){return this.rowMajor(1,0,0,0,1,0,0,0,1,ri.IDENTITY)},setToTranslation:function(t,e){return this.rowMajor(1,0,t,0,1,e,0,0,1,ri.TRANSLATION_2D)},setToScale:function(t,e){return e=void 0===e?t:e,this.rowMajor(t,0,0,0,e,0,0,0,1,ri.SCALING)},setToAffine:function(t,e,i,n,s,r){return this.rowMajor(t,e,i,n,s,r,0,0,1,ri.AFFINE)},setToRotationAxisAngle:function(t,e){const i=Math.cos(e),n=Math.sin(e),s=1-i;return this.rowMajor(t.x*t.x*s+i,t.x*t.y*s-t.z*n,t.x*t.z*s+t.y*n,t.y*t.x*s+t.z*n,t.y*t.y*s+i,t.y*t.z*s-t.x*n,t.z*t.x*s-t.y*n,t.z*t.y*s+t.x*n,t.z*t.z*s+i,ri.OTHER)},setToRotationX:function(t){const e=Math.cos(t),i=Math.sin(t);return this.rowMajor(1,0,0,0,e,-i,0,i,e,ri.OTHER)},setToRotationY:function(t){const e=Math.cos(t),i=Math.sin(t);return this.rowMajor(e,0,i,0,1,0,-i,0,e,ri.OTHER)},setToRotationZ:function(t){const e=Math.cos(t),i=Math.sin(t);return this.rowMajor(e,-i,0,i,e,0,0,0,1,ri.AFFINE)},setToTranslationRotation:function(t,e,i){const n=Math.cos(i),s=Math.sin(i);return this.rowMajor(n,-s,t,s,n,e,0,0,1,ri.AFFINE)},setToTranslationRotationPoint:function(t,e){return this.setToTranslationRotation(t.x,t.y,e)},setToSVGMatrix:function(t){return this.rowMajor(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,ri.AFFINE)},setRotationAToB:function(t,e){const i=t,n=e;let s=i.cross(n);const r=i.dot(n);if((r<0?-r:r)>.9999){let t=new qe(i.x>0?i.x:-i.x,i.y>0?i.y:-i.y,i.z>0?i.z:-i.z);t=t.x<t.y?t.x<t.z?qe.X_UNIT:qe.Z_UNIT:t.y<t.z?qe.Y_UNIT:qe.Z_UNIT;const e=t.minus(i);s=t.minus(n);const r=2/e.dot(e),o=2/s.dot(s),a=r*o*e.dot(s);return this.rowMajor(-r*e.x*e.x-o*s.x*s.x+a*s.x*e.x+1,-r*e.x*e.y-o*s.x*s.y+a*s.x*e.y,-r*e.x*e.z-o*s.x*s.z+a*s.x*e.z,-r*e.y*e.x-o*s.y*s.x+a*s.y*e.x,-r*e.y*e.y-o*s.y*s.y+a*s.y*e.y+1,-r*e.y*e.z-o*s.y*s.z+a*s.y*e.z,-r*e.z*e.x-o*s.z*s.x+a*s.z*e.x,-r*e.z*e.y-o*s.z*s.y+a*s.z*e.y,-r*e.z*e.z-o*s.z*s.z+a*s.z*e.z+1)}{const t=1/(1+r),e=t*s.x,i=t*s.z,n=e*s.y,o=e*s.z,a=i*s.y;return this.rowMajor(r+e*s.x,n-s.z,o+s.y,n+s.z,r+t*s.y*s.y,a-s.x,o-s.y,a+s.x,r+i*s.z)}},multiplyVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y+this.m02(),this.m10()*t.x+this.m11()*t.y+this.m12())},multiplyVector3:function(t){return t.setXYZ(this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,this.m20()*t.x+this.m21()*t.y+this.m22()*t.z)},multiplyTransposeVector2:function(t){return t.setXY(this.m00()*t.x+this.m10()*t.y,this.m01()*t.x+this.m11()*t.y)},multiplyRelativeVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y,this.m10()*t.y+this.m11()*t.y)},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==ri.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},copyToArray:function(t){return t[0]=this.m00(),t[1]=this.m10(),t[2]=this.m20(),t[3]=this.m01(),t[4]=this.m11(),t[5]=this.m21(),t[6]=this.m02(),t[7]=this.m12(),t[8]=this.m22(),t}},Pe.mixInto(si,{initialize:si.prototype.rowMajor,useDefaultConstruction:!0,maxSize:300}),si.IDENTITY=si.identity(),si.IDENTITY.makeImmutable(),si.X_REFLECTION=si.createFromPool(-1,0,0,0,1,0,0,0,1,ri.AFFINE),si.X_REFLECTION.makeImmutable(),si.Y_REFLECTION=si.createFromPool(1,0,0,0,-1,0,0,0,1,ri.AFFINE),si.Y_REFLECTION.makeImmutable(),si.translationTimesMatrix=function(t,e,i){let n;return i.type===ri.IDENTITY||i.type===ri.TRANSLATION_2D?si.createFromPool(1,0,i.m02()+t,0,1,i.m12()+e,0,0,1,ri.TRANSLATION_2D):(n=i.type===ri.OTHER?ri.OTHER:ri.AFFINE,si.createFromPool(i.m00(),i.m01(),i.m02()+t,i.m10(),i.m11(),i.m12()+e,i.m20(),i.m21(),i.m22(),n))},si.printer={print:function(t){console.log(t.toString())}},si.toStateObject=function(t){return{entries:t.entries,type:t.type}},si.fromStateObject=function(t){const e=si.identity();return e.entries=t.entries,e.type=t.type,e};var oi=si;const ai=new oi;function li(t){this.matrix=oi.IDENTITY.copy(),this.inverse=oi.IDENTITY.copy(),this.matrixTransposed=oi.IDENTITY.copy(),this.inverseTransposed=oi.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,this.changeEmitter=new C,t&&this.setMatrix(t)}pe.register("Transform3",li),R(Object,li,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},validateMatrix:function(t){},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.changeEmitter.emit()},prepend:function(t){ai.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(ai),this.invalidate()},prependTranslation:function(t,e){this.matrix.prependTranslation(t,e),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){const t=new li(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===oi.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){const e=this.getMatrix();return new je(e.m00()*t.x+e.m01()*t.y,e.m10()*t.x+e.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t).normalize()},transformX:function(t){const e=this.getMatrix();return e.m00()*t+e.m02()},transformY:function(t){const e=this.getMatrix();return e.m11()*t+e.m12()},transformDeltaX:function(t){return this.getMatrix().m00()*t},transformDeltaY:function(t){return this.getMatrix().m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new Ze(this.transformPosition2(t.position),this.transformDelta2(t.direction).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){const e=this.getInverse();return new je(e.m00()*t.x+e.m01()*t.y,e.m10()*t.x+e.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t).normalize()},inverseX:function(t){const e=this.getInverse();return e.m00()*t+e.m02()},inverseY:function(t){const e=this.getInverse();return e.m11()*t+e.m12()},inverseDeltaX:function(t){const e=this.getInverse();return e.m00()*t},inverseDeltaY:function(t){const e=this.getInverse();return e.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new Ze(this.inversePosition2(t.position),this.inverseDelta2(t.direction).normalized())}});var hi=li;function ui(t){if(t){for(;t.length;)t.pop();return t}return[]}a.register("cleanArray",ui);var ci=ui;function di(t,e){this.a=t,this.b=e;let i=0,n=1,s=this.apply(i),r=this.apply(n);s>1&&(s=1,i=this.applyInverse(s)),s<0&&(s=0,i=this.applyInverse(s)),r>1&&(r=1,n=this.applyInverse(r)),r<0&&(r=0,n=this.applyInverse(r)),this.t0=i,this.t1=n,t>0?(this.qt0=s,this.qt1=r):(this.qt0=r,this.qt1=s),this.t0<0&&this.t0>-1e-8&&(this.t0=0),this.t0>1&&this.t0<1+1e-8&&(this.t0=1),this.t1<0&&this.t1>-1e-8&&(this.t1=0),this.t1>1&&this.t1<1+1e-8&&(this.t1=1),this.qt0<0&&this.qt0>-1e-8&&(this.qt0=0),this.qt0>1&&this.qt0<1+1e-8&&(this.qt0=1),this.qt1<0&&this.qt1>-1e-8&&(this.qt1=0),this.qt1>1&&this.qt1<1+1e-8&&(this.qt1=1)}Je.register("Overlap",di),R(Object,di,{apply:function(t){return this.a*t+this.b},applyInverse:function(t){return(t-this.b)/this.a}},{createLinear:function(t,e,i,n){const s=(n-e)/(i-t);return new di(s,e-t*s)}});var fi=Je.Overlap;function pi(t,e,i,n,s){this.point=e,this.normal=i,this.distance=t,this.wind=n,this.t=Be.clamp(s,0,1)}Je.register("RayIntersection",pi),R(Object,pi);var mi=pi;function gi(t,e,i){this.point=t,this.aT=Be.clamp(e,0,1),this.bT=Be.clamp(i,0,1)}Je.register("SegmentIntersection",gi),R(Object,gi,{getSwapped:function(){return new gi(this.point,this.bT,this.aT)}});var yi=gi;function bi(t,e,i,n,s,r,o,a,l,h){this.initialize(t,e,i,n,s,r,o,a,l,h)}Je.register("BoundsIntersection",bi),R(Object,bi,{initialize:function(t,e,i,n,s,r,o,a,l,h){return this.a=t,this.b=e,this.atMin=i,this.atMax=n,this.btMin=s,this.btMax=r,this.aMin=o,this.aMax=a,this.bMin=l,this.bMax=h,this},pushSubdivisions:function(t){const e=(this.atMax+this.atMin)/2,i=(this.btMax+this.btMin)/2;if(e===this.atMin||e===this.atMax||i===this.btMin||i===this.btMax)return void t.push(this);const n=this.a.positionAt(e),s=this.b.positionAt(i);bi.boxIntersects(this.aMin,n,this.bMin,s)&&t.push(bi.createFromPool(this.a,this.b,this.atMin,e,this.btMin,i,this.aMin,n,this.bMin,s)),bi.boxIntersects(n,this.aMax,this.bMin,s)&&t.push(bi.createFromPool(this.a,this.b,e,this.atMax,this.btMin,i,n,this.aMax,this.bMin,s)),bi.boxIntersects(this.aMin,n,s,this.bMax)&&t.push(bi.createFromPool(this.a,this.b,this.atMin,e,i,this.btMax,this.aMin,n,s,this.bMax)),bi.boxIntersects(n,this.aMax,s,this.bMax)&&t.push(bi.createFromPool(this.a,this.b,e,this.atMax,i,this.btMax,n,this.aMax,s,this.bMax)),this.freeToPool()},distance:function(t){const e=this.atMin-t.atMin,i=this.atMax-t.atMax,n=this.btMin-t.btMin,s=this.btMax-t.btMax;return e*e+i*i+n*n+s*s},clean:function(){this.a=null,this.b=null,this.aMin=null,this.aMax=null,this.bMin=null,this.bMax=null}},{intersect:function(t,e){if(!t.bounds.intersectsBounds(e.bounds))return[];const i=bi.getIntersectionRanges(t,e),n=[];for(var s=0;s<i.length;s++){const t=i[s];let e=!1;t:for(var r=0;r<n.length;r++){var o=n[r];for(let i=0;i<o.length;i++){const n=o[i];if(t.distance(n)<1e-13){o.push(t),e=!0;break t}}}e||n.push([t])}const a=[];for(s=0;s<n.length;s++){o=n[s];let i=0,l=0;for(r=0;r<o.length;r++)i+=o[r].atMin+o[r].atMax,l+=o[r].btMin+o[r].btMax;i/=2*o.length,l/=2*o.length;const h=t.positionAt(i),u=e.positionAt(l);a.push(new yi(h.average(u),i,l))}for(s=0;s<i.length;s++)i[s].freeToPool();return bi.cleanPool(),a},getIntersectionRanges:function(t,e){const i=t.getInteriorExtremaTs(),n=e.getInteriorExtremaTs(),s=_.zip([0].concat(i),i.concat([1])),r=_.zip([0].concat(n),n.concat([1]));let o=[];for(var a=0;a<s.length;a++)for(var l=0;l<r.length;l++){const i=s[a][0],n=s[a][1],h=r[l][0],u=r[l][1],c=t.positionAt(i),d=t.positionAt(n),f=e.positionAt(h),p=e.positionAt(u);bi.boxIntersects(c,d,f,p)&&o.push(bi.createFromPool(t,e,i,n,h,u,c,d,f,p))}for(a=0;a<50;a++){const t=[];for(l=o.length-1;l>=0;l--)o[l].pushSubdivisions(t);o=t}return o},boxIntersects:function(t,e,i,n){const s=Math.max(Math.min(t.x,e.x),Math.min(i.x,n.x)),r=Math.max(Math.min(t.y,e.y),Math.min(i.y,n.y)),o=Math.min(Math.max(t.x,e.x),Math.max(i.x,n.x)),a=Math.min(Math.max(t.y,e.y),Math.max(i.y,n.y));return o-s>=0&&a-r>=0},cleanPool:function(){for(let t=0;t<bi.pool.length;t++)bi.pool[t].clean()}}),Pe.mixInto(bi,{initialize:bi.prototype.initialize});var vi=bi;function _i(){this.invalidationEmitter=new C}Je.register("Segment",_i);const wi=function(t){return t};function Ai(t){return t.getSwapped()}R(Object,_i,{areStrokedBoundsDilated:function(){return Math.abs(this.startTangent.x*this.startTangent.y)<1e-7&&Math.abs(this.endTangent.x*this.endTangent.y)<1e-7},getBoundsWithTransform:function(t){return this.transformed(t).getBounds()},slice:function(t,e){let i=this;return e<1&&(i=i.subdivided(e)[0]),t>0&&(i=i.subdivided(Be.linear(0,e,0,1,t))[1]),i},subdivisions:function(t){let e=this;const i=[];for(let n=0;n<t.length;n++){const s=t[n],r=e.subdivided(s);i.push(r[0]),e=r[1];for(let e=n+1;e<t.length;e++)t[e]=Be.linear(s,1,0,1,t[e])}return i.push(e),i},subdividedIntoMonotone:function(){return this.subdivisions(this.getInteriorExtremaTs())},isSufficientlyFlat:function(t,e){const i=this.start,n=this.positionAt(.5),s=this.end;return _i.isSufficientlyFlat(t,e,i,n,s)},getArcLength:function(t,e,i){if(t=void 0===t?1e-10:t,e=void 0===e?1e-8:e,(i=void 0===i?15:i)<=0||this.isSufficientlyFlat(t,e))return this.start.distance(this.end);{const n=this.subdivided(.5);return n[0].getArcLength(t,e,i-1)+n[1].getArcLength(t,e,i-1)}},getDashValues:function(t,e,i,n){const s=this,r=[];let o=0;const a=_.sum(t);(e%=a)<0&&(e+=a);let l=0,h=0,u=!0;function c(){l=(l+1)%t.length,u=!u}for(;e>0;)e>=t[l]?(e-=t[l],c()):(h=e,e=0);const d=u;return function e(a,u,d,f,p){const m=(a+u)/2,g=s.positionAt(m);if(p>14||_i.isSufficientlyFlat(i,n,d,g,f)){const e=d.distance(g)+g.distance(f);o+=e;let i=e;for(;h+i>=t[l];){const n=Be.linear(0,e,a,u,e-i+t[l]-h);r.push(n),i-=t[l]-h,h=0,c()}h+=i}else e(a,m,d,g,p+1),e(m,u,g,f,p+1)}(0,1,this.start,this.end,0),{values:r,arcLength:o,initiallyInside:d}},toPiecewiseLinearSegments:function(t,e,i,n,s,r){e=void 0===e?t.minLevels:e,i=void 0===i?t.maxLevels:i,n=n||[];const o=t.pointMap||wi;s=s||o(this.start),r=r||o(this.end);const a=o(this.positionAt(.5));let l=0===i;if(!l&&e<=0&&(l=this.isSufficientlyFlat(null===t.distanceEpsilon?Number.POSITIVE_INFINITY:t.distanceEpsilon,null===t.curveEpsilon?Number.POSITIVE_INFINITY:t.curveEpsilon)),l)n.push(new Je.Line(s,r));else{const o=this.subdivided(.5);o[0].toPiecewiseLinearSegments(t,e-1,i-1,n,s,a),o[1].toPiecewiseLinearSegments(t,e-1,i-1,n,a,r)}return n},toPiecewiseLinearOrArcSegments:function(t){t=h({minLevels:2,maxLevels:7,curvatureThreshold:.02,errorThreshold:10,errorPoints:[.25,.75]},t);const e=[];return this.toPiecewiseLinearOrArcRecursion(t,t.minLevels,t.maxLevels,e,0,1,this.positionAt(0),this.positionAt(1),this.curvatureAt(0),this.curvatureAt(1)),e},toPiecewiseLinearOrArcRecursion:function(t,e,i,n,s,r,o,a,l,h){const u=(s+r)/2,c=this.positionAt(u),d=this.curvatureAt(u);if(i<=0||e<=0&&Math.abs(l-d)+Math.abs(d-h)<2*t.curvatureThreshold){const e=Je.Arc.createFromPoints(o,c,a);let i=!1;if(e instanceof Je.Arc){const n=e.radius*e.radius;for(let o=0;o<t.errorPoints.length;o++){const a=t.errorPoints[o],l=this.positionAt(s*(1-a)+r*a);if(Math.abs(l.distanceSquared(e.center)-n)>t.errorThreshold){i=!0;break}}}if(!i)return void n.push(e)}this.toPiecewiseLinearOrArcRecursion(t,e-1,i-1,n,s,u,o,c,l,d),this.toPiecewiseLinearOrArcRecursion(t,e-1,i-1,n,u,r,c,a,d,h)},toShape:function(){return new Je.Shape([new Je.Subpath([this])])}}),_i.closestToPoint=function(t,e,i){const n=i*i;let s=[],r=[],o=Number.POSITIVE_INFINITY,a=!1;for(_.each(t,(function(t){if(t.explicitClosestToPoint){const i=t.explicitClosestToPoint(e);_.each(i,(function(t){t.distanceSquared<o?(r=[t],o=t.distanceSquared):t.distanceSquared===o&&r.push(t)}))}else{const i=[0].concat(t.getInteriorExtremaTs()).concat([1]);for(let n=0;n<i.length-1;n++){const a=i[n],l=i[n+1],h=t.positionAt(a),u=t.positionAt(l),c=Ke.point(h).addPoint(u),d=c.minimumDistanceToPointSquared(e);if(d<=o){const i=c.maximumDistanceToPointSquared(e);i<o&&(o=i,r=[]),s.push({ta:a,tb:l,pa:h,pb:u,segment:t,bounds:c,min:d,max:i})}}}}));s.length&&!a;){const t=s;s=[],a=!0,_.each(t,(function(t){if(t.minDistanceSquared>o)return;a&&t.pa.distanceSquared(t.pb)>n&&(a=!1);const i=(t.ta+t.tb)/2,l=t.segment.positionAt(i),h=Ke.point(t.pa).addPoint(l),u=Ke.point(t.pb).addPoint(l),c=h.minimumDistanceToPointSquared(e),d=u.minimumDistanceToPointSquared(e);if(c<=o){const n=h.maximumDistanceToPointSquared(e);n<o&&(o=n,r=[]),s.push({ta:t.ta,tb:i,pa:t.pa,pb:l,segment:t.segment,bounds:h,min:c,max:n})}if(d<=o){const n=u.maximumDistanceToPointSquared(e);n<o&&(o=n,r=[]),s.push({ta:i,tb:t.tb,pa:l,pb:t.pb,segment:t.segment,bounds:u,min:d,max:n})}}))}return _.each(s,(function(t){const i=(t.ta+t.tb)/2,n=t.segment.positionAt(i);r.push({segment:t.segment,t:i,closestPoint:n,distanceSquared:e.distanceSquared(n)})})),r},_i.polynomialGetOverlapCubic=function(t,e,i,n,s,r,o,a){if(0===a)return _i.polynomialGetOverlapQuadratic(t,e,i,s,r,o);const l=Math.sign(n/a)*Math.pow(Math.abs(n/a),1/3);return 0===l?null:{a:l,b:(i-l*l*o)/(3*l*l*a)}},_i.polynomialGetOverlapQuadratic=function(t,e,i,n,s,r){if(0===r)return _i.polynomialGetOverlapLinear(t,e,n,s);if(i/r<0)return null;const o=Math.sqrt(i/r);return 0===o?null:{a:o,b:(e-o*s)/(2*o*r)}},_i.polynomialGetOverlapLinear=function(t,e,i,n){if(0===n)return t===i||null;const s=e/n;return 0===s?null:{a:s,b:(t-i)/n}},_i.clipOverlap=function(t){},_i.intersect=function(t,e){return Je.Line&&t instanceof Je.Line&&e instanceof Je.Line?Je.Line.intersect(t,e):Je.Line&&t instanceof Je.Line?Je.Line.intersectOther(t,e):Je.Line&&e instanceof Je.Line?Je.Line.intersectOther(e,t).map(Ai):Je.Arc&&t instanceof Je.Arc&&e instanceof Je.Arc?Je.Arc.intersect(t,e):vi.intersect(t,e)},_i.deserialize=function(t){return Je[t.type].deserialize(t)},_i.isSufficientlyFlat=function(t,e,i,n,s){return!(Be.distToSegmentSquared(n,i,s)/i.distanceSquared(s)>e)&&!(Be.distToSegmentSquared(n,i,s)>t)};var xi=_i;const Ti=new je(0,0);function Si(t,e){xi.call(this),this._start=t,this._end=e,this.invalidate()}Je.register("Line",Si),R(xi,Si,{setStart:function(t){return this._start.equals(t)||(this._start=t,this.invalidate()),this},set start(t){this.setStart(t)},getStart:function(){return this._start},get start(){return this.getStart()},setEnd:function(t){return this._end.equals(t)||(this._end=t,this.invalidate()),this},set end(t){this.setEnd(t)},getEnd:function(){return this._end},get end(){return this.getEnd()},positionAt:function(t){return this._start.plus(this._end.minus(this._start).times(t))},tangentAt:function(t){return this.getStartTangent()},curvatureAt:function(t){return 0},subdivided:function(t){if(0===t||1===t)return[this];const e=this.positionAt(t);return[new Je.Line(this._start,e),new Je.Line(e,this._end)]},invalidate:function(){this._tangent=null,this._bounds=null,this._svgPathFragment=null,this.invalidationEmitter.emit()},getStartTangent:function(){return null===this._tangent&&(this._tangent=this._end.minus(this._start).normalized()),this._tangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return this.getStartTangent()},get endTangent(){return this.getEndTangent()},getBounds:function(){return null===this._bounds&&(this._bounds=Ke.NOTHING.copy().addPoint(this._start).addPoint(this._end)),this._bounds},get bounds(){return this.getBounds()},getBoundsWithTransform:function(t){const e=Ke.NOTHING.copy();return e.addPoint(t.multiplyVector2(Ti.set(this._start))),e.addPoint(t.multiplyVector2(Ti.set(this._end))),e},getNondegenerateSegments:function(){return this._start.equals(this._end)?[]:[this]},getSVGPathFragment:function(){return this._svgPathFragment||(this._svgPathFragment="L "+Je.svgNumber(this._end.x)+" "+Je.svgNumber(this._end.y)),this._svgPathFragment},strokeLeft:function(t){const e=this.getEndTangent().perpendicular.negated().times(t/2);return[new Je.Line(this._start.plus(e),this._end.plus(e))]},strokeRight:function(t){const e=this.getStartTangent().perpendicular.times(t/2);return[new Je.Line(this._end.plus(e),this._start.plus(e))]},getInteriorExtremaTs:function(){return[]},intersection:function(t){const e=[],i=this._start,n=this._end.minus(i);if(0===n.magnitudeSquared)return e;const s=t.direction.y*n.x-t.direction.x*n.y;if(0===s)return e;const r=(t.direction.x*(i.y-t.position.y)-t.direction.y*(i.x-t.position.x))/s;if(r<0||r>=1)return e;const o=(n.x*(i.y-t.position.y)-n.y*(i.x-t.position.x))/s;if(o<1e-8)return e;const a=n.perpendicular,l=i.plus(n.times(r)),h=(a.dot(t.direction)>0?a.negated():a).normalized(),u=t.direction.perpendicular.dot(n)<0?1:-1;return e.push(new mi(o,l,h,u,r)),e},windingIntersection:function(t){const e=this.intersection(t);return e.length?e[0].wind:0},writeToContext:function(t){t.lineTo(this._end.x,this._end.y)},transformed:function(t){return new Je.Line(t.timesVector2(this._start),t.timesVector2(this._end))},explicitClosestToPoint:function(t){const e=this._end.minus(this._start);let i=t.minus(this._start).dot(e)/e.magnitudeSquared;i=Be.clamp(i,0,1);const n=this.positionAt(i);return[{segment:this,t:i,closestPoint:n,distanceSquared:t.distanceSquared(n)}]},getSignedAreaFragment:function(){return.5*(this._start.x*this._end.y-this._start.y*this._end.x)},reparameterized:function(t,e){return new Je.Line(this.positionAt(e),this.positionAt(t+e))},reversed:function(){return new Je.Line(this._end,this._start)},polarToCartesian:function(t){return this._start.x===this._end.x?[new Je.Line(je.createPolar(this._start.y,this._start.x),je.createPolar(this._end.y,this._end.x))]:this._start.y===this._end.y?[new Je.Arc(je.ZERO,this._start.y,this._start.x,this._end.x,this._start.x>this._end.x)]:this.toPiecewiseLinearSegments(t)},getArcLength:function(){return this.start.distance(this.end)},toPiecewiseLinearOrArcSegments:function(){return[this]},serialize:function(){return{type:"Line",startX:this._start.x,startY:this._start.y,endX:this._end.x,endY:this._end.y}}}),Si.deserialize=function(t){return new Si(new je(t.startX,t.startY),new je(t.endX,t.endY))},Si.getOverlaps=function(t,e,i=1e-6){const n=[],s=t._start.x,r=-1*t._start.x+t._end.x,o=t._start.y,a=-1*t._start.y+t._end.y,l=e._start.x,h=-1*e._start.x+e._end.x,u=e._start.y,c=-1*e._start.y+e._end.y,d=Math.abs(Math.max(t._start.x,t._end.x,e._start.x,e._end.x)-Math.min(t._start.x,t._end.x,e._start.x,e._end.x)),f=Math.abs(Math.max(t._start.y,t._end.y,e._start.y,e._end.y)-Math.min(t._start.y,t._end.y,e._start.y,e._end.y)),p=xi.polynomialGetOverlapLinear(s,r,l,h),m=xi.polynomialGetOverlapLinear(o,a,u,c);let g;if(g=d>f?null===p||!0===p?m:p:null===m||!0===m?p:m,null===g||!0===g)return n;const y=g.a,b=g.b,v=l+b*h-s,_=y*h-r,w=u+b*c-o,A=y*c-a;if(Math.abs(v)>i||Math.abs(_+v)>i||Math.abs(w)>i||Math.abs(A+w)>i)return n;const x=y+b;return b>1&&x>1||b<0&&x<0?n:[new fi(y,b)]},Si.intersect=function(t,e){const i=Be.lineSegmentIntersection(t.start.x,t.start.y,t.end.x,t.end.y,e.start.x,e.start.y,e.end.x,e.end.y);if(null!==i){const n=t.explicitClosestToPoint(i)[0].t,s=e.explicitClosestToPoint(i)[0].t;return[new yi(i,n,s)]}return[]},Si.intersectOther=function(t,e){const i=t.end.minus(t.start),n=i.magnitude,s=new Ze(t.start,i.normalize()),r=e.intersection(s),o=[];for(let a=0;a<r.length;a++){const t=r[a],e=t.distance/n;e>1e-8&&e<1-1e-8&&o.push(new yi(t.point,e,t.t))}return o};var Di=Si;const Ei=2*Math.PI;function Ci(t,e,i,n,s){xi.call(this),this._center=t,this._radius=e,this._startAngle=i,this._endAngle=n,this._anticlockwise=s,this.invalidate()}Je.register("Arc",Ci),R(xi,Ci,{setCenter:function(t){return this._center.equals(t)||(this._center=t,this.invalidate()),this},set center(t){this.setCenter(t)},getCenter:function(){return this._center},get center(){return this.getCenter()},setRadius:function(t){return this._radius!==t&&(this._radius=t,this.invalidate()),this},set radius(t){this.setRadius(t)},getRadius:function(){return this._radius},get radius(){return this.getRadius()},setStartAngle:function(t){return this._startAngle!==t&&(this._startAngle=t,this.invalidate()),this},set startAngle(t){this.setStartAngle(t)},getStartAngle:function(){return this._startAngle},get startAngle(){return this.getStartAngle()},setEndAngle:function(t){return this._endAngle!==t&&(this._endAngle=t,this.invalidate()),this},set endAngle(t){this.setEndAngle(t)},getEndAngle:function(){return this._endAngle},get endAngle(){return this.getEndAngle()},setAnticlockwise:function(t){return this._anticlockwise!==t&&(this._anticlockwise=t,this.invalidate()),this},set anticlockwise(t){this.setAnticlockwise(t)},getAnticlockwise:function(){return this._anticlockwise},get anticlockwise(){return this.getAnticlockwise()},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(t){return(this._anticlockwise?-1:1)/this._radius},subdivided:function(t){if(0===t||1===t)return[this];const e=this.angleAt(0),i=this.angleAt(t),n=this.angleAt(1);return[new Je.Arc(this._center,this._radius,e,i,this._anticlockwise),new Je.Arc(this._center,this._radius,i,n,this._anticlockwise)]},invalidate:function(){this._start=null,this._end=null,this._startTangent=null,this._endTangent=null,this._actualEndAngle=null,this._isFullPerimeter=null,this._angleDifference=null,this._bounds=null,this._svgPathFragment=null,this._radius<0&&(this._radius=-this._radius,this._startAngle+=Math.PI,this._endAngle+=Math.PI),this.invalidationEmitter.emit()},getStart:function(){return null===this._start&&(this._start=this.positionAtAngle(this._startAngle)),this._start},get start(){return this.getStart()},getEnd:function(){return null===this._end&&(this._end=this.positionAtAngle(this._endAngle)),this._end},get end(){return this.getEnd()},getStartTangent:function(){return null===this._startTangent&&(this._startTangent=this.tangentAtAngle(this._startAngle)),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return null===this._endTangent&&(this._endTangent=this.tangentAtAngle(this._endAngle)),this._endTangent},get endTangent(){return this.getEndTangent()},getActualEndAngle:function(){return null===this._actualEndAngle&&(this._actualEndAngle=Ci.computeActualEndAngle(this._startAngle,this._endAngle,this._anticlockwise)),this._actualEndAngle},get actualEndAngle(){return this.getActualEndAngle()},getIsFullPerimeter:function(){return null===this._isFullPerimeter&&(this._isFullPerimeter=!this._anticlockwise&&this._endAngle-this._startAngle>=2*Math.PI||this._anticlockwise&&this._startAngle-this._endAngle>=2*Math.PI),this._isFullPerimeter},get isFullPerimeter(){return this.getIsFullPerimeter()},getAngleDifference:function(){return null===this._angleDifference&&(this._angleDifference=this._anticlockwise?this._startAngle-this._endAngle:this._endAngle-this._startAngle,this._angleDifference<0&&(this._angleDifference+=2*Math.PI)),this._angleDifference},get angleDifference(){return this.getAngleDifference()},getBounds:function(){return null===this._bounds&&(this._bounds=Ke.NOTHING.copy().withPoint(this.getStart()).withPoint(this.getEnd()),this._startAngle!==this._endAngle&&(this.includeBoundsAtAngle(0),this.includeBoundsAtAngle(Math.PI/2),this.includeBoundsAtAngle(Math.PI),this.includeBoundsAtAngle(3*Math.PI/2))),this._bounds},get bounds(){return this.getBounds()},getNondegenerateSegments:function(){return this._radius<=0||this._startAngle===this._endAngle?[]:[this]},includeBoundsAtAngle:function(t){this.containsAngle(t)&&(this._bounds=this._bounds.withPoint(this._center.plus(je.createPolar(this._radius,t))))},mapAngle:function(t){return Math.abs(Be.moduloBetweenDown(t-this._startAngle,-Math.PI,Math.PI))<1e-8?this._startAngle:Math.abs(Be.moduloBetweenDown(t-this.getActualEndAngle(),-Math.PI,Math.PI))<1e-8?this.getActualEndAngle():this._startAngle>this.getActualEndAngle()?Be.moduloBetweenUp(t,this._startAngle-2*Math.PI,this._startAngle):Be.moduloBetweenDown(t,this._startAngle,this._startAngle+2*Math.PI)},tAtAngle:function(t){const e=(this.mapAngle(t)-this._startAngle)/(this.getActualEndAngle()-this._startAngle);return e},angleAt:function(t){return this._startAngle+(this.getActualEndAngle()-this._startAngle)*t},positionAtAngle:function(t){return this._center.plus(je.createPolar(this._radius,t))},tangentAtAngle:function(t){const e=je.createPolar(1,t);return this._anticlockwise?e.perpendicular:e.perpendicular.negated()},containsAngle:function(t){const e=this._anticlockwise?t-this._endAngle:t-this._startAngle;return Be.moduloBetweenDown(e,0,2*Math.PI)<=this.angleDifference},getSVGPathFragment:function(){if(!this._svgPathFragment){const t=.01,e=this._anticlockwise?"0":"1";let i;if(this.angleDifference<2*Math.PI-t)i=this.angleDifference<Math.PI?"0":"1",this._svgPathFragment="A "+Je.svgNumber(this._radius)+" "+Je.svgNumber(this._radius)+" 0 "+i+" "+e+" "+Je.svgNumber(this.end.x)+" "+Je.svgNumber(this.end.y);else{const t=(this._startAngle+this._endAngle)/2,n=this._center.plus(je.createPolar(this._radius,t));i="0";const s="A "+Je.svgNumber(this._radius)+" "+Je.svgNumber(this._radius)+" 0 "+i+" "+e+" "+Je.svgNumber(n.x)+" "+Je.svgNumber(n.y),r="A "+Je.svgNumber(this._radius)+" "+Je.svgNumber(this._radius)+" 0 "+i+" "+e+" "+Je.svgNumber(this.end.x)+" "+Je.svgNumber(this.end.y);this._svgPathFragment=s+" "+r}}return this._svgPathFragment},strokeLeft:function(t){return[new Je.Arc(this._center,this._radius+(this._anticlockwise?1:-1)*t/2,this._startAngle,this._endAngle,this._anticlockwise)]},strokeRight:function(t){return[new Je.Arc(this._center,this._radius+(this._anticlockwise?-1:1)*t/2,this._endAngle,this._startAngle,!this._anticlockwise)]},getInteriorExtremaTs:function(){const t=this,e=[];return _.each([0,Math.PI/2,Math.PI,3*Math.PI/2],(function(i){if(t.containsAngle(i)){const n=t.tAtAngle(i),s=1e-10;n>s&&n<1-s&&e.push(n)}})),e.sort()},intersection:function(t){const e=[],i=t.position.minus(this._center),n=t.direction.dot(i),s=4*n*n-4*(i.magnitudeSquared-this._radius*this._radius);if(s<0)return e;const r=t.direction.dot(this._center)-t.direction.dot(t.position),o=Math.sqrt(s)/2,a=r-o,l=r+o;if(l<0)return e;const h=t.pointAtDistance(l),u=h.minus(this._center).normalized(),c=u.angle;if(a<0)this.containsAngle(c)&&e.push(new mi(l,h,u.negated(),this._anticlockwise?-1:1,this.tAtAngle(c)));else{const i=t.pointAtDistance(a),n=i.minus(this._center).normalized(),s=n.angle;this.containsAngle(s)&&e.push(new mi(a,i,n,this._anticlockwise?1:-1,this.tAtAngle(s))),this.containsAngle(c)&&e.push(new mi(l,h,u.negated(),this._anticlockwise?-1:1,this.tAtAngle(c)))}return e},windingIntersection:function(t){let e=0;const i=this.intersection(t);return _.each(i,(function(t){e+=t.wind})),e},writeToContext:function(t){t.arc(this._center.x,this._center.y,this._radius,this._startAngle,this._endAngle,this._anticlockwise)},transformed:function(t){const e=t.timesVector2(je.createPolar(1,this._startAngle)).minus(t.timesVector2(je.ZERO)).angle;let i=t.timesVector2(je.createPolar(1,this._endAngle)).minus(t.timesVector2(je.ZERO)).angle;const n=t.getDeterminant()>=0?this._anticlockwise:!this._anticlockwise;Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(i=n?e-2*Math.PI:e+2*Math.PI);const s=t.getScaleVector();if(s.x!==s.y){const r=s.x*this._radius,o=s.y*this._radius;return new Je.EllipticalArc(t.timesVector2(this._center),r,o,0,e,i,n)}{const r=s.x*this._radius;return new Je.Arc(t.timesVector2(this._center),r,e,i,n)}},getSignedAreaFragment:function(){const t=this._startAngle,e=this.getActualEndAngle();return.5*this._radius*(this._radius*(e-t)+this._center.x*(Math.sin(e)-Math.sin(t))-this._center.y*(Math.cos(e)-Math.cos(t)))},reversed:function(){return new Je.Arc(this._center,this._radius,this._endAngle,this._startAngle,!this._anticlockwise)},getArcLength:function(){return this.getAngleDifference()*this._radius},toPiecewiseLinearOrArcSegments:function(){return[this]},serialize:function(){return{type:"Arc",centerX:this._center.x,centerY:this._center.y,radius:this._radius,startAngle:this._startAngle,endAngle:this._endAngle,anticlockwise:this._anticlockwise}}}),Ci.deserialize=function(t){return new Ci(new je(t.centerX,t.centerY),t.radius,t.startAngle,t.endAngle,t.anticlockwise)},Ci.computeActualEndAngle=function(t,e,i){return i?t>e?e:t<e?e-2*Math.PI:t:t<e?e:t>e?e+2*Math.PI:t},Ci.getPartialOverlap=function(t,e,i,n,s){const r=i<e,o=r?e:i,a=r?i:e,l=Math.min(t,o);return l<a+1e-8?[]:[fi.createLinear(Be.clamp(Be.linear(0,t,0,1,a),0,1),Be.clamp(Be.linear(e,i,n,s,a),0,1),Be.clamp(Be.linear(0,t,0,1,l),0,1),Be.clamp(Be.linear(e,i,n,s,l),0,1))]},Ci.getAngularOverlaps=function(t,e,i,n){let s=e-t;const r=s<0?-1:1;s*=r;const o=Be.moduloBetweenDown(r*(i-t),0,Ei),a=r*(n-i)+o;let l;return a<-1e-10?(l=-o/(a-o),Ci.getPartialOverlap(s,o,0,0,l).concat(Ci.getPartialOverlap(s,Ei,a+Ei,l,1))):a>Ei+1e-10?(l=(Ei-o)/(a-o),Ci.getPartialOverlap(s,o,Ei,0,l).concat(Ci.getPartialOverlap(s,0,a-Ei,l,1))):Ci.getPartialOverlap(s,o,a,0,1)},Ci.getOverlaps=function(t,e){return t._center.distance(e._center)>1e-8||Math.abs(t._radius-e._radius)>1e-8?[]:Ci.getAngularOverlaps(t._startAngle,t.getActualEndAngle(),e._startAngle,e.getActualEndAngle())},Ci.getCircleIntersectionPoint=function(t,e,i,n){const s=i.minus(t),r=s.magnitude;let o=[];if(r<1e-10||r>e+n+1e-10);else if(r>e+n-1e-10)o=[t.blend(i,e/r)];else{const a=.5*(r*r-n*n+e*e)/r,l=r*r-n*n+e*e,h=4*r*r*e*e-l*l,u=t.blend(i,a/r);if(h>=1e-10){const t=Math.sqrt(h)/r/2,e=s.perpendicular.setMagnitude(t);o=[u.plus(e),u.minus(e)]}else h>-1e-10&&(o=[u])}return o},Ci.intersect=function(t,e){const i=Ci.getCircleIntersectionPoint(t._center,t._radius,e._center,e._radius),n=[];for(let s=0;s<i.length;s++){const r=i[s],o=r.minus(t._center).angle,a=r.minus(e._center).angle;t.containsAngle(o)&&e.containsAngle(a)&&n.push(new yi(r,t.tAtAngle(o),e.tAtAngle(a)))}return n},Ci.createFromPoints=function(t,e,i){const n=Be.circleCenterFromPoints(t,e,i);if(null===n)return new Di(t,i);{const s=t.minus(n),r=e.minus(n),o=i.minus(n),a=s.angle,l=r.angle,h=o.angle,u=(s.magnitude+r.magnitude+o.magnitude)/3,c=new Ci(n,u,a,h,!1);return c.containsAngle(l)?c:new Ci(n,u,a,h,!0)}};var Ii=Ci;const Pi=Be.solveQuadraticRootsReal,ki=Be.arePointsCollinear;function Li(t){return t>=0&&t<=1}function Oi(t,e,i){xi.call(this),this._start=t,this._control=e,this._end=i,this.invalidate()}Je.register("Quadratic",Oi),R(xi,Oi,{degree:2,setStart:function(t){return this._start.equals(t)||(this._start=t,this.invalidate()),this},set start(t){this.setStart(t)},getStart:function(){return this._start},get start(){return this.getStart()},setControl:function(t){return this._control.equals(t)||(this._control=t,this.invalidate()),this},set control(t){this.setControl(t)},getControl:function(){return this._control},get control(){return this.getControl()},setEnd:function(t){return this._end.equals(t)||(this._end=t,this.invalidate()),this},set end(t){this.setEnd(t)},getEnd:function(){return this._end},get end(){return this.getEnd()},positionAt:function(t){const e=1-t;return this._start.times(e*e).plus(this._control.times(2*e*t)).plus(this._end.times(t*t))},tangentAt:function(t){return this._control.minus(this._start).times(2*(1-t)).plus(this._end.minus(this._control).times(2*t))},curvatureAt:function(t){if(Math.abs(t-.5)>.5-1e-7){const e=t<.5,i=e?this._start:this._end,n=this._control,s=e?this._end:this._start,r=n.minus(i),o=r.magnitude;return(e?-1:1)*r.perpendicular.normalized().dot(s.minus(n))*(this.degree-1)/(this.degree*o*o)}return this.subdivided(t,!0)[0].curvatureAt(1)},subdivided:function(t){if(0===t||1===t)return[this];const e=this._start.blend(this._control,t),i=this._control.blend(this._end,t),n=e.blend(i,t);return[new Je.Quadratic(this._start,e,n),new Je.Quadratic(n,i,this._end)]},invalidate:function(){this._startTangent=null,this._endTangent=null,this._tCriticalX=null,this._tCriticalY=null,this._bounds=null,this._svgPathFragment=null,this.invalidationEmitter.emit()},getStartTangent:function(){if(null===this._startTangent){const t=this._start.equals(this._control);this._startTangent=t?this._end.minus(this._start).normalized():this._control.minus(this._start).normalized()}return this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){if(null===this._endTangent){const t=this._end.equals(this._control);this._endTangent=t?this._end.minus(this._start).normalized():this._end.minus(this._control).normalized()}return this._endTangent},get endTangent(){return this.getEndTangent()},getTCriticalX:function(){return null===this._tCriticalX&&(this._tCriticalX=Oi.extremaT(this._start.x,this._control.x,this._end.x)),this._tCriticalX},get tCriticalX(){return this.getTCriticalX()},getTCriticalY:function(){return null===this._tCriticalY&&(this._tCriticalY=Oi.extremaT(this._start.y,this._control.y,this._end.y)),this._tCriticalY},get tCriticalY(){return this.getTCriticalY()},getNondegenerateSegments:function(){const t=this._start,e=this._control,i=this._end,n=t.equals(i),s=t.equals(e),r=t.equals(e);if(n&&s)return[];if(n){const e=this.positionAt(.5);return[new Je.Line(t,e),new Je.Line(e,i)]}if(ki(t,e,i)){if(s||r)return[new Je.Line(t,i)];const n=i.minus(t),o=e.minus(t).dot(n.normalized)/n.magnitude,a=Oi.extremaT(0,o,1);if(!isNaN(a)&&a>0&&a<1){const e=this.positionAt(a);return _.flatten([new Je.Line(t,e).getNondegenerateSegments(),new Je.Line(e,i).getNondegenerateSegments()])}return[new Je.Line(t,i)]}return[this]},getBounds:function(){if(null===this._bounds){this._bounds=new Ke(Math.min(this._start.x,this._end.x),Math.min(this._start.y,this._end.y),Math.max(this._start.x,this._end.x),Math.max(this._start.y,this._end.y));const t=this.getTCriticalX(),e=this.getTCriticalY();!isNaN(t)&&t>0&&t<1&&(this._bounds=this._bounds.withPoint(this.positionAt(t))),!isNaN(e)&&e>0&&e<1&&(this._bounds=this._bounds.withPoint(this.positionAt(e)))}return this._bounds},get bounds(){return this.getBounds()},offsetTo:function(t,e){let i=[this];for(let s=0;s<5;s++)i=_.flatten(_.map(i,(function(t){return t.subdivided(.5,!0)})));let n=_.map(i,(function(e){return e.approximateOffset(t)}));return e&&(n.reverse(),n=_.map(n,(function(t){return t.reversed(!0)}))),n},degreeElevated:function(){return new Je.Cubic(this._start,this._start.plus(this._control.timesScalar(2)).dividedScalar(3),this._end.plus(this._control.timesScalar(2)).dividedScalar(3),this._end)},approximateOffset:function(t){return new Je.Quadratic(this._start.plus((this._start.equals(this._control)?this._end.minus(this._start):this._control.minus(this._start)).perpendicular.normalized().times(t)),this._control.plus(this._end.minus(this._start).perpendicular.normalized().times(t)),this._end.plus((this._end.equals(this._control)?this._end.minus(this._start):this._end.minus(this._control)).perpendicular.normalized().times(t)))},getSVGPathFragment:function(){return this._svgPathFragment||(this._svgPathFragment="Q "+Je.svgNumber(this._control.x)+" "+Je.svgNumber(this._control.y)+" "+Je.svgNumber(this._end.x)+" "+Je.svgNumber(this._end.y)),this._svgPathFragment},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){const t=[],e=this.getTCriticalX(),i=this.getTCriticalY();return!isNaN(e)&&e>1e-10&&e<1-1e-10&&t.push(this.tCriticalX),!isNaN(i)&&i>1e-10&&i<1-1e-10&&t.push(this.tCriticalY),t.sort()},intersection:function(t){const e=this,i=[],n=oi.rotation2(-t.direction.angle).timesMatrix(oi.translation(-t.position.x,-t.position.y)),s=n.timesVector2(this._start),r=n.timesVector2(this._control),o=n.timesVector2(this._end),a=s.y-2*r.y+o.y,l=-2*s.y+2*r.y,h=s.y,u=Pi(a,l,h);return _.each(u,(function(n){if(n>=0&&n<=1){const s=e.positionAt(n),r=e.tangentAt(n).normalized(),o=r.perpendicular,a=s.minus(t.position);if(a.dot(t.direction)>0){const e=o.dot(t.direction)>0?o.negated():o,l=t.direction.perpendicular.dot(r)<0?1:-1;i.push(new mi(a.magnitude,s,e,l,n))}}})),i},windingIntersection:function(t){let e=0;const i=this.intersection(t);return _.each(i,(function(t){e+=t.wind})),e},writeToContext:function(t){t.quadraticCurveTo(this._control.x,this._control.y,this._end.x,this._end.y)},transformed:function(t){return new Je.Quadratic(t.timesVector2(this._start),t.timesVector2(this._control),t.timesVector2(this._end))},getSignedAreaFragment:function(){return 1/6*(this._start.x*(2*this._control.y+this._end.y)+this._control.x*(-2*this._start.y+2*this._end.y)+this._end.x*(-this._start.y-2*this._control.y))},reparameterized:function(t,e){const i=this._start.plus(this._end.plus(this._control.timesScalar(-2))),n=this._control.minus(this._start).timesScalar(2),s=this._start,r=i.timesScalar(t*t),o=i.timesScalar(t*e).timesScalar(2).plus(n.timesScalar(t)),a=i.timesScalar(e*e).plus(n.timesScalar(e)).plus(s);return new Je.Quadratic(a,o.timesScalar(.5).plus(a),r.plus(o).plus(a))},reversed:function(){return new Je.Quadratic(this._end,this._control,this._start)},serialize:function(){return{type:"Quadratic",startX:this._start.x,startY:this._start.y,controlX:this._control.x,controlY:this._control.y,endX:this._end.x,endY:this._end.y}}}),Oi.deserialize=function(t){return new Oi(new je(t.startX,t.startY),new je(t.controlX,t.controlY),new je(t.endX,t.endY))},Oi.extremaT=function(t,e,i){const n=2*(i-2*e+t);return 0!==n?-2*(e-t)/n:NaN},Oi.getOverlaps=function(t,e,i=1e-6){const n=[],s=t._start.x,r=-2*t._start.x+2*t._control.x,o=t._start.x-2*t._control.x+t._end.x,a=t._start.y,l=-2*t._start.y+2*t._control.y,h=t._start.y-2*t._control.y+t._end.y,u=e._start.x,c=-2*e._start.x+2*e._control.x,d=e._start.x-2*e._control.x+e._end.x,f=e._start.y,p=-2*e._start.y+2*e._control.y,m=e._start.y-2*e._control.y+e._end.y,g=Math.abs(Math.max(t._start.x,t._control.x,t._end.x,e._start.x,e._control.x,e._end.x)-Math.min(t._start.x,t._control.x,t._end.x,e._start.x,e._control.x,e._end.x)),y=Math.abs(Math.max(t._start.y,t._control.y,t._end.y,e._start.y,e._control.y,e._end.y)-Math.min(t._start.y,t._control.y,t._end.y,e._start.y,e._control.y,e._end.y)),b=xi.polynomialGetOverlapQuadratic(s,r,o,u,c,d),v=xi.polynomialGetOverlapQuadratic(a,l,h,f,p,m);let w;if(w=g>y?null===b||!0===b?v:b:null===v||!0===v?b:v,null===w||!0===w)return n;const A=w.a,x=w.b,T=A*A,S=x*x,D=2*A*x,E=u+x*c+S*d-s,C=A*c+D*d-r,I=T*d-o,P=f+x*p+S*m-a,k=A*p+D*m-l,L=T*m-h,O=Be.solveLinearRootsReal(2*I,C),N=Be.solveLinearRootsReal(2*L,k),R=_.uniq([0,1].concat(O?O.filter(Li):[])),M=_.uniq([0,1].concat(N?N.filter(Li):[]));for(let _=0;_<R.length;_++){const t=R[_];if(Math.abs((I*t+C)*t+E)>i)return n}for(let _=0;_<M.length;_++){const t=M[_];if(Math.abs((L*t+k)*t+P)>i)return n}const B=A+x;return x>1&&B>1||x<0&&B<0?n:[new fi(A,x)]};var Ni=Oi;const Ri=Be.solveQuadraticRootsReal,Mi=Be.solveCubicRootsReal,Bi=Be.arePointsCollinear,Fi=new je(0,0),Vi=new je(0,0),Hi=new je(0,0);function zi(t){return t>=0&&t<=1}function Gi(t,e,i,n){xi.call(this),this._start=t,this._control1=e,this._control2=i,this._end=n,this.invalidate()}Je.register("Cubic",Gi),R(xi,Gi,{degree:3,setStart:function(t){return this._start.equals(t)||(this._start=t,this.invalidate()),this},set start(t){this.setStart(t)},getStart:function(){return this._start},get start(){return this.getStart()},setControl1:function(t){return this._control1.equals(t)||(this._control1=t,this.invalidate()),this},set control1(t){this.setControl1(t)},getControl1:function(){return this._control1},get control1(){return this.getControl1()},setControl2:function(t){return this._control2.equals(t)||(this._control2=t,this.invalidate()),this},set control2(t){this.setControl2(t)},getControl2:function(){return this._control2},get control2(){return this.getControl2()},setEnd:function(t){return this._end.equals(t)||(this._end=t,this.invalidate()),this},set end(t){this.setEnd(t)},getEnd:function(){return this._end},get end(){return this.getEnd()},positionAt:function(t){const e=1-t,i=e*e*e,n=3*e*e*t,s=3*e*t*t,r=t*t*t;return new je(this._start.x*i+this._control1.x*n+this._control2.x*s+this._end.x*r,this._start.y*i+this._control1.y*n+this._control2.y*s+this._end.y*r)},tangentAt:function(t){const e=1-t;return new je(0,0).set(this._start).multiplyScalar(-3*e*e).add(Fi.set(this._control1).multiplyScalar(3*e*e-6*e*t)).add(Fi.set(this._control2).multiplyScalar(6*e*t-3*t*t)).add(Fi.set(this._end).multiplyScalar(3*t*t))},curvatureAt:function(t){if(Math.abs(t-.5)>.5-1e-7){const e=t<.5,i=e?this._start:this._end,n=e?this._control1:this._control2,s=e?this._control2:this._control1,r=n.minus(i),o=r.magnitude;return(e?-1:1)*r.perpendicular.normalized().dot(s.minus(n))*(this.degree-1)/(this.degree*o*o)}return this.subdivided(t)[0].curvatureAt(1)},subdivided:function(t){if(0===t||1===t)return[this];const e=this._start.blend(this._control1,t),i=this._control2.blend(this._end,t),n=this._control1.blend(this._control2,t),s=e.blend(n,t),r=n.blend(i,t),o=s.blend(r,t);return[new Je.Cubic(this._start,e,s,o),new Je.Cubic(o,r,i,this._end)]},invalidate:function(){this._startTangent=null,this._endTangent=null,this._r=null,this._s=null,this._tCusp=null,this._tDeterminant=null,this._tInflection1=null,this._tInflection2=null,this._quadratics=null,this._xExtremaT=null,this._yExtremaT=null,this._bounds=null,this._svgPathFragment=null,this.invalidationEmitter.emit()},getStartTangent:function(){return null===this._startTangent&&(this._startTangent=this.tangentAt(0).normalized()),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return null===this._endTangent&&(this._endTangent=this.tangentAt(1).normalized()),this._endTangent},get endTangent(){return this.getEndTangent()},getR:function(){return null===this._r&&(this._r=this._control1.minus(this._start).normalized()),this._r},get r(){return this.getR()},getS:function(){return null===this._s&&(this._s=this.getR().perpendicular),this._s},get s(){return this.getS()},getTCusp:function(){return null===this._tCusp&&this.computeCuspInfo(),this._tCusp},get tCusp(){return this.getTCusp()},getTDeterminant:function(){return null===this._tDeterminant&&this.computeCuspInfo(),this._tDeterminant},get tDeterminant(){return this.getTDeterminant()},getTInflection1:function(){return null===this._tInflection1&&this.computeCuspInfo(),this._tInflection1},get tInflection1(){return this.getTInflection1()},getTInflection2:function(){return null===this._tInflection2&&this.computeCuspInfo(),this._tInflection2},get tInflection2(){return this.getTInflection2()},getQuadratics:function(){return null===this._quadratics&&this.computeCuspSegments(),this._quadratics},getXExtremaT:function(){return null===this._xExtremaT&&(this._xExtremaT=Gi.extremaT(this._start.x,this._control1.x,this._control2.x,this._end.x)),this._xExtremaT},get xExtremaT(){return this.getXExtremaT()},getYExtremaT:function(){return null===this._yExtremaT&&(this._yExtremaT=Gi.extremaT(this._start.y,this._control1.y,this._control2.y,this._end.y)),this._yExtremaT},get yExtremaT(){return this.getYExtremaT()},getBounds:function(){if(null===this._bounds){this._bounds=Ke.NOTHING,this._bounds=this._bounds.withPoint(this._start),this._bounds=this._bounds.withPoint(this._end);const t=this;_.each(this.getXExtremaT(),(function(e){e>=0&&e<=1&&(t._bounds=t._bounds.withPoint(t.positionAt(e)))})),_.each(this.getYExtremaT(),(function(e){e>=0&&e<=1&&(t._bounds=t._bounds.withPoint(t.positionAt(e)))})),this.hasCusp()&&(this._bounds=this._bounds.withPoint(this.positionAt(this.getTCusp())))}return this._bounds},get bounds(){return this.getBounds()},computeCuspInfo:function(){const t=this._start.times(-1).plus(this._control1.times(3)).plus(this._control2.times(-3)).plus(this._end),e=this._start.times(3).plus(this._control1.times(-6)).plus(this._control2.times(3)),i=this._start.times(-3).plus(this._control1.times(3)),n=t.perpendicular,s=e.perpendicular,r=n.dot(e);if(this._tCusp=n.dot(i)/r*-.5,this._tDeterminant=this._tCusp*this._tCusp-1/3*(s.dot(i)/r),this._tDeterminant>=0){const t=Math.sqrt(this._tDeterminant);this._tInflection1=this._tCusp-t,this._tInflection2=this._tCusp+t}else this._tInflection1=NaN,this._tInflection2=NaN},computeCuspSegments:function(){if(this.hasCusp()){this._quadratics=[];const t=this.getTCusp();if(0===t)this._quadratics.push(new Ni(this.start,this.control2,this.end,!1));else if(1===t)this._quadratics.push(new Ni(this.start,this.control1,this.end,!1));else{const e=this.subdivided(t);this._quadratics.push(new Ni(e[0].start,e[0].control1,e[0].end,!1)),this._quadratics.push(new Ni(e[1].start,e[1].control2,e[1].end,!1))}}else this._quadratics=null},getNondegenerateSegments:function(){const t=this,e=this._start,i=this._control1,n=this._control2,s=this._end,r=this.degreeReduced(1e-9);if(e.equals(s)&&e.equals(i)&&e.equals(n))return[];if(this.hasCusp())return _.flatten(this.getQuadratics().map((function(t){return t.getNondegenerateSegments()})));if(r)return r.getNondegenerateSegments();if(Bi(e,i,s)&&Bi(e,n,s)){const i=this.getXExtremaT().concat(this.getYExtremaT()).sort().map((function(e){return t.positionAt(e)})),n=[];let r=e;i.length&&(n.push(new Je.Line(e,i[0])),r=i[0]);for(let t=1;t<i.length;t++)n.push(new Je.Line(i[t-1],i[t])),r=i[t];return n.push(new Je.Line(r,s)),_.flatten(n.map((function(t){return t.getNondegenerateSegments()})),!0)}return[this]},hasCusp:function(){const t=this.getTCusp();return t>=0&&t<=1&&this.tangentAt(t).magnitude<1e-7},toRS:function(t){const e=t.minus(this._start);return new je(e.dot(this.getR()),e.dot(this.getS()))},offsetTo:function(t,e){const i=[],n=[];for(let s=0;s<32;s++){let r=s/31;e&&(r=1-r),i.push(this.positionAt(r).plus(this.tangentAt(r).perpendicular.normalized().times(t))),s>0&&n.push(new Je.Line(i[s-1],i[s]))}return n},getSVGPathFragment:function(){return this._svgPathFragment||(this._svgPathFragment="C "+Je.svgNumber(this._control1.x)+" "+Je.svgNumber(this._control1.y)+" "+Je.svgNumber(this._control2.x)+" "+Je.svgNumber(this._control2.y)+" "+Je.svgNumber(this._end.x)+" "+Je.svgNumber(this._end.y)),this._svgPathFragment},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){const t=this.getXExtremaT().concat(this.getYExtremaT()),e=[];return _.each(t,(function(t){t>1e-10&&t<1-1e-10&&_.every(e,(function(e){return Math.abs(t-e)>1e-10}))&&e.push(t)})),e.sort()},intersection:function(t){const e=this,i=[],n=oi.rotation2(-t.direction.angle).timesMatrix(oi.translation(-t.position.x,-t.position.y)),s=n.timesVector2(this._start),r=n.timesVector2(this._control1),o=n.timesVector2(this._control2),a=n.timesVector2(this._end),l=-s.y+3*r.y-3*o.y+a.y,h=3*s.y-6*r.y+3*o.y,u=-3*s.y+3*r.y,c=s.y,d=Mi(l,h,u,c);return _.each(d,(function(n){if(n>=0&&n<=1){const s=e.positionAt(n),r=e.tangentAt(n).normalized(),o=r.perpendicular,a=s.minus(t.position);if(a.dot(t.direction)>0){const e=o.dot(t.direction)>0?o.negated():o,l=t.direction.perpendicular.dot(r)<0?1:-1;i.push(new mi(a.magnitude,s,e,l,n))}}})),i},windingIntersection:function(t){let e=0;const i=this.intersection(t);return _.each(i,(function(t){e+=t.wind})),e},writeToContext:function(t){t.bezierCurveTo(this._control1.x,this._control1.y,this._control2.x,this._control2.y,this._end.x,this._end.y)},transformed:function(t){return new Je.Cubic(t.timesVector2(this._start),t.timesVector2(this._control1),t.timesVector2(this._control2),t.timesVector2(this._end))},degreeReduced:function(t){t=t||0;const e=Fi.set(this._control1).multiplyScalar(3).subtract(this._start).divideScalar(2),i=Vi.set(this._control2).multiplyScalar(3).subtract(this._end).divideScalar(2);return Hi.set(e).subtract(i).magnitude<=t?new Ni(this._start,e.average(i),this._end):null},getSignedAreaFragment:function(){return.05*(this._start.x*(6*this._control1.y+3*this._control2.y+this._end.y)+this._control1.x*(-6*this._start.y+3*this._control2.y+3*this._end.y)+this._control2.x*(-3*this._start.y-3*this._control1.y+6*this._end.y)+this._end.x*(-this._start.y-3*this._control1.y-6*this._control2.y))},reversed:function(){return new Je.Cubic(this._end,this._control2,this._control1,this._start)},getSelfIntersection:function(){const t=this.getInteriorExtremaTs(),e=[0].concat(t).concat([1]),i=this.subdivisions(t);if(i.length<3)return null;for(let n=0;n<i.length;n++){const t=i[n];for(let s=n+1;s<i.length;s++){const r=i[s],o=vi.intersect(t,r);if(o.length){const t=o[0];if(t.aT>1e-7&&t.aT<1-1e-7&&t.bT>1e-7&&t.bT<1-1e-7){const i=e[n]+t.aT*(e[n+1]-e[n]),r=e[s]+t.bT*(e[s+1]-e[s]);return new yi(t.point,i,r)}}}}return null},serialize:function(){return{type:"Cubic",startX:this._start.x,startY:this._start.y,control1X:this._control1.x,control1Y:this._control1.y,control2X:this._control2.x,control2Y:this._control2.y,endX:this._end.x,endY:this._end.y}}}),Gi.deserialize=function(t){return new Gi(new je(t.startX,t.startY),new je(t.control1X,t.control1Y),new je(t.control2X,t.control2Y),new je(t.endX,t.endY))},Gi.extremaT=function(t,e,i,n){if(t===e&&t===i&&t===n)return[];const s=-3*t+9*e-9*i+3*n,r=6*t-12*e+6*i,o=-3*t+3*e;return _.filter(Ri(s,r,o),zi)},Gi.getOverlaps=function(t,e,i=1e-6){const n=[],s=t._start.x,r=-3*t._start.x+3*t._control1.x,o=3*t._start.x-6*t._control1.x+3*t._control2.x,a=-1*t._start.x+3*t._control1.x-3*t._control2.x+t._end.x,l=t._start.y,h=-3*t._start.y+3*t._control1.y,u=3*t._start.y-6*t._control1.y+3*t._control2.y,c=-1*t._start.y+3*t._control1.y-3*t._control2.y+t._end.y,d=e._start.x,f=-3*e._start.x+3*e._control1.x,p=3*e._start.x-6*e._control1.x+3*e._control2.x,m=-1*e._start.x+3*e._control1.x-3*e._control2.x+e._end.x,g=e._start.y,y=-3*e._start.y+3*e._control1.y,b=3*e._start.y-6*e._control1.y+3*e._control2.y,v=-1*e._start.y+3*e._control1.y-3*e._control2.y+e._end.y,w=Math.abs(Math.max(t._start.x,t._control1.x,t._control2.x,t._end.x,t._start.x,t._control1.x,t._control2.x,t._end.x)-Math.min(t._start.x,t._control1.x,t._control2.x,t._end.x,t._start.x,t._control1.x,t._control2.x,t._end.x)),A=Math.abs(Math.max(t._start.y,t._control1.y,t._control2.y,t._end.y,t._start.y,t._control1.y,t._control2.y,t._end.y)-Math.min(t._start.y,t._control1.y,t._control2.y,t._end.y,t._start.y,t._control1.y,t._control2.y,t._end.y)),x=xi.polynomialGetOverlapCubic(s,r,o,a,d,f,p,m),T=xi.polynomialGetOverlapCubic(l,h,u,c,g,y,b,v);let S;if(S=w>A?null===x||!0===x?T:x:null===T||!0===T?x:T,null===S||!0===S)return n;const D=S.a,E=S.b,C=D*D,I=D*D*D,P=E*E,k=E*E*E,L=2*D*E,O=3*D*P,N=3*C*E,R=d+E*f+P*p+k*m-s,M=D*f+L*p+O*m-r,B=C*p+N*m-o,F=I*m-a,V=g+E*y+P*b+k*v-l,H=D*y+L*b+O*v-h,z=C*b+N*v-u,G=I*v-c,q=Be.solveQuadraticRootsReal(3*F,2*B,M),Y=Be.solveQuadraticRootsReal(3*G,2*z,H),U=_.uniq([0,1].concat(null!==q?q.filter(zi):[])),j=_.uniq([0,1].concat(null!==Y?Y.filter(zi):[]));for(let _=0;_<U.length;_++){const t=U[_];if(Math.abs(((F*t+B)*t+M)*t+R)>i)return n}for(let _=0;_<j.length;_++){const t=j[_];if(Math.abs(((G*t+z)*t+H)*t+V)>i)return n}const W=D+E;return E>1&&W>1||E<0&&W<0?n:[new fi(D,E)]};var qi=Gi;const Yi=Be.toDegrees;function Ui(t,e,i,n,s,r,o){xi.call(this),this._center=t,this._radiusX=e,this._radiusY=i,this._rotation=n,this._startAngle=s,this._endAngle=r,this._anticlockwise=o,this.invalidate()}Je.register("EllipticalArc",Ui),R(xi,Ui,{setCenter:function(t){return this._center.equals(t)||(this._center=t,this.invalidate()),this},set center(t){this.setCenter(t)},getCenter:function(){return this._center},get center(){return this.getCenter()},setRadiusX:function(t){return this._radiusX!==t&&(this._radiusX=t,this.invalidate()),this},set radiusX(t){this.setRadiusX(t)},getRadiusX:function(){return this._radiusX},get radiusX(){return this.getRadiusX()},setRadiusY:function(t){return this._radiusY!==t&&(this._radiusY=t,this.invalidate()),this},set radiusY(t){this.setRadiusY(t)},getRadiusY:function(){return this._radiusY},get radiusY(){return this.getRadiusY()},setRotation:function(t){return this._rotation!==t&&(this._rotation=t,this.invalidate()),this},set rotation(t){this.setRotation(t)},getRotation:function(){return this._rotation},get rotation(){return this.getRotation()},setStartAngle:function(t){return this._startAngle!==t&&(this._startAngle=t,this.invalidate()),this},set startAngle(t){this.setStartAngle(t)},getStartAngle:function(){return this._startAngle},get startAngle(){return this.getStartAngle()},setEndAngle:function(t){return this._endAngle!==t&&(this._endAngle=t,this.invalidate()),this},set endAngle(t){this.setEndAngle(t)},getEndAngle:function(){return this._endAngle},get endAngle(){return this.getEndAngle()},setAnticlockwise:function(t){return this._anticlockwise!==t&&(this._anticlockwise=t,this.invalidate()),this},set anticlockwise(t){this.setAnticlockwise(t)},getAnticlockwise:function(){return this._anticlockwise},get anticlockwise(){return this.getAnticlockwise()},positionAt:function(t){return this.positionAtAngle(this.angleAt(t))},tangentAt:function(t){return this.tangentAtAngle(this.angleAt(t))},curvatureAt:function(t){const e=this.angleAt(t),i=this._radiusX*Math.sin(e),n=this._radiusY*Math.cos(e),s=Math.pow(n*n+i*i,1.5);return(this._anticlockwise?-1:1)*this._radiusX*this._radiusY/s},subdivided:function(t){if(0===t||1===t)return[this];const e=this.angleAt(0),i=this.angleAt(t),n=this.angleAt(1);return[new Je.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,e,i,this._anticlockwise),new Je.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,i,n,this._anticlockwise)]},invalidate:function(){if(this._unitTransform=null,this._start=null,this._end=null,this._startTangent=null,this._endTangent=null,this._actualEndAngle=null,this._isFullPerimeter=null,this._angleDifference=null,this._unitArcSegment=null,this._bounds=null,this._svgPathFragment=null,this._radiusX<0&&(this._radiusX=-this._radiusX,this._startAngle=Math.PI-this._startAngle,this._endAngle=Math.PI-this._endAngle,this._anticlockwise=!this._anticlockwise),this._radiusY<0&&(this._radiusY=-this._radiusY,this._startAngle=-this._startAngle,this._endAngle=-this._endAngle,this._anticlockwise=!this._anticlockwise),this._radiusX<this._radiusY){this._rotation+=Math.PI/2,this._startAngle-=Math.PI/2,this._endAngle-=Math.PI/2;const t=this._radiusX;this._radiusX=this._radiusY,this._radiusY=t}if(this._radiusX<this._radiusY)throw new Error("Not verified to work if radiusX < radiusY");this.invalidationEmitter.emit()},getUnitTransform:function(){return null===this._unitTransform&&(this._unitTransform=Ui.computeUnitTransform(this._center,this._radiusX,this._radiusY,this._rotation)),this._unitTransform},get unitTransform(){return this.getUnitTransform()},getStart:function(){return null===this._start&&(this._start=this.positionAtAngle(this._startAngle)),this._start},get start(){return this.getStart()},getEnd:function(){return null===this._end&&(this._end=this.positionAtAngle(this._endAngle)),this._end},get end(){return this.getEnd()},getStartTangent:function(){return null===this._startTangent&&(this._startTangent=this.tangentAtAngle(this._startAngle)),this._startTangent},get startTangent(){return this.getStartTangent()},getEndTangent:function(){return null===this._endTangent&&(this._endTangent=this.tangentAtAngle(this._endAngle)),this._endTangent},get endTangent(){return this.getEndTangent()},getActualEndAngle:function(){return null===this._actualEndAngle&&(this._actualEndAngle=Ii.computeActualEndAngle(this._startAngle,this._endAngle,this._anticlockwise)),this._actualEndAngle},get actualEndAngle(){return this.getActualEndAngle()},getIsFullPerimeter:function(){return null===this._isFullPerimeter&&(this._isFullPerimeter=!this._anticlockwise&&this._endAngle-this._startAngle>=2*Math.PI||this._anticlockwise&&this._startAngle-this._endAngle>=2*Math.PI),this._isFullPerimeter},get isFullPerimeter(){return this.getIsFullPerimeter()},getAngleDifference:function(){return null===this._angleDifference&&(this._angleDifference=this._anticlockwise?this._startAngle-this._endAngle:this._endAngle-this._startAngle,this._angleDifference<0&&(this._angleDifference+=2*Math.PI)),this._angleDifference},get angleDifference(){return this.getAngleDifference()},getUnitArcSegment:function(){return null===this._unitArcSegment&&(this._unitArcSegment=new Je.Arc(je.ZERO,1,this._startAngle,this._endAngle,this._anticlockwise)),this._unitArcSegment},get unitArcSegment(){return this.getUnitArcSegment()},getBounds:function(){if(null===this._bounds&&(this._bounds=Ke.NOTHING.withPoint(this.getStart()).withPoint(this.getEnd()),this._startAngle!==this._endAngle)){const t=Math.atan(-this._radiusY/this._radiusX*Math.tan(this._rotation)),e=Math.atan(this._radiusY/this._radiusX/Math.tan(this._rotation));this.possibleExtremaAngles=[t,t+Math.PI,e,e+Math.PI],_.each(this.possibleExtremaAngles,this.includeBoundsAtAngle.bind(this))}return this._bounds},get bounds(){return this.getBounds()},getNondegenerateSegments:function(){if(this._radiusX<=0||this._radiusY<=0||this._startAngle===this._endAngle)return[];if(this._radiusX===this._radiusY){const t=this._startAngle-this._rotation;let e=this._endAngle-this._rotation;return Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(e=this._anticlockwise?t-2*Math.PI:t+2*Math.PI),[new Je.Arc(this._center,this._radiusX,t,e,this._anticlockwise)]}return[this]},includeBoundsAtAngle:function(t){this.unitArcSegment.containsAngle(t)&&(this._bounds=this._bounds.withPoint(this.positionAtAngle(t)))},mapAngle:function(t){return Math.abs(Be.moduloBetweenDown(t-this._startAngle,-Math.PI,Math.PI))<1e-8?this._startAngle:Math.abs(Be.moduloBetweenDown(t-this.getActualEndAngle(),-Math.PI,Math.PI))<1e-8?this.getActualEndAngle():this._startAngle>this.getActualEndAngle()?Be.moduloBetweenUp(t,this._startAngle-2*Math.PI,this._startAngle):Be.moduloBetweenDown(t,this._startAngle,this._startAngle+2*Math.PI)},tAtAngle:function(t){return(this.mapAngle(t)-this._startAngle)/(this.getActualEndAngle()-this._startAngle)},angleAt:function(t){return this._startAngle+(this.getActualEndAngle()-this._startAngle)*t},positionAtAngle:function(t){return this.getUnitTransform().transformPosition2(je.createPolar(1,t))},tangentAtAngle:function(t){const e=this.getUnitTransform().transformNormal2(je.createPolar(1,t));return this._anticlockwise?e.perpendicular:e.perpendicular.negated()},offsetTo:function(t,e){const i=[],n=[];for(let s=0;s<32;s++){let r=s/31;e&&(r=1-r);const o=this.angleAt(r);i.push(this.positionAtAngle(o).plus(this.tangentAtAngle(o).perpendicular.normalized().times(t))),s>0&&n.push(new Je.Line(i[s-1],i[s]))}return n},getSVGPathFragment:function(){if(!this._svgPathFragment){const t=.01,e=this._anticlockwise?"0":"1";let i;const n=Yi(this._rotation);if(this.getAngleDifference()<2*Math.PI-t)i=this.getAngleDifference()<Math.PI?"0":"1",this._svgPathFragment="A "+Je.svgNumber(this._radiusX)+" "+Je.svgNumber(this._radiusY)+" "+n+" "+i+" "+e+" "+Je.svgNumber(this.getEnd().x)+" "+Je.svgNumber(this.getEnd().y);else{const t=(this._startAngle+this._endAngle)/2,s=this.positionAtAngle(t);i="0";const r="A "+Je.svgNumber(this._radiusX)+" "+Je.svgNumber(this._radiusY)+" "+n+" "+i+" "+e+" "+Je.svgNumber(s.x)+" "+Je.svgNumber(s.y),o="A "+Je.svgNumber(this._radiusX)+" "+Je.svgNumber(this._radiusY)+" "+n+" "+i+" "+e+" "+Je.svgNumber(this.getEnd().x)+" "+Je.svgNumber(this.getEnd().y);this._svgPathFragment=r+" "+o}}return this._svgPathFragment},strokeLeft:function(t){return this.offsetTo(-t/2,!1)},strokeRight:function(t){return this.offsetTo(t/2,!0)},getInteriorExtremaTs:function(){const t=this,e=[];return _.each(this.possibleExtremaAngles,(function(i){if(t.unitArcSegment.containsAngle(i)){const n=t.tAtAngle(i),s=1e-10;n>s&&n<1-s&&e.push(n)}})),e.sort()},intersection:function(t){const e=this.getUnitTransform(),i=e.inverseRay2(t),n=this.getUnitArcSegment().intersection(i);return _.map(n,(function(i){const n=e.transformPosition2(i.point),s=t.position.distance(n),r=e.inverseNormal2(i.normal);return new mi(s,n,r,i.wind,i.t)}))},windingIntersection:function(t){const e=this.getUnitTransform().inverseRay2(t);return this.getUnitArcSegment().windingIntersection(e)},writeToContext:function(t){t.ellipse?t.ellipse(this._center.x,this._center.y,this._radiusX,this._radiusY,this._rotation,this._startAngle,this._endAngle,this._anticlockwise):(this.getUnitTransform().getMatrix().canvasAppendTransform(t),t.arc(0,0,1,this._startAngle,this._endAngle,this._anticlockwise),this.getUnitTransform().getInverse().canvasAppendTransform(t))},transformed:function(t){const e=t.timesVector2(je.createPolar(this._radiusX,this._rotation)).minus(t.timesVector2(je.ZERO)),i=t.timesVector2(je.createPolar(this._radiusY,this._rotation+Math.PI/2)).minus(t.timesVector2(je.ZERO)),n=e.angle,s=e.magnitude,r=i.magnitude,o=t.getDeterminant()<0,a=o?!this._anticlockwise:this._anticlockwise,l=o?-this._startAngle:this._startAngle;let h=o?-this._endAngle:this._endAngle;return Math.abs(this._endAngle-this._startAngle)===2*Math.PI&&(h=a?l-2*Math.PI:l+2*Math.PI),new Je.EllipticalArc(t.timesVector2(this._center),s,r,n,l,h,a)},getSignedAreaFragment:function(){const t=this._startAngle,e=this.getActualEndAngle(),i=Math.sin(t),n=Math.sin(e),s=Math.cos(t),r=Math.cos(e);return.5*(this._radiusX*this._radiusY*(e-t)+Math.cos(this._rotation)*(this._radiusX*this._center.y*(s-r)+this._radiusY*this._center.x*(n-i))+Math.sin(this._rotation)*(this._radiusX*this._center.x*(r-s)+this._radiusY*this._center.y*(n-i)))},reversed:function(){return new Je.EllipticalArc(this._center,this._radiusX,this._radiusY,this._rotation,this._endAngle,this._startAngle,!this._anticlockwise)},serialize:function(){return{type:"EllipticalArc",centerX:this._center.x,centerY:this._center.y,radiusX:this._radiusX,radiusY:this._radiusY,rotation:this._rotation,startAngle:this._startAngle,endAngle:this._endAngle,anticlockwise:this._anticlockwise}}}),Ui.deserialize=function(t){return new Ui(new je(t.centerX,t.centerY),t.radiusX,t.radiusY,t.rotation,t.startAngle,t.endAngle,t.anticlockwise)},Ui.getOverlaps=function(t,e){return t._center.distance(e._center)>1e-8||Math.abs(t._radiusX-e._radiusX)>1e-8||Math.abs(t._radiusY-e._radiusY)>1e-8||Math.abs(Be.moduloBetweenDown(t._rotation-e._rotation+Math.PI/2,0,Math.PI)-Math.PI/2)>1e-10?[]:Ii.getAngularOverlaps(t._startAngle+t._rotation,t.getActualEndAngle()+t._rotation,e._startAngle+e._rotation,e.getActualEndAngle()+e._rotation)},Ui.computeUnitTransform=function(t,e,i,n){return new hi(oi.translation(t.x,t.y).timesMatrix(oi.rotation2(n)).timesMatrix(oi.scaling(e,i)))};var ji=Ui;const Wi=Be.lineLineIntersection,Xi={lineWidth:1,lineCap:"butt",lineJoin:"miter",lineDash:[],lineDashOffset:0,miterLimit:10};function Ki(t){t=h({},Xi,t),this.lineWidth=t.lineWidth,this.lineCap=t.lineCap,this.lineJoin=t.lineJoin,this.lineDash=t.lineDash,this.lineDashOffset=t.lineDashOffset,this.miterLimit=t.miterLimit}Je.register("LineStyles",Ki),R(Object,Ki,{equals:function(t){if(!(this.lineWidth===t.lineWidth&&this.lineCap===t.lineCap&&this.lineJoin===t.lineJoin&&this.miterLimit===t.miterLimit&&this.lineDashOffset===t.lineDashOffset))return!1;if(this.lineDash.length!==t.lineDash.length)return!1;for(let e=0;e<this.lineDash.length;e++)if(this.lineDash[e]!==t.lineDash[e])return!1;return!0},copy:function(){return new Ki({lineWidth:this.lineWidth,lineCap:this.lineCap,lineJoin:this.lineJoin,lineDash:this.lineDash,lineDashOffset:this.lineDashOffset,miterLimit:this.miterLimit})},leftJoin:function(t,e,i){e=e.normalized(),i=i.normalized();const n=t.plus(e.perpendicular.negated().times(this.lineWidth/2)),s=t.plus(i.perpendicular.negated().times(this.lineWidth/2)),r=n.equals(s)?[]:[new Di(n,s)];if(!(e.perpendicular.dot(i)>1e-12))return r;switch(this.lineJoin){case"round":var o=e.angle+Math.PI/2,a=i.angle+Math.PI/2;return[new Ii(t,this.lineWidth/2,o,a,!0)];case"miter":var l=e.angleBetween(i.negated());if(1/Math.sin(l/2)<=this.miterLimit&&l<Math.PI-1e-5){const t=Wi(n,n.plus(e),s,s.plus(i));return[new Di(n,t),new Di(t,s)]}return r;case"bevel":return r;default:throw new Error("invalid lineJoin: "+this.lineJoin)}},rightJoin:function(t,e,i){return this.leftJoin(t,i.negated(),e.negated())},cap:function(t,e){e=e.normalized();const i=t.plus(e.perpendicular.times(-this.lineWidth/2)),n=t.plus(e.perpendicular.times(this.lineWidth/2));switch(this.lineCap){case"butt":return[new Di(i,n)];case"round":var s=e.angle;return[new Ii(t,this.lineWidth/2,s+Math.PI/2,s-Math.PI/2,!0)];case"square":var r=e.perpendicular.negated().times(this.lineWidth/2),o=e.perpendicular.times(this.lineWidth/2),a=e.times(this.lineWidth/2),l=t.plus(r).plus(a),h=t.plus(o).plus(a);return[new Di(i,l),new Di(l,h),new Di(h,n)];default:throw new Error("invalid lineCap: "+this.lineCap)}}}),Ki.DEFAULT_OPTIONS=Xi;var Qi=Je.LineStyles;function Zi(t,e,i){this.invalidatedEmitter=new C;const n=this;if(this.segments=[],this.points=e||(t&&t.length?_.map(t,(function(t){return t.start})).concat(t[t.length-1].end):[]),this.closed=!!i,this._strokedSubpaths=null,this._strokedSubpathsComputed=!1,this._strokedStyles=null,this._bounds=null,this._invalidateListener=this.invalidate.bind(this),this._invalidatingPoints=!1,t)for(let s=0;s<t.length;s++)_.each(t[s].getNondegenerateSegments(),(function(t){n.addSegmentDirectly(t)}))}Je.register("Subpath",Zi),R(Object,Zi,{getBounds:function(){if(null===this._bounds){const t=Ke.NOTHING.copy();_.each(this.segments,(function(e){t.includeBounds(e.getBounds())})),this._bounds=t}return this._bounds},get bounds(){return this.getBounds()},getArcLength:function(t,e,i){let n=0;for(let s=0;s<this.segments.length;s++)n+=this.segments[s].getArcLength(t,e,i);return n},copy:function(){return new Zi(this.segments.slice(0),this.points.slice(0),this.closed)},invalidatePoints:function(){this._invalidatingPoints=!0;const t=this.segments.length;for(let e=0;e<t;e++)this.segments[e].invalidate();this._invalidatingPoints=!1,this.invalidate()},invalidate:function(){this._invalidatingPoints||(this._bounds=null,this._strokedSubpathsComputed=!1,this.invalidatedEmitter.emit())},addPoint:function(t){return this.points.push(t),this},addSegmentDirectly:function(t){return this.segments.push(t),t.invalidationEmitter.addListener(this._invalidateListener),this},addSegment:function(t){const e=t.getNondegenerateSegments().length;for(let i=0;i<e;i++)this.addSegmentDirectly(t);return this.invalidate(),this},addClosingSegment:function(){if(this.hasClosingSegment()){const t=this.getClosingSegment();this.addSegmentDirectly(t),this.invalidate(),this.addPoint(this.getFirstPoint()),this.closed=!0}},close:function(){this.closed=!0,this.addClosingSegment()},getLength:function(){return this.points.length},getFirstPoint:function(){return _.first(this.points)},getLastPoint:function(){return _.last(this.points)},getFirstSegment:function(){return _.first(this.segments)},getLastSegment:function(){return _.last(this.segments)},getFillSegments:function(){const t=this.segments.slice();return this.hasClosingSegment()&&t.push(this.getClosingSegment()),t},isDrawable:function(){return this.segments.length>0},isClosed:function(){return this.closed},hasClosingSegment:function(){return!this.getFirstPoint().equalsEpsilon(this.getLastPoint(),1e-9)},getClosingSegment:function(){return new Di(this.getLastPoint(),this.getFirstPoint())},writeToContext:function(t){if(this.isDrawable()){const e=this.getFirstSegment().start;t.moveTo(e.x,e.y);let i=this.segments.length;this.closed&&i>=2&&this.segments[i-1]instanceof Di&&i--;for(let n=0;n<i;n++)this.segments[n].writeToContext(t);this.closed&&t.closePath()}},toPiecewiseLinear:function(t){return new Zi(_.flatten(_.map(this.segments,(function(e){return e.toPiecewiseLinearSegments(t)}))),null,this.closed)},transformed:function(t){return new Zi(_.map(this.segments,(function(e){return e.transformed(t)})),_.map(this.points,(function(e){return t.timesVector2(e)})),this.closed)},nonlinearTransformed:function(t){return new Zi(_.flatten(_.map(this.segments,(function(e){return t.methodName&&e[t.methodName]?e[t.methodName](t):e.toPiecewiseLinearSegments(t)}))),null,this.closed)},getBoundsWithTransform:function(t){const e=Ke.NOTHING.copy(),i=this.segments.length;for(let n=0;n<i;n++)e.includeBounds(this.segments[n].getBoundsWithTransform(t));return e},offset:function(t){if(!this.isDrawable())return new Zi([],null,this.closed);if(0===t)return new Zi(this.segments.slice(),null,this.closed);let e;const i=this.segments.slice(),n=[];for(e=0;e<i.length;e++)n.push(i[e].strokeLeft(2*t));let s=[];for(e=0;e<i.length;e++){if(this.closed||e>0){const n=(e>0?e:i.length)-1,r=i[e].start,o=i[n].endTangent,a=i[e].startTangent,l=o.perpendicular.negated().times(t).angle,h=a.perpendicular.negated().times(t).angle,u=o.perpendicular.dot(a)>0;s.push(new Ii(r,Math.abs(t),l,h,u))}s=s.concat(n[e])}return new Zi(s,null,this.closed)},stroked:function(t){if(!this.isDrawable())return[];if(void 0===t&&(t=new Qi),this._strokedSubpathsComputed&&this._strokedStyles.equals(t))return this._strokedSubpaths;const e=t.lineWidth;let i,n=[],s=[];const r=this.getFirstSegment(),o=this.getLastSegment();function a(t){n=n.concat(t)}function l(t){s=s.concat(t)}const h=o.end.equals(r.start),u=h?null:new Di(this.segments[this.segments.length-1].end,this.segments[0].start);for(i=0;i<this.segments.length;i++)i>0&&a(t.leftJoin(this.segments[i].start,this.segments[i-1].endTangent,this.segments[i].startTangent)),a(this.segments[i].strokeLeft(e));for(i=this.segments.length-1;i>=0;i--)i<this.segments.length-1&&l(t.rightJoin(this.segments[i].end,this.segments[i].endTangent,this.segments[i+1].startTangent)),l(this.segments[i].strokeRight(e));let c;return this.closed?(h?(a(t.leftJoin(o.end,o.endTangent,r.startTangent)),l(t.rightJoin(o.end,o.endTangent,r.startTangent))):(a(t.leftJoin(u.start,o.endTangent,u.startTangent)),a(u.strokeLeft(e)),a(t.leftJoin(u.end,u.endTangent,r.startTangent)),l(t.rightJoin(u.end,u.endTangent,r.startTangent)),l(u.strokeRight(e)),l(t.rightJoin(u.start,o.endTangent,u.startTangent))),c=[new Zi(n,null,!0),new Zi(s,null,!0)]):c=[new Zi(n.concat(t.cap(o.end,o.endTangent)).concat(s).concat(t.cap(r.start,r.startTangent.negated())),null,!0)],this._strokedSubpaths=c,this._strokedSubpathsComputed=!0,this._strokedStyles=t.copy(),c},dashed:function(t,e,i,n){function s(t,e){const i=t[t.length-1].concat(e[0]),n=t.slice(0,t.length-1).concat([i]).concat(e.slice(1));return n}function r(t,e){if(!t.hasRightFilled||!e.hasLeftFilled)return!1;const i=_.last(_.last(t.segmentArrays)),n=e.segmentArrays[0][0];return i.end.distance(n.start)<1e-5}const o=[];for(var a=0;a<this.segments.length;a++){const s=this.segments[a],r=s.getDashValues(t,e,i,n);o.push(r),e+=r.arcLength;const l=[0].concat(r.values).concat([1]),h=r.initiallyInside;r.hasLeftFilled=h,r.hasRightFilled=l.length%2==0?h:!h,r.segmentArrays=[];for(let t=h?0:1;t<l.length-1;t+=2)l[t]!==l[t+1]&&r.segmentArrays.push([s.slice(l[t],l[t+1])])}for(a=o.length-1;a>=1;a--){var l=o[a-1],h=o[a];r(l,h)&&o.splice(a-1,2,{segmentArrays:s(l.segmentArrays,h.segmentArrays),hasLeftFilled:l.hasLeftFilled,hasRightFilled:h.hasRightFilled})}return o.length>1&&r(o[o.length-1],o[0])&&(l=o.pop(),h=o.shift(),o.push({segmentArrays:s(l.segmentArrays,h.segmentArrays),hasLeftFilled:l.hasLeftFilled,hasRightFilled:h.hasRightFilled})),this.closed&&1===o.length&&1===o[0].segmentArrays.length&&o[0].hasLeftFilled&&o[0].hasRightFilled?[new Zi(o[0].segmentArrays[0],null,!0)]:_.flatten(o.map((function(t){return t.segmentArrays}))).map((function(t){return new Zi(t)}))},serialize:function(){return{type:"Subpath",segments:this.segments.map((function(t){return t.serialize()})),points:this.points.map((function(t){return{x:t.x,y:t.y}})),closed:this.closed}}}),Zi.deserialize=function(t){return new Zi(t.segments.map(xi.deserialize),t.points.map((function(t){return new je(t.x,t.y)})),t.closed)};var $i=Zi;let Ji=0;function tn(t){this.id=++Ji,this.initialize(t)}Je.register("Boundary",tn),R(Object,tn,{initialize:function(t){return this.halfEdges=t,this.signedArea=this.computeSignedArea(),this.bounds=this.computeBounds(),this.childBoundaries=ci(this.childBoundaries),this},dispose:function(){this.halfEdges=[],ci(this.childBoundaries),this.freeToPool()},isInner:function(){return this.signedArea>0},computeSignedArea:function(){let t=0;for(let e=0;e<this.halfEdges.length;e++)t+=this.halfEdges[e].signedAreaFragment;return t},computeBounds:function(){const t=Ke.NOTHING.copy();for(let e=0;e<this.halfEdges.length;e++)t.includeBounds(this.halfEdges[e].edge.segment.getBounds());return t},computeExtremePoint:function(t){const e=[];for(var i=0;i<this.halfEdges.length;i++)e.push(this.halfEdges[i].edge.segment.transformed(t.getMatrix()));const n=Ke.NOTHING.copy();for(i=0;i<e.length;i++)n.includeBounds(e[i].getBounds());for(i=0;i<e.length;i++){const s=e[i];if(s.getBounds().top===n.top){let e=new je(0,Number.POSITIVE_INFINITY);const i=[0,1].concat(s.getInteriorExtremaTs());for(let t=0;t<i.length;t++){const n=s.positionAt(i[t]);n.y<e.y&&(e=n)}return t.inversePosition2(e)}}throw new Error("Should not reach here if we have segments")},computeExtremeRay:function(t){const e=this.computeExtremePoint(t),i=t.inverseDelta2(new je(0,-1)).normalized();return new Ze(e.plus(i.timesScalar(1e-4)),i)},hasHalfEdge:function(t){for(let e=0;e<this.halfEdges.length;e++)if(this.halfEdges[e]===t)return!0;return!1},toSubpath:function(){const t=[];for(let e=0;e<this.halfEdges.length;e++)t.push(this.halfEdges[e].getDirectionalSegment());return new $i(t,null,!0)}}),Pe.mixInto(tn,{initialize:tn.prototype.initialize});var en=Je.Boundary;function nn(t,e){this.initialize(t,e)}Je.register("HalfEdge",nn),R(Object,nn,{initialize:function(t,e){return this.edge=t,this.face=null,this.isReversed=e,this.signedAreaFragment=t.signedAreaFragment*(e?-1:1),this.startVertex=null,this.endVertex=null,this.sortVector=this.sortVector||new je(0,0),this.data=null,this.updateReferences(),this},dispose:function(){this.edge=null,this.face=null,this.startVertex=null,this.endVertex=null,this.data=null,this.freeToPool()},getNext:function(t){for(let e=1;;e++){let i=this.endVertex.incidentHalfEdges.indexOf(this)-e;i<0&&(i+=this.endVertex.incidentHalfEdges.length);const n=this.endVertex.incidentHalfEdges[i].getReversed();if(!t||t(n.edge))return n}},updateReferences:function(){this.startVertex=this.isReversed?this.edge.endVertex:this.edge.startVertex,this.endVertex=this.isReversed?this.edge.startVertex:this.edge.endVertex},getEndTangent:function(){return this.isReversed?this.edge.segment.startTangent:this.edge.segment.endTangent.negated()},getEndCurvature:function(){return this.isReversed?-this.edge.segment.curvatureAt(0):this.edge.segment.curvatureAt(1)},getReversed:function(){return this.isReversed?this.edge.forwardHalf:this.edge.reversedHalf},getDirectionalSegment:function(){return this.isReversed?this.edge.segment.reversed():this.edge.segment}}),Pe.mixInto(nn,{initialize:nn.prototype.initialize});var sn=Je.HalfEdge;let rn=0;function on(t){this.id=++rn,this.initialize(t)}Je.register("Vertex",on),R(Object,on,{initialize:function(t){return this.point=t,this.incidentHalfEdges=ci(this.incidentHalfEdges),this.visited=!1,this.visitIndex=0,this.lowIndex=0,this},dispose:function(){this.point=je.ZERO,ci(this.incidentHalfEdges),this.freeToPool()},sortEdges:function(){const t=[];for(var e=0;e<this.incidentHalfEdges.length;e++){const i=this.incidentHalfEdges[e];t.push(i.sortVector.setXY(i.getEndTangent().angle,i.getEndCurvature()))}const i=1e-4-Math.PI;let n=!1;for(;!n;){for(n=!0,e=0;e<t.length;e++)t[e].x<i&&(n=!1);if(!n)for(e=0;e<t.length;e++){const i=t[e];i.x-=1.62594024516,i.x<-Math.PI-1e-4&&(i.x+=2*Math.PI)}}this.incidentHalfEdges.sort(on.edgeComparison)}},{edgeComparison:function(t,e){const i=t.sortVector.x,n=e.sortVector.x;if(Math.abs(i-n)>1e-5||i!==n&&t.edge.segment instanceof Di&&e.edge.segment instanceof Di)return i<n?-1:1;{const i=t.sortVector.y,n=e.sortVector.y;if(Math.abs(i-n)>1e-5)return i<n?1:-1;throw new Error("TODO: Need to implement more advanced disambiguation ")}}}),Pe.mixInto(on,{initialize:on.prototype.initialize});var an=Je.Vertex;let ln=0;function hn(t,e,i){this.id=++ln,this.initialize(t,e,i)}Je.register("Edge",hn),R(Object,hn,{initialize:function(t,e,i){return this.segment=t,this.startVertex=e,this.endVertex=i,this.signedAreaFragment=t.getSignedAreaFragment(),this.forwardHalf=sn.createFromPool(this,!1),this.reversedHalf=sn.createFromPool(this,!0),this.visited=!1,this.data=null,this},dispose:function(){this.segment=null,this.startVertex=null,this.endVertex=null,this.forwardHalf.dispose(),this.reversedHalf.dispose(),this.forwardHalf=null,this.reversedHalf=null,this.data=null,this.freeToPool()},getOtherVertex:function(t){return this.startVertex===t?this.endVertex:this.startVertex},updateReferences:function(){this.forwardHalf.updateReferences(),this.reversedHalf.updateReferences()}}),Pe.mixInto(hn,{initialize:hn.prototype.initialize});var un=Je.Edge;let cn=0;function dn(t){this.id=++cn,this.initialize(t)}Je.register("Face",dn),R(Object,dn,{initialize:function(t){return this.boundary=t,this.holes=ci(this.holes),this.windingMap=null,this.filled=null,t&&this.addBoundaryFaceReferences(t),this},dispose:function(){this.boundary=null,ci(this.holes),this.windingMap=null,this.filled=null,this.freeToPool()},addBoundaryFaceReferences:function(t){for(let e=0;e<t.halfEdges.length;e++)t.halfEdges[e].face=this},recursivelyAddHoles:function(t){this.holes.push(t),this.addBoundaryFaceReferences(t);for(let e=0;e<t.childBoundaries.length;e++)this.recursivelyAddHoles(t.childBoundaries[e])}}),Pe.mixInto(dn,{initialize:dn.prototype.initialize});var fn=Je.Face;let pn=0;function mn(t,e){this.id=++pn,this.initialize(t,e)}Je.register("Loop",mn),R(Object,mn,{initialize:function(t,e){return this.shapeId=t,this.closed=e,this.halfEdges=ci(this.halfEdges),this},toSubpath:function(){const t=[];for(let e=0;e<this.halfEdges.length;e++)t.push(this.halfEdges[e].getDirectionalSegment());return new $i(t,void 0,this.closed)},dispose:function(){ci(this.halfEdges),this.freeToPool()}}),Pe.mixInto(mn,{initialize:mn.prototype.initialize});var gn=Je.Loop;let yn=0;function bn(){this.vertices=[],this.edges=[],this.innerBoundaries=[],this.outerBoundaries=[],this.boundaries=[],this.shapeIds=[],this.loops=[],this.unboundedFace=fn.createFromPool(null),this.faces=[this.unboundedFace]}Je.register("Graph",bn),R(Object,bn,{addShape:function(t,e,i){for(let n=0;n<e.subpaths.length;n++)this.addSubpath(t,e.subpaths[n],i)},addSubpath:function(t,e,i){if(i=h({ensureClosed:!0},i),this.shapeIds.indexOf(t)<0&&this.shapeIds.push(t),0===e.segments.length)return;const n=e.closed||i.ensureClosed,s=i.ensureClosed?e.getFillSegments():e.segments;let r;const o=[];for(r=0;r<s.length;r++){let t=r-1;t<0&&(t=s.length-1);let e=s[t].end;const i=s[r].start;n||0!==r||(e=i),i.equals(e)?o.push(an.createFromPool(i)):o.push(an.createFromPool(i.average(e)))}n||o.push(an.createFromPool(s[s.length-1].end));const a=gn.createFromPool(t,n);for(r=0;r<s.length;r++){let t=r+1;n&&t===s.length&&(t=0);const e=un.createFromPool(s[r],o[r],o[t]);a.halfEdges.push(e.forwardHalf),this.addEdge(e)}this.loops.push(a),this.vertices.push.apply(this.vertices,o)},computeSimplifiedFaces:function(){this.eliminateOverlap(),this.eliminateSelfIntersection(),this.eliminateIntersection(),this.collapseVertices(),this.removeBridges(),this.removeLowOrderVertices(),this.orderVertexEdges(),this.extractFaces(),this.computeBoundaryTree(),this.computeWindingMap()},computeFaceInclusion:function(t){for(let e=0;e<this.faces.length;e++){const i=this.faces[e];i.filled=t(i.windingMap)}},createFilledSubGraph:function(){const t=new bn,e={};for(let i=0;i<this.edges.length;i++){const n=this.edges[i];if(n.forwardHalf.face.filled!==n.reversedHalf.face.filled){if(!e[n.startVertex.id]){const i=an.createFromPool(n.startVertex.point);t.vertices.push(i),e[n.startVertex.id]=i}if(!e[n.endVertex.id]){const i=an.createFromPool(n.endVertex.point);t.vertices.push(i),e[n.endVertex.id]=i}const i=e[n.startVertex.id],s=e[n.endVertex.id];t.addEdge(un.createFromPool(n.segment,i,s))}}return t.collapseAdjacentEdges(),t.orderVertexEdges(),t.extractFaces(),t.computeBoundaryTree(),t.fillAlternatingFaces(),t},facesToShape:function(){const t=[];for(let e=0;e<this.faces.length;e++){const i=this.faces[e];if(i.filled){t.push(i.boundary.toSubpath());for(let e=0;e<i.holes.length;e++)t.push(i.holes[e].toSubpath())}}return new Je.Shape(t)},dispose:function(){for(;this.boundaries.length;)this.boundaries.pop().dispose();for(ci(this.innerBoundaries),ci(this.outerBoundaries);this.loops.length;)this.loops.pop().dispose();for(;this.faces.length;)this.faces.pop().dispose();for(;this.vertices.length;)this.vertices.pop().dispose();for(;this.edges.length;)this.edges.pop().dispose()},addEdge:function(t){this.edges.push(t),t.startVertex.incidentHalfEdges.push(t.reversedHalf),t.endVertex.incidentHalfEdges.push(t.forwardHalf)},removeEdge:function(t){q(this.edges,t),q(t.startVertex.incidentHalfEdges,t.reversedHalf),q(t.endVertex.incidentHalfEdges,t.forwardHalf)},replaceEdgeInLoops:function(t,e){const i=[];for(var n=0;n<e.length;n++)i.push(e[e.length-1-n].getReversed());for(n=0;n<this.loops.length;n++){const s=this.loops[n];for(let n=s.halfEdges.length-1;n>=0;n--){const r=s.halfEdges[n];if(r.edge===t){const o=r===t.forwardHalf?e:i;Array.prototype.splice.apply(s.halfEdges,[n,1].concat(o))}}}},collapseAdjacentEdges:function(){let t=!0;for(;t;){t=!1;t:for(let e=0;e<this.vertices.length;e++){const i=this.vertices[e];if(2===i.incidentHalfEdges.length){const e=i.incidentHalfEdges[0].edge,n=i.incidentHalfEdges[1].edge;let s=e.segment,r=n.segment;const o=e.getOtherVertex(i),a=n.getOtherVertex(i);if(e.startVertex===i&&(s=s.reversed()),n.endVertex===i&&(r=r.reversed()),s instanceof Di&&r instanceof Di&&s.tangentAt(0).normalized().distance(r.tangentAt(0).normalized())<1e-6){this.removeEdge(e),this.removeEdge(n),e.dispose(),n.dispose(),q(this.vertices,i),i.dispose();const s=new Di(o.point,a.point);this.addEdge(new un(s,o,a)),t=!0;break t}}}}},eliminateOverlap:function(){let t=!0;for(;t;){t=!1;t:for(let e=0;e<this.edges.length;e++){const i=this.edges[e],n=i.segment;for(let s=e+1;s<this.edges.length;s++){const e=this.edges[s],r=e.segment;let o=null;if(n instanceof Di&&r instanceof Di&&(o=Di.getOverlaps),n instanceof Ni&&r instanceof Ni&&(o=Ni.getOverlaps),n instanceof qi&&r instanceof qi&&(o=qi.getOverlaps),n instanceof Ii&&r instanceof Ii&&(o=Ii.getOverlaps),n instanceof ji&&r instanceof ji&&(o=ji.getOverlaps),o){const s=o(n,r);if(s.length)for(let n=0;n<s.length;n++){const r=s[n];if(Math.abs(r.t1-r.t0)>1e-5&&Math.abs(r.qt1-r.qt0)>1e-5){this.splitOverlap(i,e,r),t=!0;break t}}}}}}},splitOverlap:function(t,e,i){const n=t.segment,s=e.segment;this.removeEdge(t),this.removeEdge(e);let r=i.t0,o=i.t1,a=i.qt0,l=i.qt1;r<1e-5&&(r=0),o>.99999&&(o=1),a<1e-5&&(a=0),l>.99999&&(l=1);const h=r>0?n.subdivided(r)[0]:null,u=a>0?s.subdivided(a)[0]:null,c=o<1?n.subdivided(o)[1]:null,d=l<1?s.subdivided(l)[1]:null;let f,p,m=n;r>0&&(m=m.subdivided(r)[1]),o<1&&(m=m.subdivided(Be.linear(r,1,0,1,o))[0]),h&&u?(f=an.createFromPool(m.start),this.vertices.push(f)):f=h?i.a>0?e.startVertex:e.endVertex:t.startVertex,c&&d?(p=an.createFromPool(m.end),this.vertices.push(p)):p=c?i.a>0?e.endVertex:e.startVertex:t.endVertex;const g=un.createFromPool(m,f,p);let y,b,v,_;this.addEdge(g),h&&(y=un.createFromPool(h,t.startVertex,f),this.addEdge(y)),c&&(b=un.createFromPool(c,p,t.endVertex),this.addEdge(b)),u&&(v=un.createFromPool(u,e.startVertex,i.a>0?f:p),this.addEdge(v)),d&&(_=un.createFromPool(d,i.a>0?p:f,e.endVertex),this.addEdge(_));const w=(h?[y]:[]).concat([g]).concat(c?[b]:[]),A=(u?[v]:[]).concat([g]).concat(d?[_]:[]),x=[],T=[];for(var S=0;S<w.length;S++)x.push(w[S].forwardHalf);for(S=0;S<A.length;S++){const t=A[S]!==g||i.a>0;T.push(t?A[S].forwardHalf:A[S].reversedHalf)}this.replaceEdgeInLoops(t,x),this.replaceEdgeInLoops(e,T),t.dispose(),e.dispose()},eliminateSelfIntersection:function(){for(let t=this.edges.length-1;t>=0;t--){const e=this.edges[t],i=e.segment;if(i instanceof qi){const t=i.getSelfIntersection();if(t){const n=i.subdivisions([t.aT,t.bT]),s=an.createFromPool(t.point);this.vertices.push(s);const r=un.createFromPool(n[0],e.startVertex,s),o=un.createFromPool(n[1],s,s),a=un.createFromPool(n[2],s,e.endVertex);this.removeEdge(e),this.addEdge(r),this.addEdge(o),this.addEdge(a),this.replaceEdgeInLoops(e,[r.forwardHalf,o.forwardHalf,a.forwardHalf]),e.dispose()}}}},eliminateIntersection:function(){let t=!0;for(;t;){t=!1;t:for(let e=0;e<this.edges.length;e++){const i=this.edges[e],n=i.segment;for(let s=e+1;s<this.edges.length;s++){const e=this.edges[s],r=e.segment;let o=xi.intersect(n,r);if(o=o.filter((function(t){const e=t.aT,i=t.bT;return e>1e-5&&e<.99999||i>1e-5&&i<.99999})),o.length){const n=o[0];t=this.simpleSplit(i,e,n.aT,n.bT,n.point);break t}}}}},simpleSplit:function(t,e,i,n,s){let r=!1;const o=i>1e-6&&i<.999999,a=n>1e-6&&n<.999999;let l=null;return o?a?(l=an.createFromPool(s),this.vertices.push(l)):l=n<.5?e.startVertex:e.endVertex:l=i<.5?t.startVertex:t.endVertex,o&&l!==t.startVertex&&l!==t.endVertex&&(this.splitEdge(t,i,l),r=!0),a&&l!==e.startVertex&&l!==e.endVertex&&(this.splitEdge(e,n,l),r=!0),r},splitEdge:function(t,e,i){const n=t.segment.subdivided(e),s=un.createFromPool(n[0],t.startVertex,i),r=un.createFromPool(n[1],i,t.endVertex);this.removeEdge(t),this.addEdge(s),this.addEdge(r),this.replaceEdgeInLoops(t,[s.forwardHalf,r.forwardHalf]),t.dispose()},collapseVertices:function(){let t=!0;for(;t;){t=!1;t:for(let e=0;e<this.vertices.length;e++){const i=this.vertices[e];for(let n=e+1;n<this.vertices.length;n++){const e=this.vertices[n],s=i.point.distance(e.point);if(s<1e-5){const n=an.createFromPool(0===s?i.point:i.point.average(e.point));this.vertices.push(n),q(this.vertices,i),q(this.vertices,e);for(let t=this.edges.length-1;t>=0;t--){const s=this.edges[t],r=s.startVertex===i||s.startVertex===e,o=s.endVertex===i||s.endVertex===e;if(r&&o){if((s.segment.bounds.width>1e-5||s.segment.bounds.height>1e-5)&&(s.segment instanceof qi||s.segment instanceof Ii||s.segment instanceof ji)){const t=un.createFromPool(s.segment,n,n);this.addEdge(t),this.replaceEdgeInLoops(s,[t.forwardHalf])}else this.replaceEdgeInLoops(s,[]);this.removeEdge(s),s.dispose()}else r?(s.startVertex=n,n.incidentHalfEdges.push(s.reversedHalf),s.updateReferences()):o&&(s.endVertex=n,n.incidentHalfEdges.push(s.forwardHalf),s.updateReferences())}i.dispose(),e.dispose(),t=!0;break t}}}}},markBridges:function(t,e){e.visited=!0,e.visitIndex=e.lowIndex=yn++;for(let i=0;i<e.incidentHalfEdges.length;i++){const n=e.incidentHalfEdges[i].edge,s=e.incidentHalfEdges[i].startVertex;s.visited?n.visited||(e.lowIndex=Math.min(e.lowIndex,s.visitIndex)):(n.visited=!0,s.parent=e,this.markBridges(t,s),e.lowIndex=Math.min(e.lowIndex,s.lowIndex),s.lowIndex>e.visitIndex&&t.push(n))}},removeBridges:function(){const t=[];for(var e=0;e<this.vertices.length;e++){const i=this.vertices[e];i.visited||this.markBridges(t,i)}for(e=0;e<t.length;e++){const i=t[e];this.removeEdge(i),this.replaceEdgeInLoops(i,[]),i.dispose()}},removeLowOrderVertices:function(){let t=!0;for(;t;){t=!1;t:for(let e=this.vertices.length-1;e>=0;e--){const i=this.vertices[e];if(i.incidentHalfEdges.length<2){for(let t=0;t<i.incidentHalfEdges.length;t++){const e=i.incidentHalfEdges[t].edge;this.removeEdge(e),this.replaceEdgeInLoops(e,[]),e.dispose()}this.vertices.splice(e,1),i.dispose(),t=!0;break t}}}},orderVertexEdges:function(){for(let t=0;t<this.vertices.length;t++)this.vertices[t].sortEdges()},extractFaces:function(){const t=[];for(var e=0;e<this.edges.length;e++)t.push(this.edges[e].forwardHalf),t.push(this.edges[e].reversedHalf);for(;t.length;){const e=[];let i=t[0];const n=i;for(;i&&(q(t,i),e.push(i),i=i.getNext(),i!==n););const s=en.createFromPool(e);(s.signedArea>0?this.innerBoundaries:this.outerBoundaries).push(s),this.boundaries.push(s)}for(e=0;e<this.innerBoundaries.length;e++)this.faces.push(fn.createFromPool(this.innerBoundaries[e]))},computeBoundaryTree:function(){const t=[],e=new hi(oi.rotation2(1.5729657));for(var i=0;i<this.outerBoundaries.length;i++){const n=this.outerBoundaries[i],s=n.computeExtremeRay(e);let r=null,o=Number.POSITIVE_INFINITY,a=!1;for(let t=0;t<this.edges.length;t++){const e=this.edges[t],i=e.segment.intersection(s);for(let t=0;t<i.length;t++){const n=i[t];n.distance<o&&(r=e,o=n.distance,a=n.wind)}}if(null===r)t.push(n);else{const t=a<0?r.reversedHalf:r.forwardHalf;this.getBoundaryOfHalfEdge(t).childBoundaries.push(n)}}for(t.forEach(this.unboundedFace.recursivelyAddHoles.bind(this.unboundedFace)),i=0;i<this.faces.length;i++){const t=this.faces[i];null!==t.boundary&&t.boundary.childBoundaries.forEach(t.recursivelyAddHoles.bind(t))}},computeWindingMap:function(){const t=this.edges.slice(),e={};for(let i=0;i<this.shapeIds.length;i++)e[this.shapeIds[i]]=0;for(this.unboundedFace.windingMap=e;t.length;)for(let e=t.length-1;e>=0;e--){const i=t[e],n=i.forwardHalf,s=i.reversedHalf,r=n.face,o=s.face,a=null!==r.windingMap,l=null!==o.windingMap;if(a&&l)t.splice(e,1);else{if(!a&&!l)continue;{const t=a?r:o,e=a?o:r,n={};for(let s=0;s<this.shapeIds.length;s++){const e=this.shapeIds[s],r=this.computeDifferential(i,e);n[e]=t.windingMap[e]+r*(a?-1:1)}e.windingMap=n}}}},computeDifferential:function(t,e){let i=0;for(let n=0;n<this.loops.length;n++){const s=this.loops[n];if(s.shapeId===e)for(let e=0;e<s.halfEdges.length;e++){const n=s.halfEdges[e];n===t.forwardHalf?i++:n===t.reversedHalf&&i--}}return i},fillAlternatingFaces:function(){let t=0;for(var e=0;e<this.faces.length;e++)this.faces[e].filled=null,t++;for(this.unboundedFace.filled=!1,t--;t;)for(e=0;e<this.edges.length;e++){const i=this.edges[e],n=i.forwardHalf.face,s=i.reversedHalf.face,r=null===n.filled,o=null===s.filled;r&&!o?(n.filled=!s.filled,t--):!r&&o&&(s.filled=!n.filled,t--)}},getBoundaryOfHalfEdge:function(t){for(let e=0;e<this.boundaries.length;e++){const i=this.boundaries[e];if(i.hasHalfEdge(t))return i}throw new Error("Could not find boundary")}}),bn.BINARY_NONZERO_UNION=function(t){return 0!==t[0]||0!==t[1]},bn.BINARY_NONZERO_INTERSECTION=function(t){return 0!==t[0]&&0!==t[1]},bn.BINARY_NONZERO_DIFFERENCE=function(t){return 0!==t[0]&&0===t[1]},bn.BINARY_NONZERO_XOR=function(t){return 1==(0!==t[0]^0!==t[1])},bn.binaryResult=function(t,e,i){const n=new bn;n.addShape(0,t),n.addShape(1,e),n.computeSimplifiedFaces(),n.computeFaceInclusion(i);const s=n.createFilledSubGraph(),r=s.facesToShape();return n.dispose(),s.dispose(),r},bn.unionNonZero=function(t){const e=new bn;for(let s=0;s<t.length;s++)e.addShape(s,t[s]);e.computeSimplifiedFaces(),e.computeFaceInclusion((function(e){for(let i=0;i<t.length;i++)if(0!==e[i])return!0;return!1}));const i=e.createFilledSubGraph(),n=i.facesToShape();return e.dispose(),i.dispose(),n},bn.intersectionNonZero=function(t){const e=new bn;for(let s=0;s<t.length;s++)e.addShape(s,t[s]);e.computeSimplifiedFaces(),e.computeFaceInclusion((function(e){for(let i=0;i<t.length;i++)if(0===e[i])return!1;return!0}));const i=e.createFilledSubGraph(),n=i.facesToShape();return e.dispose(),i.dispose(),n},bn.xorNonZero=function(t){const e=new bn;for(let s=0;s<t.length;s++)e.addShape(s,t[s]);e.computeSimplifiedFaces(),e.computeFaceInclusion((function(e){let i=!1;for(let n=0;n<t.length;n++)0!==e[n]&&(i=!i);return i}));const i=e.createFilledSubGraph(),n=i.facesToShape();return e.dispose(),i.dispose(),n},bn.simplifyNonZero=function(t){const e=new bn;e.addShape(0,t),e.computeSimplifiedFaces(),e.computeFaceInclusion((function(t){return 0!==t[0]}));const i=e.createFilledSubGraph(),n=i.facesToShape();return e.dispose(),i.dispose(),n},bn.clipShape=function(t,e,i){let n,s,r;i=h({includeExterior:!1,includeBoundary:!0,includeInterior:!0},i);const o=bn.simplifyNonZero(t),a=new bn;for(a.addShape(0,e,{ensureClosed:!1}),a.addShape(1,o),a.eliminateOverlap(),a.eliminateSelfIntersection(),a.eliminateIntersection(),a.collapseVertices(),n=0;n<a.loops.length;n++)if(r=a.loops[n],1===r.shapeId)for(s=0;s<r.halfEdges.length;s++)r.halfEdges[s].edge.data=!0;const l=[];for(n=0;n<a.loops.length;n++)if(r=a.loops[n],0===r.shapeId){let t=[];for(s=0;s<r.halfEdges.length;s++){const e=r.halfEdges[s];(e.edge.data?i.includeBoundary:o.containsPoint(e.edge.segment.positionAt(.5))?i.includeInterior:i.includeExterior)?t.push(e.getDirectionalSegment()):t.length&&(l.push(new $i(t,void 0,r.closed)),t=[])}t.length&&l.push(new $i(t,void 0,r.closed))}return a.dispose(),new Je.Shape(l)};var vn=Je.Graph;function _n(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var wn={parse:function(t,e){var i={svgPath:function(){var t,e,i,s,r,o;r=n,o=n,t=[],e=j();for(;null!==e;)t.push(e),e=j();if(null!==t)if(null!==(e=null!==(e=a())?e:"")){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i?t=[t,e,i]:(t=null,n=o)}else t=null,n=o;else t=null,n=o;null!==t&&(l=t[1],t=l||[]);var l;null===t&&(n=r);return t},movetoDrawtoCommandGroups:a,movetoDrawtoCommandGroup:l,drawtoCommands:h,drawtoCommand:u,moveto:c,movetoArgumentSequence:d,closepath:f,lineto:p,linetoArgumentSequence:m,horizontalLineto:g,horizontalLinetoArgumentSequence:y,verticalLineto:b,verticalLinetoArgumentSequence:v,curveto:_,curvetoArgumentSequence:w,curvetoArgument:A,smoothCurveto:x,smoothCurvetoArgumentSequence:T,smoothCurvetoArgument:S,quadraticBezierCurveto:D,quadraticBezierCurvetoArgumentSequence:E,quadraticBezierCurvetoArgument:C,smoothQuadraticBezierCurveto:I,smoothQuadraticBezierCurvetoArgumentSequence:P,ellipticalArc:k,ellipticalArcArgumentSequence:L,ellipticalArcArgument:O,coordinatePair:N,nonnegativeNumber:R,number:M,flag:B,commaWsp:F,comma:V,floatingPointConstant:H,fractionalConstant:z,exponent:G,sign:q,digitSequence:Y,digit:U,wsp:j};if(void 0!==e){if(void 0===i[e])throw new Error("Invalid rule name: "+_n(e)+".")}else e="svgPath";var n=0,s=0,r=[];function o(t){n<s||(n>s&&(s=n,r=[]),r.push(t))}function a(){var t,e,i,s,r,o,h;if(s=n,r=n,null!==(t=l())){for(e=[],i=j();null!==i;)e.push(i),i=j();null!==e&&null!==(i=a())?t=[t,e,i]:(t=null,n=r)}else t=null,n=r;return null!==t&&(o=t[0],h=t[2],t=o.concat(h)),null===t&&(n=s),null===t&&(s=n,null!==(t=l())&&(t=function(t,e){return e}(0,t)),null===t&&(n=s)),t}function l(){var t,e,i,s,r,o,a;if(s=n,r=n,null!==(t=c())){for(e=[],i=j();null!==i;)e.push(i),i=j();null!==e&&null!==(i=null!==(i=h())?i:"")?t=[t,e,i]:(t=null,n=r)}else t=null,n=r;return null!==t&&(o=t[0],t=(a=t[2]).length?o.concat(a):o),null===t&&(n=s),t}function h(){var t,e,i,s,r,o,a;if(s=n,r=n,null!==(t=u())){for(e=[],i=j();null!==i;)e.push(i),i=j();null!==e&&null!==(i=h())?t=[t,e,i]:(t=null,n=r)}else t=null,n=r;return null!==t&&(o=t[0],a=t[2],t=o.concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=u())&&(t=function(t,e){return e}(0,t)),null===t&&(n=s)),t}function u(){var t;return null===(t=f())&&null===(t=p())&&null===(t=g())&&null===(t=b())&&null===(t=_())&&null===(t=x())&&null===(t=D())&&null===(t=I())&&(t=k()),t}function c(){var e,i,s,r,a;if(r=n,a=n,77===t.charCodeAt(n)?(e="M",n++):(e=null,o('"M"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=d())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=W(e[2],!1)),null===e&&(n=r),null===e){if(r=n,a=n,109===t.charCodeAt(n)?(e="m",n++):(e=null,o('"m"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=d())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return W(e,!0)}(0,e[2])),null===e&&(n=r)}return e}function d(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=N())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=m())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=N())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function f(){var e,i;return i=n,90===t.charCodeAt(n)?(e="Z",n++):(e=null,o('"Z"')),null===e&&(122===t.charCodeAt(n)?(e="z",n++):(e=null,o('"z"'))),null!==e&&(e={cmd:"close"}),null===e&&(n=i),e}function p(){var e,i,s,r,a;if(r=n,a=n,76===t.charCodeAt(n)?(e="L",n++):(e=null,o('"L"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=m())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"lineTo",args:[t.x,t.y]}}))),null===e&&(n=r),null===e){if(r=n,a=n,108===t.charCodeAt(n)?(e="l",n++):(e=null,o('"l"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=m())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"lineToRelative",args:[t.x,t.y]}}))}(0,e[2])),null===e&&(n=r)}return e}function m(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=N())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=m())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=N())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function g(){var e,i,s,r,a;if(r=n,a=n,72===t.charCodeAt(n)?(e="H",n++):(e=null,o('"H"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=y())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"horizontalLineTo",args:[t]}}))),null===e&&(n=r),null===e){if(r=n,a=n,104===t.charCodeAt(n)?(e="h",n++):(e=null,o('"h"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=y())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"horizontalLineToRelative",args:[t]}}))}(0,e[2])),null===e&&(n=r)}return e}function y(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=M())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=y())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=M())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function b(){var e,i,s,r,a;if(r=n,a=n,86===t.charCodeAt(n)?(e="V",n++):(e=null,o('"V"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=v())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"verticalLineTo",args:[t]}}))),null===e&&(n=r),null===e){if(r=n,a=n,118===t.charCodeAt(n)?(e="v",n++):(e=null,o('"v"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=v())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"verticalLineToRelative",args:[t]}}))}(0,e[2])),null===e&&(n=r)}return e}function v(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=M())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=v())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=M())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function _(){var e,i,s,r,a;if(r=n,a=n,67===t.charCodeAt(n)?(e="C",n++):(e=null,o('"C"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=w())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"cubicCurveTo",args:t}}))),null===e&&(n=r),null===e){if(r=n,a=n,99===t.charCodeAt(n)?(e="c",n++):(e=null,o('"c"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=w())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"cubicCurveToRelative",args:t}}))}(0,e[2])),null===e&&(n=r)}return e}function w(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=A())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=w())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=A())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function A(){var t,e,i,s,r,o,a,l,h,u;return o=n,a=n,null!==(t=N())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=N())&&null!==(s=null!==(s=F())?s:"")&&null!==(r=N())?t=[t,e,i,s,r]:(t=null,n=a),null!==t&&(l=t[0],h=t[2],u=t[4],t=[l.x,l.y,h.x,h.y,u.x,u.y]),null===t&&(n=o),t}function x(){var e,i,s,r,a;if(r=n,a=n,83===t.charCodeAt(n)?(e="S",n++):(e=null,o('"S"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=T())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"smoothCubicCurveTo",args:t}}))),null===e&&(n=r),null===e){if(r=n,a=n,115===t.charCodeAt(n)?(e="s",n++):(e=null,o('"s"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=T())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"smoothCubicCurveToRelative",args:t}}))}(0,e[2])),null===e&&(n=r)}return e}function T(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=S())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=T())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=S())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function S(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=N())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=N())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o.x,o.y,a.x,a.y]),null===t&&(n=s),t}function D(){var e,i,s,r,a;if(r=n,a=n,81===t.charCodeAt(n)?(e="Q",n++):(e=null,o('"Q"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=E())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"quadraticCurveTo",args:t}}))),null===e&&(n=r),null===e){if(r=n,a=n,113===t.charCodeAt(n)?(e="q",n++):(e=null,o('"q"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=E())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"quadraticCurveToRelative",args:t}}))}(0,e[2])),null===e&&(n=r)}return e}function E(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=C())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=E())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=C())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function C(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=N())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=N())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o.x,o.y,a.x,a.y]),null===t&&(n=s),t}function I(){var e,i,s,r,a;if(r=n,a=n,84===t.charCodeAt(n)?(e="T",n++):(e=null,o('"T"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=P())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return{cmd:"smoothQuadraticCurveTo",args:[t.x,t.y]}}))),null===e&&(n=r),null===e){if(r=n,a=n,116===t.charCodeAt(n)?(e="t",n++):(e=null,o('"t"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=P())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return{cmd:"smoothQuadraticCurveToRelative",args:[t.x,t.y]}}))}(0,e[2])),null===e&&(n=r)}return e}function P(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=N())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=P())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=N())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function k(){var e,i,s,r,a;if(r=n,a=n,65===t.charCodeAt(n)?(e="A",n++):(e=null,o('"A"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=L())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;if(null!==e&&(e=e[2].map((function(t){return t[2]*=Math.PI/180,{cmd:"ellipticalArcTo",args:t}}))),null===e&&(n=r),null===e){if(r=n,a=n,97===t.charCodeAt(n)?(e="a",n++):(e=null,o('"a"')),null!==e){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i&&null!==(s=L())?e=[e,i,s]:(e=null,n=a)}else e=null,n=a;null!==e&&(e=function(t,e){return e.map((function(t){return t[2]*=Math.PI/180,{cmd:"ellipticalArcToRelative",args:t}}))}(0,e[2])),null===e&&(n=r)}return e}function L(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=O())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=L())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t=[o].concat(a)),null===t&&(n=s),null===t&&(s=n,null!==(t=O())&&(t=function(t,e){return[e]}(0,t)),null===t&&(n=s)),t}function O(){var t,e,i,s,r,o,a,l,h,u,c,d,f,p,m,g,y,b,v;return d=n,f=n,null!==(t=R())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=R())&&null!==(s=null!==(s=F())?s:"")&&null!==(r=M())&&null!==(o=F())&&null!==(a=B())&&null!==(l=null!==(l=F())?l:"")&&null!==(h=B())&&null!==(u=null!==(u=F())?u:"")&&null!==(c=N())?t=[t,e,i,s,r,o,a,l,h,u,c]:(t=null,n=f),null!==t&&(p=t[0],m=t[2],g=t[4],y=t[6],b=t[8],v=t[10],t=[p,m,g,y,b,v.x,v.y]),null===t&&(n=d),t}function N(){var t,e,i,s,r,o,a;return s=n,r=n,null!==(t=M())&&null!==(e=null!==(e=F())?e:"")&&null!==(i=M())?t=[t,e,i]:(t=null,n=r),null!==t&&(o=t[0],a=t[2],t={x:o,y:a}),null===t&&(n=s),t}function R(){var t,e;return e=n,null!==(t=H())&&(t=parseFloat(t)),null===t&&(n=e),null===t&&(e=n,null!==(t=Y())&&(t=function(t,e){return parseInt(e,10)}(0,t)),null===t&&(n=e)),t}function M(){var t,e,i,s,r,o;return i=n,s=n,null!==(t=null!==(t=q())?t:"")&&null!==(e=H())?t=[t,e]:(t=null,n=s),null!==t&&(r=t[0],o=t[1],t=parseFloat(r+o)),null===t&&(n=i),null===t&&(i=n,s=n,null!==(t=null!==(t=q())?t:"")&&null!==(e=Y())?t=[t,e]:(t=null,n=s),null!==t&&(t=function(t,e,i){return parseInt(e+i,10)}(0,t[0],t[1])),null===t&&(n=i)),t}function B(){var e,i;return i=n,48===t.charCodeAt(n)?(e="0",n++):(e=null,o('"0"')),null!==e&&(e=!1),null===e&&(n=i),null===e&&(i=n,49===t.charCodeAt(n)?(e="1",n++):(e=null,o('"1"')),null!==e&&(e=!0),null===e&&(n=i)),e}function F(){var t,e,i,s,r;if(r=n,null!==(e=j()))for(t=[];null!==e;)t.push(e),e=j();else t=null;if(null!==t)if(null!==(e=null!==(e=V())?e:"")){for(i=[],s=j();null!==s;)i.push(s),s=j();null!==i?t=[t,e,i]:(t=null,n=r)}else t=null,n=r;else t=null,n=r;if(null===t)if(r=n,null!==(t=V())){for(e=[],i=j();null!==i;)e.push(i),i=j();null!==e?t=[t,e]:(t=null,n=r)}else t=null,n=r;return t}function V(){var e;return 44===t.charCodeAt(n)?(e=",",n++):(e=null,o('","')),e}function H(){var t,e,i,s,r,o;return i=n,s=n,null!==(t=z())&&null!==(e=null!==(e=G())?e:"")?t=[t,e]:(t=null,n=s),null!==t&&(r=t[0],o=t[1],t=r+o),null===t&&(n=i),null===t&&(i=n,s=n,null!==(t=Y())&&null!==(e=G())?t=[t,e]:(t=null,n=s),null!==t&&(t=function(t,e,i){return e+i}(0,t[0],t[1])),null===t&&(n=i)),t}function z(){var e,i,s,r,a,l,h;return r=n,a=n,null!==(e=null!==(e=Y())?e:"")?(46===t.charCodeAt(n)?(i=".",n++):(i=null,o('"."')),null!==i&&null!==(s=Y())?e=[e,i,s]:(e=null,n=a)):(e=null,n=a),null!==e&&(l=e[0],h=e[2],e=l+"."+h),null===e&&(n=r),null===e&&(r=n,a=n,null!==(e=Y())?(46===t.charCodeAt(n)?(i=".",n++):(i=null,o('"."')),null!==i?e=[e,i]:(e=null,n=a)):(e=null,n=a),null!==e&&(e=function(t,e){return e}(0,e[0])),null===e&&(n=r)),e}function G(){var e,i,s,r,a,l,h,u;return r=n,a=n,101===t.charCodeAt(n)?(e="e",n++):(e=null,o('"e"')),null===e&&(69===t.charCodeAt(n)?(e="E",n++):(e=null,o('"E"'))),null!==e&&null!==(i=null!==(i=q())?i:"")&&null!==(s=Y())?e=[e,i,s]:(e=null,n=a),null!==e&&(l=e[0],h=e[1],u=e[2],e=l+h+u),null===e&&(n=r),e}function q(){var e;return 43===t.charCodeAt(n)?(e="+",n++):(e=null,o('"+"')),null===e&&(45===t.charCodeAt(n)?(e="-",n++):(e=null,o('"-"'))),e}function Y(){var t,e,i,s,r,o;return i=n,s=n,null!==(t=U())&&null!==(e=Y())?t=[t,e]:(t=null,n=s),null!==t&&(r=t[0],o=t[1],t=r+o),null===t&&(n=i),null===t&&(t=U()),t}function U(){var e;return/^[0-9]/.test(t.charAt(n))?(e=t.charAt(n),n++):(e=null,o("[0-9]")),e}function j(){var e;return 32===t.charCodeAt(n)?(e=" ",n++):(e=null,o('" "')),null===e&&(9===t.charCodeAt(n)?(e="\t",n++):(e=null,o('"\\t"')),null===e&&(13===t.charCodeAt(n)?(e="\r",n++):(e=null,o('"\\r"')),null===e&&(10===t.charCodeAt(n)?(e="\n",n++):(e=null,o('"\\n"'))))),e}function W(t,e){var i=[{cmd:e?"moveToRelative":"moveTo",args:[t[0].x,t[0].y]}];if(t.length>1)for(var n=1;n<t.length;n++)i.push({cmd:e?"lineToRelative":"lineTo",args:[t[n].x,t[n].y]});return i}var X=i[e]();if(null===X||n!==t.length){var K=Math.max(n,s),Q=K<t.length?t.charAt(K):null,Z=function(){for(var e=1,i=1,r=!1,o=0;o<Math.max(n,s);o++){var a=t.charAt(o);"\n"===a?(r||e++,i=1,r=!1):"\r"===a||"\u2028"===a||"\u2029"===a?(e++,i=1,r=!0):(i++,r=!1)}return{line:e,column:i}}();throw new this.SyntaxError(function(t){t.sort();for(var e=null,i=[],n=0;n<t.length;n++)t[n]!==e&&(i.push(t[n]),e=t[n]);return i}(r),Q,K,Z.line,Z.column)}return X},toSource:function(){return this._source},SyntaxError:function(t,e,i,n,s){this.name="SyntaxError",this.expected=t,this.found=e,this.message=function(t,e){var i;switch(t.length){case 0:i="end of input";break;case 1:i=t[0];break;default:i=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return"Expected "+i+" but "+(e?_n(e):"end of input")+" found."}(t,e),this.offset=i,this.line=n,this.column=s}};wn.SyntaxError.prototype=Error.prototype,Je.register("svgPath",wn);var An=Je.svgPath;const xn=Math.random;function Tn(t,e){return new je(t,e)}function Sn(t,e,i,n){return i.copy().subtract(t).multiplyScalar((1-n)/6).add(e)}function Dn(t,e){const i=this;if(this.subpaths=[],this._bounds=e?e.copy():null,this.invalidatedEmitter=new C,this.resetControlPoints(),this._invalidateListener=this.invalidate.bind(this),this._invalidatingPoints=!1,this._immutable=!1,"object"==typeof t)for(let n=0;n<t.length;n++)this.addSubpath(t[n]);t&&"object"!=typeof t&&_.each(An.parse(t),(function(t){i[t.cmd].apply(i,t.args)})),this.invalidate()}Je.register("Shape",Dn),R(Object,Dn,{resetControlPoints:function(){this.lastQuadraticControlPoint=null,this.lastCubicControlPoint=null},setQuadraticControlPoint:function(t){this.lastQuadraticControlPoint=t,this.lastCubicControlPoint=null},setCubicControlPoint:function(t){this.lastQuadraticControlPoint=null,this.lastCubicControlPoint=t},moveTo:function(t,e){return this.moveToPoint(Tn(t,e))},moveToRelative:function(t,e){return this.moveToPointRelative(Tn(t,e))},moveToPointRelative:function(t){return this.moveToPoint(this.getRelativePoint().plus(t))},moveToPoint:function(t){return this.addSubpath((new $i).addPoint(t)),this.resetControlPoints(),this},lineTo:function(t,e){return this.lineToPoint(Tn(t,e))},lineToRelative:function(t,e){return this.lineToPointRelative(Tn(t,e))},lineToPointRelative:function(t){return this.lineToPoint(this.getRelativePoint().plus(t))},lineToPoint:function(t){if(this.hasSubpaths()){const e=this.getLastSubpath().getLastPoint(),i=t,n=new Di(e,i);this.getLastSubpath().addPoint(i),this.addSegmentAndBounds(n)}else this.ensure(t);return this.resetControlPoints(),this},horizontalLineTo:function(t){return this.lineTo(t,this.getRelativePoint().y)},horizontalLineToRelative:function(t){return this.lineToRelative(t,0)},verticalLineTo:function(t){return this.lineTo(this.getRelativePoint().x,t)},verticalLineToRelative:function(t){return this.lineToRelative(0,t)},zigZagTo:function(t,e,i,n,s){return this.zigZagToPoint(new je(t,e),i,n,s)},zigZagToPoint:function(t,e,i,n){this.ensure(t);const s=this.getLastPoint(),r=t.minus(s),o=r.normalized(),a=o.perpendicular.times(e);let l;l=n?r.magnitude/(i+.5):r.magnitude/i;for(let h=0;h<i;h++){const t=o.times(h*l).plus(s),e=t.plus(o.times(l/4)).plus(a),i=t.plus(o.times(3*l/4)).minus(a);this.lineToPoint(e),this.lineToPoint(i)}if(n){const t=o.times(i*l).plus(s).plus(o.times(l/4)).plus(a);this.lineToPoint(t)}return this.lineToPoint(t)},quadraticCurveTo:function(t,e,i,n){return this.quadraticCurveToPoint(Tn(t,e),Tn(i,n))},quadraticCurveToRelative:function(t,e,i,n){return this.quadraticCurveToPointRelative(Tn(t,e),Tn(i,n))},quadraticCurveToPointRelative:function(t,e){const i=this.getRelativePoint();return this.quadraticCurveToPoint(i.plus(t),i.plus(e))},smoothQuadraticCurveTo:function(t,e){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),Tn(t,e))},smoothQuadraticCurveToRelative:function(t,e){return this.quadraticCurveToPoint(this.getSmoothQuadraticControlPoint(),Tn(t,e).plus(this.getRelativePoint()))},quadraticCurveToPoint:function(t,e){const i=this;this.ensure(t);const n=this.getLastSubpath().getLastPoint(),s=new Ni(n,t,e);this.getLastSubpath().addPoint(e);const r=s.getNondegenerateSegments();return _.each(r,(function(t){i.addSegmentAndBounds(t)})),this.setQuadraticControlPoint(t),this},cubicCurveTo:function(t,e,i,n,s,r){return this.cubicCurveToPoint(Tn(t,e),Tn(i,n),Tn(s,r))},cubicCurveToRelative:function(t,e,i,n,s,r){return this.cubicCurveToPointRelative(Tn(t,e),Tn(i,n),Tn(s,r))},cubicCurveToPointRelative:function(t,e,i){const n=this.getRelativePoint();return this.cubicCurveToPoint(n.plus(t),n.plus(e),n.plus(i))},smoothCubicCurveTo:function(t,e,i,n){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),Tn(t,e),Tn(i,n))},smoothCubicCurveToRelative:function(t,e,i,n){return this.cubicCurveToPoint(this.getSmoothCubicControlPoint(),Tn(t,e).plus(this.getRelativePoint()),Tn(i,n).plus(this.getRelativePoint()))},cubicCurveToPoint:function(t,e,i){const n=this;this.ensure(t);const s=this.getLastSubpath().getLastPoint(),r=new qi(s,t,e,i).getNondegenerateSegments();return _.each(r,(function(t){n.addSegmentAndBounds(t)})),this.getLastSubpath().addPoint(i),this.setCubicControlPoint(e),this},arc:function(t,e,i,n,s,r){return this.arcPoint(Tn(t,e),i,n,s,r)},arcPoint:function(t,e,i,n,s){void 0===s&&(s=!1);const r=new Ii(t,e,i,n,s),o=r.getStart(),a=r.getEnd();return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!o.equals(this.getLastSubpath().getLastPoint(),0)&&this.addSegmentAndBounds(new Di(this.getLastSubpath().getLastPoint(),o)),this.hasSubpaths()||this.addSubpath(new $i),this.getLastSubpath().addPoint(o),this.getLastSubpath().addPoint(a),this.addSegmentAndBounds(r),this.resetControlPoints(),this},ellipticalArc:function(t,e,i,n,s,r,o,a){return this.ellipticalArcPoint(Tn(t,e),i,n,s,r,o,a)},ellipticalArcPoint:function(t,e,i,n,s,r,o){void 0===o&&(o=!1);const a=new ji(t,e,i,n,s,r,o),l=a.start,h=a.end;return this.hasSubpaths()&&this.getLastSubpath().getLength()>0&&!l.equals(this.getLastSubpath().getLastPoint(),0)&&this.addSegmentAndBounds(new Di(this.getLastSubpath().getLastPoint(),l)),this.hasSubpaths()||this.addSubpath(new $i),this.getLastSubpath().addPoint(l),this.getLastSubpath().addPoint(h),this.addSegmentAndBounds(a),this.resetControlPoints(),this},close:function(){if(this.hasSubpaths()){const t=this.getLastSubpath(),e=new $i;t.close(),this.addSubpath(e),e.addPoint(t.getFirstPoint())}return this.resetControlPoints(),this},newSubpath:function(){return this.addSubpath(new $i),this.resetControlPoints(),this},makeImmutable:function(){return this._immutable=!0,this.notifyInvalidationListeners(),this},isImmutable:function(){return this._immutable},ellipticalArcToRelative:function(t,e,i,n,s,r,o){const a=this.getRelativePoint();return this.ellipticalArcTo(t,e,i,n,s,r+a.x,o+a.y)},ellipticalArcTo:function(t,e,i,n,s,r,o){const a=this,l=new je(r,o);this.ensure(l);const h=this.getLastSubpath().getLastPoint();this.getLastSubpath().addPoint(l),t<0&&(t*=-1),e<0&&(e*=-1);let u=t*t,c=e*e;const d=h.minus(l).dividedScalar(2).rotated(-i),f=d.x*d.x,p=d.y*d.y;let m=new je(t*d.y/e,-e*d.x/t);const g=f/u+p/c;g>1&&(u=(t*=Math.sqrt(g))*t,c=(e*=Math.sqrt(g))*e,m=new je(t*d.y/e,-e*d.x/t)),m.multiplyScalar(Math.sqrt(Math.max(0,(u*c-u*p-c*f)/(u*p+c*f)))),n===s&&m.multiplyScalar(-1);const y=h.blend(l,.5).plus(m.rotated(i));function b(t,e){return(t.x*e.y-t.y*e.x>0?1:-1)*t.angleBetween(e)}const v=new je((d.x-m.x)/t,(d.y-m.y)/e),w=new je((-d.x-m.x)/t,(-d.y-m.y)/e),A=b(je.X_UNIT,v);let x=b(v,w)%(2*Math.PI);!s&&x>0&&(x-=2*Math.PI),s&&x<0&&(x+=2*Math.PI);const T=new ji(y,t,e,i,A,A+x,!s).getNondegenerateSegments();return _.each(T,(function(t){a.addSegmentAndBounds(t)})),this},circle:function(t,e,i){if("object"==typeof t){const n=t;return i=e,this.arcPoint(n,i,0,2*Math.PI,!1).close()}return this.arcPoint(Tn(t,e),i,0,2*Math.PI,!1).close()},ellipse:function(t,e,i,n,s){if("object"==typeof t){const r=t;return s=n,n=i,i=e,this.ellipticalArcPoint(r,i,n,s||0,0,2*Math.PI,!1).close()}return this.ellipticalArcPoint(Tn(t,e),i,n,s||0,0,2*Math.PI,!1).close()},rect:function(t,e,i,n){const s=new $i;return this.addSubpath(s),s.addPoint(Tn(t,e)),s.addPoint(Tn(t+i,e)),s.addPoint(Tn(t+i,e+n)),s.addPoint(Tn(t,e+n)),this.addSegmentAndBounds(new Di(s.points[0],s.points[1])),this.addSegmentAndBounds(new Di(s.points[1],s.points[2])),this.addSegmentAndBounds(new Di(s.points[2],s.points[3])),s.close(),this.addSubpath(new $i),this.getLastSubpath().addPoint(Tn(t,e)),this.resetControlPoints(),this},roundRect:function(t,e,i,n,s,r){const o=t+s,a=t+i-s,l=e+r,h=e+n-r;return s===r?this.arc(a,l,s,-Math.PI/2,0,!1).arc(a,h,s,0,Math.PI/2,!1).arc(o,h,s,Math.PI/2,Math.PI,!1).arc(o,l,s,Math.PI,3*Math.PI/2,!1).close():this.ellipticalArc(a,l,s,r,0,-Math.PI/2,0,!1).ellipticalArc(a,h,s,r,0,0,Math.PI/2,!1).ellipticalArc(o,h,s,r,0,Math.PI/2,Math.PI,!1).ellipticalArc(o,l,s,r,0,Math.PI,3*Math.PI/2,!1).close(),this},polygon:function(t){const e=t.length;if(e>0){this.moveToPoint(t[0]);for(let i=1;i<e;i++)this.lineToPoint(t[i])}return this.close()},cardinalSpline:function(t,e){e=h({tension:0,isClosedLineSegments:!1},e);const i=t.length,n=e.isClosedLineSegments?i:i-1;for(let r=0;r<n;r++){var s;const o=[(s=0!==r||e.isClosedLineSegments?r!==n-1||e.isClosedLineSegments?[t[(r-1+i)%i],t[r%i],t[(r+1)%i],t[(r+2)%i]]:[t[r-1],t[r],t[r+1],t[r+1]]:[t[0],t[0],t[1],t[2]])[1],Sn(s[0],s[1],s[2],e.tension),Sn(s[3],s[2],s[1],e.tension),s[2]];0===r&&(this.ensure(o[0]),this.getLastSubpath().addPoint(o[0])),this.cubicCurveToPoint(o[1],o[2],o[3])}return this},copy:function(){return new Dn(_.map(this.subpaths,(function(t){return t.copy()})),this.bounds)},writeToContext:function(t){const e=this.subpaths.length;for(let i=0;i<e;i++)this.subpaths[i].writeToContext(t)},getSVGPath:function(){let t="";const e=this.subpaths.length;for(let i=0;i<e;i++){const e=this.subpaths[i];if(e.isDrawable()){const i=e.segments[0].start;t+="M "+Je.svgNumber(i.x)+" "+Je.svgNumber(i.y)+" ";for(let n=0;n<e.segments.length;n++)t+=e.segments[n].getSVGPathFragment()+" ";e.isClosed()&&(t+="Z ")}}return t},transformed:function(t){const e=_.map(this.subpaths,(function(e){return e.transformed(t)}));return new Dn(e,_.reduce(e,(function(t,e){return t.union(e.bounds)}),Ke.NOTHING))},nonlinearTransformed:function(t){t=h({minLevels:0,maxLevels:7,distanceEpsilon:.16,curveEpsilon:t&&t.includeCurvature?.002:null},t);const e=_.map(this.subpaths,(function(e){return e.nonlinearTransformed(t)}));return new Dn(e,_.reduce(e,(function(t,e){return t.union(e.bounds)}),Ke.NOTHING))},polarToCartesian:function(t){return this.nonlinearTransformed(h({pointMap:function(t){return je.createPolar(t.y,t.x)},methodName:"polarToCartesian"},t))},toPiecewiseLinear:function(t){return this.nonlinearTransformed(t)},containsPoint:function(t){const e=new Ze(t,je.X_UNIT);return 0!==this.windingIntersection(e)},intersection:function(t){let e=[];const i=this.subpaths.length;for(let n=0;n<i;n++){const i=this.subpaths[n];if(i.isDrawable()){const n=i.segments.length;for(let s=0;s<n;s++){const n=i.segments[s];e=e.concat(n.intersection(t))}i.hasClosingSegment()&&(e=e.concat(i.getClosingSegment().intersection(t)))}}return _.sortBy(e,(function(t){return t.distance}))},interiorIntersectsLineSegment:function(t,e){const i=t.blend(e,.5);if(this.containsPoint(i))return!0;const n=e.minus(t),s=n.magnitude;if(0===s)return!1;n.normalize();const r=this.intersection(new Ze(t,n));for(let o=0;o<r.length;o++)if(r[o].distance<=s)return!0;return!1},windingIntersection:function(t){let e=0;const i=this.subpaths.length;for(let n=0;n<i;n++){const i=this.subpaths[n];if(i.isDrawable()){const n=i.segments.length;for(let s=0;s<n;s++)e+=i.segments[s].windingIntersection(t);i.hasClosingSegment()&&(e+=i.getClosingSegment().windingIntersection(t))}}return e},intersectsBounds:function(t){if(this.bounds.intersection(t).equals(this.bounds))return!0;const e=new Ze(new je(t.minX,t.minY),new je(1,0)),i=new Ze(new je(t.minX,t.minY),new je(0,1)),n=new Ze(new je(t.maxX,t.maxY),new je(-1,0)),s=new Ze(new je(t.maxX,t.maxY),new je(0,-1));let r,o;const a=this.intersection(e).concat(this.intersection(n));for(o=0;o<a.length;o++)if(r=a[o].point,r.x>=t.minX&&r.x<=t.maxX)return!0;const l=this.intersection(i).concat(this.intersection(s));for(o=0;o<l.length;o++)if(r=l[o].point,r.y>=t.minY&&r.y<=t.maxY)return!0;return!1},getStrokedShape:function(t){let e=[];const i=Ke.NOTHING.copy();let n=this.subpaths.length;for(var s=0;s<n;s++){const i=this.subpaths[s].stroked(t);e=e.concat(i)}for(n=e.length,s=0;s<n;s++)i.includeBounds(e[s].bounds);return new Dn(e,i)},getOffsetShape:function(t){const e=[],i=Ke.NOTHING.copy();let n=this.subpaths.length;for(var s=0;s<n;s++)e.push(this.subpaths[s].offset(t));for(n=e.length,s=0;s<n;s++)i.includeBounds(e[s].bounds);return new Dn(e,i)},getDashedShape:function(t,e,i){return i=h({distanceEpsilon:1e-10,curveEpsilon:1e-8},i),new Dn(_.flatten(this.subpaths.map((function(n){return n.dashed(t,e,i.distanceEpsilon,i.curveEpsilon)}))))},getBounds:function(){if(null===this._bounds){const t=Ke.NOTHING.copy();_.each(this.subpaths,(function(e){t.includeBounds(e.getBounds())})),this._bounds=t}return this._bounds},get bounds(){return this.getBounds()},getStrokedBounds:function(t){let e=!0;for(var i=0;i<this.subpaths.length;i++){const t=this.subpaths[i];if(t.isDrawable()&&!t.isClosed()){e=!1;break}for(var n=0;n<t.segments.length;n++){if(!t.segments[n].areStrokedBoundsDilated()){e=!1;break}}}if(e)return this.bounds.dilated(t.lineWidth/2);{const e=this.bounds.copy();for(i=0;i<this.subpaths.length;i++){const s=this.subpaths[i].stroked(t);for(n=0;n<s.length;n++)e.includeBounds(s[n].bounds)}return e}},getSimplifiedAreaShape:function(){return vn.simplifyNonZero(this)},getBoundsWithTransform:function(t,e){const i=Ke.NOTHING.copy(),n=this.subpaths.length;for(let s=0;s<n;s++){const e=this.subpaths[s];i.includeBounds(e.getBoundsWithTransform(t))}return e&&i.includeBounds(this.getStrokedShape(e).getBoundsWithTransform(t)),i},getApproximateArea:function(t){const e=this.bounds.minX,i=this.bounds.minY,n=this.bounds.width,s=this.bounds.height,r=n*s;let o=0;const a=new je(0,0);for(let l=0;l<t;l++)a.x=e+xn()*n,a.y=i+xn()*s,this.containsPoint(a)&&o++;return r*o/t},getNonoverlappingArea:function(){return Math.abs(_.sum(this.subpaths.map((function(t){return _.sum(t.getFillSegments().map((function(t){return t.getSignedAreaFragment()})))}))))},getArea:function(){return this.getSimplifiedAreaShape().getNonoverlappingArea()},getApproximateCentroid:function(t){const e=this.bounds.minX,i=this.bounds.minY,n=this.bounds.width,s=this.bounds.height;let r=0;const o=new je(0,0),a=new je(0,0);for(let l=0;l<t;l++)a.x=e+xn()*n,a.y=i+xn()*s,this.containsPoint(a)&&(o.add(a),r++);return o.dividedScalar(r)},invalidatePoints:function(){this._invalidatingPoints=!0;const t=this.subpaths.length;for(let e=0;e<t;e++)this.subpaths[e].invalidatePoints();this._invalidatingPoints=!1,this.invalidate()},toString:function(){return"new kite.Shape( '"+this.getSVGPath()+"' )"},invalidate:function(){this._invalidatingPoints||(this._bounds=null,this.notifyInvalidationListeners())},notifyInvalidationListeners:function(){this.invalidatedEmitter.emit()},addSegmentAndBounds:function(t){this.getLastSubpath().addSegment(t),this.invalidate()},ensure:function(t){this.hasSubpaths()||(this.addSubpath(new $i),this.getLastSubpath().addPoint(t))},addSubpath:function(t){return this.subpaths.push(t),t.invalidatedEmitter.addListener(this._invalidateListener),this.invalidate(),this},hasSubpaths:function(){return this.subpaths.length>0},getLastSubpath:function(){return _.last(this.subpaths)},getLastPoint:function(){return this.hasSubpaths()?this.getLastSubpath().getLastPoint():null},getLastSegment:function(){if(!this.hasSubpaths())return null;const t=this.getLastSubpath();return t.isDrawable()?t.getLastSegment():null},getSmoothQuadraticControlPoint:function(){const t=this.getLastPoint();return this.lastQuadraticControlPoint?t.plus(t.minus(this.lastQuadraticControlPoint)):t},getSmoothCubicControlPoint:function(){const t=this.getLastPoint();return this.lastCubicControlPoint?t.plus(t.minus(this.lastCubicControlPoint)):t},getRelativePoint:function(){const t=this.getLastPoint();return t||je.ZERO},shapeUnion:function(t){return vn.binaryResult(this,t,vn.BINARY_NONZERO_UNION)},shapeIntersection:function(t){return vn.binaryResult(this,t,vn.BINARY_NONZERO_INTERSECTION)},shapeDifference:function(t){return vn.binaryResult(this,t,vn.BINARY_NONZERO_DIFFERENCE)},shapeXor:function(t){return vn.binaryResult(this,t,vn.BINARY_NONZERO_XOR)},shapeClip:function(t,e){return vn.clipShape(t,this,e)},getArcLength:function(t,e,i){let n=0;for(let s=0;s<this.subpaths.length;s++)n+=this.subpaths[s].getArcLength(t,e,i);return n},serialize:function(){return{type:"Shape",subpaths:this.subpaths.map((function(t){return t.serialize()}))}}}),Dn.deserialize=function(t){return new Dn(t.subpaths.map($i.deserialize))},Dn.rectangle=function(t,e,i,n){return(new Dn).rect(t,e,i,n)},Dn.rect=Dn.rectangle,Dn.roundRect=function(t,e,i,n,s,r){return(new Dn).roundRect(t,e,i,n,s,r)},Dn.roundRectangle=Dn.roundRect,Dn.roundedRectangleWithRadii=function(t,e,i,n,s){const r=s&&s.topLeft||0,o=s&&s.topRight||0,a=s&&s.bottomLeft||0,l=s&&s.bottomRight||0,h=new Je.Shape,u=t+i,c=e+n;return l>0?h.arc(u-l,c-l,l,0,Math.PI/2,!1):h.moveTo(u,c),a>0?h.arc(t+a,c-a,a,Math.PI/2,Math.PI,!1):h.lineTo(t,c),r>0?h.arc(t+r,e+r,r,Math.PI,3*Math.PI/2,!1):h.lineTo(t,e),o>0?h.arc(u-o,e+o,o,3*Math.PI/2,2*Math.PI,!1):h.lineTo(u,e),h.close(),h},Dn.boundsOffsetWithRadii=function(t,e,i){const n=t.withOffsets(e.left,e.top,e.right,e.bottom);return Dn.roundedRectangleWithRadii(n.minX,n.minY,n.width,n.height,i)},Dn.polygon=function(t){return(new Dn).polygon(t)},Dn.bounds=function(t){return(new Dn).rect(t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY)},Dn.lineSegment=function(t,e,i,n){return"number"==typeof t?(new Dn).moveTo(t,e).lineTo(i,n):(new Dn).moveToPoint(t).lineToPoint(e)},Dn.regularPolygon=function(t,e){const i=new Dn;return _.each(_.range(t),(function(n){const s=je.createPolar(e,2*Math.PI*n/t);0===n?i.moveToPoint(s):i.lineToPoint(s)})),i.close()},Dn.circle=function(t,e,i){return void 0===e?(new Dn).circle(0,0,t):(new Dn).circle(t,e,i)},Dn.ellipse=function(t,e,i,n,s){return void 0===n?(new Dn).ellipse(0,0,t,e,i):(new Dn).ellipse(t,e,i,n,s)},Dn.arc=function(t,e,i,n,s,r){return(new Dn).arc(t,e,i,n,s,r)},Dn.union=function(t){return vn.unionNonZero(t)},Dn.intersection=function(t){return vn.intersectionNonZero(t)},Dn.xor=function(t){return vn.xorNonZero(t)},Dn.segments=function(t,e){return new Dn([new $i(t,void 0,!!e)])};var En=Dn;const Cn={};function In(){}a.register("InstanceRegistry",In),R(Object,In,{},{map:Cn,registerDataURL:function(t,e,i){if(phet.chipper.queryParameters.binder){const s=t+"/"+e;Cn[s]=Cn[s]||[];try{i.toDataURL((function(t){Cn[s].push(t)}))}catch(n){}}}});function Pn(t){return _.each(Array.prototype.slice.call(arguments,1),(function(e){if(e)for(const i in e){const n=Object.getOwnPropertyDescriptor(e,i);!n||"function"!=typeof n.get&&void 0===e[i]||Object.defineProperty(t,i,n)}})),t}a.register("extendDefined",Pn);var kn=Pn;function Ln(t){const e=[t];let i=t.prototype;for(;i&&(i=Object.getPrototypeOf(i));)i.constructor&&e.push(i.constructor);return e}a.register("inheritance",Ln);var On=Ln;window.sceneryLog=null,window.sceneryAccessibilityLog=null;const Nn=document.createElement("canvas"),Rn=Nn.getContext("2d");let Mn="";const Bn=new r("scenery");function Fn(t){Bn.logString+=t.replace(/%c/g,"")+"\n"}function Vn(){window.console&&window.console.log&&window.console.log.apply(window.console,Array.prototype.slice.call(arguments,0))}Bn.register("scratchCanvas",Nn),Bn.register("scratchContext",Rn);const Hn={dirty:{name:"dirty",style:"color: #888;"},bounds:{name:"bounds",style:"color: #888;"},hitTest:{name:"hitTest",style:"color: #888;"},hitTestInternal:{name:"hitTestInternal",style:"color: #888;"},PerfCritical:{name:"Perf",style:"color: #f00;"},PerfMajor:{name:"Perf",style:"color: #aa0;"},PerfMinor:{name:"Perf",style:"color: #088;"},PerfVerbose:{name:"Perf",style:"color: #888;"},Cursor:{name:"Cursor",style:""},Stitch:{name:"Stitch",style:""},StitchDrawables:{name:"Stitch",style:""},GreedyStitcher:{name:"Greedy",style:"color: #088;"},GreedyVerbose:{name:"Greedy",style:"color: #888;"},RelativeTransform:{name:"RelativeTransform",style:"color: #606;"},BackboneDrawable:{name:"Backbone",style:"color: #a00;"},CanvasBlock:{name:"Canvas",style:""},WebGLBlock:{name:"WebGL",style:""},Display:{name:"Display",style:""},DOMBlock:{name:"DOM",style:""},Drawable:{name:"",style:""},FittedBlock:{name:"FittedBlock",style:""},Instance:{name:"Instance",style:""},InstanceTree:{name:"InstanceTree",style:""},ChangeInterval:{name:"ChangeInterval",style:"color: #0a0;"},SVGBlock:{name:"SVG",style:""},SVGGroup:{name:"SVGGroup",style:""},ImageSVGDrawable:{name:"ImageSVGDrawable",style:""},Paints:{name:"Paints",style:""},AlignBox:{name:"AlignBox",style:""},AlignGroup:{name:"AlignGroup",style:""},RichText:{name:"RichText",style:""},ParallelDOM:{name:"ParallelDOM",style:""},PDOMInstance:{name:"PDOMInstance",style:""},PDOMTree:{name:"PDOMTree",style:""},PDOMDisplaysInfo:{name:"PDOMDisplaysInfo",style:""},KeyboardFuzzer:{name:"KeyboardFuzzer",style:""},InputListener:{name:"InputListener",style:""},InputEvent:{name:"InputEvent",style:""},OnInput:{name:"OnInput",style:""},Pointer:{name:"Pointer",style:""},Input:{name:"Input",style:""},EventDispatch:{name:"EventDispatch",style:""}};O(Bn,{logString:"",logFunction:function(){window.console&&window.console.log&&window.console.log.apply(window.console,Array.prototype.slice.call(arguments,0))},switchLogToConsole:function(){Bn.logFunction=Vn},switchLogToString:function(){window.console&&window.console.log("switching to string log"),Bn.logFunction=Fn},enableIndividualLog:function(t){return"stitch"===t?(this.enableIndividualLog("Stitch"),this.enableIndividualLog("StitchDrawables"),this.enableIndividualLog("GreedyStitcher"),void this.enableIndividualLog("GreedyVerbose")):"perf"===t?(this.enableIndividualLog("PerfCritical"),this.enableIndividualLog("PerfMajor"),this.enableIndividualLog("PerfMinor"),void this.enableIndividualLog("PerfVerbose")):"input"===t?(this.enableIndividualLog("InputListener"),this.enableIndividualLog("InputEvent"),this.enableIndividualLog("OnInput"),this.enableIndividualLog("Pointer"),this.enableIndividualLog("Input"),void this.enableIndividualLog("EventDispatch")):"a11y"===t?(this.enableIndividualLog("ParallelDOM"),this.enableIndividualLog("PDOMInstance"),this.enableIndividualLog("PDOMTree"),void this.enableIndividualLog("PDOMDisplaysInfo")):void(t&&(window.sceneryLog[t]=window.sceneryLog[t]||function(e,i){const n=Hn[t],s=n.name?"["+n.name+"] ":"";Bn.logFunction("%c"+Mn+"%c"+s+e,"color: #ddd;",i||n.style)}))},disableIndividualLog:function(t){t&&delete window.sceneryLog[t]},enableLogging:function(t){window.sceneryLog=function(t){Bn.logFunction(t)},window.sceneryLog.push=function(){Mn+="| "},window.sceneryLog.pop=function(){Mn=Mn.slice(0,-2)},window.sceneryLog.getDepth=function(){return Mn.length/2};for(let e=0;e<t.length;e++)this.enableIndividualLog(t[e])},disableLogging:function(){window.sceneryLog=null},isLoggingPerformance:function(){return window.sceneryLog.PerfCritical||window.sceneryLog.PerfMajor||window.sceneryLog.PerfMinor||window.sceneryLog.PerfVerbose},copy:function(t){return Bn.deserialize(Bn.serialize(t))},serialize:function(t){if(t instanceof pe.Vector2)return{type:"Vector2",x:t.x,y:t.y};if(t instanceof pe.Matrix3)return{type:"Matrix3",m00:t.m00(),m01:t.m01(),m02:t.m02(),m10:t.m10(),m11:t.m11(),m12:t.m12(),m20:t.m20(),m21:t.m21(),m22:t.m22()};if(t instanceof pe.Bounds2)return{type:"Bounds2",maxX:t.maxX,maxY:t.maxY,minX:t.minX,minY:t.minY};if(t instanceof Je.Shape)return{type:"Shape",path:t.getSVGPath()};if(Array.isArray(t))return{type:"Array",value:t.map(Bn.serialize)};if(t instanceof Bn.Color)return{type:"Color",red:t.red,green:t.green,blue:t.blue,alpha:t.alpha};if(t instanceof c.Property)return{type:"Property",value:Bn.serialize(t.value)};if(Bn.Paint&&t instanceof Bn.Paint){const e={};return t.transformMatrix&&(e.transformMatrix=Bn.serialize(t.transformMatrix)),Bn.Gradient&&t instanceof Bn.Gradient&&(e.stops=t.stops.map((function(t){return{ratio:t.ratio,stop:Bn.serialize(t.color)}})),e.start=Bn.serialize(t.start),e.end=Bn.serialize(t.end),Bn.LinearGradient&&t instanceof Bn.LinearGradient?e.type="LinearGradient":Bn.RadialGradient&&t instanceof Bn.RadialGradient&&(e.type="RadialGradient",e.startRadius=t.startRadius,e.endRadius=t.endRadius)),Bn.Pattern&&t instanceof Bn.Pattern&&(e.type="Pattern",e.url=t.image.src),e}if(t instanceof Bn.Node){const e=t,i={},n={};["visible","opacity","pickable","inputEnabled","cursor","transformBounds","renderer","usesOpacity","layerSplit","cssTransform","excludeInvisible","webglScale","preventFit"].forEach((function(t){e[t]!==Bn.Node.DEFAULT_OPTIONS[t]&&(i[t]=e[t])})),["maxWidth","maxHeight","clipArea","mouseArea","touchArea"].forEach((function(t){e[t]!==Bn.Node.DEFAULT_OPTIONS[t]&&(n[t]=Bn.serialize(e[t]))})),e.matrix.isIdentity()||(n.matrix=Bn.serialize(e.matrix)),e._localBoundsOverridden&&(n.localBounds=Bn.serialize(e.localBounds)),n.children=e.children.map((function(t){return t.id})),n.hasInputListeners=e.inputListeners.length>0;const s={id:e.id,type:"Node",types:On(e.constructor).map((function(t){return t.name})).filter((function(t){return t&&"Object"!==t&&"Node"!==t})),name:e.constructor.name,options:i,setup:n};if(Bn.Path&&e instanceof Bn.Path&&(s.type="Path",n.path=Bn.serialize(e.shape),e.boundsMethod!==Bn.Path.DEFAULT_OPTIONS.boundsMethod&&(i.boundsMethod=e.boundsMethod)),Bn.Circle&&e instanceof Bn.Circle&&(s.type="Circle",i.radius=e.radius),Bn.Line&&e instanceof Bn.Line&&(s.type="Line",i.x1=e.x1,i.y1=e.y1,i.x2=e.x2,i.y2=e.y2),Bn.Rectangle&&e instanceof Bn.Rectangle&&(s.type="Rectangle",i.rectX=e.rectX,i.rectY=e.rectY,i.rectWidth=e.rectWidth,i.rectHeight=e.rectHeight,i.cornerXRadius=e.cornerXRadius,i.cornerYRadius=e.cornerYRadius),Bn.Text&&e instanceof Bn.Text&&(s.type="Text","hybrid"!==e.boundsMethod&&(i.boundsMethod=e.boundsMethod),i.text=e.text,i.font=e.font),Bn.HTMLText&&e instanceof Bn.HTMLText&&(s.type="HTMLText"),Bn.Image&&e instanceof Bn.Image&&(s.type="Image",["imageOpacity","initialWidth","initialHeight","mipmapBias","mipmapInitialLevel","mipmapMaxLevel"].forEach((function(t){e[t]!==Bn.Image.DEFAULT_OPTIONS[t]&&(i[t]=e[t])})),n.width=e.imageWidth,n.height=e.imageHeight,e._mipmapData?(n.imageType="mipmapData",n.mipmapData=e._mipmapData.map((function(t){return{url:t.url,width:t.width,height:t.height}}))):(e._mipmap&&(n.generateMipmaps=!0),e._image instanceof HTMLImageElement?(n.imageType="image",n.src=e._image.src):e._image instanceof HTMLCanvasElement&&(n.imageType="canvas",n.src=e._image.toDataURL()))),Bn.CanvasNode&&e instanceof Bn.CanvasNode||Bn.WebGLNode&&e instanceof Bn.WebGLNode){s.type=Bn.CanvasNode&&e instanceof Bn.CanvasNode?"CanvasNode":"WebGLNode",n.canvasBounds=Bn.serialize(e.canvasBounds);let t=Math.min(5,e._drawables.length?1/_.mean(e._drawables.map((function(t){const e=t.instance.trail.getMatrix().getScaleVector();return(e.x+e.y)/2}))):1);t=1;const i=document.createElement("canvas");i.width=Math.ceil(e.canvasBounds.width*t),i.height=Math.ceil(e.canvasBounds.height*t);const r=i.getContext("2d"),o=new Bn.CanvasContextWrapper(i,r),a=pe.Matrix3.scale(1/t);o.context.setTransform(t,0,0,t,-e.canvasBounds.left,-e.canvasBounds.top),e.renderToCanvasSelf(o,a),n.url=i.toDataURL(),n.scale=t,n.offset=Bn.serialize(e.canvasBounds.leftTop)}return Bn.DOM&&e instanceof Bn.DOM&&(s.type="DOM",n.element=(new window.XMLSerializer).serializeToString(e.element)),(Bn.Path&&e instanceof Bn.Path||Bn.Text&&e instanceof Bn.Text)&&(["fillPickable","strokePickable","lineWidth","lineCap","lineJoin","lineDashOffset","miterLimit"].forEach((function(t){e[t]!==Bn.Paintable.DEFAULT_OPTIONS[t]&&(i[t]=e[t])})),e.fill!==Bn.Paintable.DEFAULT_OPTIONS.fill&&(n.fill=Bn.serialize(e.fill)),e.stroke!==Bn.Paintable.DEFAULT_OPTIONS.stroke&&(n.stroke=Bn.serialize(e.stroke)),e.lineDash.length&&(n.lineDash=Bn.serialize(e.lineDash))),s}return t instanceof Bn.Display?{type:"Display",width:t.width,height:t.height,backgroundColor:Bn.serialize(t.backgroundColor),tree:{type:"Subtree",rootNodeId:t.rootNode.id,nodes:Bn.serializeConnectedNodes(t.rootNode)}}:{type:"value",value:t}},deserialize:function(t){if("Vector2"===t.type)return new pe.Vector2(t.x,t.y);if("Matrix3"===t.type)return(new pe.Matrix3).rowMajor(t.m00,t.m01,t.m02,t.m10,t.m11,t.m12,t.m20,t.m21,t.m22);if("Bounds2"===t.type)return new pe.Bounds2(t.minX,t.minY,t.maxX,t.maxY);if("Shape"===t.type)return new Je.Shape(t.path);if("Array"===t.type)return t.value.map(Bn.deserialize);if("Color"===t.type)return new Bn.Color(t.red,t.green,t.blue,t.alpha);if("Property"===t.type)return new c.Property(Bn.deserialize(t.value));if("Pattern"===t.type||"LinearGradient"===t.type||"RadialGradient"===t.type){let e;if("Pattern"===t.type){const i=new window.Image;i.src=t.url,e=new Bn.Pattern(i)}else{const i=Bn.deserialize(t.start),n=Bn.deserialize(t.end);"LinearGradient"===t.type?e=new Bn.LinearGradient(i.x,i.y,n.x,n.y):"RadialGradient"===t.type&&(e=new Bn.RadialGradient(i.x,i.y,t.startRadius,n.x,n.y,t.endRadius)),t.stops.forEach((function(t){e.addColorStop(t.ratio,Bn.deserialize(t.stop))}))}return t.transformMatrix&&e.setTransformMatrix(Bn.deserialize(t.transformMatrix)),e}if(_.includes(["Node","Path","Circle","Line","Rectangle","Text","HTMLText","Image","CanvasNode","WebGLNode","DOM"],t.type)){let e;const i=t.setup;if("Node"===t.type)e=new Bn.Node;else if("Path"===t.type)e=new Bn.Path(Bn.deserialize(i.path));else if("Circle"===t.type)e=new Bn.Circle({});else if("Line"===t.type)e=new Bn.Line({});else if("Rectangle"===t.type)e=new Bn.Rectangle({});else if("Text"===t.type)e=new Bn.Text("");else if("HTMLText"===t.type)e=new Bn.HTMLText("");else if("Image"===t.type){if("image"===i.imageType||"canvas"===i.imageType)e=new Bn.Image(i.src),i.generateMipmaps&&(e.mipmaps=!0);else if("mipmapData"===i.imageType){const t=i.mipmapData.map((function(t){const e={width:t.width,height:t.height,url:t.url};e.img=new window.Image,e.img.src=t.url,e.canvas=document.createElement("canvas"),e.canvas.width=t.width,e.canvas.height=t.height;const i=e.canvas.getContext("2d");return e.updateCanvas=function(){e.img.complete&&(void 0===e.img.naturalWidth||e.img.naturalWidth>0)&&(i.drawImage(e.img,0,0),delete e.updateCanvas)},e}));e=new Bn.Image(t)}e.initialWidth=i.width,e.initialHeight=i.height}else if("CanvasNode"===t.type||"WebGLNode"===t.type)e=new Bn.Node({children:[new Bn.Image(i.url,{translation:Bn.deserialize(i.offset),scale:1/i.scale})]});else if("DOM"===t.type){const i=document.createElement("div");i.innerHTML=t.element;const n=i.childNodes[0];i.removeChild(n),e=new Bn.DOM(n)}return i.clipArea&&(e.clipArea=Bn.deserialize(i.clipArea)),i.mouseArea&&(e.mouseArea=Bn.deserialize(i.mouseArea)),i.touchArea&&(e.touchArea=Bn.deserialize(i.touchArea)),i.matrix&&(e.matrix=Bn.deserialize(i.matrix)),i.localBounds&&(e.localBounds=Bn.deserialize(i.localBounds)),i.fill&&(e.fill=Bn.deserialize(i.fill)),i.stroke&&(e.stroke=Bn.deserialize(i.stroke)),i.lineDash&&(e.lineDash=Bn.deserialize(i.lineDash)),e.mutate(t.options),e._serialization=t,e}if("Subtree"===t.type){const e={},i=t.nodes.map(Bn.deserialize);return i.forEach((function(t){e[t._serialization.id]=t})),i.forEach((function(t){t._serialization.setup.children.forEach((function(i){t.addChild(e[i])}))})),e[t.rootNodeId]}return"value"===t.type?t.value:void 0},serializeConnectedNodes:function(t){return t.getSubtreeNodes().map(Bn.serialize)}});var zn=Bn;class Gn extends C{constructor(t,e){super(),this._value=t}get(){return this.onAccessAttempt&&this.onAccessAttempt(),this._value}get value(){return this.get()}set(t){if(!this.equalsValue(t)){const e=this._value;this.setPropertyValue(t),this.notifyListeners(e)}return this}set value(t){this.set(t)}setPropertyValue(t){this._value=t}equalsValue(t){return this.areValuesEqual(t,this._value)}areValuesEqual(t,e){return this.useDeepEquality&&t&&e&&t.constructor===e.constructor?t.equals(e):t===e}notifyListeners(t){this.emit(this._value,t,this)}link(t){this.addListener(t),t(this._value,null,this)}lazyLink(t){this.addListener(t)}unlink(t){this.removeListener(t)}unlinkAll(){this.removeAllListeners()}linkAttribute(t,e){const i=i=>{t[e]=i};return this.link(i),i}unlinkAttribute(t){this.unlink(t)}dispose(){this.unlinkAll(),super.dispose()}}c.register("TinyProperty",Gn);var qn=Gn;const Yn={};zn.register("Renderer",Yn),Yn.numActiveRenderers=4,Yn.bitsPerRenderer=5,Yn.bitmaskRendererArea=255,Yn.bitmaskCurrentRendererArea=15,Yn.bitmaskLacksOffset=65536,Yn.bitmaskLacksShift=16,Yn.bitmaskNodeDefault=Yn.bitmaskRendererArea,Yn.bitmaskCanvas=1,Yn.bitmaskSVG=2,Yn.bitmaskDOM=4,Yn.bitmaskWebGL=8,Yn.bitmaskSingleCanvas=256,Yn.bitmaskSingleSVG=512,Yn.bitmaskNotPainted=4096,Yn.bitmaskBoundsValid=8192,Yn.bitmaskNotAccessible=16384,Yn.bitmaskLacksCanvas=Yn.bitmaskCanvas<<Yn.bitmaskLacksShift,Yn.bitmaskLacksSVG=Yn.bitmaskSVG<<Yn.bitmaskLacksShift,Yn.bitmaskLacksDOM=Yn.bitmaskDOM<<Yn.bitmaskLacksShift,Yn.bitmaskLacksWebGL=Yn.bitmaskWebGL<<Yn.bitmaskLacksShift,Yn.isCanvas=function(t){return 0!=(t&Yn.bitmaskCanvas)},Yn.isSVG=function(t){return 0!=(t&Yn.bitmaskSVG)},Yn.isDOM=function(t){return 0!=(t&Yn.bitmaskDOM)},Yn.isWebGL=function(t){return 0!=(t&Yn.bitmaskWebGL)};const Un={canvas:Yn.bitmaskCanvas,svg:Yn.bitmaskSVG,dom:Yn.bitmaskDOM,webgl:Yn.bitmaskWebGL};Yn.fromName=function(t){return Un[t]},Yn.stripBitmask=function(t){return t&Yn.bitmaskRendererArea},Yn.createOrderBitmask=function(t,e,i,n){return(t=t||0)|(e=e||0)<<5|(i=i||0)<<10|(n=n||0)<<15},Yn.bitmaskOrder=function(t,e){return e>0&&(t>>=5*e),t&Yn.bitmaskCurrentRendererArea},Yn.bitmaskOrderFirst=function(t){return t&Yn.bitmaskCurrentRendererArea},Yn.bitmaskOrderSecond=function(t){return t>>5&Yn.bitmaskCurrentRendererArea},Yn.bitmaskOrderThird=function(t){return t>>10&Yn.bitmaskCurrentRendererArea},Yn.bitmaskOrderFourth=function(t){return t>>15&Yn.bitmaskCurrentRendererArea},Yn.pushOrderBitmask=function(t,e){let i=e;const n=Yn.bitsPerRenderer*Yn.numActiveRenderers;for(let s=0;s<=n;s+=Yn.bitsPerRenderer){const n=t>>s&Yn.bitmaskCurrentRendererArea;if(n===i)return t;if(0===n)return t|=i<<s;if(t&=~(Yn.bitmaskCurrentRendererArea<<s),t|=i<<s,i=n,i===e)return t}throw new Error("pushOrderBitmask overflow")},Yn.createSelfDrawable=function(t,e,i,n){let s;if(Yn.isCanvas(i))s=e.createCanvasDrawable(i,t);else if(Yn.isSVG(i))s=e.createSVGDrawable(i,t);else if(Yn.isDOM(i))s=e.createDOMDrawable(i,t);else{if(!Yn.isWebGL(i))throw new Error("Unrecognized renderer: "+i);s=e.createWebGLDrawable(i,t)}return s.setFittable(n),s},Yn.webglCustom=1,Yn.webglTexturedTriangles=2,Yn.webglVertexColorPolygons=3;var jn=Yn;let Wn=1;function Xn(t){this.initializeDrawable(t)}zn.register("Drawable",Xn),R(Object,Xn,{initializeDrawable:function(t){return this.id=this.id||Wn++,this.cleanDrawable(),this.renderer=t,this.dirty=!0,this.isDisposed=!1,this.linksDirty=!1,this.visibleProperty=new qn(!0),this.fittableProperty=new qn(!0),this},cleanDrawable:function(){this.parentDrawable=null,this.backbone=null,this.pendingParentDrawable=null,this.pendingBackbone=null,this.pendingAddition=!1,this.pendingRemoval=!1,this.previousDrawable=null,this.nextDrawable=null,this.oldPreviousDrawable=null,this.oldNextDrawable=null,this.visibleProperty&&this.visibleProperty.removeAllListeners(),this.fittableProperty&&this.fittableProperty.removeAllListeners()},update:function(){let t=!1;return this.dirty&&!this.isDisposed&&(this.dirty=!1,t=!0),t},setVisible:function(t){this.visibleProperty.value=t},set visible(t){this.setVisible(t)},isVisible:function(){return this.visibleProperty.value},get visible(){return this.isVisible()},setFittable:function(t){this.fittableProperty.value=t},set fittable(t){this.setFittable(t)},isFittable:function(){return this.fittableProperty.value},get fittable(){return this.isFittable()},setBlockBackbone:function(t){this.parentDrawable=t,this.backbone=t,this.pendingParentDrawable=t,this.pendingBackbone=t,this.pendingAddition=!1,this.pendingRemoval=!1},notePendingAddition:function(t,e,i){this.pendingParentDrawable=e,this.pendingBackbone=i,this.pendingAddition=!0,this.pendingRemoval||t.markDrawableChangedBlock(this)},notePendingRemoval:function(t){this.pendingRemoval=!0,this.pendingAddition||t.markDrawableChangedBlock(this)},notePendingMove:function(t,e){this.pendingParentDrawable=e,this.pendingRemoval&&this.pendingAddition||t.markDrawableChangedBlock(this),this.pendingAddition=!0,this.pendingRemoval=!0},updateBlock:function(){let t=!1;return(this.pendingRemoval||this.pendingAddition)&&(t=!this.pendingRemoval||!this.pendingAddition||this.parentDrawable!==this.pendingParentDrawable||this.backbone!==this.pendingBackbone,t?(this.pendingRemoval&&(this.parentDrawable.removeDrawable(this),this.pendingAddition||(this.pendingParentDrawable=null,this.pendingBackbone=null)),this.parentDrawable=this.pendingParentDrawable,this.backbone=this.pendingBackbone,this.pendingAddition&&this.parentDrawable.addDrawable(this)):this.pendingAddition&&jn.isCanvas(this.renderer)&&this.parentDrawable.onPotentiallyMovedDrawable(this),this.pendingAddition=!1,this.pendingRemoval=!1),t},updateLinks:function(){this.oldNextDrawable=this.nextDrawable,this.oldPreviousDrawable=this.previousDrawable,this.linksDirty=!1},markDirty:function(){this.dirty||(this.dirty=!0,this.parentDrawable&&this.parentDrawable.markDirtyDrawable(this))},markLinksDirty:function(t){this.linksDirty||(this.linksDirty=!0,t.markDrawableForLinksUpdate(this))},markForDisposal:function(t){Xn.disconnectBefore(this,t),Xn.disconnectAfter(this,t),t.markDrawableForDisposal(this)},disposeImmediately:function(t){Xn.disconnectBefore(this,t),Xn.disconnectAfter(this,t),this.dispose()},dispose:function(){this.cleanDrawable(),this.isDisposed=!0,this.freeToPool()},audit:function(t,e,i){0},toString:function(){return this.constructor.name+"#"+this.id},toDetailedString:function(){return this.toString()}}),Xn.connectDrawables=function(t,e,i){t.nextDrawable!==e&&(t.nextDrawable&&(t.nextDrawable.markLinksDirty(i),t.nextDrawable.previousDrawable=null),e.previousDrawable&&(e.previousDrawable.markLinksDirty(i),e.previousDrawable.nextDrawable=null),t.nextDrawable=e,e.previousDrawable=t,t.markLinksDirty(i),e.markLinksDirty(i))},Xn.disconnectBefore=function(t,e){t.previousDrawable&&(t.markLinksDirty(e),t.previousDrawable.markLinksDirty(e),t.previousDrawable.nextDrawable=null,t.previousDrawable=null)},Xn.disconnectAfter=function(t,e){t.nextDrawable&&(t.markLinksDirty(e),t.nextDrawable.markLinksDirty(e),t.nextDrawable.previousDrawable=null,t.nextDrawable=null)},Xn.listToArray=function(t,e){const i=[];for(let n=t;i.push(n),n!==e;n=n.nextDrawable);return i},Xn.oldListToArray=function(t,e){const i=[];for(let n=t;i.push(n),n!==e;n=n.oldNextDrawable);return i};var Kn=Xn;function Qn(t,e){this.initializeSelfDrawable(t,e)}zn.register("SelfDrawable",Qn),R(Kn,Qn,{initializeSelfDrawable:function(t,e){return this.drawableVisibilityListener=this.drawableVisibilityListener||this.updateSelfVisibility.bind(this),this.initializeDrawable(t),this.instance=e,this.node=e.trail.lastNode(),this.node.attachDrawable(this),this.instance.selfVisibleEmitter.addListener(this.drawableVisibilityListener),this.updateSelfVisibility(),this},dispose:function(){this.instance.selfVisibleEmitter.removeListener(this.drawableVisibilityListener),this.node.detachDrawable(this),this.instance=null,this.node=null,Kn.prototype.dispose.call(this)},updateSelfVisibility:function(){this.visible=this.instance.selfVisible},toDetailedString:function(){return this.toString()+" ("+this.instance.trail.toPathString()+")"}});var Zn=Qn;function $n(t,e){throw this.initializeCanvasSelfDrawable(t,e),new Error("Should use initialization and pooling")}zn.register("CanvasSelfDrawable",$n),R(Zn,$n,{initializeCanvasSelfDrawable:function(t,e){return this.initializeSelfDrawable(t,e),this.transformListener=this.transformListener||this.markTransformDirty.bind(this),e.relativeTransform.addListener(this.transformListener),e.relativeTransform.addPrecompute(),this},markTransformDirty:function(){this.markDirty()},markPaintDirty:function(){this.markDirty()},updateSelfVisibility:function(){Zn.prototype.updateSelfVisibility.call(this),this.markDirty()},dispose:function(){this.instance.relativeTransform.removeListener(this.transformListener),this.instance.relativeTransform.removePrecompute(),Zn.prototype.dispose.call(this)}});var Jn=$n;const ts=Be.clamp,es=Be.linear;function is(t,e,i,n){this.changeEmitter=new C,this.set(t,e,i,n)}zn.register("Color",is);const ns="(-?\\d{1,3}%?)";function ss(t){let e=1;return"%"===t.charAt(t.length-1)&&(e=2.55,t=t.slice(0,t.length-1)),Be.roundSymmetric(parseInt(t,10)*e)}is.formatParsers=[{regexp:/^transparent$/,apply:function(t,e){t.setRGBA(0,0,0,0)}},{regexp:/^#(\w{1})(\w{1})(\w{1})$/,apply:function(t,e){t.setRGBA(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),1)}},{regexp:/^#(\w{2})(\w{2})(\w{2})$/,apply:function(t,e){t.setRGBA(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1)}},{regexp:new RegExp("^rgb\\("+ns+","+ns+","+ns+"\\)$"),apply:function(t,e){t.setRGBA(ss(e[1]),ss(e[2]),ss(e[3]),1)}},{regexp:new RegExp("^rgba\\("+ns+","+ns+","+ns+",(\\d+|\\d*\\.\\d+)\\)$"),apply:function(t,e){t.setRGBA(ss(e[1]),ss(e[2]),ss(e[3]),parseFloat(e[4]))}},{regexp:new RegExp("^hsl\\((\\d{1,3}),(\\d{1,3})%,(\\d{1,3})%\\)$"),apply:function(t,e){t.setHSLA(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),1)}},{regexp:new RegExp("^hsla\\((\\d{1,3}),(\\d{1,3})%,(\\d{1,3})%,(\\d+|\\d*\\.\\d+)\\)$"),apply:function(t,e){t.setHSLA(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4]))}}],is.hueToRGB=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t},is.toColor=function(t){return t instanceof is?t:new is(t)},R(Object,is,{copy:function(){return new is(this.r,this.g,this.b,this.a)},set:function(t,e,i,n){if("string"==typeof t)this.setCSS(t);else if(t instanceof is)this.setRGBA(t.r,t.g,t.b,t.a);else if(void 0===i){const i=t>>16&255,n=t>>8&255,s=t>>0&255,r=void 0===e?1:e;this.setRGBA(i,n,s,r)}else this.setRGBA(t,e,i,void 0===n?1:n);return this},getRed:function(){return this.r},setRed:function(t){return this.setRGBA(t,this.g,this.b,this.a)},get red(){return this.getRed()},set red(t){return this.setRed(t)},getGreen:function(){return this.g},setGreen:function(t){return this.setRGBA(this.r,t,this.b,this.a)},get green(){return this.getGreen()},set green(t){return this.setGreen(t)},getBlue:function(){return this.b},setBlue:function(t){return this.setRGBA(this.r,this.g,t,this.a)},get blue(){return this.getBlue()},set blue(t){return this.setBlue(t)},getAlpha:function(){return this.a},setAlpha:function(t){return this.setRGBA(this.r,this.g,this.b,t)},get alpha(){return this.getAlpha()},set alpha(t){return this.setAlpha(t)},setRGBA:function(t,e,i,n){return this.r=Be.roundSymmetric(ts(t,0,255)),this.g=Be.roundSymmetric(ts(e,0,255)),this.b=Be.roundSymmetric(ts(i,0,255)),this.a=ts(n,0,1),this.updateColor(),this},blend:function(t,e){const i=Math.pow(this.r,2.4),n=Math.pow(t.r,2.4),s=Math.pow(this.g,2.4),r=Math.pow(t.g,2.4),o=Math.pow(this.b,2.4),a=Math.pow(t.b,2.4);return new is(Math.pow(i+(n-i)*e,1/2.4),Math.pow(s+(r-s)*e,1/2.4),Math.pow(o+(a-o)*e,1/2.4),this.a+(t.a-this.a)*e)},computeCSS:function(){if(1===this.a)return"rgb("+this.r+","+this.g+","+this.b+")";{let t=this.a.toFixed(20);for(;t.length>=2&&"0"===t[t.length-1]&&"."!==t[t.length-2];)t=t.slice(0,t.length-1);const e=0===this.a||1===this.a?this.a:t;return"rgba("+this.r+","+this.g+","+this.b+","+e+")"}},toCSS:function(){return this._css},setCSS:function(t){let e=t.replace(/ /g,"").toLowerCase(),i=!1;const n=is.colorKeywords[e];n&&(e="#"+n);for(let s=0;s<is.formatParsers.length;s++){const t=is.formatParsers[s],n=t.regexp.exec(e);if(n){t.apply(this,n),i=!0;break}}if(!i)throw new Error("Color unable to parse color string: "+t);this.updateColor()},toNumber:function(){return(this.r<<16)+(this.g<<8)+this.b},updateColor:function(){const t=this._css;this._css=this.computeCSS(),t!==this._css&&this.changeEmitter.emit()},setImmutable:function(){return this},getCanvasStyle:function(){return this.toCSS()},setHSLA:function(t,e,i,n){let s;t=t%360/360,e=ts(e/100,0,1),s=(i=ts(i/100,0,1))<.5?i*(e+1):i+e-i*e;const r=2*i-s;return this.r=Be.roundSymmetric(255*is.hueToRGB(r,s,t+1/3)),this.g=Be.roundSymmetric(255*is.hueToRGB(r,s,t)),this.b=Be.roundSymmetric(255*is.hueToRGB(r,s,t-1/3)),this.a=ts(n,0,1),this.updateColor(),this},equals:function(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},withAlpha:function(t){return new is(this.r,this.g,this.b,t)},checkFactor:function(t){if(t<0||t>1)throw new Error("factor must be between 0 and 1: "+t);return void 0===t?.7:t},brighterColor:function(t){return t=this.checkFactor(t),new is(Math.min(255,Math.floor(this.r/t)),Math.min(255,Math.floor(this.g/t)),Math.min(255,Math.floor(this.b/t)),this.a)},colorUtilsBrighter:function(t){return t=this.checkFactor(t),new is(Math.min(255,this.getRed()+Math.floor(t*(255-this.getRed()))),Math.min(255,this.getGreen()+Math.floor(t*(255-this.getGreen()))),Math.min(255,this.getBlue()+Math.floor(t*(255-this.getBlue()))),this.getAlpha())},darkerColor:function(t){return t=this.checkFactor(t),new is(Math.max(0,Math.floor(t*this.r)),Math.max(0,Math.floor(t*this.g)),Math.max(0,Math.floor(t*this.b)),this.a)},colorUtilsDarker:function(t){return t=this.checkFactor(t),new is(Math.max(0,this.getRed()-Math.floor(t*this.getRed())),Math.max(0,this.getGreen()-Math.floor(t*this.getGreen())),Math.max(0,this.getBlue()-Math.floor(t*this.getBlue())),this.getAlpha())},colorUtilsBrightness:function(t){return 0===t?this:t>0?this.colorUtilsBrighter(t):this.colorUtilsDarker(-t)},toString:function(){return this.constructor.name+"[r:"+this.r+" g:"+this.g+" b:"+this.b+" a:"+this.a+"]"},toStateObject:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}}}),is.basicColorKeywords={aqua:"00ffff",black:"000000",blue:"0000ff",fuchsia:"ff00ff",gray:"808080",green:"008000",lime:"00ff00",maroon:"800000",navy:"000080",olive:"808000",purple:"800080",red:"ff0000",silver:"c0c0c0",teal:"008080",white:"ffffff",yellow:"ffff00"},is.colorKeywords={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},is.BLACK=is.black=new is(0,0,0).setImmutable(),is.BLUE=is.blue=new is(0,0,255).setImmutable(),is.CYAN=is.cyan=new is(0,255,255).setImmutable(),is.DARK_GRAY=is.darkGray=new is(64,64,64).setImmutable(),is.GRAY=is.gray=new is(128,128,128).setImmutable(),is.GREEN=is.green=new is(0,255,0).setImmutable(),is.LIGHT_GRAY=is.lightGray=new is(192,192,192).setImmutable(),is.MAGENTA=is.magenta=new is(255,0,255).setImmutable(),is.ORANGE=is.orange=new is(255,200,0).setImmutable(),is.PINK=is.pink=new is(255,175,175).setImmutable(),is.RED=is.red=new is(255,0,0).setImmutable(),is.WHITE=is.white=new is(255,255,255).setImmutable(),is.YELLOW=is.yellow=new is(255,255,0).setImmutable(),is.TRANSPARENT=is.transparent=new is(0,0,0,0).setImmutable(),is.interpolateRGBA=function(t,e,i){if(i<0||i>1)throw new Error("distance must be between 0 and 1: "+i);return new is(Math.floor(es(0,1,t.r,e.r,i)),Math.floor(es(0,1,t.g,e.g,i)),Math.floor(es(0,1,t.b,e.b,i)),es(0,1,t.a,e.a,i))},is.supersampleBlend=function(t){const e=t.map(t=>Math.pow(t.r/255,2.2)),i=t.map(t=>Math.pow(t.g/255,2.2)),n=t.map(t=>Math.pow(t.b/255,2.2)),s=t.map(t=>Math.pow(t.a,2.2)),r=_.sum(s);if(0===r)return new is(0,0,0,0);const o=_.sum(_.range(0,t.length).map(t=>e[t]*s[t]))/r,a=_.sum(_.range(0,t.length).map(t=>i[t]*s[t]))/r,l=_.sum(_.range(0,t.length).map(t=>n[t]*s[t]))/r,h=r/t.length;return new is(Math.floor(255*Math.pow(o,1/2.2)),Math.floor(255*Math.pow(a,1/2.2)),Math.floor(255*Math.pow(l,1/2.2)),Math.pow(h,1/2.2))},is.fromStateObject=function(t){return new is(t.r,t.g,t.b,t.a)},is.hsla=function(t,e,i,n){return new is(0,0,0,1).setHSLA(t,e,i,n)};new is("blue");is.checkPaintString=function(t){0},is.checkPaint=function(t){"string"==typeof t?is.checkPaintString(t):t instanceof Yt&&"string"==typeof t.value&&is.checkPaintString(t.value)},is.getLuminance=function(t){const e=is.toColor(t),i=.2126*e.red+.7152*e.green+.0722*e.blue;return i},is.toGrayscale=function(t){const e=is.getLuminance(t);return new is(e,e,e)},is.isDarkColor=function(t,e=186){return is.getLuminance(t)<e},is.isLightColor=function(t,e){return!is.isDarkColor(t,e)};var rs=is;let os=1;function as(){this.id="paint"+os++,this.transformMatrix=null}zn.register("Paint",as),R(Object,as,{isPaint:!0,getCanvasStyle:function(){throw new Error("abstract method")},setTransformMatrix:function(t){return this.transformMatrix!==t&&(this.transformMatrix=t),this}});var ls=as;function hs(){ls.call(this),this.stops=[],this.lastStopRatio=0,this.canvasGradient=null,this.colorStopsDirty=!1,this.lastColorStopValues=[]}zn.register("Gradient",hs),R(ls,hs,{isGradient:!0,addColorStop:function(t,e){if(this.lastStopRatio>t)throw new Error("Color stops not specified in the order of increasing ratios");return this.lastStopRatio=t,this.stops.push({ratio:t,color:e}),this.lastColorStopValues.push(""),this},createCanvasGradient:function(){throw new Error("abstract method")},getSVGStops:function(){return this.stops},invalidateCanvasGradient:function(){this.colorStopsDirty=!0},haveCanvasColorStopsChanged:function(){if(null===this.lastColorStopValues)return!0;for(let t=0;t<this.stops.length;t++)if(hs.colorToString(this.stops[t].color)!==this.lastColorStopValues[t])return!0;return!1},getCanvasStyle:function(){if(!this.canvasGradient||this.colorStopsDirty&&this.haveCanvasColorStopsChanged()){this.colorStopsDirty=!1,ci(this.lastColorStopValues),this.canvasGradient=this.createCanvasGradient();for(let t=0;t<this.stops.length;t++){const e=this.stops[t],i=hs.colorToString(e.color);this.canvasGradient.addColorStop(e.ratio,i),this.lastColorStopValues.push(i)}}return this.canvasGradient}}),hs.colorToString=function(t){return t instanceof Yt&&(t=t.value),null===t&&(t="transparent"),t instanceof rs&&(t=t.toCSS()),t};var us=hs;function cs(t){this.primary=null,this.changeCallback=t,this.notifyChangeCallback=this.notifyChanged.bind(this),this.updateSecondaryListener=this.updateSecondary.bind(this),this.secondaryPropertyCountsMap={}}zn.register("PaintObserver",cs),R(Object,cs,{setPrimary:function(t){t!==this.primary&&(this.detachPrimary(this.primary),this.primary=t,this.attachPrimary(t),this.notifyChangeCallback())},clean:function(){this.detachPrimary(this.primary),this.primary=null},updateSecondary:function(t,e,i){const n=this.secondaryPropertyCountsMap[i.id];for(let s=0;s<n;s++)this.attachSecondary(t);this.notifyChangeCallback()},attachPrimary:function(t){if(t instanceof Yt)this.secondaryLazyLinkProperty(t),this.attachSecondary(t.get());else if(t instanceof rs)t.setImmutable();else if(t instanceof us)for(let e=0;e<t.stops.length;e++)this.attachPrimary(t.stops[e].color)},detachPrimary:function(t){if(t instanceof Yt)this.secondaryUnlinkProperty(t);else if(t instanceof us)for(let e=0;e<t.stops.length;e++)this.detachPrimary(t.stops[e].color)},attachSecondary:function(t){t instanceof rs&&t.setImmutable()},notifyChanged:function(){this.primary instanceof us&&this.primary.invalidateCanvasGradient(),this.changeCallback()},secondaryLazyLinkProperty:function(t){const e=t.id;this.secondaryPropertyCountsMap[e]?this.secondaryPropertyCountsMap[e]++:(this.secondaryPropertyCountsMap[e]=1,t.lazyLink(this.updateSecondaryListener))},secondaryUnlinkProperty:function(t){const e=t.id,i=--this.secondaryPropertyCountsMap[e];0===i&&(delete this.secondaryPropertyCountsMap[e],t.isDisposed||t.unlink(this.updateSecondaryListener))}});var ds=cs;const fs={mixInto:function(t){const e=t.prototype;e.initializePaintableStateless=function(t,e){return this.fillCallback=this.fillCallback||this.markDirtyFill.bind(this),this.strokeCallback=this.strokeCallback||this.markDirtyStroke.bind(this),this.fillObserver=this.fillObserver||new ds(this.fillCallback),this.strokeObserver=this.strokeObserver||new ds(this.strokeCallback),this.fillObserver.setPrimary(e.node._fill),this.strokeObserver.setPrimary(e.node._stroke),this},e.disposePaintableStateless=function(){this.fillObserver.clean(),this.strokeObserver.clean()},e.markDirtyFill=function(){this.markPaintDirty(),this.fillObserver.setPrimary(this.instance.node._fill)},e.markDirtyStroke=function(){this.markPaintDirty(),this.strokeObserver.setPrimary(this.instance.node._stroke)},e.markDirtyLineWidth=function(){this.markPaintDirty()},e.markDirtyLineOptions=function(){this.markPaintDirty()},e.markDirtyCachedPaints=function(){this.markPaintDirty()}}};zn.register("PaintableStatelessDrawable",fs);var ps=fs;function ms(t,e){this.initializeCanvasSelfDrawable(t,e),this.initializePaintableStateless(t,e)}zn.register("PathCanvasDrawable",ms),R(Jn,ms,{paintCanvas:function(t,e,i){const n=t.context;e.hasShape()&&(n.beginPath(),e._shape.writeToContext(n),e.hasFill()&&(e.beforeCanvasFill(t),n.fill(),e.afterCanvasFill(t)),e.hasPaintableStroke()&&(e.beforeCanvasStroke(t),n.stroke(),e.afterCanvasStroke(t)))},markDirtyShape:function(){this.markPaintDirty()},dispose:function(){Jn.prototype.dispose.call(this),this.disposePaintableStateless()}}),ps.mixInto(ms),Pe.mixInto(ms);var gs=ms;const ys="http://www.w3.org/2000/svg";zn.register("svgns",ys);var bs=ys;function vs(t,e){return t?t.toCSS?t.toCSS():t.isPaint?"url(#"+t.id+"-"+(e?e.id:"noblock")+")":t:"none"}function _s(){this.initialize()}zn.register("PaintSVGState",_s),R(Object,_s,{initialize:function(){this.svgBlock=null,this.fillStyle="none",this.strokeStyle="none",this.fillPaint=null,this.strokePaint=null,this.updateBaseStyle(),this.strokeDetailStyle=""},dispose:function(){this.releaseFillPaint(),this.releaseStrokePaint()},releaseFillPaint:function(){this.fillPaint&&(this.svgBlock.decrementPaint(this.fillPaint),this.fillPaint=null)},releaseStrokePaint:function(){this.strokePaint&&(this.svgBlock.decrementPaint(this.strokePaint),this.strokePaint=null)},updateFill:function(t,e){const i=vs(e,t);e!==this.fillPaint&&(this.releaseFillPaint(),e&&e.isPaint&&(this.fillPaint=e,t.incrementPaint(e))),i!==this.fillStyle&&(this.fillStyle=i,this.updateBaseStyle())},updateStroke:function(t,e){const i=vs(e,t);e!==this.strokePaint&&(this.releaseStrokePaint(),e&&e.isPaint&&(this.strokePaint=e,t.incrementPaint(e))),i!==this.strokeStyle&&(this.strokeStyle=i,this.updateBaseStyle())},updateBaseStyle:function(){this.baseStyle="fill: "+this.fillStyle+"; stroke: "+this.strokeStyle+";"},updateStrokeDetailStyle:function(t){let e="";const i=t.getLineWidth();1!==i&&(e+="stroke-width: "+i+";");const n=t.getLineCap();"butt"!==n&&(e+="stroke-linecap: "+n+";");const s=t.getLineJoin();"miter"!==s&&(e+="stroke-linejoin: "+s+";"),e+="stroke-miterlimit: "+t.getMiterLimit()+";",t.hasLineDash()&&(e+="stroke-dasharray: "+t.getLineDash().join(",")+";",e+="stroke-dashoffset: "+t.getLineDashOffset()+";"),this.strokeDetailStyle=e},updateSVGBlock:function(t){const e=this.svgBlock;e&&(this.fillPaint&&e.decrementPaint(this.fillPaint),this.strokePaint&&e.decrementPaint(this.strokePaint)),this.svgBlock=t,this.fillPaint&&t.incrementPaint(this.fillPaint),this.strokePaint&&t.incrementPaint(this.strokePaint)}});var ws=_s;function As(t,e){throw this.initializeSVGSelfDrawable(t,e),new Error("Should use initialization and pooling")}zn.register("SVGSelfDrawable",As),R(Zn,As,{initializeSVGSelfDrawable:function(t,e,i,n){return this.initializeSelfDrawable(t,e),this.usesPaint=i,this.keepElements=n,this.svgElement=null,this.svgBlock=null,this.initializeState(t,e),this.usesPaint&&(this.paintState?this.paintState.initialize():this.paintState=new ws),this},update:function(){return!!Zn.prototype.update.call(this)&&(this.updateSVG(),!0)},updateSVG:function(){if(this.paintDirty&&this.updateSVGSelf(this.node,this.svgElement),this.usesPaint&&this.dirtyCachedPaints){const t=this.node._cachedPaints.slice();let e,i;for(e=0;e<t.length;e++){const n=t[e];let s=!0;for(i=0;i<this.lastCachedPaints.length;i++)if(n===this.lastCachedPaints[i]){s=!1;break}s&&this.svgBlock.incrementPaint(n)}for(e=0;e<this.lastCachedPaints.length;e++){const n=this.lastCachedPaints[e];let s=!0;for(i=0;i<t.length;i++)if(n===t[i]){s=!1;break}s&&this.svgBlock.decrementPaint(n)}this.lastCachedPaints=t}this.setToCleanState()},updateFillStrokeStyle:function(t){if(!this.usesPaint)return;this.dirtyFill&&this.paintState.updateFill(this.svgBlock,this.node.getFillValue()),this.dirtyStroke&&this.paintState.updateStroke(this.svgBlock,this.node.getStrokeValue());const e=this.dirtyLineWidth||this.dirtyLineOptions;e&&this.paintState.updateStrokeDetailStyle(this.node),(this.dirtyFill||this.dirtyStroke||e)&&t.setAttribute("style",this.paintState.baseStyle+this.paintState.strokeDetailStyle),this.cleanPaintableState()},updateSVGBlock:function(t){const e=this.svgBlock;if(this.usesPaint&&e)for(let i=0;i<this.lastCachedPaints.length;i++)e.decrementPaint(this.lastCachedPaints[i]);if(this.svgBlock=t,this.usesPaint)for(let i=0;i<this.lastCachedPaints.length;i++)t.incrementPaint(this.lastCachedPaints[i]);this.updateDefsSelf&&this.updateDefsSelf(t),this.usesPaint&&this.paintState.updateSVGBlock(t),this.usesPaint&&this.markDirtyFill(),this.usesPaint&&this.markDirtyStroke()},dispose:function(){this.disposeState(),this.keepElements||(this.svgElement=null),this.updateDefsSelf&&this.updateDefsSelf(null),this.usesPaint&&this.paintState.dispose(),this.defs=null,this.svgBlock=null,Zn.prototype.dispose.call(this)}});var xs=As;const Ts={mixInto:function(t){const e=t.prototype;e.initializePaintableState=function(t,e){return this.dirtyFill=!0,this.hadStroke=!1,this.dirtyStroke=!0,this.dirtyLineWidth=!0,this.dirtyLineOptions=!0,this.dirtyCachedPaints=!0,this.lastCachedPaints=[],this.fillCallback=this.fillCallback||this.markDirtyFill.bind(this),this.strokeCallback=this.strokeCallback||this.markDirtyStroke.bind(this),this.fillObserver=this.fillObserver||new ds(this.fillCallback),this.strokeObserver=this.strokeObserver||new ds(this.strokeCallback),this.fillObserver.setPrimary(e.node._fill),this.strokeObserver.setPrimary(e.node._stroke),this},e.cleanPaintableState=function(){this.dirtyFill=!1,this.dirtyStroke=!1,this.dirtyLineWidth=!1,this.dirtyLineOptions=!1,this.dirtyCachedPaints=!1,this.hadStroke=null!==this.node.getStroke()},e.disposePaintableState=function(){this.fillObserver.clean(),this.strokeObserver.clean()},e.markDirtyFill=function(){this.dirtyFill=!0,this.markPaintDirty(),this.fillObserver.setPrimary(this.instance.node._fill)},e.markDirtyStroke=function(){this.dirtyStroke=!0,this.markPaintDirty(),this.strokeObserver.setPrimary(this.instance.node._stroke)},e.markDirtyLineWidth=function(){this.dirtyLineWidth=!0,this.markPaintDirty()},e.markDirtyLineOptions=function(){this.dirtyLineOptions=!0,this.markPaintDirty()},e.markDirtyCachedPaints=function(){this.dirtyCachedPaints=!0,this.markPaintDirty()}}};zn.register("PaintableStatefulDrawable",Ts);var Ss=Ts;const Ds={mixInto:function(t){const e=t.prototype;e.initializeState=function(t,e){return this.paintDirty=!0,this.dirtyShape=!0,this.initializePaintableState(t,e),this},e.disposeState=function(){this.disposePaintableState()},e.markPaintDirty=function(){this.paintDirty=!0,this.markDirty()},e.markDirtyShape=function(){this.dirtyShape=!0,this.markPaintDirty()},e.setToCleanState=function(){this.paintDirty=!1,this.dirtyShape=!1},Ss.mixInto(t)}};zn.register("PathStatefulDrawable",Ds);var Es=Ds;function Cs(t,e){this.initializeSVGSelfDrawable(t,e,!0,!0),this.svgElement=this.svgElement||document.createElementNS(bs,"path")}zn.register("PathSVGDrawable",Cs),R(xs,Cs,{updateSVGSelf:function(){const t=this.svgElement;if(this.dirtyShape){let e=this.node.hasShape()?this.node._shape.getSVGPath():"";e||(e="M0 0"),t.setAttribute("d",e)}this.updateFillStrokeStyle(t)}}),Es.mixInto(Cs),Pe.mixInto(Cs);var Is=Cs;class Ps extends qn{constructor(t,e){super(t,e)}setForwardingProperty(t){if(this.forwardingProperty===t)return;this.forwardingListener=this.forwardingListener||((t,e,i)=>{this.notifyListeners(e)});const e=this.get();this.forwardingProperty&&this.forwardingProperty.unlink(this.forwardingListener),this.forwardingProperty=t,this.forwardingProperty?this.forwardingProperty.lazyLink(this.forwardingListener):this._value=e;const i=this.get();this.areValuesEqual(e,i)||this.notifyListeners(e)}get(){return this.onAccessAttempt&&this.onAccessAttempt(),this.forwardingProperty?this.forwardingProperty.value:this._value}set(t){return this.forwardingProperty?this.forwardingProperty.set(t):super.set(t),this}notifyListeners(t){this.emit(this.get(),t,this)}link(t){this.addListener(t),t(this.get(),null,this)}}c.register("TinyForwardingProperty",Ps);var ks=Ps;class Ls extends qn{set(t){throw new Error("Cannot set a TinyStaticProperty value")}}c.register("TinyStaticProperty",Ls);var Os=Ls;function Ns(t,e,i,n,s){i=i||[],n=n||[],s=s||[],Array.prototype.push.apply(i,t),Array.prototype.push.apply(n,e);t:for(let r=0;r<i.length;r++){const t=i[r];for(let e=0;e<n.length;e++){if(t===n[e]){if(s.push(t),i.splice(r,1),n.splice(e,1),e=0,r===i.length)break t;r-=1}}}return i}a.register("arrayDifference",Ns);var Rs=Ns;function Ms(t,e){this.trail=t,this.setBefore(e)}zn.register("TrailPointer",Ms),R(Object,Ms,{copy:function(){return new Ms(this.trail.copy(),this.isBefore)},setBefore:function(t){this.isBefore=t,this.isAfter=!t},getRenderSwappedPointer:function(){const t=this.isBefore?this.trail.previous():this.trail.next();return null===t?null:new Ms(t,!this.isBefore)},getRenderBeforePointer:function(){return this.isBefore?this:this.getRenderSwappedPointer()},getRenderAfterPointer:function(){return this.isAfter?this:this.getRenderSwappedPointer()},compareRender:function(t){const e=this.getRenderBeforePointer(),i=t.getRenderBeforePointer();return null!==e&&null!==i?e.trail.compare(i.trail):e===i?0:null===e?1:-1},compareNested:function(t){const e=this.trail.compare(t.trail);return 0===e?this.isBefore===t.isBefore?0:this.isBefore?-1:1:this.trail.isExtensionOf(t.trail)?t.isBefore?1:-1:t.trail.isExtensionOf(this.trail)?this.isBefore?-1:1:e},equalsRender:function(t){return 0===this.compareRender(t)},equalsNested:function(t){return 0===this.compareNested(t)},hasTrail:function(){return!!this.trail},nestedForwards:function(){if(this.isBefore)this.trail.lastNode()._children.length>0?this.trail.addDescendant(this.trail.lastNode()._children[0],0):this.setBefore(!1);else{if(0===this.trail.indices.length)return this.trail=null,null;{const t=this.trail.indices[this.trail.indices.length-1];this.trail.removeDescendant(),this.trail.lastNode()._children.length>t+1&&(this.trail.addDescendant(this.trail.lastNode()._children[t+1],t+1),this.setBefore(!0))}}return this},nestedBackwards:function(){if(this.isBefore){if(0===this.trail.indices.length)return this.trail=null,null;{const t=this.trail.indices[this.trail.indices.length-1];this.trail.removeDescendant(),t-1>=0&&(this.trail.addDescendant(this.trail.lastNode()._children[t-1],t-1),this.setBefore(!1))}}else if(this.trail.lastNode()._children.length>0){const t=this.trail.lastNode()._children;this.trail.addDescendant(t[t.length-1],t.length-1)}else this.setBefore(!0);return this},eachNodeBetween:function(t,e){this.eachTrailBetween(t,(function(t){return e(t.lastNode())}))},eachTrailBetween:function(t,e){this.isBefore&&e(this.trail),this.depthFirstUntil(t,(function(t){if(t.isBefore)return e(t.trail)}),!0)},depthFirstUntil:function(t,e,i){this.trail.reindex(),t.trail.reindex();const n=this.copy();n.trail.setMutable();let s=!0;for(;!n.equalsNested(t);){let r=!1;if(s?(i||(r=e(n)),s=!1):r=e(n),r&&n.isBefore){if(n.setBefore(!1),1===n.compareNested(t))break}else n.nestedForwards()}i||e(n)},toString:function(){return"["+(this.isBefore?"before":"after")+" "+this.trail.toString().slice(1)}}),Ms.compareNested=function(t,e,i,n){const s=t.compare(i);return 0===s?e===n?0:e?-1:1:t.isExtensionOf(i)?n?1:-1:i.isExtensionOf(t)?e?-1:1:s};var Bs=Ms;function Fs(t){if(t instanceof Fs){const e=t;return this.nodes=e.nodes.slice(0),this.length=e.length,this.uniqueId=e.uniqueId,void(this.indices=e.indices.slice(0))}this.nodes=[],this.length=0,this.uniqueId="",this.indices=[];const e=this;if(t)if(t instanceof ll){const i=t;e.addDescendant(i)}else{const i=t.length;for(let n=0;n<i;n++)e.addDescendant(t[n])}}zn.register("Trail",Fs),R(Object,Fs,{copy:function(){return new Fs(this)},isPainted:function(){return this.lastNode().isPainted()},isValid:function(){this.reindex();const t=this.indices.length;for(let e=0;e<t;e++)if(this.indices[e]<0)return!1;return!0},isVisible:function(){let t=this.nodes.length;for(;t--;)if(!this.nodes[t].isVisible())return!1;return!0},isAccessibleVisible:function(){let t=this.nodes.length;for(;t--;)if(!this.nodes[t].isVisible()||!this.nodes[t].getAccessibleVisible())return!1;return!0},getOpacity:function(){let t=1,e=this.nodes.length;for(;e--;)t*=this.nodes[e].getOpacity();return t},isPickable:function(){return!_.some(this.nodes,(function(t){return!1===t.pickable||!1===t.visible}))&&(!!_.some(this.nodes,(function(t){return t._inputListeners.length>0||!0===t.pickableProperty.value}))||this.lastNode()._picker._subtreePickableCount>0)},get:function(t){return t>=0?this.nodes[t]:this.nodes[this.nodes.length+t]},slice:function(t,e){return new Fs(this.nodes.slice(t,e))},subtrailTo:function(t,e){return this.slice(0,_.indexOf(this.nodes,t)+(e?0:1))},isEmpty:function(){return 0===this.nodes.length},getMatrix:function(){const t=oi.identity(),e=this.nodes,i=e.length;for(let n=0;n<i;n++)t.multiplyMatrix(e[n].getMatrix());return t},getAncestorMatrix:function(){const t=oi.identity(),e=this.nodes,i=e.length;for(let n=1;n<i;n++)t.multiplyMatrix(e[n].getMatrix());return t},getParentMatrix:function(){const t=oi.identity(),e=this.nodes,i=e.length;for(let n=0;n<i-1;n++)t.multiplyMatrix(e[n].getMatrix());return t},getTransform:function(){return new hi(this.getMatrix())},getParentTransform:function(){return new hi(this.getParentMatrix())},addAncestor:function(t,e){if(this.nodes.length){const i=this.nodes[0];this.indices.unshift(void 0===e?_.indexOf(t._children,i):e)}return this.nodes.unshift(t),this.length++,this.uniqueId=this.uniqueId?t.id+"-"+this.uniqueId:t.id+"",this},removeAncestor:function(){return this.nodes.shift(),this.indices.length&&this.indices.shift(),this.length--,this.updateUniqueId(),this},addDescendant:function(t,e){if(this.nodes.length){const i=this.lastNode();this.indices.push(void 0===e?_.indexOf(i._children,t):e)}return this.nodes.push(t),this.length++,this.uniqueId=this.uniqueId?this.uniqueId+"-"+t.id:t.id+"",this},removeDescendant:function(){return this.nodes.pop(),this.indices.length&&this.indices.pop(),this.length--,this.updateUniqueId(),this},addDescendantTrail:function(t){const e=t.length;e&&this.addDescendant(t.nodes[0]);for(let i=1;i<e;i++)this.addDescendant(t.nodes[i],this.indices[i-1])},removeDescendantTrail:function(t){for(let e=t.length-1;e>=0;e--)this.removeDescendant()},reindex:function(){const t=this.length;for(let e=1;e<t;e++){const t=this.indices[e-1],i=this.nodes[e-1];i._children[t]!==this.nodes[e]&&(this.indices[e-1]=_.indexOf(i._children,this.nodes[e]))}},setImmutable:function(){return this},setMutable:function(){return this},areIndicesValid:function(){for(let t=1;t<this.length;t++){const e=this.indices[t-1];if(this.nodes[t-1]._children[e]!==this.nodes[t])return!1}return!0},equals:function(t){if(this.length!==t.length)return!1;for(let e=0;e<this.nodes.length;e++)if(this.nodes[e]!==t.nodes[e])return!1;return!0},upToNode:function(t){_.indexOf(this.nodes,t);return this.slice(0,_.indexOf(this.nodes,t)+1)},isExtensionOf:function(t,e){if(this.length<=t.length-(e?1:0))return!1;for(let i=0;i<t.nodes.length;i++)if(this.nodes[i]!==t.nodes[i])return!1;return!0},containsNode:function(t){return _.includes(this.nodes,t)},getTransformTo:function(t){return new hi(this.getMatrixTo(t))},getMatrixTo:function(t){this.reindex(),t.reindex();const e=this.getBranchIndexTo(t);let i,n=oi.IDENTITY;for(i=this.length-1;i>=e;i--)n=this.nodes[i].getMatrix().timesMatrix(n);for(i=e;i<t.length;i++)n=t.nodes[i].getTransform().getInverse().timesMatrix(n);return n},getBranchIndexTo:function(t){let e;const i=Math.min(this.length,t.length);for(e=0;e<i&&this.nodes[e]===t.nodes[e];e++);return e},getLastInputEnabledIndex:function(){let t=-1;for(let e=0;e<this.length&&this.nodes[e].inputEnabled;e++)t=e;return t},getCursorCheckIndex:function(){const t=this.getLastInputEnabledIndex();return t+1<this.length?t+1:t},nodeFromTop:function(t){return this.nodes[this.length-1-t]},lastNode:function(){return this.nodeFromTop(0)},rootNode:function(){return this.nodes[0]},previous:function(){if(this.nodes.length<=1)return null;const t=this.nodeFromTop(0),e=this.nodeFromTop(1),i=_.indexOf(e._children,t),n=this.nodes.slice(0,this.nodes.length-1);if(0===i)return new Fs(n);for(n.push(e._children[i-1]);0!==n[n.length-1]._children.length;){const t=n[n.length-1];n.push(t._children[t._children.length-1])}return new Fs(n)},previousPainted:function(){let t=this.previous();for(;t&&!t.isPainted();)t=t.previous();return t},next:function(){const t=this.nodes.slice(0),e=this.nodeFromTop(0);if(e._children.length>0)return t.push(e._children[0]),new Fs(t);{let e=this.nodes.length-1;for(;e>0;){const i=this.nodes[e],n=this.nodes[e-1];t.pop();const s=_.indexOf(n._children,i);if(s!==n._children.length-1)return t.push(n._children[s+1]),new Fs(t);e--}return null}},nextPainted:function(){let t=this.next();for(;t&&!t.isPainted();)t=t.next();return t},eachTrailUnder:function(t){new Bs(this,!0).eachTrailBetween(new Bs(this,!1),t)},compare:function(t){const e=Math.min(this.indices.length,t.indices.length);for(let i=0;i<e;i++)if(this.indices[i]!==t.indices[i])return this.indices[i]<t.indices[i]?-1:1;return this.nodes.length<t.nodes.length?-1:this.nodes.length>t.nodes.length?1:0},isBefore:function(t){return-1===this.compare(t)},isAfter:function(t){return 1===this.compare(t)},localToGlobalPoint:function(t){return this.getMatrix().timesVector2(t)},localToGlobalBounds:function(t){return t.transformed(this.getMatrix())},globalToLocalPoint:function(t){return this.getTransform().inversePosition2(t)},globalToLocalBounds:function(t){return this.getTransform().inverseBounds2(t)},parentToGlobalPoint:function(t){return this.getParentMatrix().timesVector2(t)},parentToGlobalBounds:function(t){return t.transformed(this.getParentMatrix())},globalToParentPoint:function(t){return this.getParentTransform().inversePosition2(t)},globalToParentBounds:function(t){return this.getParentTransform().inverseBounds2(t)},updateUniqueId:function(){let t="";const e=this.nodes.length;e>0&&(t+=this.nodes[0]._id);for(let i=1;i<e;i++)t+="-"+this.nodes[i]._id;this.uniqueId=t},getUniqueId:function(){return this.uniqueId},toString:function(){return this.reindex(),this.length?"[Trail "+this.indices.join(".")+" "+this.getUniqueId()+"]":"Empty Trail"},toPathString:function(){const t=_.filter(this.nodes,(function(t){return"Node"!==t.constructor.name}));return _.map(t,(function(t){return t.constructor.name})).join("/")},toDebugString:function(){return this.toString()+" "+this.toPathString()}}),Fs.eachPaintedTrailBetween=function(t,e,i,n,s){Fs.eachTrailBetween(t,e,(function(t){if(t&&t.isPainted())return i(t)}),n,s)},Fs.eachTrailBetween=function(t,e,i,n,s){const r=new Bs(t?t.copy():new Fs(s),!0),o=e?new Bs(e.copy(),!0):new Bs(new Fs(s),!1);n&&(r.nestedForwards(),o.nestedBackwards(),1===r.compareNested(o))||r.depthFirstUntil(o,(function(t){if(t.isBefore)return i(t.trail)}),!1)},Fs.branchIndex=function(t,e){let i;const n=Math.min(t.length,e.length);for(i=0;i<n&&t.nodes[i]===e.nodes[i];i++);return i},Fs.sharedTrail=function(t,e){return t.slice(0,Fs.branchIndex(t,e))},Fs.appendAncestorTrailsWithPredicate=function(t,e,i){const n=e.rootNode();i(n)&&t.push(e.copy());const s=n._parents.length;for(let r=0;r<s;r++){const s=n._parents[r];e.addAncestor(s),Fs.appendAncestorTrailsWithPredicate(t,e,i),e.removeAncestor()}},Fs.appendDescendantTrailsWithPredicate=function(t,e,i){const n=e.lastNode();i(n)&&t.push(e.copy());const s=n._children.length;for(let r=0;r<s;r++){const s=n._children[r];e.addDescendant(s,r),Fs.appendDescendantTrailsWithPredicate(t,e,i),e.removeDescendant()}},Fs.spannedSubtrees=function(t,e){},Fs.fromUniqueId=function(t,e){const i=e.split("-").map((function(t){return parseInt(t,10)}));let n=t;i.shift();const s=[n];for(;i.length>0;){const t=i.shift(),e=(n.accessibleOrder||[]).concat(n.children);for(let i=0;i<e.length;i++)if(null!==e[i]&&e[i].id===t){const t=e[i];s.push(t),n=t;break}}return new Fs(s)};var Vs=Fs;const Hs={validateA11yBehaviorFunctionDef:function(t){}};zn.register("A11yBehaviorFunctionDef",Hs);function zs(t){this.node=t,this.accessibleDisplays=[]}zn.register("PDOMDisplaysInfo",zs),R(Object,zs,{onAddChild:function(t){t._accessibleDisplaysInfo.canHaveAccessibleDisplays()&&t._accessibleDisplaysInfo.addAccessibleDisplays(this.accessibleDisplays)},onRemoveChild:function(t){t._accessibleDisplaysInfo.canHaveAccessibleDisplays()&&t._accessibleDisplaysInfo.removeAccessibleDisplays(this.accessibleDisplays)},onSummaryChange:function(t,e){if(this.node.visible&&this.node.accessibleVisible){const i=!(jn.bitmaskNotAccessible&t),n=!(jn.bitmaskNotAccessible&e);n&&!i&&this.addAllAccessibleDisplays(),!n&&i&&this.removeAllAccessibleDisplays()}},onVisibilityChange:function(t){this.node.accessibleVisible&&!this.node._rendererSummary.isNotAccessible()&&(t?this.addAllAccessibleDisplays():this.removeAllAccessibleDisplays())},onAccessibleVisibilityChange:function(t){this.node.visible&&!this.node._rendererSummary.isNotAccessible()&&(t?this.addAllAccessibleDisplays():this.removeAllAccessibleDisplays())},onAddedRootedDisplay:function(t){t._accessible&&this.canHaveAccessibleDisplays()&&this.addAccessibleDisplays([t])},onRemovedRootedDisplay:function(t){t._accessible&&this.canHaveAccessibleDisplays()&&this.removeAccessibleDisplays([t])},canHaveAccessibleDisplays:function(){return this.node.visible&&this.node.accessibleVisible&&!this.node._rendererSummary.isNotAccessible()},addAllAccessibleDisplays:function(){let t;const e=[];for(t=0;t<this.node._parents.length;t++)Array.prototype.push.apply(e,this.node._parents[t]._accessibleDisplaysInfo.accessibleDisplays);for(t=0;t<this.node._rootedDisplays.length;t++){const i=this.node._rootedDisplays[t];i._accessible&&e.push(i)}this.addAccessibleDisplays(e)},removeAllAccessibleDisplays:function(){this.removeAccessibleDisplays(this.accessibleDisplays.slice())},addAccessibleDisplays:function(t){if(0!==t.length){Array.prototype.push.apply(this.accessibleDisplays,t);for(let e=0;e<this.node._children.length;e++){this.node._children[e]._accessibleDisplaysInfo.canHaveAccessibleDisplays()&&this.node._children[e]._accessibleDisplaysInfo.addAccessibleDisplays(t)}this.node.accessibleDisplaysEmitter.emit()}},removeAccessibleDisplays:function(t){if(0!==t.length){let e;for(e=t.length-1;e>=0;e--){this.accessibleDisplays.lastIndexOf(t[e]);this.accessibleDisplays.splice(e,1)}for(e=0;e<this.node._children.length;e++){const i=this.node._children[e];i._accessibleDisplaysInfo.canHaveAccessibleDisplays()&&!i._isGettingRemovedFromParent&&i._accessibleDisplaysInfo.removeAccessibleDisplays(t)}this.node.accessibleDisplaysEmitter.emit()}}});var Gs=zs;const qs=navigator.userAgent;function Ys(t){return js()===t}function Us(){return!!(window.phet&&phet.chipper&&phet.chipper.queryParameters&&phet.chipper.queryParameters["phet-app"]||(qs.match(/(iPod|iPhone|iPad)/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>=2)&&qs.match(/AppleWebKit/))}function js(){let t=-1,e=null;return"Microsoft Internet Explorer"===navigator.appName?(e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==e.exec(qs)&&(t=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==e.exec(qs)&&(t=parseFloat(RegExp.$1))),t}const Ws={firefox:qs.toLowerCase().indexOf("firefox")>-1,mobileSafari:Us(),safari5:!!(qs.match(/Version\/5\./)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),safari6:!!(qs.match(/Version\/6\./)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),safari7:!!(qs.match(/Version\/7\./)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),safari10:!!(qs.match(/Version\/10\./)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),safari11:!!(qs.match(/Version\/11\./)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),safari9:!!(qs.match(/Version\/9\./)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),safari:Us()||!!(qs.match(/Version\//)&&qs.match(/Safari\//)&&qs.match(/AppleWebKit/)),ie:-1!==js(),ie9:Ys(9),ie10:Ys(10),ie11:Ys(11),android:qs.indexOf("Android")>0,edge:!!qs.match(/Edge\//),chromium:/chrom(e|ium)/.test(qs.toLowerCase())&&!qs.match(/Edge\//)};a.register("platform",Ws);var Xs=Ws;function Ks(t,e){const i=this;e=h({isStatic:!1},e),this._isStatic=e.isStatic,this.trail=t,this._matrices=null,this._dirtyIndex=0,this._listeners=[],this._nodeTransformListeners=[];for(let n=1;n<this.trail.length;n++){const e=function(t){return function(){i.onTransformChange(t)}}(n-1);this._nodeTransformListeners.push(e),t.nodes[n].transformEmitter.addListener(e)}}zn.register("TransformTracker",Ks),R(Object,Ks,{dispose:function(){for(let t=1;t<this.trail.length;t++){const e=this._nodeTransformListeners[t-1];this.trail.nodes[t].transformEmitter.hasListener(e)&&this.trail.nodes[t].transformEmitter.removeListener(e)}},addListener:function(t){this._listeners.push(t)},removeListener:function(t){const e=_.indexOf(this._listeners,t);this._listeners.splice(e,1)},notifyListeners:function(){let t=this._listeners;this._isStatic||(t=t.slice());const e=t.length;for(let i=0;i<e;i++)t[i]()},onTransformChange:function(t){this._dirtyIndex=Math.min(this._dirtyIndex,t),this.notifyListeners()},getMatrix:function(){if(null===this._matrices){this._matrices=[];for(let t=1;t<this.trail.length;t++)this._matrices.push(new oi)}if(this._matrices.length<=0)return oi.IDENTITY;const t=this._matrices.length;for(let e=this._dirtyIndex;e<t;e++){const t=this.trail.nodes[e+1].matrix;0===e?this._matrices[e].set(t):(this._matrices[e].set(this._matrices[e-1]),this._matrices[e].multiplyMatrix(t))}return this._dirtyIndex=t,this._matrices[t-1]},get matrix(){return this.getMatrix()}});var Qs=Ks;function Zs(t,e){return void 0!==t[e]?e:void 0!==t["moz"+(e=e.charAt(0).toUpperCase()+e.slice(1))]?"moz"+e:void 0!==t["Moz"+e]?"Moz"+e:void 0!==t["webkit"+e]?"webkit"+e:void 0!==t["ms"+e]?"ms"+e:void 0!==t["o"+e]?"o"+e:void 0}a.register("detectPrefix",Zs);var $s=Zs;function Js(t,e,i){return void 0!==t["on"+e]?e:void 0!==t["onmoz"+e]?"moz"+e:void 0!==t["onMoz"+e]?"Moz"+e:void 0!==t["onwebkit"+e]?"webkit"+e:void 0!==t["onms"+e]?"ms"+e:void 0!==t["ono"+e]?"o"+e:void 0}a.register("detectPrefixEvent",Js);var tr=Js;const er=$s(document,"exitFullscreen")||$s(document,"cancelFullScreen"),ir=$s(document,"fullscreenElement")||$s(document,"fullScreenElement"),nr=$s(document,"fullscreenEnabled")||$s(document,"fullScreenEnabled");let sr=tr(document,"fullscreenchange");"msfullscreenchange"===sr&&(sr="MSFullscreenChange");var rr={isFullScreen:function(){return!!document[ir]},isFullScreenEnabled:function(){return document[nr]&&!Xs.safari7},enterFullScreen:function(t){const e=$s(document.body,"requestFullscreen")||$s(document.body,"requestFullScreen");if(Xs.ie9||Xs.ie10){if(void 0!==window.ActiveXObject){const t=new window.ActiveXObject("WScript.Shell");null!==t&&t.SendKeys("{F11}")}}else t.domElement[e]&&t.domElement[e]()},exitFullScreen:function(){document[er]&&document[er]()},toggleFullScreen:function(t){rr.isFullScreen()?rr.exitFullScreen():rr.enterFullScreen(t)},isFullScreenProperty:new Yt(!1)};document.addEventListener(sr,(function(t){rr.isFullScreenProperty.set(rr.isFullScreen())})),zn.register("FullScreen",rr);var or=rr;const ar=document.createElement("style");ar.type="text/css",document.head.appendChild(ar);const lr=document.styleSheets[document.styleSheets.length-1],hr={stylesheet:lr,styleElement:ar,addRule:function(t){this.stylesheet.insertRule(t,0)}};zn.register("SceneryStyle",hr);var ur=hr;ur.addRule(".pdom-sibling{position: fixed;pointer-events: none;top: 0px;left: 0px;transform-origin: left top 0px;border-width: 0px;border: 0px;padding: 1px 1px;margin: 0px;white-space: nowrap;outline: none;box-shadow:none;border-color:transparent;font-size: 1px;clip: rect(1px, 1px, 1px, 1px);}"),ur.addRule(".pdom-root{position: absolute;z-index: 1;opacity: 0.0001;}");const cr={SIBLING_CLASS_NAME:"pdom-sibling",ROOT_CLASS_NAME:"pdom-root"};zn.register("PDOMSiblingStyle",cr);var dr=cr;function fr(t){return t.replace(/\u202a|\u202b|\u202c/g,"")}a.register("stripEmbeddingMarks",fr);var pr=fr;const mr=["A","AREA","INPUT","SELECT","TEXTAREA","BUTTON","IFRAME"],gr=["B","STRONG","I","EM","MARK","SMALL","DEL","INS","SUB","SUP","BR"],yr=["INPUT"];function br(t){const e=t.getElementsByTagName("*"),i=[];for(let n=0;n<e.length;n++)e[n].nodeType===Node.ELEMENT_NODE&&(i[n]=e[n]);return i}function vr(t,e){const i=br(e||document.body),n=document.activeElement,s="NEXT"===t?1:-1;let r=i.indexOf(n)+s;for(;r<i.length&&r>=0;){const t=i[r];if(r+=s,wr.isElementFocusable(t))return t}return n}function _r(t){return!_.includes(yr,t.toUpperCase())}var wr={getNextFocusable:function(t){return vr("NEXT",t)},getPreviousFocusable:function(t){return vr("PREVIOUS",t)},getRandomFocusable:function(t){const e=br(document.body),i=[];for(let n=0;n<e.length;n++)wr.isElementFocusable(e[n])&&i.push(e[n]);return i[t.nextInt(i.length)]},containsFormattingTags:function(t){if(null===t)return!1;let e=0;const i=[],n=[];for(;e<t.length;){const s=t.indexOf("<",e),r=t.indexOf(">",e);s>-1&&(i.push(s),e=s+1),r>-1?(n.push(r),e=r+1):e++}if(i.length!==n.length||0===i.length)return!1;let s=!0;const r=t.toUpperCase();for(let o=0;o<i.length;o++){let t=r.substring(i[o]+1,n[o]);t=t.replace("/","");const e=t.replace(/^\s+/,"");t.length-e.length>0||(_.includes(gr,t)||(s=!1))}return s},setTextContent:function(t,e){const i=pr(e);A(i,v.STRING_WITHOUT_TEMPLATE_VARS_VALIDATOR),_r(t.tagName)&&(wr.containsFormattingTags(i)?t.innerHTML=i:t.textContent=i)},tagIsDefaultFocusable:function(t){return _.includes(mr,t.toUpperCase())},isElementFocusable:function(t){return!!document.body.contains(t)&&(!function t(e){return!!e.hidden||e!==document.body&&t(e.parentElement)}(t)&&(!_.includes(gr,t.tagName)&&"true"===t.getAttribute("data-focusable")))},tagNameSupportsContent:function(t){return _r(t)},removeElements:function(t,e){for(let i=0;i<e.length;i++){const n=e[i];t.removeChild(n)}},insertElements:function(t,e,i){for(let n=0;n<e.length;n++){const s=e[n];t.insertBefore(s,i||null)}},validateAssociationObject:function(t){Object.keys(t)},createElement:function(t,e,i){const n=(i=h({namespace:null,id:null,trailId:null},i)).namespace?document.createElementNS(i.namespace,t):document.createElement(t);return i.trailId&&n.setAttribute(wr.DATA_TRAIL_ID,i.trailId),i.id&&(n.id=i.id),wr.overrideFocusWithTabIndex(n,e),n.className=dr.SIBLING_CLASS_NAME,n},overrideFocusWithTabIndex:function(t,e){wr.tagIsDefaultFocusable(t.tagName)!==e?t.tabIndex=e?0:-1:t.removeAttribute("tabindex"),t.setAttribute("data-focusable",e)},TAGS:{INPUT:"INPUT",LABEL:"LABEL",BUTTON:"BUTTON",TEXTAREA:"TEXTAREA",SELECT:"SELECT",OPTGROUP:"OPTGROUP",DATALIST:"DATALIST",OUTPUT:"OUTPUT",DIV:"DIV",A:"A",P:"P",B:"B",STRONG:"STRONG",I:"I",EM:"EM",MARK:"MARK",SMALL:"SMALL",DEL:"DEL",INS:"INS",SUB:"SUB",SUP:"SUP"},FORM_ELEMENTS:["INPUT","BUTTON","TEXTAREA","SELECT","OPTGROUP","DATALIST","OUTPUT","A"],DEFAULT_CONTAINER_TAG_NAME:"DIV",DEFAULT_DESCRIPTION_TAG_NAME:"P",DEFAULT_LABEL_TAG_NAME:"P",ASSOCIATION_ATTRIBUTES:["aria-labelledby","aria-describedby","aria-activedescendant"],INPUT_TYPES_THAT_SUPPORT_CHECKED:["RADIO","CHECKBOX"],DOM_EVENTS:["focusin","focusout","input","change","click","keydown","keyup"],DATA_TRAIL_ID:"data-trail-id",DATA_EXCLUDE_FROM_INPUT:"data-exclude-from-input"};zn.register("PDOMUtils",wr);var Ar=wr;const xr=Ar.TAGS.LABEL,Tr=Ar.TAGS.INPUT,Sr={attributes:!1,childList:!0,characterData:!0};let Dr=1;const Er=new Ke(0,0,0,0),Cr=new Ke(0,0,0,0),Ir=new oi,Pr=new oi,kr=new oi;function Lr(t,e){this.initializeAccessiblePeer(t,e)}function Or(t,e,i,n){(n=h({siblingName:null,excludeFromInput:!1},n)).id=n.siblingName?`${n.siblingName}-${i}`:i,n.trailId=i;const s=Ar.createElement(t,e,n);return n.excludeFromInput&&s.setAttribute(Ar.DATA_EXCLUDE_FROM_INPUT,!0),s}function Nr(t,e,i){return Ir.setToTranslation(i.minX,i.minY),Pr.setToScale(i.width/t,i.height/e),Ir.multiplyMatrix(Pr).multiplyMatrix(kr)}function Rr(t){let e=t.clientWidth,i=t.clientHeight;if(0===e&&0===i){const n=t.getBoundingClientRect();e=n.width,i=n.height}return{width:e,height:i}}function Mr(t,e){t.style.top=e.top+"px",t.style.left=e.left+"px",t.style.width=e.width+"px",t.style.height=e.height+"px"}zn.register("PDOMPeer",Lr),R(Object,Lr,{initializeAccessiblePeer:function(t,e){return e=h({primarySibling:null},e),this.id=this.id||Dr++,this.accessibleInstance=t,this.node=this.accessibleInstance.node,this.display=t.display,this.trail=t.trail,this.visible=null,this.focusable=null,this._labelSibling=null,this._descriptionSibling=null,this._containerParent=null,this.topLevelElements=[],this.positionDirty=!1,this.childPositionDirty=!1,this.mutationObserver=this.mutationObserver||new MutationObserver(this.invalidateCSSPositioning.bind(this)),this.transformListener=this.transformListener||this.invalidateCSSPositioning.bind(this),this.accessibleInstance.transformTracker.addListener(this.transformListener),this.isDisposed=!1,this.accessibleInstance.isRootInstance&&(this._primarySibling=e.primarySibling,this._primarySibling.className=dr.ROOT_CLASS_NAME),this},update:function(){const t=this.accessibleInstance.trail.getUniqueId();let e=this.node.getBaseOptions();null!==this.node.accessibleName&&(e=this.node.accessibleNameBehavior(this.node,e,this.node.accessibleName)),null!==this.node.accessibleHeading&&(e=this.node.accessibleHeadingBehavior(this.node,e,this.node.accessibleHeading)),null!==this.node.helpText&&(e=this.node.helpTextBehavior(this.node,e,this.node.helpText)),this._primarySibling=Or(e.tagName,this.node.focusable,t,{namespace:e.accessibleNamespace}),e.containerTagName&&(this._containerParent=Or(e.containerTagName,!1,t,{siblingName:"container"})),e.labelTagName&&(this._labelSibling=Or(e.labelTagName,!1,t,{siblingName:"label",excludeFromInput:this.node.excludeLabelSiblingFromInput})),e.descriptionTagName&&(this._descriptionSibling=Or(e.descriptionTagName,!1,t,{siblingName:"description"})),this.orderElements(e),this.mutationObserver.disconnect(),this.mutationObserver.observe(this._primarySibling,Sr),e.labelContent&&null!==e.labelTagName&&this.setLabelSiblingContent(e.labelContent),e.innerContent&&null!==e.tagName&&this.setPrimarySiblingContent(e.innerContent),e.descriptionContent&&null!==e.descriptionTagName&&this.setDescriptionSiblingContent(e.descriptionContent),e.tagName.toUpperCase()===Tr&&e.inputType&&this.setAttributeToElement("type",e.inputType),this.setFocusable(this.node.focusable),this.onAriaLabelledbyAssociationChange(),this.onAriaDescribedbyAssociationChange(),this.onActiveDescendantAssociationChange(),this.onAttributeChange(e),this.onInputValueChange(),this.node.updateOtherNodesAriaLabelledby(),this.node.updateOtherNodesAriaDescribedby(),this.node.updateOtherNodesActiveDescendant()},orderElements:function(t){this._containerParent?(this._containerParent.insertBefore(this._primarySibling,this._containerParent.children[0]||null),this.topLevelElements=[this._containerParent]):this.topLevelElements=[this._labelSibling,this._descriptionSibling,this._primarySibling].filter(_.identity),this._labelSibling&&this.arrangeContentElement(this._labelSibling,t.appendLabel),this._descriptionSibling&&this.arrangeContentElement(this._descriptionSibling,t.appendDescription)},getPrimarySibling:function(){return this._primarySibling},get primarySibling(){return this.getPrimarySibling()},getLabelSibling:function(){return this._labelSibling},get labelSibling(){return this.getLabelSibling()},getDescriptionSibling:function(){return this._descriptionSibling},get descriptionSibling(){return this.getDescriptionSibling()},getContainerParent:function(){return this._containerParent},get containerParent(){return this.getContainerParent()},onAriaLabelledbyAssociationChange:function(){this.removeAttributeFromAllElements("aria-labelledby");for(let t=0;t<this.node.ariaLabelledbyAssociations.length;t++){const e=this.node.ariaLabelledbyAssociations[t];this.setAssociationAttribute("aria-labelledby",e)}},onAriaDescribedbyAssociationChange:function(){this.removeAttributeFromAllElements("aria-describedby");for(let t=0;t<this.node.ariaDescribedbyAssociations.length;t++){const e=this.node.ariaDescribedbyAssociations[t];this.setAssociationAttribute("aria-describedby",e)}},onActiveDescendantAssociationChange:function(){this.removeAttributeFromAllElements("aria-activedescendant");for(let t=0;t<this.node.activeDescendantAssociations.length;t++){const e=this.node.activeDescendantAssociations[t];this.setAssociationAttribute("aria-activedescendant",e)}},onAttributeChange:function(t){for(let e=0;e<this.node.accessibleAttributes.length;e++){const i=this.node.accessibleAttributes[e],n=i.attribute;let s=i.value;"aria-label"===n&&t&&"string"==typeof t.ariaLabel&&"PRIMARY_SIBLING"===i.options.elementName&&(s=t.ariaLabel),this.setAttributeToElement(n,s,i.options)}},onInputValueChange:function(){if(null===this.node.inputValue)this.removeAttributeFromElement("value");else{const t=this.node.inputValue+"";this.setAttributeToElement("value",t,{asProperty:!0})}},getElementByName:function(t){return t===Lr.PRIMARY_SIBLING?this._primarySibling:t===Lr.LABEL_SIBLING?this._labelSibling:t===Lr.DESCRIPTION_SIBLING?this._descriptionSibling:t===Lr.CONTAINER_PARENT?this._containerParent:void 0},setAttributeToElement:function(t,e,i){const n=(i=h({namespace:null,asProperty:!1,elementName:"PRIMARY_SIBLING",element:null},i)).element||this.getElementByName(i.elementName);i.namespace?n.setAttributeNS(i.namespace,t,e):i.asProperty?n[t]=e:n.setAttribute(t,e)},removeAttributeFromElement:function(t,e){const i=(e=h({namespace:null,elementName:"PRIMARY_SIBLING",element:null},e)).element||this.getElementByName(e.elementName);e.namespace?i.removeAttributeNS(e.namespace,t):i.removeAttribute(t)},removeAttributeFromAllElements:function(t){this._primarySibling&&this._primarySibling.removeAttribute(t),this._labelSibling&&this._labelSibling.removeAttribute(t),this._descriptionSibling&&this._descriptionSibling.removeAttribute(t),this._containerParent&&this._containerParent.removeAttribute(t)},setAssociationAttribute:function(t,e){const i=e.otherNode.getAccessibleInstances();if(i.length>0){const n=i[0];n===this.accessibleInstance&&(n.peer=this);const s=n.peer.getElementByName(e.otherElementName),r=this.getElementByName(e.thisElementName);if(r&&s){const i=r.getAttribute(t)||"",n=[i.trim(),s.id].join(" ").trim();this.setAttributeToElement(t,n,{elementName:e.thisElementName})}}},arrangeContentElement:function(t,e){if(this.topLevelElements[0]===this._containerParent)e?this._containerParent.appendChild(t):this._containerParent.insertBefore(t,this._primarySibling);else{q(this.topLevelElements,t);const i=this.topLevelElements.indexOf(this._primarySibling),n=e?this.topLevelElements.length:i;this.topLevelElements.splice(n,0,t)}},isVisible:function(){return null===this.visible||this.visible},setVisible:function(t){if(this.visible!==t){this.visible=t;for(let e=0;e<this.topLevelElements.length;e++){const i=this.topLevelElements[e];t?this.removeAttributeFromElement("hidden",{element:i}):this.setAttributeToElement("hidden","",{element:i})}this.invalidateCSSPositioning()}},isFocused:function(){const t=zn.PDOMInstance.guessVisualTrail(this.trail,this.display.rootNode);return zn.Display.focusProperty.value&&zn.Display.focusProperty.value.trail.equals(t)},focus:function(){this._primarySibling.focus()},blur:function(){if(document.activeElement===this._primarySibling){const t=this;Xs.ie11&&or.isFullScreen()?window.setTimeout((function(){t._primarySibling&&t._primarySibling.blur()}),0):this._primarySibling.blur()}},setFocusable:function(t){const e=this.isFocused();this.focusable!==t&&(this.focusable=t,Ar.overrideFocusWithTabIndex(this.primarySibling,t),e&&!t&&this.blur(),this.invalidateCSSPositioning())},setLabelSiblingContent:function(t){this._labelSibling&&(Ar.setTextContent(this._labelSibling,t),this._labelSibling.tagName.toUpperCase()===xr&&this.setAttributeToElement("for",this._primarySibling.id,{elementName:Lr.LABEL_SIBLING}))},setDescriptionSiblingContent:function(t){this._descriptionSibling&&Ar.setTextContent(this._descriptionSibling,t)},setPrimarySiblingContent:function(t){this._primarySibling&&Ar.setTextContent(this._primarySibling,t)},setPDOMTransformSourceNode:function(t){this.accessibleInstance.transformTracker.removeListener(this.transformListener),this.accessibleInstance.updateTransformTracker(t),this.accessibleInstance.transformTracker.addListener(this.transformListener),this.invalidateCSSPositioning()},invalidateCSSPositioning:function(){if(!this.positionDirty&&this.focusable){this.positionDirty=!0;let t=this.accessibleInstance.parent;for(;t;)t.peer.childPositionDirty=!0,t=t.parent}},positionElements:function(){if(this.node.focusable){const t=this.node.pdomTransformSourceNode||this.node;if(Er.set(t.localBounds),Er.isFinite()){Er.transform(this.accessibleInstance.transformTracker.getMatrix());const t=this.display.bounds;if(t.intersectsBounds(Er)){Er.constrainBounds(t);let e=Rr(this._primarySibling),i=e.width,n=e.height;i>0&&n>0&&(Cr.setMinMax(0,0,i,n),Cr.transform(Nr(i,n,Er)),Mr(this._primarySibling,Cr)),this.labelSibling&&(e=Rr(this._labelSibling),i=e.width,n=e.height,n>0&&i>0&&(Cr.setMinMax(0,0,i,n),Cr.transform(Nr(i,n,Er)),Mr(this._labelSibling,Cr)))}}}this.positionDirty=!1},updateSubtreePositioning:function(){this.childPositionDirty=!1,this.positionDirty&&this.positionElements();for(let t=0;t<this.accessibleInstance.children.length;t++){const e=this.accessibleInstance.children[t].peer;(e.positionDirty||e.childPositionDirty)&&this.accessibleInstance.children[t].peer.updateSubtreePositioning()}},dispose:function(){this.isDisposed=!0,this.blur(),this._primarySibling.removeEventListener("blur",this.blurEventListener),this._primarySibling.removeEventListener("focus",this.focusEventListener),this.accessibleInstance.transformTracker.removeListener(this.transformListener),this.mutationObserver.disconnect(),this.accessibleInstance=null,this.node=null,this.display=null,this.trail=null,this._primarySibling=null,this._labelSibling=null,this._descriptionSibling=null,this._containerParent=null,this.focusable=null,this.freeToPool()}},{PRIMARY_SIBLING:"PRIMARY_SIBLING",LABEL_SIBLING:"LABEL_SIBLING",DESCRIPTION_SIBLING:"DESCRIPTION_SIBLING",CONTAINER_PARENT:"CONTAINER_PARENT"}),Pe.mixInto(Lr,{initalize:Lr.prototype.initializeAccessiblePeer});var Br=Lr;let Fr=1;function Vr(t,e,i){this.initializeAccessibleInstance(t,e,i)}zn.register("PDOMInstance",Vr),R(Object,Vr,{initializeAccessibleInstance:function(t,e,i){if(this.id=this.id||Fr++,this.parent=t,this.display=e,this.trail=i,this.isRootInstance=null===t,this.node=this.isRootInstance?null:i.lastNode(),this.children=ci(this.children),this.node&&this.node.addAccessibleInstance(this),this.peer=null,this.invisibleCount=0,this.relativeNodes=[],this.relativeVisibilities=[],this.relativeListeners=[],this.transformTracker=null,this.updateTransformTracker(this.node?this.node.pdomTransformSourceNode:null),this.isDisposed=!1,this.isRootInstance){const t=document.createElement("div");this.peer=Br.createFromPool(this,{primarySibling:t})}else{this.peer=Br.createFromPool(this),this.peer.update();const t=this.parent.trail;for(let n=t.length;n<i.length;n++){const s=i.nodes[n];this.relativeNodes.push(s);const r=s._accessibleDisplaysInfo.accessibleDisplays,o=_.includes(r,e);this.relativeVisibilities.push(o),o||this.invisibleCount++;const a=this.checkAccessibleDisplayVisibility.bind(this,n-t.length);s.accessibleDisplaysEmitter.addListener(a),this.relativeListeners.push(a)}this.updateVisibility()}return this},addConsecutiveInstances:function(t){const e=this.children.length>0;Array.prototype.push.apply(this.children,t);for(let i=0;i<t.length;i++)Ar.insertElements(this.peer.primarySibling,t[i].peer.topLevelElements);e&&this.sortChildren()},removeInstancesForTrail:function(t){for(let e=0;e<this.children.length;e++){const i=this.children[e],n=i.trail;let s=n.length<t.length;if(!s)for(let e=this.trail.length;e<t.length;e++)if(t.nodes[e]!==n.nodes[e]){s=!0;break}s||(this.children.splice(e,1),i.dispose(),e-=1)}},removeAllChildren:function(){for(;this.children.length;)this.children.pop().dispose()},findChildWithTrail:function(t){for(let e=0;e<this.children.length;e++){const i=this.children[e];if(i.trail.equals(t))return i}return null},removeSubtree:function(t){for(let e=this.children.length-1;e>=0;e--){const i=this.children[e];i.trail.isExtensionOf(t,!0)&&(this.children.splice(e,1),i.dispose())}},checkAccessibleDisplayVisibility:function(t){const e=_.includes(this.relativeNodes[t]._accessibleDisplaysInfo.accessibleDisplays,this.display);if(e!==this.relativeVisibilities[t]){this.relativeVisibilities[t]=e;const i=0===this.invisibleCount;this.invisibleCount+=e?-1:1,0===this.invisibleCount!==i&&this.updateVisibility()}},updateVisibility:function(){this.peer.setVisible(this.invisibleCount<=0),this.peer.isVisible()||this.peer.primarySibling.contains(document.activeElement)&&(zn.Display.focus=null),Xs.edge&&(this.display.getAccessibleDOMElement().style.display="none",this.display.getAccessibleDOMElement().style.display="block")},isGloballyVisible:function(){return!!this.peer.isVisible()&&(!this.parent||this.parent.isGloballyVisible())},getChildOrdering:function(t){const e=t.lastNode(),i=e.getEffectiveChildren();let n;const s=[];if(e.accessibleContent&&e!==this.node){const i=e.accessibleInstances;t:for(n=0;n<i.length;n++){const e=i[n];if(e.parent===this){for(let i=0;i<t.length;i++)if(t.nodes[i]!==e.trail.nodes[i+e.trail.length-t.length])continue t;s.push(e)}}}else for(n=0;n<i.length;n++)t.addDescendant(i[n],n),Array.prototype.push.apply(s,this.getChildOrdering(t)),t.removeDescendant();return s},sortChildren:function(){const t=this.getChildOrdering(new zn.Trail(this.isRootInstance?this.display.rootNode:this.node));this.children=t;const e=this.peer.primarySibling;let i=e.childNodes.length-1;for(let n=this.children.length-1;n>=0;n--){const t=this.children[n].peer;for(let n=t.topLevelElements.length-1;n>=0;n--){const s=t.topLevelElements[n];e.childNodes[i]!==s&&e.insertBefore(s,e.childNodes[i+1]),i--}}},updateTransformTracker(t){this.transformTracker&&this.transformTracker.dispose();let e=null;e=t?t.getUniqueTrail():Vr.guessVisualTrail(this.trail,this.display.rootNode),this.transformTracker=new Qs(e)},dispose:function(){if(!this.isRootInstance){Ar.removeElements(this.parent.peer.primarySibling,this.peer.topLevelElements);for(let t=0;t<this.relativeNodes.length;t++)this.relativeNodes[t].accessibleDisplaysEmitter.removeListener(this.relativeListeners[t])}for(;this.children.length;)this.children.pop().dispose();this.peer.dispose(),this.transformTracker.dispose(),this.transformTracker=null,this.node&&this.node.removeAccessibleInstance(this),this.relativeNodes=null,this.display=null,this.trail=null,this.node=null,this.peer=null,this.isDisposed=!0,this.freeToPool()},toString:function(){return this.id+"#{"+this.trail.toString()+"}"},auditRoot:function(){return void 0}},{guessVisualTrail:function(t,e){t.reindex();const i=t.indices.lastIndexOf(-1);if(i<0)return t;const n=i+1,s=t.nodes[n].getTrailsTo(e);if(0===s.length)return t;const r=s[0];for(let o=n+1;o<t.length;o++)r.addDescendant(t.nodes[o]);return r},createFakeAccessibleTree:function(t){return{node:null,children:function t(e){let i=_.flatten(e.getEffectiveChildren().map(t));return e.accessibleContent&&(i=[{node:e,children:i}]),i}(t)}}}),Pe.mixInto(Vr,{initialize:Vr.prototype.initializeAccessibleInstance});var Hr=Vr;function zr(t,e,i){this.accessibleInstance=t,this.trail=e,this.isRoot=i,this.fullTrail=this.accessibleInstance.trail.copy();for(let n=this.isRoot?0:1;n<this.trail.length;n++)this.fullTrail.addDescendant(this.trail.nodes[n])}zn.register("PartialPDOMTrail",zr),R(Object,zr);var Gr=zr;let qr=null;var Yr={addChild:function(t,e){const i=Yr.beforeOp(e);e._accessibleParent||Yr.addTree(t,e),Yr.afterOp(i)},removeChild:function(t,e){const i=Yr.beforeOp(e);e._accessibleParent||Yr.removeTree(t,e),Yr.afterOp(i)},childrenOrderChange:function(t){const e=Yr.beforeOp(t);Yr.reorder(t),Yr.afterOp(e)},accessibleOrderChange:function(t,e,i){const n=Yr.beforeOp(t),s=[],r=[];let o,a;Rs(e||[],i||[],s,r);const l=Yr.findAccessibleTrails(t);for(o=0;o<s.length;o++){const e=s[o];e&&(Yr.removeTree(t,e,l),e._accessibleParent=null)}for(o=0;o<r.length;o++){const e=r[o];if(e){const i=e._parents;for(a=0;a<i.length;a++)Yr.removeTree(i[a],e);e._accessibleParent=t}}for(o=0;o<s.length;o++){const t=s[o];if(t){const e=t._parents;for(a=0;a<e.length;a++)Yr.addTree(e[a],t)}}for(o=0;o<r.length;o++){const e=r[o];e&&Yr.addTree(t,e,l)}Yr.reorder(t,l),Yr.afterOp(n)},accessibleContentChange:function(t){const e=Yr.beforeOp(t);let i;const n=t._accessibleParent?[t._accessibleParent]:t._parents,s=[];for(i=0;i<n.length;i++){const e=n[i],r=Yr.findAccessibleTrails(e);s.push(r),Yr.removeTree(e,t,r)}for(i=0;i<n.length;i++)Yr.addTree(n[i],t,s[i]);for(i=0;i<t._rootedDisplays.length;i++){const e=t._rootedDisplays[i];e._accessible&&Yr.rebuildInstanceTree(e._rootAccessibleInstance)}Yr.afterOp(e)},rebuildInstanceTree:function(t){const e=t.display.rootNode;t.removeAllChildren(),t.addConsecutiveInstances(Yr.createTree(new Vs(e),t.display,t))},addTree:function(t,e,i){i=i||Yr.findAccessibleTrails(t);for(let n=0;n<i.length;n++){const t=i[n],s=t.accessibleInstance;t.fullTrail.addDescendant(e);const r=Yr.createTree(t.fullTrail,s.display,s);t.fullTrail.removeDescendant(e),s.addConsecutiveInstances(r)}},removeTree:function(t,e,i){i=i||Yr.findAccessibleTrails(t);for(let n=0;n<i.length;n++){const t=i[n];t.fullTrail.addDescendant(e),t.accessibleInstance.removeInstancesForTrail(t.fullTrail),t.fullTrail.removeDescendant(e)}},reorder:function(t,e){e=e||Yr.findAccessibleTrails(t);for(let i=0;i<e.length;i++){e[i].accessibleInstance.sortChildren()}},createTree:function(t,e,i){const n=t.lastNode(),s=n.getEffectiveChildren();let r,o=!1;n.accessibleContent&&(r=i.findChildWithTrail(t),r?o=!0:r=Hr.createFromPool(i,e,t.copy()),i=r);const a=[];for(let l=0;l<s.length;l++)t.addDescendant(s[l],l),Array.prototype.push.apply(a,Yr.createTree(t,e,i)),t.removeDescendant();return r?(r.addConsecutiveInstances(a),o?[]:[r]):a},beforeOp:function(t){qr=zn.Display&&zn.Display.focusedNode;const e=[],i=this.findAccessibleTrails(t);for(let n=0;n<i.length;n++){const t=i[n].accessibleInstance.display;t.blockFocusCallbacks=!0,e.push(t)}return e},afterOp:function(t){qr&&qr.focus();for(let e=0;e<t.length;e++)t[e].blockFocusCallbacks=!1},findAccessibleTrails:function(t){const e=[];return Yr.recursiveAccessibleTrailSearch(e,new Vs(t)),e},recursiveAccessibleTrailSearch:function(t,e){const i=e.rootNode();let n;if(i.accessibleContent){const s=i.accessibleInstances;for(n=0;n<s.length;n++)t.push(new Gr(s[n],e.copy(),!1));return}{const s=i.rootedDisplays;for(n=0;n<s.length;n++){const i=s[n];i._accessible&&t.push(new Gr(i._rootAccessibleInstance,e.copy(),!0))}}const s=i._accessibleParent?[i._accessibleParent]:i._parents,r=s.length;for(n=0;n<r;n++){const i=s[n];e.addAncestor(i),Yr.recursiveAccessibleTrailSearch(t,e),e.removeAncestor()}},auditAccessibleDisplays:function(t){0},auditNodeForAccessibleCycles:function(t){0},debugOrder:function(t){return null===t?"null":"["+t.map((function(t){return null===t?"null":t._id})).join(",")+"]"}};zn.register("PDOMTree",Yr);var Ur=Yr;Ar.TAGS.INPUT;const jr=Ar.TAGS.P,Wr=jr,Xr=jr,Kr=function(t,e,i){return"input"===t.tagName?(e.labelTagName="label",e.labelContent=i):Ar.tagNameSupportsContent(t.tagName)?e.innerContent=i:e.ariaLabel=i,e},Qr=function(t,e,i){return e.descriptionTagName=Ar.DEFAULT_DESCRIPTION_TAG_NAME,e.descriptionContent=i,e.appendDescription=!0,e},Zr=function(t,e,i){return e.labelTagName="h"+t.headingLevel,e.labelContent=i,e},$r=(Ar.FORM_ELEMENTS,Ar.INPUT_TYPES_THAT_SUPPORT_CHECKED,Ar.ASSOCIATION_ATTRIBUTES,["focusable","tagName","accessibleName","helpText","helpTextBehavior","accessibleHeading","accessibleHeadingBehavior","containerTagName","containerAriaRole","innerContent","inputType","inputValue","accessibleChecked","accessibleNamespace","ariaLabel","ariaRole","ariaValueText","labelTagName","labelContent","appendLabel","descriptionTagName","descriptionContent","appendDescription","focusHighlight","focusHighlightLayerable","groupFocusHighlight","accessibleVisible","accessibleOrder","ariaLabelledbyAssociations","ariaDescribedbyAssociations","activeDescendantAssociations","pdomTransformSourceNode"]),Jr={compose:function(t){const e=t.prototype;O(e,{_mutatorKeys:$r.concat(e._mutatorKeys),initializeAccessibility:function(){this._tagName=null,this._containerTagName=null,this._labelTagName=null,this._descriptionTagName=null,this._inputType=null,this._inputValue=null,this._accessibleChecked=!1,this._appendLabel=!1,this._appendDescription=!1,this._accessibleAttributes=[],this._labelContent=null,this._innerContent=null,this._descriptionContent=null,this._accessibleNamespace=null,this._ariaLabel=null,this._ariaRole=null,this._containerAriaRole=null,this._ariaValueText=null,this._ariaLabelledbyAssociations=[],this._nodesThatAreAriaLabelledbyThisNode=[],this._ariaDescribedbyAssociations=[],this._nodesThatAreAriaDescribedbyThisNode=[],this._activeDescendantAssociations=[],this._nodesThatAreActiveDescendantToThisNode=[],this._focusableOverride=null,this._focusHighlight=null,this._focusHighlightLayerable=!1,this._groupFocusHighlight=!1,this._accessibleVisible=!0,this._accessibleOrder=null,this._accessibleParent=null,this._pdomTransformSourceNode=null,this._accessibleDisplaysInfo=new Gs(this),this._accessibleInstances=[],this.excludeLabelSiblingFromInput=!1,this._accessibleName=null,this._accessibleNameBehavior=Kr,this._helpText=null,this._helpTextBehavior=Qr,this._accessibleHeading=null,this._headingLevel=null,this._accessibleHeadingBehavior=Zr},disposeAccessibility:function(){this.accessibleOrder=null,this.setPDOMTransformSourceNode(null),this.setAriaLabelledbyAssociations([]),this.setAriaDescribedbyAssociations([]),this.setActiveDescendantAssociations([])},isFocused:function(){for(let t=0;t<this._accessibleInstances.length;t++){if(this._accessibleInstances[t].peer.isFocused())return!0}return!1},get focused(){return this.isFocused()},focus:function(){if(this._accessibleInstances.length>0){const t=this._accessibleInstances[0].peer;t.focus()}},blur:function(){if(this._accessibleInstances.length>0){const t=this._accessibleInstances[0].peer;t.blur(),this.interruptInput()}},accessibleAudit:function(){this.accessibleContent;for(let t=0;t<this.children.length;t++)this.children[t].accessibleAudit()},setAccessibleName:function(t){this._accessibleName!==t&&(this._accessibleName=t,this.onAccessibleContentChange())},set accessibleName(t){this.setAccessibleName(t)},getAccessibleName:function(){return this._accessibleName},get accessibleName(){return this.getAccessibleName()},setAccessibleNameBehavior:function(t){this._accessibleNameBehavior!==t&&(this._accessibleNameBehavior=t,this.onAccessibleContentChange())},set accessibleNameBehavior(t){this.setAccessibleNameBehavior(t)},getAccessibleNameBehavior:function(){return this._accessibleNameBehavior},get accessibleNameBehavior(){return this.getAccessibleNameBehavior()},setAccessibleHeading:function(t){this._accessibleHeading!==t&&(this._accessibleHeading=t,this.onAccessibleContentChange())},set accessibleHeading(t){this.setAccessibleHeading(t)},getAccessibleHeading:function(){return this._accessibleHeading},get accessibleHeading(){return this.getAccessibleHeading()},setAccessibleHeadingBehavior:function(t){this._accessibleHeadingBehavior!==t&&(this._accessibleHeadingBehavior=t,this.onAccessibleContentChange())},set accessibleHeadingBehavior(t){this.setAccessibleHeadingBehavior(t)},getAccessibleHeadingBehavior:function(){return this._accessibleHeadingBehavior},get accessibleHeadingBehavior(){return this.getAccessibleHeadingBehavior()},getHeadingLevel:function(){return this._headingLevel},get headingLevel(){return this.getHeadingLevel()},computeHeadingLevel:function(){if(!this._accessibleParent)return this._accessibleHeading?(this._headingLevel=1,1):0;if(this._accessibleHeading){const t=this._accessibleParent.computeHeadingLevel()+1;return this._headingLevel=t,t}return this._accessibleParent.computeHeadingLevel()},setHelpText:function(t){this._helpText!==t&&(this._helpText=t,this.onAccessibleContentChange())},set helpText(t){this.setHelpText(t)},getHelpText:function(){return this._helpText},get helpText(){return this.getHelpText()},setHelpTextBehavior:function(t){this._helpTextBehavior!==t&&(this._helpTextBehavior=t,this.onAccessibleContentChange())},set helpTextBehavior(t){this.setHelpTextBehavior(t)},getHelpTextBehavior:function(){return this._helpTextBehavior},get helpTextBehavior(){return this.getHelpTextBehavior()},setTagName:function(t){t!==this._tagName&&(this._tagName=t,this.onAccessibleContentChange())},set tagName(t){this.setTagName(t)},getTagName:function(){return this._tagName},get tagName(){return this.getTagName()},setLabelTagName:function(t){t!==this._labelTagName&&(this._labelTagName=t,this.onAccessibleContentChange())},set labelTagName(t){this.setLabelTagName(t)},getLabelTagName:function(){return this._labelTagName},get labelTagName(){return this.getLabelTagName()},setDescriptionTagName:function(t){t!==this._descriptionTagName&&(this._descriptionTagName=t,this.onAccessibleContentChange())},set descriptionTagName(t){this.setDescriptionTagName(t)},getDescriptionTagName:function(){return this._descriptionTagName},get descriptionTagName(){return this.getDescriptionTagName()},setInputType:function(t){if(t!==this._inputType){this._inputType=t;for(let e=0;e<this._accessibleInstances.length;e++){const i=this._accessibleInstances[e].peer;null===t?i.removeAttributeFromElement("type"):i.setAttributeToElement("type",t)}}},set inputType(t){this.setInputType(t)},getInputType:function(){return this._inputType},get inputType(){return this.getInputType()},setAppendLabel:function(t){this._appendLabel!==t&&(this._appendLabel=t,this.onAccessibleContentChange())},set appendLabel(t){this.setAppendLabel(t)},getAppendLabel:function(){return this._appendLabel},get appendLabel(){return this.getAppendLabel()},setAppendDescription:function(t){this._appendDescription!==t&&(this._appendDescription=t,this.onAccessibleContentChange())},set appendDescription(t){this.setAppendDescription(t)},getAppendDescription:function(){return this._appendDescription},get appendDescription(){return this.getAppendDescription()},setContainerTagName:function(t){this._containerTagName!==t&&(this._containerTagName=t,this.onAccessibleContentChange())},set containerTagName(t){this.setContainerTagName(t)},getContainerTagName:function(){return this._containerTagName},get containerTagName(){return this.getContainerTagName()},setLabelContent:function(t){if(this._labelContent!==t){this._labelContent=t,this._labelTagName||this.setLabelTagName(Xr);for(let t=0;t<this._accessibleInstances.length;t++){this._accessibleInstances[t].peer.setLabelSiblingContent(this._labelContent)}}},set labelContent(t){this.setLabelContent(t)},getLabelContent:function(){return this._labelContent},get labelContent(){return this.getLabelContent()},setInnerContent:function(t){if(this._innerContent!==t){this._innerContent=t;for(let t=0;t<this._accessibleInstances.length;t++){this._accessibleInstances[t].peer.setPrimarySiblingContent(this._innerContent)}}},set innerContent(t){this.setInnerContent(t)},getInnerContent:function(){return this._innerContent},get innerContent(){return this.getInnerContent()},setDescriptionContent:function(t){if(this._descriptionContent!==t){this._descriptionContent=t,this._descriptionTagName||this.setDescriptionTagName(Wr);for(let t=0;t<this._accessibleInstances.length;t++){this._accessibleInstances[t].peer.setDescriptionSiblingContent(this._descriptionContent)}}},set descriptionContent(t){this.setDescriptionContent(t)},getDescriptionContent:function(){return this._descriptionContent},get descriptionContent(){return this.getDescriptionContent()},setAriaRole:function(t){this._ariaRole!==t&&(this._ariaRole=t,null!==t?this.setAccessibleAttribute("role",t):this.removeAccessibleAttribute("role"))},set ariaRole(t){this.setAriaRole(t)},getAriaRole:function(){return this._ariaRole},get ariaRole(){return this.getAriaRole()},setContainerAriaRole:function(t){this._containerAriaRole!==t&&(this._containerAriaRole=t,null===this._containerAriaRole?this.removeAccessibleAttribute("role",{elementName:Br.CONTAINER_PARENT}):this.setAccessibleAttribute("role",t,{elementName:Br.CONTAINER_PARENT}))},set containerAriaRole(t){this.setContainerAriaRole(t)},getContainerAriaRole:function(){return this._containerAriaRole},get containerAriaRole(){return this.getContainerAriaRole()},setAriaValueText:function(t){this._ariaValueText!==t&&(this._ariaValueText=t,null===this._ariaValueText?this.removeAccessibleAttribute("aria-valuetext"):this.setAccessibleAttribute("aria-valuetext",t))},set ariaValueText(t){this.setAriaValueText(t)},getAriaValueText:function(){return this._ariaValueText},get ariaValueText(){return this.getAriaValueText()},setAccessibleNamespace:function(t){return this._accessibleNamespace!==t&&(this._accessibleNamespace=t,this.onAccessibleContentChange()),this},set accessibleNamespace(t){this.setAccessibleNamespace(t)},getAccessibleNamespace:function(){return this._accessibleNamespace},get accessibleNamespace(){return this.getAccessibleNamespace()},setAriaLabel:function(t){this._ariaLabel!==t&&(this._ariaLabel=t,null===this._ariaLabel?this.removeAccessibleAttribute("aria-label"):this.setAccessibleAttribute("aria-label",t))},set ariaLabel(t){this.setAriaLabel(t)},getAriaLabel:function(){return this._ariaLabel},get ariaLabel(){return this.getAriaLabel()},setFocusHighlight:function(t){this._focusHighlight!==t&&(this._focusHighlight=t,this._focusHighlightLayerable&&(t.visible=this.focused),this.focusHighlightChangedEmitter.emit())},set focusHighlight(t){this.setFocusHighlight(t)},getFocusHighlight:function(){return this._focusHighlight},get focusHighlight(){return this.getFocusHighlight()},setFocusHighlightLayerable:function(t){this._focusHighlightLayerable!==t&&(this._focusHighlightLayerable=t,this._focusHighlight&&(this._focusHighlight.visible=this.focused))},set focusHighlightLayerable(t){this.setFocusHighlightLayerable(t)},getFocusHighlightLayerable:function(){return this._focusHighlightLayerable},get focusHighlightLayerable(){return this.getFocusHighlightLayerable()},setGroupFocusHighlight:function(t){this._groupFocusHighlight=t},set groupFocusHighlight(t){this.setGroupFocusHighlight(t)},getGroupFocusHighlight:function(){return this._groupFocusHighlight},get groupFocusHighlight(){return this.getGroupFocusHighlight()},setAriaLabelledbyAssociations:function(t){let e,i;if(0===t.length&&0===this._ariaLabelledbyAssociations.length)return;const n=[],s=[],r=[];for(Rs(t,this._ariaLabelledbyAssociations,s,n,r),i=0;i<n.length;i++)e=n[i],this.removeAriaLabelledbyAssociation(e);for(i=0;i<s.length;i++){const e=t[i];this.addAriaLabelledbyAssociation(e)}},set ariaLabelledbyAssociations(t){return this.setAriaLabelledbyAssociations(t)},getAriaLabelledbyAssociations:function(){return this._ariaLabelledbyAssociations},get ariaLabelledbyAssociations(){return this.getAriaLabelledbyAssociations()},addAriaLabelledbyAssociation:function(t){this._ariaLabelledbyAssociations.push(t),t.otherNode._nodesThatAreAriaLabelledbyThisNode.push(this),this.updateAriaLabelledbyAssociationsInPeers()},removeAriaLabelledbyAssociation:function(t){this._ariaLabelledbyAssociations.splice(_.indexOf(this._ariaLabelledbyAssociations,t),1)[0].otherNode.removeNodeThatIsAriaLabelledByThisNode(this),this.updateAriaLabelledbyAssociationsInPeers()},removeNodeThatIsAriaLabelledByThisNode:function(t){const e=_.indexOf(this._nodesThatAreAriaLabelledbyThisNode,t);this._nodesThatAreAriaLabelledbyThisNode.splice(e,1)},updateAriaLabelledbyAssociationsInPeers:function(){for(let t=0;t<this.accessibleInstances.length;t++){this.accessibleInstances[t].peer.onAriaLabelledbyAssociationChange()}},updateOtherNodesAriaLabelledby:function(){for(let t=0;t<this._nodesThatAreAriaLabelledbyThisNode.length;t++){this._nodesThatAreAriaLabelledbyThisNode[t].updateAriaLabelledbyAssociationsInPeers()}},getNodesThatAreAriaLabelledbyThisNode:function(){return this._nodesThatAreAriaLabelledbyThisNode},get nodesThatAreAriaLabelledbyThisNode(){return this.getNodesThatAreAriaLabelledbyThisNode()},setAriaDescribedbyAssociations:function(t){let e;if(0===t.length&&0===this._ariaDescribedbyAssociations.length)return;const i=[],n=[],s=[];let r;for(Rs(t,this._ariaDescribedbyAssociations,n,i,s),r=0;r<i.length;r++)e=i[r],this.removeAriaDescribedbyAssociation(e);for(r=0;r<n.length;r++){const e=t[r];this.addAriaDescribedbyAssociation(e)}},set ariaDescribedbyAssociations(t){return this.setAriaDescribedbyAssociations(t)},getAriaDescribedbyAssociations:function(){return this._ariaDescribedbyAssociations},get ariaDescribedbyAssociations(){return this.getAriaDescribedbyAssociations()},addAriaDescribedbyAssociation:function(t){this._ariaDescribedbyAssociations.push(t),t.otherNode._nodesThatAreAriaDescribedbyThisNode.push(this),this.updateAriaDescribedbyAssociationsInPeers()},hasAriaDescribedbyAssociation:function(t){return _.includes(this._ariaDescribedbyAssociations,t)},removeAriaDescribedbyAssociation:function(t){this._ariaDescribedbyAssociations.splice(_.indexOf(this._ariaDescribedbyAssociations,t),1)[0].otherNode.removeNodeThatIsAriaDescribedByThisNode(this),this.updateAriaDescribedbyAssociationsInPeers()},removeNodeThatIsAriaDescribedByThisNode:function(t){const e=_.indexOf(this._nodesThatAreAriaDescribedbyThisNode,t);this._nodesThatAreAriaDescribedbyThisNode.splice(e,1)},updateAriaDescribedbyAssociationsInPeers:function(){for(let t=0;t<this.accessibleInstances.length;t++){this.accessibleInstances[t].peer.onAriaDescribedbyAssociationChange()}},updateOtherNodesAriaDescribedby:function(){for(let t=0;t<this._nodesThatAreAriaDescribedbyThisNode.length;t++){this._nodesThatAreAriaDescribedbyThisNode[t].updateAriaDescribedbyAssociationsInPeers()}},getNodesThatAreAriaDescribedbyThisNode:function(){return this._nodesThatAreAriaDescribedbyThisNode},get nodesThatAreAriaDescribedbyThisNode(){return this.getNodesThatAreAriaDescribedbyThisNode()},setActiveDescendantAssociations:function(t){let e;if(0===t.length&&0===this._activeDescendantAssociations.length)return;const i=[],n=[],s=[];let r;for(Rs(t,this._activeDescendantAssociations,n,i,s),r=0;r<i.length;r++)e=i[r],this.removeActiveDescendantAssociation(e);for(r=0;r<n.length;r++){const e=t[r];this.addActiveDescendantAssociation(e)}},set activeDescendantAssociations(t){return this.setActiveDescendantAssociations(t)},getActiveDescendantAssociations:function(){return this._activeDescendantAssociations},get activeDescendantAssociations(){return this.getActiveDescendantAssociations()},addActiveDescendantAssociation:function(t){this._activeDescendantAssociations.push(t),t.otherNode._nodesThatAreActiveDescendantToThisNode.push(this),this.updateActiveDescendantAssociationsInPeers()},removeActiveDescendantAssociation:function(t){this._activeDescendantAssociations.splice(_.indexOf(this._activeDescendantAssociations,t),1)[0].otherNode.removeNodeThatIsActiveDescendantThisNode(this),this.updateActiveDescendantAssociationsInPeers()},removeNodeThatIsActiveDescendantThisNode:function(t){const e=_.indexOf(this._nodesThatAreActiveDescendantToThisNode,t);this._nodesThatAreActiveDescendantToThisNode.splice(e,1)},updateActiveDescendantAssociationsInPeers:function(){for(let t=0;t<this.accessibleInstances.length;t++){this.accessibleInstances[t].peer.onActiveDescendantAssociationChange()}},updateOtherNodesActiveDescendant:function(){for(let t=0;t<this._nodesThatAreActiveDescendantToThisNode.length;t++){this._nodesThatAreActiveDescendantToThisNode[t].updateActiveDescendantAssociationsInPeers()}},getNodesThatAreActiveDescendantToThisNode:function(){return this._nodesThatAreActiveDescendantToThisNode},get nodesThatAreActiveDescendantToThisNode(){return this.getNodesThatAreActiveDescendantToThisNode()},setAccessibleOrder:function(t){if(this._accessibleOrder!==t){const e=this._accessibleOrder;this._accessibleOrder=null===t?null:t.slice(),Ur.accessibleOrderChange(this,e,t),this.rendererSummaryRefreshEmitter.emit()}},set accessibleOrder(t){this.setAccessibleOrder(t)},getAccessibleOrder:function(){return this._accessibleOrder?this._accessibleOrder.slice(0):this._accessibleOrder},get accessibleOrder(){return this.getAccessibleOrder()},hasAccessibleOrder:function(){return null!==this._accessibleOrder&&0!==this._accessibleOrder.length&&(this._accessibleOrder.length>1||null!==this._accessibleOrder[0])},getAccessibleParent:function(){return this._accessibleParent},get accessibleParent(){return this.getAccessibleParent()},getEffectiveChildren:function(){const t=[];for(let e=0;e<this._children.length;e++){const i=this._children[e];i._accessibleParent||t.push(i)}if(this.hasAccessibleOrder()){const e=this.accessibleOrder.slice(),i=e.indexOf(null);return i>=0?(t.unshift(i,1),Array.prototype.splice.apply(e,t)):Array.prototype.push.apply(e,t),e}return t},setAccessibleVisible:function(t){this._accessibleVisible!==t&&(this._accessibleVisible=t,this._accessibleDisplaysInfo.onAccessibleVisibilityChange(t))},set accessibleVisible(t){this.setAccessibleVisible(t)},getAccessibleVisible:function(){return this._accessibleVisible},get accessibleVisible(){return this.getAccessibleVisible()},isAccessibleDisplayed:function(){for(let t=0;t<this._accessibleInstances.length;t++)if(this._accessibleInstances[t].isGloballyVisible())return!0;return!1},get accessibleDisplayed(){return this.isAccessibleDisplayed()},setInputValue:function(t){if((t=""+t)!==this._inputValue){this._inputValue=t;for(let t=0;t<this.accessibleInstances.length;t++){this.accessibleInstances[t].peer.onInputValueChange()}}},set inputValue(t){this.setInputValue(t)},getInputValue:function(){return this._inputValue},get inputValue(){return this.getInputValue()},setAccessibleChecked:function(t){this._tagName,this._inputType,this._accessibleChecked!==t&&(this._accessibleChecked=t,this.setAccessibleAttribute("checked",t,{asProperty:!0}))},set accessibleChecked(t){this.setAccessibleChecked(t)},getAccessibleChecked:function(){return this._accessibleChecked},get accessibleChecked(){return this.getAccessibleChecked()},getAccessibleAttributes:function(){return this._accessibleAttributes.slice(0)},get accessibleAttributes(){return this.getAccessibleAttributes()},setAccessibleAttribute:function(t,e,i){i=h({namespace:null,asProperty:!1,elementName:Br.PRIMARY_SIBLING},i);for(let n=0;n<this._accessibleAttributes.length;n++){const e=this._accessibleAttributes[n];e.attribute===t&&e.options.namespace===i.namespace&&e.options.asProperty===i.asProperty&&e.options.elementName===i.elementName&&this._accessibleAttributes.splice(n,1)}this._accessibleAttributes.push({attribute:t,value:e,options:i});for(let n=0;n<this._accessibleInstances.length;n++){this._accessibleInstances[n].peer.setAttributeToElement(t,e,i)}},removeAccessibleAttribute:function(t,e){e=h({namespace:null,elementName:Br.PRIMARY_SIBLING},e);let i=!1;for(let n=0;n<this._accessibleAttributes.length;n++)this._accessibleAttributes[n].attribute===t&&this._accessibleAttributes[n].options.namespace===e.namespace&&this._accessibleAttributes[n].options.elementName===e.elementName&&(this._accessibleAttributes.splice(n,1),i=!0);for(let n=0;n<this._accessibleInstances.length;n++){this._accessibleInstances[n].peer.removeAttributeFromElement(t,e)}},removeAccessibleAttributes:function(){const t=this.getAccessibleAttributes();for(let e=0;e<t.length;e++){const i=t[e].attribute;this.removeAccessibleAttribute(i)}},hasAccessibleAttribute:function(t,e){e=h({namespace:null,elementName:Br.PRIMARY_SIBLING},e);let i=!1;for(let n=0;n<this._accessibleAttributes.length;n++)this._accessibleAttributes[n].attribute===t&&this._accessibleAttributes[n].options.namespace===e.namespace&&this._accessibleAttributes[n].options.elementName===e.elementName&&(i=!0);return i},setFocusable:function(t){if(this._focusableOverride!==t){this._focusableOverride=t;for(let t=0;t<this._accessibleInstances.length;t++)this._accessibleInstances[t].peer.setFocusable(this.focusable)}},set focusable(t){this.setFocusable(t)},isFocusable:function(){return null!==this._focusableOverride?this._focusableOverride:null!==this._tagName&&Ar.tagIsDefaultFocusable(this._tagName)},get focusable(){return this.isFocusable()},setPDOMTransformSourceNode:function(t){this._pdomTransformSourceNode=t;for(let e=0;e<this._accessibleInstances.length;e++)this._accessibleInstances[e].peer.setPDOMTransformSourceNode(this._pdomTransformSourceNode)},set pdomTransformSourceNode(t){this.setPDOMTransformSourceNode(t)},getPDOMTransformSourceNode:function(){return this._pdomTransformSourceNode},get pdomTransformSourceNode(){return this.getPDOMTransformSourceNode()},setExcludeLabelSiblingFromInput:function(){this.excludeLabelSiblingFromInput=!0,this.onAccessibleContentChange()},getBaseOptions:function(){const t={};for(let e=0;e<$r.length;e++){const i=$r[e];t[i]=this[i]}return t},getNestedAccessibleOrder:function(){const t=new Vs(this);let e=[];const i=[],n=[i];return function i(s,r){let o=0;if(_.each(e,(function(t){s===t&&o++})),o>1||1===o&&!r)return;if(s.accessibleContent){const e={trail:t.copy(),children:[]};n[n.length-1].push(e),n.push(e.children)}const a=null===s._accessibleOrder?[]:s._accessibleOrder;e=e.concat(a),_.each(a,(function(e){_.each(s.getLeafTrailsTo(e),(function(n){n.removeAncestor(),t.addDescendantTrail(n),i(e,!0),t.removeDescendantTrail(n)}))}));const l=s._children.length;for(let e=0;e<l;e++){const n=s._children[e];t.addDescendant(n,e),i(n,!1),t.removeDescendant()}_.each(a,(function(){e.pop()})),s.accessibleContent&&n.pop()}(this,!1),i},onAccessibleContentChange:function(){Ur.accessibleContentChange(this),this._accessibleHeading&&this.computeHeadingLevel(),this.rendererSummaryRefreshEmitter.emit()},hasAccessibleContent:function(){return!!this._tagName},get accessibleContent(){return this.hasAccessibleContent()},onAccessibleAddChild:function(t){this._accessibleDisplaysInfo.onAddChild(t),Ur.addChild(this,t)},onAccessibleRemoveChild:function(t){this._accessibleDisplaysInfo.onRemoveChild(t),Ur.removeChild(this,t),t.updateOtherNodesAriaLabelledby(),t.updateOtherNodesAriaDescribedby(),t.updateOtherNodesActiveDescendant()},onAccessibleReorderedChildren:function(){Ur.childrenOrderChange(this)},getAccessibleInstances:function(){return this._accessibleInstances},get accessibleInstances(){return this.getAccessibleInstances()},addAccessibleInstance:function(t){this._accessibleInstances.push(t)},removeAccessibleInstance:function(t){const e=_.indexOf(this._accessibleInstances,t);this._accessibleInstances.splice(e,1)}})}};zn.register("ParallelDOM",Jr);var to=Jr;const eo={};function io(t){try{const e=document.createElement("canvas");e.width=1,e.height=1;const i=e.getContext("2d");i.fillStyle="black",i.fillRect(0,0,1,1);const n=e.toDataURL([t]),s="data:"+t;return n.slice(0,s.length)===s}catch(e){return!1}}function no(t,e){const i=document.createElement("canvas");i.width=1,i.height=1;const n=i.getContext("2d"),s=document.createElement("img");s.crossOrigin="Anonymous";const r=function(){try{n.drawImage(s,0,0),i.toDataURL(),eo[t]=!0}catch(e){eo[t]=!1}};s.onload=r;try{s.src=e,s.complete&&r()}catch(o){eo[t]=!1}}zn.register("Features",eo),eo.canvasPNGOutput=io("image/png"),eo.canvasJPEGOutput=io("image/jpeg"),eo.canvasGIFOutput=io("image/gif"),eo.canvasICONOutput=io("image/x-icon"),no("canvasPNGInput","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2NkYGD4DwABCQEBtxmN7wAAAABJRU5ErkJggg=="),no("canvasJPEGInput","data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8qqKKKAP/2Q=="),no("canvasSVGInput","data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+DQo8c3ZnIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3cG9ydD0iMCAwIDEgMSIgd2lkdGg9IjEiIGhlaWdodD0iMSIgPg0KICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIiByeD0iMCIgcnk9IjAiIHN0eWxlPSJmaWxsOiBibGFjazsgc3Ryb2tlOiBub25lOyI+PC9yZWN0Pg0KPC9zdmc+DQo="),no("canvasGIFInput","data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEAAAIALAAAAAABAAEAAAICRAEAOw==");const so=document.createElement("canvas"),ro=so.getContext("2d");eo.toDataURLHD=$s(so,"toDataURLHD"),eo.createImageDataHD=$s(ro,"createImageDataHD"),eo.getImageDataHD=$s(ro,"getImageDataHD"),eo.putImageDataHD=$s(ro,"putImageDataHD"),eo.currentTransform=$s(ro,"currentTransform");const oo=document.createElement("span"),ao=document.createElement("div");eo.textStroke=$s(oo.style,"textStroke"),eo.textStrokeColor=$s(oo.style,"textStrokeColor"),eo.textStrokeWidth=$s(oo.style,"textStrokeWidth"),eo.transform=$s(ao.style,"transform"),eo.transformOrigin=$s(ao.style,"transformOrigin"),eo.backfaceVisibility=$s(ao.style,"backfaceVisibility"),eo.borderRadius=$s(ao.style,"borderRadius"),eo.userSelect=$s(ao.style,"userSelect"),eo.touchAction=$s(ao.style,"touchAction"),eo.touchCallout=$s(ao.style,"touchCallout"),eo.userDrag=$s(ao.style,"userDrag"),eo.tapHighlightColor=$s(ao.style,"tapHighlightColor"),eo.fontSmoothing=$s(ao.style,"fontSmoothing"),eo.requestAnimationFrame=$s(window,"requestAnimationFrame"),eo.cancelAnimationFrame=$s(window,"cancelAnimationFrame"),eo.setStyle=function(t,e,i){void 0!==e&&(t.style[e]=i)},eo.passive=!1,window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){eo.passive=!0}}));var lo=eo;function ho(t,e){return new je(t,e)}const uo=lo.transform,co=lo.transformOrigin||"transformOrigin";let fo=!0;var po={prepareForTransform:function(t,e){t.style[co]="top left",e?po.setTransformAcceleration(t):po.unsetTransformAcceleration(t)},setTransformAcceleration:function(t){t.style.webkitBackfaceVisibility="hidden"},unsetTransformAcceleration:function(t){t.style.webkitBackfaceVisibility=""},applyPreparedTransform:function(t,e,i){e.style[uo]=t.getCSSTransform()},setTransform:function(t,e,i){e.style[uo]=t},unsetTransform:function(t){t.style[uo]=""},polyfillRequestAnimationFrame:function(){window.requestAnimationFrame&&window.cancelAnimationFrame||(lo.requestAnimationFrame&&lo.cancelAnimationFrame?(window.requestAnimationFrame=window[lo.requestAnimationFrame],window.cancelAnimationFrame=window[lo.cancelAnimationFrame]):(window.requestAnimationFrame=function(t){const e=Date.now();return window.setTimeout((function(){t(Date.now()-e)}),16)},window.cancelAnimationFrame=clearTimeout))},backingStorePixelRatio:function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},backingScale:function(t){if("devicePixelRatio"in window){const e=po.backingStorePixelRatio(t);return window.devicePixelRatio/e}return 1},scanBounds:function(t,e,i){const n=_.map(_.range(e),(function(){return!1})),s=_.map(_.range(e),(function(){return!1}));for(let u=0;u<e;u++)for(let i=0;i<e;i++){const r=4*(i*e+u);0===t.data[r]&&0===t.data[r+1]&&0===t.data[r+2]&&0===t.data[r+3]||(n[u]=!0,s[i]=!0)}const r=_.indexOf(n,!0),o=_.lastIndexOf(n,!0),a=_.indexOf(s,!0),l=_.lastIndexOf(s,!0),h=e/16;return{minBounds:new Ke(r<1||r>=e-1?Number.POSITIVE_INFINITY:i.inversePosition2(ho(r+1+h,0)).x,a<1||a>=e-1?Number.POSITIVE_INFINITY:i.inversePosition2(ho(0,a+1+h)).y,o<1||o>=e-1?Number.NEGATIVE_INFINITY:i.inversePosition2(ho(o-h,0)).x,l<1||l>=e-1?Number.NEGATIVE_INFINITY:i.inversePosition2(ho(0,l-h)).y),maxBounds:new Ke(r<1||r>=e-1?Number.NEGATIVE_INFINITY:i.inversePosition2(ho(r-1-h,0)).x,a<1||a>=e-1?Number.NEGATIVE_INFINITY:i.inversePosition2(ho(0,a-1-h)).y,o<1||o>=e-1?Number.POSITIVE_INFINITY:i.inversePosition2(ho(o+2+h,0)).x,l<1||l>=e-1?Number.POSITIVE_INFINITY:i.inversePosition2(ho(0,l+2+h)).y)}},canvasAccurateBounds:function(t,e){const i=e&&e.precision?e.precision:.001,n=e&&e.resolution?e.resolution:128,s=e&&e.initialScale?e.initialScale:1/16;let r=Ke.NOTHING,o=Ke.EVERYTHING;const a=document.createElement("canvas");a.width=n,a.height=n;const l=a.getContext("2d");function h(e){l.save(),e.matrix.canvasSetTransform(l),t(l),l.restore();const i=l.getImageData(0,0,n,n),s=po.scanBounds(i,n,e);return l.clearRect(0,0,n,n),s}function u(t){const e=(n-4)/(t.maxX-t.minX),i=(n-4)/(t.maxY-t.minY),s=-e*t.minX+2,r=-i*t.minY+2;return new hi(oi.translation(s,r).timesMatrix(oi.scaling(e,i)))}const c=new hi;c.append(oi.translation(n/2,n/2)),c.append(oi.scaling(s));const d=h(c);let f,p,m;for(r=r.union(d.minBounds),o=o.intersection(d.maxBounds),f=o.minY,p=o.maxY;isFinite(r.minX)&&isFinite(o.minX)&&Math.abs(r.minX-o.minX)>i;){if(m=h(u(new Ke(o.minX,f,r.minX,p))),r.minX<=m.minBounds.minX&&o.minX>=m.maxBounds.minX){0;break}r=r.withMinX(Math.min(r.minX,m.minBounds.minX)),o=o.withMinX(Math.max(o.minX,m.maxBounds.minX)),f=Math.max(f,m.maxBounds.minY),p=Math.min(p,m.maxBounds.maxY)}for(f=o.minY,p=o.maxY;isFinite(r.maxX)&&isFinite(o.maxX)&&Math.abs(r.maxX-o.maxX)>i;){if(m=h(u(new Ke(r.maxX,f,o.maxX,p))),r.maxX>=m.minBounds.maxX&&o.maxX<=m.maxBounds.maxX){0;break}r=r.withMaxX(Math.max(r.maxX,m.minBounds.maxX)),o=o.withMaxX(Math.min(o.maxX,m.maxBounds.maxX)),f=Math.max(f,m.maxBounds.minY),p=Math.min(p,m.maxBounds.maxY)}for(f=o.minX,p=o.maxX;isFinite(r.minY)&&isFinite(o.minY)&&Math.abs(r.minY-o.minY)>i;){if(m=h(u(new Ke(f,o.minY,p,r.minY))),r.minY<=m.minBounds.minY&&o.minY>=m.maxBounds.minY){0;break}r=r.withMinY(Math.min(r.minY,m.minBounds.minY)),o=o.withMinY(Math.max(o.minY,m.maxBounds.minY)),f=Math.max(f,m.maxBounds.minX),p=Math.min(p,m.maxBounds.maxX)}for(f=o.minX,p=o.maxX;isFinite(r.maxY)&&isFinite(o.maxY)&&Math.abs(r.maxY-o.maxY)>i;){if(m=h(u(new Ke(f,r.maxY,p,o.maxY))),r.maxY>=m.minBounds.maxY&&o.maxY<=m.maxBounds.maxY){0;break}r=r.withMaxY(Math.max(r.maxY,m.minBounds.maxY)),o=o.withMaxY(Math.min(o.maxY,m.maxBounds.maxY)),f=Math.max(f,m.maxBounds.minX),p=Math.min(p,m.maxBounds.maxX)}const g=new Ke(isFinite(r.minX)&&isFinite(o.minX)?(r.minX+o.minX)/2:Number.POSITIVE_INFINITY,isFinite(r.minY)&&isFinite(o.minY)?(r.minY+o.minY)/2:Number.POSITIVE_INFINITY,isFinite(r.maxX)&&isFinite(o.maxX)?(r.maxX+o.maxX)/2:Number.NEGATIVE_INFINITY,isFinite(r.maxY)&&isFinite(o.maxY)?(r.maxY+o.maxY)/2:Number.NEGATIVE_INFINITY);return g.minBounds=r,g.maxBounds=o,g.isConsistent=o.containsBounds(r),g.precision=Math.max(Math.abs(r.minX-o.minX),Math.abs(r.minY-o.minY),Math.abs(r.maxX-o.maxX),Math.abs(r.maxY-o.maxY)),g},toPowerOf2:function(t){let e=1;for(;e<t;)e*=2;return e},createShader:function(t,e,i){const n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||(console.log("GLSL compile error:"),console.log(t.getShaderInfoLog(n)),console.log(e)),n},applyWebGLContextDefaults:function(t){t.clearColor(0,0,0,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},setWebGLEnabled(t){fo=t},checkWebGLSupport:function(t){if(!1===fo)return!1;const e=document.createElement("canvas"),i={failIfMajorPerformanceCaveat:!0};try{const n=!!window.WebGLRenderingContext&&(e.getContext("webgl",i)||e.getContext("experimental-webgl",i));if(!n)return!1;if(t)for(let e=0;e<t.length;e++)if(null===n.getExtension(t[e]))return!1;return!0}catch(n){return!1}},checkIE11StencilSupport:function(){const t=document.createElement("canvas");try{const e=!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"));return!!e&&(e.clearStencil(0),0===e.getError())}catch(e){return!1}},get isWebGLSupported(){return void 0===this._extensionlessWebGLSupport&&(this._extensionlessWebGLSupport=po.checkWebGLSupport()),this._extensionlessWebGLSupport},loseContext:function(t){const e=t.getExtension("WEBGL_lose_context");e&&(e.loseContext(),setTimeout((function(){e.restoreContext()}),1e3))}};zn.register("Utils",po);var mo=po;function go(t,e){throw new Error("Should never be called")}zn.register("Block",go),R(Kn,go,{initializeBlock:function(t,e){return this.initializeDrawable(e),this.display=t,this.drawableCount=0,this.used=!0,this.firstDrawable=null,this.lastDrawable=null,this.pendingFirstDrawable=null,this.pendingLastDrawable=null,this.previousBlock=null,this.nextBlock=null,this.zIndex=0,this},dispose:function(){this.display=null,this.firstDrawable=null,this.lastDrawable=null,this.pendingFirstDrawable=null,this.pendingLastDrawable=null,this.previousBlock=null,this.nextBlock=null,Kn.prototype.dispose.call(this)},addDrawable:function(t){this.drawableCount++,this.markDirtyDrawable(t)},removeDrawable:function(t){this.drawableCount--,this.markDirty()},onIntervalChange:function(t,e){},updateInterval:function(){this.pendingFirstDrawable===this.firstDrawable&&this.pendingLastDrawable===this.lastDrawable||(this.onIntervalChange(this.pendingFirstDrawable,this.pendingLastDrawable),this.firstDrawable=this.pendingFirstDrawable,this.lastDrawable=this.pendingLastDrawable)},notifyInterval:function(t,e){this.pendingFirstDrawable=t,this.pendingLastDrawable=e,this.updateInterval()},audit:function(t,e,i){0}});var yo=go;function bo(t,e){this.initialize(t,e)}zn.register("ChangeInterval",bo),R(Object,bo,{initialize:function(t,e){return this.nextChangeInterval=null,this.drawableBefore=t,this.drawableAfter=e,this.collapsedEmpty=!1,this},dispose:function(){this.nextChangeInterval=null,this.drawableBefore=null,this.drawableAfter=null,this.freeToPool()},constrict:function(){let t=!1;if(this.isEmpty())return!0;for(;this.drawableBefore&&this.drawableBefore.nextDrawable===this.drawableBefore.oldNextDrawable;)if(this.drawableBefore=this.drawableBefore.nextDrawable,t=!0,this.drawableBefore||(this.collapsedEmpty=!0),this.isEmpty())return!0;for(;this.drawableAfter&&this.drawableAfter.previousDrawable===this.drawableAfter.oldPreviousDrawable;)if(this.drawableAfter=this.drawableAfter.previousDrawable,t=!0,this.drawableAfter||(this.collapsedEmpty=!0),this.isEmpty())return!0;return t},isEmpty:function(){return this.collapsedEmpty||null!==this.drawableBefore&&this.drawableBefore===this.drawableAfter},getOldInternalDrawableCount:function(t,e){const i=this.drawableBefore?this.drawableBefore.oldNextDrawable:t,n=this.drawableAfter;let s=0;for(let r=i;r!==n;r=r.oldNextDrawable)s++;return s},getNewInternalDrawableCount:function(t,e){const i=this.drawableBefore?this.drawableBefore.nextDrawable:t,n=this.drawableAfter;let s=0;for(let r=i;r!==n;r=r.nextDrawable)s++;return s}}),Pe.mixInto(bo,{initialize:bo.prototype.initialize}),bo.newForDisplay=function(t,e,i){const n=bo.createFromPool(t,e);return i.markChangeIntervalToDispose(n),n};var vo=bo;function _o(t,e){this.canvas=t,this.context=e,this.resetStyles()}zn.register("CanvasContextWrapper",_o),R(Object,_o,{resetStyles:function(){this.fillStyle=void 0,this.strokeStyle=void 0,this.lineWidth=void 0,this.lineCap=void 0,this.lineJoin=void 0,this.lineDash=void 0,this.lineDashOffset=void 0,this.miterLimit=void 0,this.font=void 0,this.direction=void 0},setDimensions:function(t,e){this.canvas.width=t,this.canvas.height=e,this.resetStyles()},setFillStyle:function(t){t&&t instanceof Yt&&(t=t.value),t&&t.getCanvasStyle&&(t=t.getCanvasStyle()),this.fillStyle!==t&&(this.fillStyle=t,this.context.fillStyle=t)},setStrokeStyle:function(t){t&&t instanceof Yt&&(t=t.value),t&&t.getCanvasStyle&&(t=t.getCanvasStyle()),this.strokeStyle!==t&&(this.strokeStyle=t,this.context.strokeStyle=t)},setLineWidth:function(t){this.lineWidth!==t&&(this.lineWidth=t,this.context.lineWidth=t)},setLineCap:function(t){this.lineCap!==t&&(this.lineCap=t,this.context.lineCap=t)},setLineJoin:function(t){this.lineJoin!==t&&(this.lineJoin=t,this.context.lineJoin=t)},setMiterLimit:function(t){this.miterLimit!==t&&(this.miterLimit=t,this.context.miterLimit=t)},setLineDash:function(t){this.lineDash!==t&&(this.lineDash=t,this.context.setLineDash?this.context.setLineDash(null===t?[]:t):void 0!==this.context.mozDash?this.context.mozDash=t:void 0!==this.context.webkitLineDash&&(this.context.webkitLineDash=t||[]))},setLineDashOffset:function(t){this.lineDashOffset!==t&&(this.lineDashOffset=t,void 0!==this.context.lineDashOffset?this.context.lineDashOffset=t:void 0!==this.context.webkitLineDashOffset&&(this.context.webkitLineDashOffset=t))},setFont:function(t){this.font!==t&&(this.font=t,this.context.font=t)},setDirection:function(t){this.direction!==t&&(this.direction=t,this.context.direction=t)}});var wo=_o;const Ao=Ke.NOTHING.copy();function xo(t,e,i){this.initialize(t,e,i)}zn.register("FittedBlock",xo),R(yo,xo,{initializeFittedBlock:function(t,e,i,n){return this.initializeBlock(t,e),this.transformRootInstance=i,this.canBeFullDisplay=i.isDisplayRoot,this.preferredFit=n,this.fit=n,this.dirtyFit=!0,this.dirtyFitListener=this.dirtyFitListener||this.markDirtyFit.bind(this),this.commonFitInstance=null,this.fitBounds=Ke.NOTHING.copy(),this.oldFitBounds=Ke.NOTHING.copy(),this.fitOffset=new je(0,0),this.unfittableDrawableCount=0,this.fittableListener=this.onFittabilityChange.bind(this),this.forceAcceleration=!1,this.display.sizeProperty.lazyLink(this.dirtyFitListener),this},setFit:function(t){this.canBeFullDisplay||t!==xo.FULL_DISPLAY||(t=xo.COMMON_ANCESTOR),this.fit!==t&&(this.fit=t,this.markDirtyFit(),this.oldFitBounds.set(Ke.NOTHING),t===xo.COMMON_ANCESTOR&&this.removeCommonFitInstance())},markDirtyFit:function(){this.dirtyFit=!0,this.markDirty()},updateFit:function(){if(this.dirtyFit||this.fit!==xo.FULL_DISPLAY)if(this.dirtyFit=!1,this.fit===xo.COMMON_ANCESTOR&&null===this.commonFitInstance&&this.addCommonFitInstance(this.computeCommonAncestorInstance()),this.fit===xo.COMMON_ANCESTOR&&this.commonFitInstance.fittability.subtreeUnfittableCount>0&&this.canBeFullDisplay&&(this.oldFitBounds.set(Ke.NOTHING),this.fit=xo.FULL_DISPLAY),this.fit===xo.FULL_DISPLAY)this.fitBounds.set(Ke.NOTHING),this.setSizeFullDisplay();else{if(this.fit!==xo.COMMON_ANCESTOR)throw new Error("unknown fit");{this.fitBounds.set(this.commonFitInstance.node.getLocalBounds());let t=this.commonFitInstance;for(;t!==this.transformRootInstance;)this.fitBounds.transform(t.node.getMatrix()),t=t.parent;this.fitBounds.roundOut(),this.fitBounds.dilate(4),this.transformRootInstance.isDisplayRoot&&(Ao.setMinMax(0,0,this.display.width,this.display.height),this.fitBounds.constrainBounds(Ao)),this.fitBounds.isValid()||this.fitBounds.setMinMax(0,0,0,0),this.fitBounds.equals(this.oldFitBounds)||(this.oldFitBounds.set(this.fitBounds),this.setSizeFitBounds())}}},setSizeFullDisplay:function(){},setSizeFitBounds:function(){},addCommonFitInstance:function(t){t&&(this.commonFitInstance=t,this.commonFitInstance.fittability.subtreeFittabilityChangeEmitter.addListener(this.dirtyFitListener))},removeCommonFitInstance:function(){this.commonFitInstance&&(this.commonFitInstance.fittability.subtreeFittabilityChangeEmitter.removeListener(this.dirtyFitListener),this.commonFitInstance=null)},dispose:function(){this.display.sizeProperty.unlink(this.dirtyFitListener),this.removeCommonFitInstance(),this.transformRootInstance=null,yo.prototype.dispose.call(this)},addDrawable:function(t){yo.prototype.addDrawable.call(this,t),t.fittableProperty.lazyLink(this.fittableListener),t.fittable||this.incrementUnfittable()},removeDrawable:function(t){yo.prototype.removeDrawable.call(this,t),t.fittableProperty.unlink(this.fittableListener),t.fittable||this.decrementUnfittable()},onFittabilityChange:function(t){t?this.decrementUnfittable():this.incrementUnfittable()},incrementUnfittable:function(){this.unfittableDrawableCount++,1===this.unfittableDrawableCount&&this.checkFitConstraints()},decrementUnfittable:function(){this.unfittableDrawableCount--,0===this.unfittableDrawableCount&&this.checkFitConstraints()},checkFitConstraints:function(){this.unfittableDrawableCount>0&&this.canBeFullDisplay?this.setFit(xo.FULL_DISPLAY):this.setFit(this.preferredFit)},computeCommonAncestorInstance:function(){let t=this.firstDrawable.instance,e=this.lastDrawable.instance;const i=Math.min(t.trail.length,e.trail.length);for(;t.trail.length>i;)t=t.parent;for(;e.trail.length>i;)e=e.parent;for(;t!==e;)t=t.parent,e=e.parent;return t},onIntervalChange:function(t,e){yo.prototype.onIntervalChange.call(this,t,e),this.fit===xo.COMMON_ANCESTOR&&(this.removeCommonFitInstance(),this.markDirtyFit())}}),xo.FULL_DISPLAY=1,xo.COMMON_ANCESTOR=2,xo.fitString={1:"fullDisplay",2:"commonAncestor"};var To=xo;const So=new oi,Do=new oi;function Eo(t,e,i,n){this.initialize(t,e,i,n)}zn.register("CanvasBlock",Eo),R(To,Eo,{initialize:function(t,e,i,n){return this.initializeFittedBlock(t,e,i,To.COMMON_ANCESTOR),this.filterRootInstance=n,this.dirtyDrawables=ci(this.dirtyDrawables),this.domElement||(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.pointerEvents="none",this.canvasId=this.canvas.id="scenery-canvas"+this.id,this.context=this.canvas.getContext("2d"),this.context.save(),this.context.miterLimit=20,this.context.miterLimit=10,this.wrapper=new wo(this.canvas,this.context),this.domElement=this.canvas,this.wrapperStack=[this.wrapper]),this.wrapperStackIndex=0,this.filterListenerCountMap=this.filterListenerCountMap||{},mo.prepareForTransform(this.canvas,this.forceAcceleration),mo.unsetTransform(this.canvas),this.canvasDrawOffset=new je(0,0),this.currentDrawable=null,this.clipDirty=!0,this.clipCount=0,this.backingScale=e&jn.bitmaskCanvasLowResolution?1:mo.backingScale(this.context),this.clipDirtyListener=this.markDirty.bind(this),this.opacityDirtyListener=this.markDirty.bind(this),this.filterRootNode=this.filterRootInstance.node,this},setSizeFullDisplay:function(){const t=this.display.getSize();this.canvas.width=t.width*this.backingScale,this.canvas.height=t.height*this.backingScale,this.canvas.style.width=t.width+"px",this.canvas.style.height=t.height+"px",this.wrapper.resetStyles(),this.canvasDrawOffset.setXY(0,0),mo.unsetTransform(this.canvas)},setSizeFitBounds:function(){const t=this.fitBounds.minX,e=this.fitBounds.minY;this.canvasDrawOffset.setXY(-t,-e),mo.setTransform("matrix(1,0,0,1,"+t+","+e+")",this.canvas,this.forceAcceleration),this.canvas.width=this.fitBounds.width*this.backingScale,this.canvas.height=this.fitBounds.height*this.backingScale,this.canvas.style.width=this.fitBounds.width+"px",this.canvas.style.height=this.fitBounds.height+"px",this.wrapper.resetStyles()},update:function(){if(!To.prototype.update.call(this))return!1;for(;this.dirtyDrawables.length;)this.dirtyDrawables.pop().update();this.updateFit(),this.context.restore(),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save(),this.wrapper.resetStyles(),this.currentDrawable=null;for(let t=this.firstDrawable;null!==t&&(this.renderDrawable(t),t!==this.lastDrawable);t=t.nextDrawable);return this.currentDrawable&&this.walkDown(this.currentDrawable.instance.trail,0),!0},applyClip:function(t){this.clipDirty=!1;const e=this.wrapperStack[this.wrapperStackIndex],i=e.context;if(i.restore(),i.save(),e.resetStyles(),this.clipCount){const e=t.instance.trail;So.rowMajor(this.backingScale,0,this.canvasDrawOffset.x*this.backingScale,0,this.backingScale,this.canvasDrawOffset.y*this.backingScale,0,0,1),Do.set(this.transformRootInstance.trail.getMatrix()).invert(),Do.multiplyMatrix(So).canvasSetTransform(i);for(let t=0;t<e.length;t++){const n=e.nodes[t];n.getMatrix().canvasAppendTransform(i),n.hasClipArea()&&(i.beginPath(),n.clipArea.writeToContext(i),i.clip())}}},walkDown:function(t,e){const i=this.filterRootInstance.trail.length-1;for(let n=t.length-1;n>=e;n--){const e=t.nodes[n];if(e.hasClipArea()&&(this.clipCount--,this.clipDirty=!0),n>i&&1!==e.getOpacity()){const t=this.wrapperStack[this.wrapperStackIndex],i=this.wrapperStack[this.wrapperStackIndex-1];this.wrapperStackIndex--,this.clipDirty=!0,i.context.setTransform(1,0,0,1,0,0),i.context.globalAlpha=e.getOpacity(),i.context.drawImage(t.canvas,0,0),i.context.globalAlpha=1}}},walkUp:function(t,e){const i=this.filterRootInstance.trail.length-1;for(let n=e;n<t.length;n++){const e=t.nodes[n];if(n>i&&1!==e.getOpacity()){if(this.wrapperStackIndex++,this.clipDirty=!0,this.wrapperStackIndex===this.wrapperStack.length){const t=document.createElement("canvas"),e=t.getContext("2d");e.save(),this.wrapperStack.push(new wo(t,e))}const t=this.wrapperStack[this.wrapperStackIndex],e=t.context;t.setDimensions(this.canvas.width,this.canvas.height),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this.canvas.width,this.canvas.height)}e.hasClipArea()&&(this.clipCount++,this.clipDirty=!0)}},renderDrawable:function(t){if(!t.visible)return;const e=this.currentDrawable?t.instance.getBranchIndexTo(this.currentDrawable.instance):0;this.currentDrawable&&this.walkDown(this.currentDrawable.instance.trail,e),this.walkUp(t.instance.trail,e);const i=this.wrapperStack[this.wrapperStackIndex],n=i.context;this.clipDirty&&this.applyClip(t);const s=t.instance.relativeTransform.matrix;n.setTransform(this.backingScale,0,0,this.backingScale,this.canvasDrawOffset.x*this.backingScale,this.canvasDrawOffset.y*this.backingScale),t.instance!==this.transformRootInstance&&s.canvasAppendTransform(n),t.paintCanvas(i,t.instance.node,t.instance.relativeTransform.matrix),this.currentDrawable=t},dispose:function(){this.filterRootNode=null,this.transformRootInstance=null,ci(this.dirtyDrawables),this.canvas.width=0,this.canvas.height=0,To.prototype.dispose.call(this)},markDirtyDrawable:function(t){this.dirtyDrawables.push(t),this.markDirty()},addDrawable:function(t){To.prototype.addDrawable.call(this,t);for(let e=t.instance;e&&e!==this.filterRootInstance;e=e.parent){const t=e.node;this.filterListenerCountMap[t.id]?this.filterListenerCountMap[t.id]++:(this.filterListenerCountMap[t.id]=1,t.opacityProperty.lazyLink(this.opacityDirtyListener),t.clipAreaProperty.lazyLink(this.clipDirtyListener))}},removeDrawable:function(t){for(let e=t.instance;e&&e!==this.filterRootInstance;e=e.parent){const t=e.node;this.filterListenerCountMap[t.id]--,0===this.filterListenerCountMap[t.id]&&(delete this.filterListenerCountMap[t.id],t.clipAreaProperty.unlink(this.clipDirtyListener),t.opacityProperty.unlink(this.opacityDirtyListener))}To.prototype.removeDrawable.call(this,t)},onIntervalChange:function(t,e){To.prototype.onIntervalChange.call(this,t,e),this.markDirty()},onPotentiallyMovedDrawable:function(t){t.markDirty()},toString:function(){return`CanvasBlock#${this.id}-${To.fitString[this.fit]}`}}),Pe.mixInto(Eo,{initialize:Eo.prototype.initialize});var Co=Eo;function Io(t,e){this.initialize(t,e)}zn.register("DOMBlock",Io),R(yo,Io,{initialize:function(t,e){return this.initializeBlock(t,e.renderer),this.domDrawable=e,this.domElement=e.domElement,this},update:function(){return!!yo.prototype.update.call(this)&&(this.domDrawable.update(),!0)},dispose:function(){this.domDrawable=null,this.domElement=null,yo.prototype.dispose.call(this)},markDirtyDrawable:function(t){this.markDirty()},addDrawable:function(t){yo.prototype.addDrawable.call(this,t)},removeDrawable:function(t){yo.prototype.removeDrawable.call(this,t)}}),Pe.mixInto(Io,{initialize:Io.prototype.initialize});var Po=Io;function ko(t,e,i){this.initialize(t,e,i)}zn.register("SVGGroup",ko),R(Object,ko,{initialize:function(t,e,i){return this.block=t,this.instance=e,this.node=e.trail.lastNode(),this.parent=i,this.children=ci(this.children),this.hasSelfDrawable=!1,this.selfDrawable=null,this.dirty=!0,this.willApplyTransforms=this.block.transformRootInstance.trail.nodes.length<this.instance.trail.nodes.length,this.willApplyFilters=this.block.filterRootInstance.trail.nodes.length<this.instance.trail.nodes.length,this.transformDirty=!0,this.hasTransform=void 0!==this.hasTransform&&this.hasTransform,this.transformDirtyListener=this.transformDirtyListener||this.markTransformDirty.bind(this),this.willApplyTransforms&&this.node.transformEmitter.addListener(this.transformDirtyListener),this.opacityDirty=!0,this.visibilityDirty=!0,this.clipDirty=!0,this.hasOpacity=void 0!==this.hasOpacity&&this.hasOpacity,this.clipDefinition=void 0!==this.clipDefinition?this.clipDefinition:null,this.clipPath=void 0!==this.clipPath?this.clipPath:null,this.opacityDirtyListener=this.opacityDirtyListener||this.markOpacityDirty.bind(this),this.visibilityDirtyListener=this.visibilityDirtyListener||this.markVisibilityDirty.bind(this),this.clipDirtyListener=this.clipDirtyListener||this.markClipDirty.bind(this),this.node.visibleProperty.lazyLink(this.visibilityDirtyListener),this.willApplyFilters&&this.node.opacityProperty.lazyLink(this.opacityDirtyListener),this.node.clipAreaProperty.lazyLink(this.clipDirtyListener),this.orderDirty=!0,this.orderDirtyListener=this.orderDirtyListener||this.markOrderDirty.bind(this),this.node.childrenChangedEmitter.addListener(this.orderDirtyListener),this.svgGroup||(this.svgGroup=document.createElementNS(bs,"g")),this.instance.addSVGGroup(this),this.block.markDirtyGroup(this),this},addSelfDrawable:function(t){this.selfDrawable=t,this.svgGroup.insertBefore(t.svgElement,this.children.length?this.children[0].svgGroup:null),this.hasSelfDrawable=!0},removeSelfDrawable:function(t){this.hasSelfDrawable=!1,this.svgGroup.removeChild(t.svgElement),this.selfDrawable=null},addChildGroup:function(t){this.markOrderDirty(),t.parent=this,this.children.push(t),this.svgGroup.appendChild(t.svgGroup)},removeChildGroup:function(t){this.markOrderDirty(),t.parent=null,this.children.splice(_.indexOf(this.children,t),1),this.svgGroup.removeChild(t.svgGroup)},markDirty:function(){this.dirty||(this.dirty=!0,this.block.markDirtyGroup(this))},markOrderDirty:function(){this.orderDirty||(this.orderDirty=!0,this.markDirty())},markTransformDirty:function(){this.transformDirty||(this.transformDirty=!0,this.markDirty())},markOpacityDirty:function(){this.opacityDirty||(this.opacityDirty=!0,this.markDirty())},markVisibilityDirty:function(){this.visibilityDirty||(this.visibilityDirty=!0,this.markDirty())},markClipDirty:function(){this.clipDirty||(this.clipDirty=!0,this.markDirty())},update:function(){if(!this.block)return;const t=this.svgGroup;if(this.dirty=!1,this.transformDirty)if(this.transformDirty=!1,this.willApplyTransforms){this.node.transform.isIdentity()?this.hasTransform&&(this.hasTransform=!1,Xs.ie9||Xs.ie10?t.setAttribute("transform",""):t.removeAttribute("transform")):(this.hasTransform=!0,t.setAttribute("transform",this.node.transform.getMatrix().getSVGTransform()))}else this.hasTransform&&(this.hasTransform=!1,Xs.ie9||Xs.ie10?t.setAttribute("transform",""):t.removeAttribute("transform"));if(this.visibilityDirty&&(this.visibilityDirty=!1,t.style.display=this.node.isVisible()?"":"none"),this.opacityDirty&&(this.opacityDirty=!1,this.willApplyFilters&&1!==this.node.opacity?(this.hasOpacity=!0,t.setAttribute("opacity",this.node.opacity)):this.hasOpacity&&(this.hasOpacity=!1,t.removeAttribute("opacity"))),this.clipDirty)if(this.clipDirty=!1,this.node.clipArea){if(!this.clipDefinition){const e="clip"+this.node.getId();this.clipDefinition=document.createElementNS(bs,"clipPath"),this.clipDefinition.setAttribute("id",e),this.clipDefinition.setAttribute("clipPathUnits","userSpaceOnUse"),this.block.defs.appendChild(this.clipDefinition),this.clipPath=document.createElementNS(bs,"path"),this.clipDefinition.appendChild(this.clipPath),t.setAttribute("clip-path","url(#"+e+")")}this.clipPath.setAttribute("d",this.node.clipArea.getSVGPath())}else this.clipDefinition&&(t.removeAttribute("clip-path"),this.block.defs.removeChild(this.clipDefinition),this.clipDefinition=null,this.clipPath=null);if(this.orderDirty){this.orderDirty=!1;let e=this.children.length-1;const i=this.instance.children;for(let n=i.length-1;n>=0;n--){const s=i[n].lookupSVGGroup(this.block);if(s){if(this.children[e]!==s){t.insertBefore(s.svgGroup,e+1>=this.children.length?null:this.children[e+1].svgGroup);const i=_.indexOf(this.children,s);this.children.splice(i,1),this.children.splice(e,0,s)}e--}}}},isReleasable:function(){return!this.hasSelfDrawable&&!this.children.length&&this.parent},dispose:function(){this.willApplyTransforms&&this.node.transformEmitter.removeListener(this.transformDirtyListener),this.node.visibleProperty.unlink(this.visibilityDirtyListener),this.willApplyFilters&&this.node.opacityProperty.unlink(this.opacityDirtyListener),this.node.clipAreaProperty.unlink(this.clipDirtyListener),this.node.childrenChangedEmitter.removeListener(this.orderDirtyListener),this.instance.active&&this.instance.removeSVGGroup(this),this.clipDefinition&&(this.svgGroup.removeAttribute("clip-path"),this.block.defs.removeChild(this.clipDefinition),this.clipDefinition=null,this.clipPath=null),this.parent=null,this.block=null,this.instance=null,this.node=null,ci(this.children),this.selfDrawable=null,this.freeToPool()},toString:function(){return"SVGGroup:"+this.block.toString()+"_"+this.instance.toString()}}),ko.addDrawable=function(t,e){ko.ensureGroupsToInstance(t,e.instance).addSelfDrawable(e)},ko.removeDrawable=function(t,e){e.instance.lookupSVGGroup(t).removeSelfDrawable(e),ko.releaseGroupsToInstance(t,e.instance)},ko.ensureGroupsToInstance=function(t,e){let i=e.lookupSVGGroup(t);if(!i){const n=ko.ensureGroupsToInstance(t,e.parent);i=ko.createFromPool(t,e,n),n.addChildGroup(i)}return i},ko.releaseGroupsToInstance=function(t,e){const i=e.lookupSVGGroup(t);if(i.isReleasable()){const e=i.parent;e.removeChildGroup(i),ko.releaseGroupsToInstance(t,e.instance),i.dispose()}},Pe.mixInto(ko,{initialize:ko.prototype.initialize});var Lo=ko;function Oo(t,e,i,n){this.initialize(t,e,i,n)}zn.register("SVGBlock",Oo),R(To,Oo,{initialize:function(t,e,i,n){this.initializeFittedBlock(t,e,i,To.COMMON_ANCESTOR),this.filterRootInstance=n,this.dirtyGradients=ci(this.dirtyGradients),this.dirtyGroups=ci(this.dirtyGroups),this.dirtyDrawables=ci(this.dirtyDrawables),this.paintMap={},this.domElement||(this.svg=document.createElementNS(bs,"svg"),this.svg.style.position="absolute",this.svg.style.left="0",this.svg.style.top="0",this.svg.setAttribute("focusable",!1),this.svg.style["pointer-events"]="none",this.defs=document.createElementNS(bs,"defs"),this.svg.appendChild(this.defs),this.baseTransformGroup=document.createElementNS(bs,"g"),this.svg.appendChild(this.baseTransformGroup),this.domElement=this.svg),mo.prepareForTransform(this.svg,this.forceAcceleration),mo.unsetTransform(this.svg),this.baseTransformGroup.setAttribute("transform","");const s=i.trail.nodes.length>n.trail.nodes.length?n:i;return this.rootGroup=Lo.createFromPool(this,s,null),this.baseTransformGroup.appendChild(this.rootGroup.svgGroup),this},incrementPaint:function(t){if(this.paintMap.hasOwnProperty(t.id))this.paintMap[t.id].count++;else{const e=t.createSVGPaint(this);e.definition.setAttribute("id",t.id+"-"+this.id),this.paintMap[t.id]={count:1,paint:t,svgPaint:e},this.defs.appendChild(e.definition)}},decrementPaint:function(t){if(this.paintMap.hasOwnProperty(t.id)){const e=this.paintMap[t.id];1===e.count?(this.defs.removeChild(e.svgPaint.definition),e.svgPaint.dispose(),delete this.paintMap[t.id]):e.count--}},markDirtyGradient:function(t){this.dirtyGradients.push(t),this.markDirty()},markDirtyGroup:function(t){this.dirtyGroups.push(t),this.markDirty()},markDirtyDrawable:function(t){this.dirtyDrawables.push(t),this.markDirty()},setSizeFullDisplay:function(){this.baseTransformGroup.removeAttribute("transform"),mo.unsetTransform(this.svg);const t=this.display.getSize();this.svg.setAttribute("width",t.width),this.svg.setAttribute("height",t.height)},setSizeFitBounds:function(){const t=this.fitBounds.minX,e=this.fitBounds.minY;this.baseTransformGroup.setAttribute("transform","translate("+-t+","+-e+")"),mo.setTransform("matrix(1,0,0,1,"+t+","+e+")",this.svg,this.forceAcceleration),this.svg.setAttribute("width",this.fitBounds.width),this.svg.setAttribute("height",this.fitBounds.height)},update:function(){if(!To.prototype.update.call(this))return!1;for(;this.dirtyGroups.length;){const t=this.dirtyGroups.pop();t.block===this&&t.update()}for(;this.dirtyGradients.length;)this.dirtyGradients.pop().update();for(;this.dirtyDrawables.length;){const t=this.dirtyDrawables.pop();t.parentDrawable===this&&t.update()}return this.updateFit(),!0},dispose:function(){for(this.svg.setAttribute("width","0"),this.svg.setAttribute("height","0"),this.filterRootInstance=null,ci(this.dirtyGradients),ci(this.dirtyGroups),ci(this.dirtyDrawables),this.paintMap={},this.baseTransformGroup.removeChild(this.rootGroup.svgGroup),this.rootGroup.dispose(),this.rootGroup=null;this.defs.childNodes.length;)this.defs.removeChild(this.defs.childNodes[0]);To.prototype.dispose.call(this)},addDrawable:function(t){To.prototype.addDrawable.call(this,t),Lo.addDrawable(this,t),t.updateSVGBlock(this)},removeDrawable:function(t){Lo.removeDrawable(this,t),To.prototype.removeDrawable.call(this,t)},onIntervalChange:function(t,e){To.prototype.onIntervalChange.call(this,t,e)},toString:function(){return"SVGBlock#"+this.id+"-"+To.fitString[this.fit]}}),Pe.mixInto(Oo,{initialize:Oo.prototype.initialize});var No=Oo;const Ro={isValidValue:t=>t instanceof(window.phet?phet.axon.Action:c.Action)},Mo=t=>t.typeName,Bo={};function Fo(t){const e=t.map(Mo).join(",");return Bo.hasOwnProperty(e)||(Bo[e]=Vo(t)),Bo[e]}const Vo=t=>{class e extends T{}return e.methods={execute:{returnType:Qt,parameterTypes:t,implementation:function(){this.phetioObject.execute.apply(this.phetioObject,arguments)},documentation:"Executes the function the Action is wrapping.",invocableForReadOnlyElements:!1}},e.documentation="Executes when an event occurs.",e.events=["emitted"],e.validator=Ro,e.typeName=`ActionIO<${t.map(Mo).join(", ")}>`,e.parameterTypes=t,T.validateSubtype(e),e};c.register("ActionIO",Fo);var Ho=Fo;const zo=[],Go=(["name","phetioType","phetioDocumentation","phetioPrivate"].concat(v.VALIDATOR_KEYS),t=>t.phetioType),qo=t=>t.name;class Yo extends Et{constructor(t,e){const i=(e=h({parameters:zo,tandem:ot.OPTIONAL,phetioOuterType:Ho,phetioState:!1,phetioPlayback:Et.DEFAULT_OPTIONS.phetioPlayback,phetioEventMetadata:Et.DEFAULT_OPTIONS.phetioEventMetadata,phetioDocumentation:"A function that executes."},e)).parameters.filter(Go);e.phetioType=e.phetioOuterType(i.map(Go)),e.phetioPlayback&&(e.phetioEventMetadata=e.phetioEventMetadata||{},e.phetioEventMetadata.dataKeys=e.parameters.map(qo)),e.phetioDocumentation=Yo.getPhetioDocumentation(e.phetioDocumentation,i),super(e),this._parameters=e.parameters,this._action=t,this._phetioOuterType=e.phetioOuterType}static validateParameters(t,e){A(t,{valueType:Array});let i=!1;for(let n=0;n<t.length;n++){const e=t[n];i=i||e.phetioPrivate;for(const t in e);v.validateValidator(e)}}getPhetioData(){let t=null;if(this._parameters.length>0){t={};for(let e=0;e<this._parameters.length;e++){const i=this._parameters[e];i.phetioPrivate||(t[i.name]=i.phetioType.toStateObject(arguments[e]))}}return t}static getPhetioDocumentation(t,e){return t+(0===e.length?" No arguments.":" The arguments are:<br/><ol>"+e.map(t=>{const e=t.phetioDocumentation?" - "+t.phetioDocumentation:"";return`<li>${t.name}: ${t.phetioType.typeName}${e}</li>`}).join("<br/>")+"</ol>")}execute(){this.phetioStartEvent("emitted",{getData:()=>this.getPhetioData.apply(this,arguments)}),this._action.apply(null,arguments),this.phetioEndEvent()}}c.register("Action",Yo);var Uo=Yo;const jo={isValidValue:t=>t instanceof(window.phet?phet.axon.Emitter:c.Emitter)},Wo={};function Xo(t){const e=t.map(t=>t.typeName).join(",");return Wo.hasOwnProperty(e)||(Wo[e]=Ko(t)),Wo[e]}const Ko=t=>{class e extends(Ho(t)){}return e.methods={addListener:{returnType:Qt,parameterTypes:[Xt(Qt,t)],implementation:function(t){this.phetioObject.addListener(t)},documentation:"Adds a listener which will be called when the emitter emits."},emit:{returnType:Qt,parameterTypes:t,implementation:function(){this.phetioObject.emit.apply(this.phetioObject,arguments)},documentation:"Emits a single event to all listeners.",invocableForReadOnlyElements:!1}},e.documentation="Emits when an event occurs and calls added listeners.",e.parameterTypes=t,e.validator=jo,e.typeName=`EmitterIO<${t.map(t=>t.typeName).join(", ")}>`,T.validateSubtype(e),e};c.register("EmitterIO",Xo);var Qo=Xo;class Zo extends Uo{constructor(t){super((function(){e.tinyEmitter.emit.apply(e.tinyEmitter,arguments)}),t=h({phetioOuterType:Qo},t));const e=this;this.tinyEmitter=new C}execute(){}emit(){super.execute.apply(this,arguments)}dispose(){this.tinyEmitter.dispose(),super.dispose()}addListener(t){this.tinyEmitter.addListener(t)}removeListener(t){this.tinyEmitter.removeListener(t)}removeAllListeners(){this.tinyEmitter.removeAllListeners()}hasListener(t){return this.tinyEmitter.hasListener(t)}hasListeners(){return this.tinyEmitter.hasListeners()}getListenerCount(){return this.tinyEmitter.getListenerCount()}}c.register("Emitter",Zo);var $o=Zo;function Jo(t,e,i,n){n=h({attributes:[],uniforms:[]},n),this.vertexSource=e,this.fragmentSource=i,this.attributeNames=n.attributes,this.uniformNames=n.uniforms,this.initialize(t)}zn.register("ShaderProgram",Jo),R(Object,Jo,{initialize:function(t){const e=this;this.gl=t,this.used=!1,this.program=this.gl.createProgram(),this.vertexShader=mo.createShader(this.gl,this.vertexSource,this.gl.VERTEX_SHADER),this.fragmentShader=mo.createShader(this.gl,this.fragmentSource,this.gl.FRAGMENT_SHADER),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)||(console.log("GLSL link error:"),console.log(this.gl.getProgramInfoLog(this.program)),console.log("for vertex shader"),console.log(this.vertexSource),console.log("for fragment shader"),console.log(this.fragmentSource)),this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader),this.uniformLocations={},this.attributeLocations={},this.activeAttributes={},_.each(this.attributeNames,(function(t){e.attributeLocations[t]=e.gl.getAttribLocation(e.program,t),e.activeAttributes[t]=!0})),_.each(this.uniformNames,(function(t){e.uniformLocations[t]=e.gl.getUniformLocation(e.program,t)})),this.isInitialized=!0},use:function(){if(this.used)return;const t=this;this.used=!0,this.gl.useProgram(this.program),_.each(this.attributeNames,(function(e){t.activeAttributes[e]&&t.enableVertexAttribArray(e)}))},activateAttribute:function(t){this.activeAttributes[t]||(this.activeAttributes[t]=!0,this.used&&this.enableVertexAttribArray(t))},enableVertexAttribArray:function(t){this.gl.enableVertexAttribArray(this.attributeLocations[t])},unuse:function(){if(!this.used)return;const t=this;this.used=!1,_.each(this.attributeNames,(function(e){t.activeAttributes[e]&&t.disableVertexAttribArray(e)}))},disableVertexAttribArray:function(t){this.gl.disableVertexAttribArray(this.attributeLocations[t])},deactivateAttribute:function(t){this.activeAttributes[t]&&(this.activeAttributes[t]=!1,this.used&&this.disableVertexAttribArray(t))},dispose:function(){this.gl.deleteProgram(this.program)}});var ta=Jo;function ea(t){this.rootBin=new pe.BinPacker.Bin(t,null)}pe.register("BinPacker",ea),R(Object,ea,{allocate:function(t,e){const i=this.rootBin.findAvailableBin(t,e);if(i){const n=i.split(t,e);return n.use(),n}return null},deallocate:function(t){t.unuse()},toString:function(){let t="",e="";return function i(n){t+=e+n.toString()+"\n",e+="  ",_.each(n.children,i),e=e.substring(2)}(this.rootBin),t}}),ea.Bin=function(t,e){this.bounds=t,this.parent=e,this.isSplit=!1,this.isUsed=!1,this.children=[]},R(Object,ea.Bin,{findAvailableBin:function(t,e){if(this.isUsed)return null;if(this.bounds.width<t||this.bounds.height<e)return null;if(this.isSplit){for(let i=0;i<this.children.length;i++){const n=this.children[i].findAvailableBin(t,e);if(n)return n}return null}return this},split:function(t,e){if(t===this.bounds.width&&e===this.bounds.height)return this;this.isSplit=!0;const i=this.bounds.minX+t,n=this.bounds.minY+e,s=new Ke(this.bounds.minX,this.bounds.minY,i,n),r=new Ke(i,this.bounds.minY,this.bounds.maxX,n),o=new Ke(this.bounds.minX,n,this.bounds.maxX,this.bounds.maxY),a=new pe.BinPacker.Bin(s,this);return this.children.push(a),r.hasNonzeroArea()&&this.children.push(new pe.BinPacker.Bin(r,this)),o.hasNonzeroArea()&&this.children.push(new pe.BinPacker.Bin(o,this)),a},use:function(){this.isUsed=!0},unuse:function(){this.isUsed=!1,this.parent&&this.parent.attemptToCollapse()},attemptToCollapse:function(){for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isSplit||e.isUsed)return}this.children=[],this.isSplit=!1,this.parent&&this.parent.attemptToCollapse()},toString:function(){return this.bounds.toString()+(this.isUsed?" used":"")}});var ia=ea;function na(t,e){this.width=t,this.height=e}pe.register("Dimension2",na),R(Object,na,{toString:function(){return"["+this.width+"w, "+this.height+"h]"},set:function(t){return this.width=t.width,this.height=t.height,this},setWidth:function(t){return this.width=t,this},setHeight:function(t){return this.height=t,this},copy:function(t){return t?t.set(this):new na(this.width,this.height)},flipped:function(){return new na(this.height,this.width)},toBounds:function(t,e){return new Ke(t=void 0!==t?t:0,e=void 0!==e?e:0,this.width+t,this.height+e)},equals:function(t){return this.width===t.width&&this.height===t.height}});var sa=na;const ra=new sa(1024,1024);function oa(t){this.useMipmaps=t,this.gl=null,this.texture=null,this.bounds=new Ke(0,0,ra.width,ra.height),this.width=this.bounds.width,this.height=this.bounds.height,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.binPacker=new ia(this.bounds),this.dirty=!0,this.usedSprites=[],this.unusedSprites=[]}zn.register("SpriteSheet",oa),R(Object,oa,{initializeContext:function(t){this.gl=t,this.createTexture()},createTexture:function(){const t=this.gl;this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.useMipmaps?t.LINEAR_MIPMAP_LINEAR:t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas),this.useMipmaps&&(t.hint(t.GENERATE_MIPMAP_HINT,t.NICEST),t.generateMipmap(t.TEXTURE_2D)),t.bindTexture(t.TEXTURE_2D,null),this.dirty=!1},updateTexture:function(){if(this.dirty){this.dirty=!1;const t=this.gl;t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas),this.useMipmaps&&(t.hint(t.GENERATE_MIPMAP_HINT,t.NICEST),t.generateMipmap(t.TEXTURE_2D)),t.bindTexture(t.TEXTURE_2D,null)}},addImage:function(t,e,i){let n,s;for(n=0;n<this.usedSprites.length;n++){const e=this.usedSprites[n];if(e.image===t)return e.count++,e}for(n=0;n<this.unusedSprites.length;n++){const e=this.unusedSprites[n];if(e.image===t)return e.count++,this.unusedSprites.splice(n,1),this.usedSprites.push(e),e}for(;!(s=this.binPacker.allocate(e+2+1,i+2+1))&&this.unusedSprites.length;){const t=this.unusedSprites.shift();this.dirty=!0;const e=t.bin.bounds;this.context.clearRect(e.x,e.y,e.width,e.height),this.binPacker.deallocate(t.bin)}if(s){const n=new Ke((s.bounds.minX+1)/this.width,(s.bounds.minY+1)/this.height,(s.bounds.maxX-1-1)/this.width,(s.bounds.maxY-1-1)/this.height),r=new oa.Sprite(this,s,n,t,1);return this.copyImageWithGutter(t,e,i,s.bounds.x,s.bounds.y),this.dirty=!0,this.usedSprites.push(r),r}return null},removeImage:function(t){let e,i;for(i=0;i<this.usedSprites.length;i++)if(this.usedSprites[i].image===t){e=this.usedSprites[i];break}--e.count<=0&&(this.usedSprites.splice(i,1),this.unusedSprites.push(e))},containsImage:function(t){let e;for(e=0;e<this.usedSprites.length;e++)if(this.usedSprites[e].image===t)return!0;for(e=0;e<this.unusedSprites.length;e++)if(this.unusedSprites[e].image===t)return!0;return!1},copyImageWithGutter:function(t,e,i,n,s){this.copyImageRegion(t,1,1,0,0,n,s),this.copyImageRegion(t,1,1,e-1,0,n+1+e,s),this.copyImageRegion(t,1,1,e-1,i-1,n+1+e,s+1+i),this.copyImageRegion(t,1,1,0,i-1,n,s+1+i),this.copyImageRegion(t,e,1,0,0,n+1,s),this.copyImageRegion(t,e,1,0,i-1,n+1,s+1+i),this.copyImageRegion(t,1,i,0,0,n,s+1),this.copyImageRegion(t,1,i,e-1,0,n+1+e,s+1),this.context.drawImage(t,n+1,s+1)},copyImageRegion:function(t,e,i,n,s,r,o){this.context.drawImage(t,n,s,e,i,r,o,e,i)}}),oa.Sprite=function(t,e,i,n,s){this.spriteSheet=t,this.bin=e,this.uvBounds=i,this.image=n,this.count=s},oa.MAX_DIMENSION=ra;var aa=oa;function la(t,e,i,n){this.initialize(t,e,i,n)}zn.register("WebGLBlock",la),R(To,la,{initialize:function(t,e,i,n){return this.initializeFittedBlock(t,e,i,To.FULL_DISPLAY),this.filterRootInstance=n,this.preserveDrawingBuffer=t.options.preserveDrawingBuffer,this.dirtyDrawables=ci(this.dirtyDrawables),this.spriteSheets=this.spriteSheets||[],this.projectionMatrix=this.projectionMatrix||new oi,this.projectionMatrixArray=new Float32Array(9),this.customProcessor=this.customProcessor||new la.CustomProcessor,this.vertexColorPolygonsProcessor=this.vertexColorPolygonsProcessor||new la.VertexColorPolygons(this.projectionMatrixArray),this.texturedTrianglesProcessor=this.texturedTrianglesProcessor||new la.TexturedTrianglesProcessor(this.projectionMatrixArray),this.glChangedEmitter=new $o,this.isContextLost=!1,this.contextLostListener=this.onContextLoss.bind(this),this.contextRestoreListener=this.onContextRestoration.bind(this),this.domElement||(this.domElement=document.createElement("div"),this.domElement.className="webgl-container",this.domElement.style.position="absolute",this.domElement.style.left="0",this.domElement.style.top="0",this.rebuildCanvas()),this.gl.clear(this.gl.COLOR_BUFFER_BIT),mo.prepareForTransform(this.canvas,!1),mo.unsetTransform(this.canvas),this},rebuildCanvas:function(){const t=document.createElement("canvas"),e=this.getContextFromCanvas(t);e&&(this.canvas&&(this.domElement.removeChild(this.canvas),this.canvas.removeEventListener("webglcontextlost",this.contextLostListener,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoreListener,!1)),this.canvas=t,this.canvas.style.pointerEvents="none",this.canvasId=this.canvas.id="scenery-webgl"+this.id,this.canvas.addEventListener("webglcontextlost",this.contextLostListener,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoreListener,!1),this.domElement.appendChild(this.canvas),this.setupContext(e))},setupContext:function(t){this.isContextLost=!1,this.gl=t,this.backingScale=mo.backingScale(this.gl),this.display._allowBackingScaleAntialiasing&&0===t.getParameter(t.SAMPLES)&&(this.backingScale*=2),this.originalBackingScale=this.backingScale,mo.applyWebGLContextDefaults(this.gl),this.markDirty(),this.dirtyFit=!0,this.customProcessor.initializeContext(this.gl),this.vertexColorPolygonsProcessor.initializeContext(this.gl),this.texturedTrianglesProcessor.initializeContext(this.gl);for(let e=0;e<this.spriteSheets.length;e++)this.spriteSheets[e].initializeContext(this.gl);this.glChangedEmitter.emit()},delayedRebuildCanvas:function(){const t=this;window.setTimeout((function(){t.rebuildCanvas()}))},onContextLoss:function(t){this.isContextLost||(this.isContextLost=!0,t.preventDefault(),this.canvas.style.display="none",this.markDirty())},onContextRestoration:function(t){if(this.isContextLost){const t=this.getContextFromCanvas(this.canvas);this.setupContext(t),this.canvas.style.display=""}},getContextFromCanvas:function(t){const e={antialias:!0,preserveDrawingBuffer:this.preserveDrawingBuffer};return t.getContext("webgl",e)||t.getContext("experimental-webgl",e)},setSizeFullDisplay:function(){const t=this.display.getSize();this.canvas.width=Math.ceil(t.width*this.backingScale),this.canvas.height=Math.ceil(t.height*this.backingScale),this.canvas.style.width=t.width+"px",this.canvas.style.height=t.height+"px"},setSizeFitBounds:function(){throw new Error("setSizeFitBounds unimplemented for WebGLBlock")},update:function(){if(!To.prototype.update.call(this))return!1;const t=this.gl;for(this.isContextLost&&this.display._aggressiveContextRecreation&&this.delayedRebuildCanvas();this.dirtyDrawables.length;)this.dirtyDrawables.pop().update();const e=this.spriteSheets.length;for(let s=0;s<e;s++)this.spriteSheets[s].updateTexture();this.firstDrawable&&this.firstDrawable===this.lastDrawable&&this.firstDrawable.node&&null!==this.firstDrawable.node._hints.webglScale&&this.backingScale!==this.originalBackingScale*this.firstDrawable.node._hints.webglScale&&(this.backingScale=this.originalBackingScale*this.firstDrawable.node._hints.webglScale,this.dirtyFit=!0),this.updateFit(),this.projectionMatrix.rowMajor(2/this.display.width,0,-1,0,-2/this.display.height,1,0,0,1),this.projectionMatrix.copyToArray(this.projectionMatrixArray),this.preserveDrawingBuffer&&t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,this.canvas.width,this.canvas.height);let i=null,n=0;for(let s=this.firstDrawable;null!==s;s=s.nextDrawable){if(s.visible){let t=null;s.webglRenderer===jn.webglTexturedTriangles?t=this.texturedTrianglesProcessor:s.webglRenderer===jn.webglCustom?t=this.customProcessor:s.webglRenderer===jn.webglVertexColorPolygons&&(t=this.vertexColorPolygonsProcessor),t!==i&&(i&&(n+=i.deactivate()),i=t,i.activate()),i.processDrawable(s)}if(s===this.lastDrawable)break}return i&&(n+=i.deactivate()),0!==n||this.preserveDrawingBuffer||t.clear(t.COLOR_BUFFER_BIT),t.flush(),!0},dispose:function(){ci(this.dirtyDrawables),To.prototype.dispose.call(this)},markDirtyDrawable:function(t){this.dirtyDrawables.push(t),this.markDirty()},addDrawable:function(t){To.prototype.addDrawable.call(this,t),t.onAddToBlock(this)},removeDrawable:function(t){let e=0;for(;(e=this.dirtyDrawables.indexOf(t,e))>=0;)this.dirtyDrawables.splice(e,1);t.onRemoveFromBlock(this),To.prototype.removeDrawable.call(this,t)},addSpriteSheetImage:function(t,e,i){let n=null;const s=this.spriteSheets.length;for(let r=0;r<s;r++){if(n=this.spriteSheets[r].addImage(t,e,i),n)break}if(!n){const s=new aa(!0);if(n=s.addImage(t,e,i),s.initializeContext(this.gl),this.spriteSheets.push(s),!n)throw new Error("Attempt to load image that is too large for sprite sheets")}return n},removeSpriteSheetImage:function(t){t.spriteSheet.removeImage(t.image)},onIntervalChange:function(t,e){To.prototype.onIntervalChange.call(this,t,e),this.markDirty()},onPotentiallyMovedDrawable:function(t){this.markDirty()},toString:function(){return"WebGLBlock#"+this.id+"-"+To.fitString[this.fit]}}),la.CustomProcessor=function(){this.drawable=null},R(Object,la.CustomProcessor,{initializeContext:function(t){},activate:function(){this.drawCount=0},processDrawable:function(t){this.drawable=t,this.draw()},deactivate:function(){return this.drawCount},draw:function(){if(this.drawable){const t=this.drawable.draw();this.drawCount+=t,this.drawable=null}}}),la.VertexColorPolygons=function(t){this.projectionMatrixArray=t,this.lastArrayLength=128,this.vertexArray=new Float32Array(this.lastArrayLength)},R(Object,la.VertexColorPolygons,{initializeContext:function(t){this.gl=t,this.shaderProgram=new ta(t,["attribute vec2 aVertex;","attribute vec4 aColor;","varying vec4 vColor;","uniform mat3 uProjectionMatrix;","void main() {","  vColor = aColor;","  vec3 ndc = uProjectionMatrix * vec3( aVertex, 1.0 );","  gl_Position = vec4( ndc.xy, 0.0, 1.0 );","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main() {","  gl_FragColor = vec4( vColor.rgb * vColor.a, vColor.a );","}"].join("\n"),{attributes:["aVertex","aColor"],uniforms:["uProjectionMatrix"]}),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.DYNAMIC_DRAW)},activate:function(){this.shaderProgram.use(),this.vertexArrayIndex=0,this.drawCount=0},processDrawable:function(t){if(t.includeVertices){const e=t.vertexArray;for(;e.length+this.vertexArrayIndex>this.vertexArray.length;){const t=new Float32Array(2*this.vertexArray.length);t.set(this.vertexArray),this.vertexArray=t}this.vertexArray.set(e,this.vertexArrayIndex),this.vertexArrayIndex+=e.length,this.drawCount++}},deactivate:function(){return this.drawCount&&this.draw(),this.shaderProgram.unuse(),this.drawCount},draw:function(){const t=this.gl;t.uniformMatrix3fv(this.shaderProgram.uniformLocations.uProjectionMatrix,!1,this.projectionMatrixArray),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray.length>this.lastArrayLength?t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.DYNAMIC_DRAW):t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray.subarray(0,this.vertexArrayIndex));const e=Float32Array.BYTES_PER_ELEMENT,i=6*e;t.vertexAttribPointer(this.shaderProgram.attributeLocations.aVertex,2,t.FLOAT,!1,i,0*e),t.vertexAttribPointer(this.shaderProgram.attributeLocations.aColor,4,t.FLOAT,!1,i,2*e),t.drawArrays(t.TRIANGLES,0,this.vertexArrayIndex/6),this.vertexArrayIndex=0}}),la.TexturedTrianglesProcessor=function(t){this.projectionMatrixArray=t,this.lastArrayLength=128,this.vertexArray=new Float32Array(this.lastArrayLength)},R(Object,la.TexturedTrianglesProcessor,{initializeContext:function(t){this.gl=t,this.shaderProgram=new ta(t,["attribute vec2 aVertex;","attribute vec2 aTextureCoord;","attribute float aAlpha;","varying vec2 vTextureCoord;","varying float vAlpha;","uniform mat3 uProjectionMatrix;","void main() {","  vTextureCoord = aTextureCoord;","  vAlpha = aAlpha;","  vec3 ndc = uProjectionMatrix * vec3( aVertex, 1.0 );","  gl_Position = vec4( ndc.xy, 0.0, 1.0 );","}"].join("\n"),["precision mediump float;","varying vec2 vTextureCoord;","varying float vAlpha;","uniform sampler2D uTexture;","void main() {","  vec4 color = texture2D( uTexture, vTextureCoord, -0.7 );","  color.a *= vAlpha;","  gl_FragColor = color;","}"].join("\n"),{attributes:["aVertex","aTextureCoord","aAlpha"],uniforms:["uTexture","uProjectionMatrix"]}),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.DYNAMIC_DRAW)},activate:function(){this.shaderProgram.use(),this.currentSpriteSheet=null,this.vertexArrayIndex=0,this.drawCount=0},processDrawable:function(t){if(!t.sprite)return;this.currentSpriteSheet&&t.sprite.spriteSheet!==this.currentSpriteSheet&&this.draw(),this.currentSpriteSheet=t.sprite.spriteSheet;const e=t.vertexArray;for(;e.length+this.vertexArrayIndex>this.vertexArray.length;){const t=new Float32Array(2*this.vertexArray.length);t.set(this.vertexArray),this.vertexArray=t}this.vertexArray.set(e,this.vertexArrayIndex),this.vertexArrayIndex+=e.length},deactivate:function(){return this.currentSpriteSheet&&this.draw(),this.shaderProgram.unuse(),this.drawCount},draw:function(){const t=this.gl;t.uniformMatrix3fv(this.shaderProgram.uniformLocations.uProjectionMatrix,!1,this.projectionMatrixArray),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray.length>this.lastArrayLength?t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.DYNAMIC_DRAW):t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray.subarray(0,this.vertexArrayIndex));const e=Float32Array.BYTES_PER_ELEMENT,i=5*e;t.vertexAttribPointer(this.shaderProgram.attributeLocations.aVertex,2,t.FLOAT,!1,i,0*e),t.vertexAttribPointer(this.shaderProgram.attributeLocations.aTextureCoord,2,t.FLOAT,!1,i,2*e),t.vertexAttribPointer(this.shaderProgram.attributeLocations.aAlpha,1,t.FLOAT,!1,i,4*e),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.currentSpriteSheet.texture),t.uniform1i(this.shaderProgram.uniformLocations.uTexture,0),t.drawArrays(t.TRIANGLES,0,this.vertexArrayIndex/5),t.bindTexture(t.TEXTURE_2D,null),this.drawCount++,this.currentSpriteSheet=null,this.vertexArrayIndex=0}}),Pe.mixInto(la,{initialize:la.prototype.initialize});var ha=la;function ua(t,e){throw new Error("We are too abstract for that!")}zn.register("Stitcher",ua),R(Object,ua,{initialize:function(t,e,i,n,s,r,o){this.backbone=t,this.firstDrawable=e,this.lastDrawable=i,this.touchedBlocks=ci(this.touchedBlocks)},clean:function(){this.backbone=null,this.firstDrawable=null,this.lastDrawable=null},recordBackboneBoundaries:function(){this.backbone.previousFirstDrawable=this.firstDrawable,this.backbone.previousLastDrawable=this.lastDrawable},notePendingAddition:function(t,e){t.notePendingAddition(this.backbone.display,e,this.backbone)},notePendingMove:function(t,e){t.notePendingMove(this.backbone.display,e)},notePendingRemoval:function(t){t.notePendingRemoval(this.backbone.display)},markBlockForDisposal:function(t){t.domElement.parentNode===this.backbone.domElement&&this.backbone.domElement.removeChild(t.domElement),t.markForDisposal(this.backbone.display)},removeAllBlocks:function(){for(;this.backbone.blocks.length;){const t=this.backbone.blocks[0];this.removeBlock(t),this.markBlockForDisposal(t)}},notifyInterval:function(t,e,i){t.notifyInterval(e,i),this.backbone.markDirtyDrawable(t)},markBeforeBlock:function(t,e){t.pendingFirstDrawable=e,this.touchedBlocks.push(t)},markAfterBlock:function(t,e){t.pendingLastDrawable=e,this.touchedBlocks.push(t)},updateBlockIntervals:function(){for(;this.touchedBlocks.length;){const t=this.touchedBlocks.pop();t.used&&(t.updateInterval(),this.backbone.markDirtyDrawable(t))}},createBlock:function(t,e){const i=this.backbone;let n;if(jn.isCanvas(t))n=Co.createFromPool(i.display,t,i.transformRootInstance,i.backboneInstance);else if(jn.isSVG(t))n=No.createFromPool(i.display,t,i.transformRootInstance,i.backboneInstance);else if(jn.isDOM(t))n=Po.createFromPool(i.display,e);else{if(!jn.isWebGL(t))throw new Error("unsupported renderer for createBlock: "+t);n=ha.createFromPool(i.display,t,i.transformRootInstance,i.backboneInstance)}return n.setBlockBackbone(i),i.domElement.appendChild(n.domElement),i.isDisplayRoot&&n.domElement.setAttribute("aria-hidden",!0),i.markDirtyDrawable(n),n},appendBlock:function(t){this.backbone.blocks.push(t)},removeBlock:function(t){const e=_.indexOf(this.backbone.blocks,t);this.backbone.blocks.splice(e,1)},useNoBlocks:function(){ci(this.backbone.blocks)},reindex:function(){this.backbone.reindexBlocks()},auditStitch:function(){0}}),ua.debugIntervals=function(t){0},ua.debugDrawables=function(t,e,i,n,s){0};var ca=ua;function da(t,e){return t.renderer!==e.renderer||jn.isDOM(t.renderer)||jn.isDOM(e.renderer)}function fa(t){return null!==t.previousDrawable&&!da(t.previousDrawable,t)}function pa(t){return null!==t.nextDrawable&&!da(t,t.nextDrawable)}function ma(t,e,i){return t.drawableBefore?t.drawableBefore.oldNextDrawable!==t.drawableAfter:t.drawableAfter?t.drawableAfter.oldPreviousDrawable!==t.drawableBefore:null!==e}function ga(t,e,i){const n=t.drawableBefore?t.drawableBefore.parentDrawable:null,s=t.drawableAfter?t.drawableAfter.parentDrawable:null;return(!n||!s||n!==s)&&(n?n.nextBlock!==s:s?s.previousBlock!==n:null!==e)}const ya={stitch:function(t,e,i,n,s,r,o){let a;if(this.initialize(t,e,i,n,s,r,o),this.blockOrderChanged=!1,this.reusableBlocks=ci(this.reusableBlocks),this.blockWasAdded=!1,this.recordBackboneBoundaries(),t.blocks.length){const e=t.blocks[0];t.blocks[t.blocks.length-1];for(a=r;null!==a;a=a.nextChangeInterval){if(ma(a,n)){const t=a.drawableBefore?a.drawableBefore.oldNextDrawable:n,e=a.drawableAfter?a.drawableAfter.oldPreviousDrawable:s;for(let i=t;this.notePendingRemoval(i),i!==e;i=i.oldNextDrawable);}if(ga(a,e)){const e=null===a.drawableBefore?t.blocks[0]:a.drawableBefore.parentDrawable.nextBlock,i=null===a.drawableAfter?t.blocks[t.blocks.length-1]:a.drawableAfter.parentDrawable.previousBlock;for(let t=e;this.unuseBlock(t),t!==i;t=t.nextBlock);}}}if(e)for(a=r;null!==a;a=a.nextChangeInterval)this.processInterval(t,a,e,i);this.removeUnusedBlocks(),this.updateBlockIntervals(),null===e?this.useNoBlocks():this.blockOrderChanged&&(this.processBlockLinkedList(t,e.pendingParentDrawable,i.pendingParentDrawable),this.reindex()),this.clean(),ci(this.reusableBlocks)},processInterval:function(t,e,i,n){if(function(t,e,i){return t.drawableBefore?t.drawableBefore.nextDrawable!==t.drawableAfter:t.drawableAfter?t.drawableAfter.previousDrawable!==t.drawableBefore:null!==e}(e,i)){let n=e.drawableBefore?e.drawableBefore.nextDrawable:i,s=null,r=null,o=!0;for(;;){const i=n.nextDrawable,a=i===e.drawableAfter;if(s||(s=n),null===r&&n.parentDrawable&&!n.parentDrawable.used&&n.backbone===t&&n.parentDrawable.parentDrawable===t&&(r=n.parentDrawable),(a||da(n,i))&&(o&&this.processEdgeCases(e,fa(s),pa(n)),this.processSubBlock(e,s,n,r,o,a),s=null,r=null,o=!1),a)break;n=i}}else{if(e.drawableBefore&&e.drawableAfter){const t=!da(e.drawableBefore,e.drawableAfter);this.processEdgeCases(e,t,t)}e.drawableBefore&&!pa(e.drawableBefore)?this.linkAfterDrawable(e.drawableBefore):e.drawableAfter&&!fa(e.drawableAfter)&&this.linkBeforeDrawable(e.drawableAfter)}},processSubBlock:function(t,e,i,n,s,r){const o=fa(e),a=pa(i);o&&(n=e.previousDrawable.pendingParentDrawable),a&&(n=i.nextDrawable.pendingParentDrawable),n=this.ensureUsedBlock(n,e);for(let l=e;this.notePendingAddition(l,n),l!==i;l=l.nextDrawable);o||this.linkBeforeDrawable(e),r&&!a&&this.linkAfterDrawable(i)},processEdgeCases:function(t,e,i){if(null!==t.drawableBefore&&null!==t.drawableAfter){const n=t.drawableBefore.pendingParentDrawable,s=t.drawableAfter.pendingParentDrawable,r=t.nextChangeInterval&&t.nextChangeInterval.drawableAfter?t.nextChangeInterval.drawableAfter.pendingParentDrawable:null;let o;n===s&&(this.blockWasAdded=!0),e&&i?o=n:this.blockWasAdded||n===s?(o=this.createBlock(t.drawableAfter.renderer,t.drawableAfter),this.blockOrderChanged=!0):o=s,s===o?this.blockWasAdded=!0:this.changeExternals(t,o),r!==s&&(this.blockWasAdded||this.unuseBlock(s),this.blockWasAdded=!1)}},changeExternals:function(t,e){const i=function(t){const e=t.drawableAfter;if(e){const i=e.renderer,n=t.nextChangeInterval?t.nextChangeInterval.drawableBefore.nextDrawable:null;let s=e;for(;;){const t=s.nextDrawable;if(t===n||t.renderer!==i)break;s=t}return s}return null}(t);this.notePendingMoves(e,t.drawableAfter,i),t.nextChangeInterval&&t.nextChangeInterval.drawableBefore===i||this.linkAfterDrawable(i)},notePendingMoves:function(t,e,i){for(let n=e;this.notePendingMove(n,t),n!==i;n=n.nextDrawable);},ensureUsedBlock:function(t,e){return t?t.used||this.useBlock(t):t=this.getBlockForRenderer(e.renderer,e),t},getBlockForRenderer:function(t,e){let i;if(!jn.isDOM(t))for(let n=this.reusableBlocks.length-1;n>=0;n--){const e=this.reusableBlocks[n];if(e.renderer===t){this.useBlockAtIndex(e,n),i=e;break}}return i||(i=this.createBlock(t,e)),this.blockOrderChanged=!0,i},unuseBlock:function(t){t.used&&(t.used=!1,this.reusableBlocks.push(t))},useBlock:function(t){this.useBlockAtIndex(t,_.indexOf(this.reusableBlocks,t))},useBlockAtIndex:function(t,e){this.reusableBlocks.splice(e,1),t.used=!0},removeUnusedBlocks:function(){for(;this.reusableBlocks.length;){const t=this.reusableBlocks.pop();this.markBlockForDisposal(t),this.blockOrderChanged=!0}},linkBeforeDrawable:function(t){const e=t.previousDrawable;this.linkBlocks(e?e.pendingParentDrawable:null,t.pendingParentDrawable,e,t)},linkAfterDrawable:function(t){const e=t.nextDrawable;this.linkBlocks(t.pendingParentDrawable,e?e.pendingParentDrawable:null,t,e)},linkBlocks:function(t,e,i,n){t&&(t.nextBlock!==e&&(this.blockOrderChanged=!0,t.nextBlock&&(t.nextBlock.previousBlock=null),t.nextBlock=e),this.markAfterBlock(t,i)),e&&(e.previousBlock!==t&&(this.blockOrderChanged=!0,e.previousBlock&&(e.previousBlock.nextBlock=null),e.previousBlock=t),this.markBeforeBlock(e,n))},processBlockLinkedList:function(t,e,i){for(;t.blocks.length;)t.blocks.pop();if(e)for(let n=e;t.blocks.push(n),n!==i;n=n.nextBlock);}},ba=R(ca,(function(){}),ya);zn.register("GreedyStitcher",ba),ba.stitchPrototype=ya;var va=ba;const _a={stitch:function(t,e,i,n,s,r,o){this.initialize(t,e,i,n,s,r,o);for(let u=t.previousFirstDrawable;null!==u&&(this.notePendingRemoval(u),u!==t.previousLastDrawable);u=u.oldNextDrawable);this.recordBackboneBoundaries(),this.removeAllBlocks();let a=null,l=0,h=null;for(let u=e;null!==u&&(a&&u.renderer===l||(a&&this.notifyInterval(a,h,u.previousDrawable),l=u.renderer,a=this.createBlock(l,u),jn.isDOM(l)&&(l=0),this.appendBlock(a),h=u),this.notePendingAddition(u,a),u!==i);u=u.nextDrawable);a&&this.notifyInterval(a,h,i),this.reindex(),this.clean()}},wa=R(ca,(function(){}),_a);zn.register("RebuildStitcher",wa),wa.stitchPrototype=_a;function Aa(t,e,i,n,s){this.initialize(t,e,i,n,s)}zn.register("BackboneDrawable",Aa),R(Kn,Aa,{initialize:function(t,e,i,n,s){if(Kn.call(this,n),this.display=t,this.forceAcceleration=!1,this.backboneInstance=e,this.transformRootInstance=i,this.filterRootAncestorInstance=e.parent?e.parent.getFilterRootInstance():e,this.transformRootAncestorInstance=e.parent?e.parent.getTransformRootInstance():e,this.willApplyTransform=this.transformRootAncestorInstance!==this.transformRootInstance,this.willApplyFilters=this.filterRootAncestorInstance!==this.backboneInstance,this.transformListener=this.transformListener||this.markTransformDirty.bind(this),this.willApplyTransform&&(this.backboneInstance.relativeTransform.addListener(this.transformListener),this.backboneInstance.relativeTransform.addPrecompute()),this.backboneVisibilityListener=this.backboneVisibilityListener||this.updateBackboneVisibility.bind(this),this.backboneInstance.relativeVisibleEmitter.addListener(this.backboneVisibilityListener),this.updateBackboneVisibility(),this.visibilityDirty=!0,this.renderer=n,this.domElement=s?t._domElement:Aa.createDivBackbone(),this.isDisplayRoot=s,this.dirtyDrawables=ci(this.dirtyDrawables),mo.prepareForTransform(this.domElement,this.forceAcceleration),this.watchedFilterNodes=ci(this.watchedFilterNodes),this.opacityDirty=!0,this.clipDirty=!0,this.opacityDirtyListener=this.opacityDirtyListener||this.markOpacityDirty.bind(this),this.clipDirtyListener=this.clipDirtyListener||this.markClipDirty.bind(this),this.willApplyFilters)for(let r=this.backboneInstance;r!==this.filterRootAncestorInstance;r=r.parent){const t=r.node;this.watchedFilterNodes.push(t),t.opacityProperty.lazyLink(this.opacityDirtyListener),t.clipAreaProperty.lazyLink(this.clipDirtyListener)}return this.lastZIndex=0,this.blocks=this.blocks||[],this.previousFirstDrawable=null,this.previousLastDrawable=null,this.removedDrawables=!1,this.stitcher=this.stitcher||new va,this},dispose:function(){for(;this.watchedFilterNodes.length;){const t=this.watchedFilterNodes.pop();t.opacityProperty.unlink(this.opacityDirtyListener),t.clipAreaProperty.unlink(this.clipDirtyListener)}if(this.backboneInstance.relativeVisibleEmitter.removeListener(this.backboneVisibilityListener),!this.removedDrawables)for(let t=this.previousFirstDrawable;null!==t&&(t.parentDrawable.removeDrawable(t),t!==this.previousLastDrawable);t=t.nextDrawable);this.markBlocksForDisposal(),this.willApplyTransform&&(this.backboneInstance.relativeTransform.removeListener(this.transformListener),this.backboneInstance.relativeTransform.removePrecompute()),this.backboneInstance=null,this.transformRootInstance=null,this.filterRootAncestorInstance=null,this.transformRootAncestorInstance=null,ci(this.dirtyDrawables),ci(this.watchedFilterNodes),this.previousFirstDrawable=null,this.previousLastDrawable=null,Kn.prototype.dispose.call(this)},markBlocksForDisposal:function(){for(;this.blocks.length;){const t=this.blocks.pop();t.domElement.parentNode===this.domElement&&this.domElement.removeChild(t.domElement),t.markForDisposal(this.display)}},updateBackboneVisibility:function(){this.visible=this.backboneInstance.relativeVisible,this.visibilityDirty||(this.visibilityDirty=!0,this.markDirty())},markForDisposal:function(t){for(let e=this.previousFirstDrawable;null!==e&&(e.notePendingRemoval(this.display),e!==this.previousLastDrawable);e=e.oldNextDrawable);this.removedDrawables=!0,Kn.prototype.markForDisposal.call(this,t)},markDirtyDrawable:function(t){this.dirtyDrawables.push(t),this.markDirty()},markTransformDirty:function(){mo.applyPreparedTransform(this.backboneInstance.relativeTransform.matrix,this.domElement,this.forceAcceleration)},markOpacityDirty:function(){this.opacityDirty||(this.opacityDirty=!0,this.markDirty())},markClipDirty:function(){this.clipDirty||(this.clipDirty=!0,this.markDirty())},update:function(){if(!Kn.prototype.update.call(this))return!1;for(;this.dirtyDrawables.length;)this.dirtyDrawables.pop().update();if(this.opacityDirty){this.opacityDirty=!1;const t=this.willApplyFilters?this.getFilterOpacity():1;this.domElement.style.opacity=1!==t?t:""}return this.visibilityDirty&&(this.visibilityDirty=!1,this.domElement.style.display=this.visible?"":"none"),this.clipDirty&&(this.clipDirty=!1),!0},getFilterOpacity:function(){let t=1;const e=this.watchedFilterNodes.length;for(let i=0;i<e;i++)t*=this.watchedFilterNodes[i].getOpacity();return t},getFilterVisibility:function(){const t=this.watchedFilterNodes.length;for(let e=0;e<t;e++)if(!this.watchedFilterNodes[e].isVisible())return!1;return!0},getFilterClip:function(){return""},reindexBlocks:function(){let t=0;for(let e=0;e<this.blocks.length;e++){const i=this.blocks[e];if(i.zIndex<=t){const n=e+1<this.blocks.length&&this.blocks[e+1].zIndex-1>t?Math.ceil((t+this.blocks[e+1].zIndex)/2):t+20;i.domElement.style.zIndex=i.zIndex=n}t=i.zIndex}this.lastZIndex=t+1},stitch:function(t,e,i,n){if(null===i||null===n)return;let s=null,r=i,o=!1;for(;r;)o=r.constrict()||o,r.isEmpty()?s&&(s.nextChangeInterval=r.nextChangeInterval):(s||(i=r),s=r),r=r.nextChangeInterval;s&&((n=s).nextChangeInterval=null,this.stitcher.stitch(this,t,e,this.previousFirstDrawable,this.previousLastDrawable,i,n))},audit:function(t,e,i){0}}),Aa.createDivBackbone=function(){const t=document.createElement("div");return t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.width="0",t.style.height="0",t},Aa.repurposeBackboneContainer=function(t){return"relative"===t.style.position&&"absolute"===t.style.position||(t.style.position="relative"),t.style.left="0",t.style.top="0",t},Pe.mixInto(Aa,{initialize:Aa.prototype.initialize});var xa=Aa;function Ta(t){this.instance=t}zn.register("Fittability",Ta),R(Object,Ta,{initialize:function(t,e){return this.display=t,this.trail=e,this.node=e&&e.lastNode(),this.selfFittable=!!e&&this.isSelfFitSupported(),this.ancestorsFittable=this.selfFittable,this.subtreeUnfittableCount=this.selfFittable?0:1,this.subtreeFittabilityChangeEmitter=this.subtreeFittabilityChangeEmitter||new C,this},get parent(){return this.instance.parent?this.instance.parent.fittability:null},checkSelfFittability:function(){const t=this.isSelfFitSupported();this.selfFittable!==t&&this.updateSelfFittable()},isSelfFitSupported:function(){return!this.node.isPreventFit()},markSubtreeFittable:function(){if(!this.selfFittable)return;this.ancestorsFittable=!0;const t=this.instance.children;for(let e=0;e<t.length;e++)t[e].fittability.markSubtreeFittable();this.instance.updateDrawableFittability(!0)},markSubtreeUnfittable:function(){if(!this.ancestorsFittable)return;this.ancestorsFittable=!1;const t=this.instance.children;for(let e=0;e<t.length;e++)t[e].fittability.markSubtreeUnfittable();this.instance.updateDrawableFittability(!1)},updateSelfFittable:function(){const t=this.isSelfFitSupported();this.selfFittable=t,!this.selfFittable||this.parent&&!this.parent.ancestorsFittable?this.selfFittable||this.markSubtreeUnfittable():this.markSubtreeFittable(),this.selfFittable?this.decrementSubtreeUnfittableCount():this.incrementSubtreeUnfittableCount()},incrementSubtreeUnfittableCount:function(){this.subtreeUnfittableCount++,1===this.subtreeUnfittableCount&&(this.parent&&this.parent.incrementSubtreeUnfittableCount(),this.subtreeFittabilityChangeEmitter.emit())},decrementSubtreeUnfittableCount:function(){this.subtreeUnfittableCount--,0===this.subtreeUnfittableCount&&(this.parent&&this.parent.decrementSubtreeUnfittableCount(),this.subtreeFittabilityChangeEmitter.emit())},onInsert:function(t){this.ancestorsFittable||t.markSubtreeUnfittable(),t.subtreeUnfittableCount>0&&this.incrementSubtreeUnfittableCount()},onRemove:function(t){this.ancestorsFittable||t.markSubtreeFittable(),t.subtreeUnfittableCount>0&&this.decrementSubtreeUnfittableCount()},audit:function(){0}});var Sa=Ta;function Da(t,e){Kn.call(this,t),this.instance=e}zn.register("InlineCanvasCacheDrawable",Da),R(Kn,Da,{stitch:function(t,e,i,n){}});var Ea=Da;function Ca(t){this.instance=t}zn.register("RelativeTransform",Ca),R(Object,Ca,{initialize:function(t,e){return this.display=t,this.trail=e,this.node=e&&e.lastNode(),this.transformDirty=!0,this.nodeTransformListener=this.nodeTransformListener||this.onNodeTransformDirty.bind(this),this.matrix=this.matrix||oi.identity(),this.relativeSelfDirty=!0,this.relativeChildrenListenersCount=0,this.relativePrecomputeCount=0,this.relativeChildrenPrecomputeCount=0,this.relativeFrameId=-1,this.relativeChildDirtyFrame=t?t._frameId:0,this.relativeTransformListeners=ci(this.relativeTransformListeners),this},get parent(){return this.instance.parent?this.instance.parent.relativeTransform:null},addInstance:function(t){t.stateless||(t.relativeTransform.hasAncestorListenerNeed()&&this.incrementTransformListenerChildren(),t.relativeTransform.hasAncestorComputeNeed()&&this.incrementTransformPrecomputeChildren()),t.relativeTransform.forceMarkTransformDirty()},removeInstance:function(t){t.relativeTransform.hasAncestorListenerNeed()&&this.decrementTransformListenerChildren(),t.relativeTransform.hasAncestorComputeNeed()&&this.decrementTransformPrecomputeChildren()},attachNodeListeners:function(){this.node.transformEmitter.addListener(this.nodeTransformListener)},detachNodeListeners:function(){this.node.transformEmitter.removeListener(this.nodeTransformListener)},hasDescendantListenerNeed:function(){return this.instance.isTransformed?this.relativeChildrenListenersCount>0:this.relativeChildrenListenersCount>0||this.relativeTransformListeners.length>0},hasAncestorListenerNeed:function(){return this.instance.isTransformed?this.relativeTransformListeners.length>0:this.relativeChildrenListenersCount>0||this.relativeTransformListeners.length>0},hasSelfListenerNeed:function(){return this.relativeTransformListeners.length>0},incrementTransformListenerChildren:function(){const t=this.hasAncestorListenerNeed();this.relativeChildrenListenersCount++,t!==this.hasAncestorListenerNeed()&&this.parent&&this.parent.incrementTransformListenerChildren()},decrementTransformListenerChildren:function(){const t=this.hasAncestorListenerNeed();this.relativeChildrenListenersCount--,t!==this.hasAncestorListenerNeed()&&this.parent&&this.parent.decrementTransformListenerChildren()},addListener:function(t){const e=this.hasAncestorListenerNeed();this.relativeTransformListeners.push(t),e!==this.hasAncestorListenerNeed()&&(this.parent&&this.parent.incrementTransformListenerChildren(),this.hasAncestorComputeNeed()||this.forceMarkTransformDirty())},removeListener:function(t){const e=this.hasAncestorListenerNeed();this.relativeTransformListeners.splice(_.indexOf(this.relativeTransformListeners,t),1),e!==this.hasAncestorListenerNeed()&&this.parent&&this.parent.decrementTransformListenerChildren()},hasDescendantComputeNeed:function(){return this.instance.isTransformed?this.relativeChildrenPrecomputeCount>0:this.relativeChildrenPrecomputeCount>0||this.relativePrecomputeCount>0},hasAncestorComputeNeed:function(){return this.instance.isTransformed?this.relativePrecomputeCount>0:this.relativeChildrenPrecomputeCount>0||this.relativePrecomputeCount>0},hasSelfComputeNeed:function(){return this.relativePrecomputeCount>0},incrementTransformPrecomputeChildren:function(){const t=this.hasAncestorComputeNeed();this.relativeChildrenPrecomputeCount++,t!==this.hasAncestorComputeNeed()&&this.parent&&this.parent.incrementTransformPrecomputeChildren()},decrementTransformPrecomputeChildren:function(){const t=this.hasAncestorComputeNeed();this.relativeChildrenPrecomputeCount--,t!==this.hasAncestorComputeNeed()&&this.parent&&this.parent.decrementTransformPrecomputeChildren()},addPrecompute:function(){const t=this.hasAncestorComputeNeed();this.relativePrecomputeCount++,t!==this.hasAncestorComputeNeed()&&(this.parent&&this.parent.incrementTransformPrecomputeChildren(),this.hasAncestorListenerNeed()||this.forceMarkTransformDirty())},removePrecompute:function(){const t=this.hasAncestorComputeNeed();this.relativePrecomputeCount--,t!==this.hasAncestorComputeNeed()&&this.parent&&this.parent.decrementTransformPrecomputeChildren()},onNodeTransformDirty:function(){this.transformDirty||this.forceMarkTransformDirty()},forceMarkTransformDirty:function(){this.transformDirty=!0,this.relativeSelfDirty=!0;const t=this.display._frameId;let e=this.instance.parent;for(;e&&e.relativeTransform.relativeChildDirtyFrame!==t;){const i=e.parent,n=e.isTransformed;if(e.relativeTransform.relativeChildDirtyFrame=t,null===i){this.display.markTransformRootDirty(e,n);break}if(n){this.display.markTransformRootDirty(e,!0);break}e=i}},computeRelativeTransform:function(){const t=this.node.getMatrix();this.instance.parent&&!this.instance.parent.isTransformed?(this.matrix.set(this.parent.matrix),this.matrix.multiplyMatrix(t)):this.matrix.set(t),this.relativeFrameId=this.display._frameId,this.relativeSelfDirty=!1},isValidationNotNeeded:function(){return this.hasAncestorComputeNeed()||this.relativeFrameId===this.display._frameId},validate:function(){if(!this.isValidationNotNeeded()&&(this.instance.parent&&!this.instance.parent.isTransformed&&this.parent.validate(),this.relativeSelfDirty)){this.computeRelativeTransform();const t=this.instance.children.length;for(let e=0;e<t;e++)this.instance.children[e].relativeTransform.relativeSelfDirty=!0}},updateTransformListenersAndCompute:function(t,e,i,n){let s,r;if(n)for(s=this.instance.children.length,r=0;r<s;r++)this.instance.children[r].relativeTransform.updateTransformListenersAndCompute(!1,!1,i,!1);else{const o=t||this.relativeSelfDirty,a=o||this.relativeChildDirtyFrame===i,l=this.hasDescendantComputeNeed(),h=this.hasDescendantListenerNeed(),u=this.hasSelfComputeNeed(),c=this.hasSelfListenerNeed();if(l||!o||e||(this.relativeSelfDirty=!0),!a||!l&&!h&&!u&&!c)return;if(o&&(l||u)&&this.computeRelativeTransform(),this.transformDirty&&(this.transformDirty=!1),this.notifyRelativeTransformListeners(),!this.instance.isTransformed||n){const t=o&&!(l||u);for(s=this.instance.children.length,r=0;r<s;r++)this.instance.children[r].relativeTransform.updateTransformListenersAndCompute(o,t,i,!1)}}},notifyRelativeTransformListeners:function(){const t=this.relativeTransformListeners.length;for(let e=0;e<t;e++)this.relativeTransformListeners[e]()},audit:function(t,e){}});var Ia=Ca;function Pa(t,e,i,n){Kn.call(this,e),this.instance=i,this.sharedInstance=n}zn.register("SharedCanvasCacheDrawable",Pa),R(Kn,Pa,{});var ka=Pa;let La=1;const Oa=jn.createOrderBitmask(jn.bitmaskSVG,jn.bitmaskCanvas,jn.bitmaskDOM,jn.bitmaskWebGL);function Na(t,e,i,n){this.active=!1,this.initialize(t,e,i,n)}zn.register("Instance",Na),R(Object,Na,{initialize:function(t,e,i,n){return e.setImmutable(),this.id=this.id||La++,this.isWebGLSupported=t._allowWebGL&&mo.isWebGLSupported,this.relativeTransform=this.relativeTransform||new Ia(this),this.fittability=this.fittability||new Sa(this),this.visible=!0,this.relativeVisible=!0,this.selfVisible=!0,this.visibilityDirty=!0,this.childVisibilityDirty=!0,this.branchIndexMap={}||this.branchIndexMap,this.branchIndexReferences=ci(this.branchIndexReferences),this.addRemoveCounter=0,this.stitchChangeFrame=t._frameId,this.stitchChangeBefore=0,this.stitchChangeAfter=0,this.stitchChangeOnChildren=0,this.stitchChangeIncluded=!1,this.childInsertedListener=this.childInsertedListener||this.onChildInserted.bind(this),this.childRemovedListener=this.childRemovedListener||this.onChildRemoved.bind(this),this.childrenReorderedListener=this.childrenReorderedListener||this.onChildrenReordered.bind(this),this.visibilityListener=this.visibilityListener||this.onVisibilityChange.bind(this),this.markRenderStateDirtyListener=this.markRenderStateDirtyListener||this.markRenderStateDirty.bind(this),this.visibleEmitter=new C,this.relativeVisibleEmitter=new C,this.selfVisibleEmitter=new C,this.cleanInstance(t,e),this.node.addInstance(this),this.externalReferenceCount=0,this.stateless=!0,this.isDisplayRoot=i,this.isSharedCanvasCacheRoot=n,this.preferredRenderers=0,this.isUnderCanvasCache=n,this.isBackbone=!1,this.isTransformed=!1,this.isVisibilityApplied=!1,this.isInstanceCanvasCache=!1,this.isSharedCanvasCachePlaceholder=!1,this.isSharedCanvasCacheSelf=n,this.selfRenderer=0,this.groupRenderer=0,this.sharedCacheRenderer=0,this.renderStateDirtyFrame=t._frameId,this.skipPruningFrame=t._frameId,this.active=!0,this},cleanInstance:function(t,e){this.display=t,this.trail=e,this.node=e?e.lastNode():null,this.parent=null,this.oldParent=null,this.children=ci(this.children),this.sharedCacheInstance=null,this.relativeTransform.initialize(t,e),this.fittability.initialize(t,e),this.instanceRemovalCheckList=ci(this.instanceRemovalCheckList),this.selfDrawable=null,this.groupDrawable=null,this.sharedCacheDrawable=null,this.firstDrawable=null,this.lastDrawable=null,this.firstInnerDrawable=null,this.lastInnerDrawable=null,this.svgGroups=ci(this.svgGroups),this.cleanSyncTreeResults()},cleanSyncTreeResults:function(){this.beforeStableIndex=this.children.length,this.afterStableIndex=-1,this.firstChangeInterval=null,this.lastChangeInterval=null,this.incompatibleStateChange=!1,this.groupChanged=!1,this.cascadingStateChange=!1,this.anyStateChange=!1},updateRenderingState:function(){const t=this.isBackbone,e=this.isTransformed,i=this.isVisibilityApplied,n=this.isInstanceCanvasCache,s=this.isSharedCanvasCacheSelf,r=this.isSharedCanvasCachePlaceholder,o=this.isUnderCanvasCache,a=this.selfRenderer,l=this.groupRenderer,h=this.sharedCacheRenderer,u=this.preferredRenderers;this.isBackbone=!1,this.isTransformed=!1,this.isVisibilityApplied=!1,this.isInstanceCanvasCache=!1,this.isSharedCanvasCacheSelf=!1,this.isSharedCanvasCachePlaceholder=!1,this.selfRenderer=0,this.groupRenderer=0,this.sharedCacheRenderer=0;const c=this.node._hints;this.isUnderCanvasCache=this.isSharedCanvasCacheRoot||!!this.parent&&(this.parent.isUnderCanvasCache||this.parent.isInstanceCanvasCache||this.parent.isSharedCanvasCacheSelf),this.preferredRenderers=this.parent?this.parent.preferredRenderers:Oa,c.renderer&&(this.preferredRenderers=jn.pushOrderBitmask(this.preferredRenderers,c.renderer));const d=this.node.hasClipArea(),f=1!==this.node.opacity||c.usesOpacity,p=c.requireElement||c.cssTransform||c.layerSplit,m=this.isDisplayRoot||!this.isUnderCanvasCache&&p,g=!m&&(f||d)&&(this.node._rendererSummary.isSubtreeRenderedExclusivelySVG(this.preferredRenderers)||this.node._rendererSummary.isSubtreeRenderedExclusivelyCanvas(this.preferredRenderers));if(!g&&(m||f||d)?(this.isBackbone=!0,this.isVisibilityApplied=!0,this.isTransformed=this.isDisplayRoot||!!c.cssTransform,this.groupRenderer=jn.bitmaskDOM):!g&&(f||d||c.canvasCache)&&(c.singleCache?this.isSharedCanvasCacheRoot?(this.isSharedCanvasCacheSelf=!0,this.sharedCacheRenderer=this.isWebGLSupported?jn.bitmaskWebGL:jn.bitmaskCanvas):this.isSharedCanvasCachePlaceholder=!0:(this.isInstanceCanvasCache=!0,this.isUnderCanvasCache=!0,this.groupRenderer=this.isWebGLSupported?jn.bitmaskWebGL:jn.bitmaskCanvas)),this.node.isPainted())if(this.isUnderCanvasCache)this.selfRenderer=jn.bitmaskCanvas;else{let t=this.node._rendererBitmask;if(!this.isWebGLSupported){t^=t&jn.bitmaskWebGL}this.selfRenderer=t&jn.bitmaskOrder(this.preferredRenderers,0)||t&jn.bitmaskOrder(this.preferredRenderers,1)||t&jn.bitmaskOrder(this.preferredRenderers,2)||t&jn.bitmaskOrder(this.preferredRenderers,3)||t&jn.bitmaskSVG||t&jn.bitmaskCanvas||t&jn.bitmaskDOM||t&jn.bitmaskWebGL||0}this.groupChanged=t!==this.isBackbone||n!==this.isInstanceCanvasCache||s!==this.isSharedCanvasCacheSelf,this.cascadingStateChange=o!==this.isUnderCanvasCache||u!==this.preferredRenderers,this.incompatibleStateChange=this.isTransformed!==e||this.isSharedCanvasCachePlaceholder!==r,this.anyStateChange=this.groupChanged||this.cascadingStateChange||this.incompatibleStateChange||a!==this.selfRenderer||l!==this.groupRenderer||h!==this.sharedCacheRenderer,i!==this.isVisibilityApplied&&(this.visibilityDirty=!0,this.parent&&this.parent.markChildVisibilityDirty()),this.fittability.checkSelfFittability()},getStateString:function(){return"S[ "+(this.isDisplayRoot?"displayRoot ":"")+(this.isBackbone?"backbone ":"")+(this.isInstanceCanvasCache?"instanceCache ":"")+(this.isSharedCanvasCachePlaceholder?"sharedCachePlaceholder ":"")+(this.isSharedCanvasCacheSelf?"sharedCacheSelf ":"")+(this.isTransformed?"TR ":"")+(this.isVisibilityApplied?"VIS ":"")+(this.selfRenderer?this.selfRenderer.toString(16):"-")+","+(this.groupRenderer?this.groupRenderer.toString(16):"-")+","+(this.sharedCacheRenderer?this.sharedCacheRenderer.toString(16):"-")+" "+"]"},baseSyncTree:function(){this.syncTree(),this.cleanSyncTreeResults()},syncTree:function(){const t=this.stateless;if((t||this.parent&&this.parent.cascadingStateChange||this.renderStateDirtyFrame===this.display._frameId)&&this.updateRenderingState(),!t&&this.incompatibleStateChange)return!1;if(this.stateless=!1,t&&(this.isTransformed&&this.display.markTransformRootDirty(this,!0),this.attachNodeListeners()),this.isSharedCanvasCachePlaceholder)this.sharedSyncTree();else if(t||this.skipPruningFrame===this.display._frameId||this.anyStateChange){this.prepareChildInstances(t);this.firstDrawable,this.lastDrawable,this.firstInnerDrawable,this.lastInnerDrawable;const e=this.updateSelfDrawable();this.localSyncTree(e),this.groupSyncTree(t)}return!0},localSyncTree:function(t){const e=this.display._frameId;let i=this.selfDrawable,n=i,s=null;t&&(s=vo.newForDisplay(null,null,this.display));let r=s,o=t?null:this.selfDrawable;for(let a=0;a<this.children.length;a++){let t=this.children[a];t.syncTree()||(t=this.updateIncompatibleChildInstance(t,a),t.syncTree());const l=t.shouldIncludeInParentDrawables();l&&t.firstDrawable&&(n?Kn.connectDrawables(n,t.firstDrawable,this.display):i=t.firstDrawable,n=t.lastDrawable);const h=t.stitchChangeIncluded,u=l;t.stitchChangeIncluded=u,t.stitchChangeFrame===e&&(t.firstChangeInterval=t.lastChangeInterval=vo.newForDisplay(null,null,this.display));const c=t.firstChangeInterval;let d=r&&null===r.drawableAfter;const f=c&&null===c.drawableBefore;if(t.stitchChangeBefore===e&&!d&&!f){const t=vo.newForDisplay(o,null,this.display);r&&(r.nextChangeInterval=t),r=t,s=s||r,d=!0}if((h||u)&&(d?c?null===c.drawableBefore?(r.drawableAfter=c.drawableAfter,r.nextChangeInterval=c.nextChangeInterval,r=t.lastChangeInterval===c?r:t.lastChangeInterval):(r.drawableAfter=t.firstDrawable,r.nextChangeInterval=c,r=t.lastChangeInterval):r.drawableAfter=t.firstDrawable:c&&(s=s||c,null===c.drawableBefore&&(c.drawableBefore=o),r&&(r.nextChangeInterval=c),r=t.lastChangeInterval),o=r&&null===r.drawableAfter?null:t.lastDrawable?t.lastDrawable:o),a===this.children.length-1&&t.stitchChangeAfter===e&&(!r||null!==r.drawableAfter)){const t=vo.newForDisplay(o,null,this.display);r&&(r.nextChangeInterval=t),r=t,s=s||r}t.cleanSyncTreeResults()}s||this.stitchChangeOnChildren!==this.display._frameId||0!==this.children.length||(s=r=vo.newForDisplay(null,null,this.display)),this.firstChangeInterval=s,this.lastChangeInterval=r,this.firstDrawable=this.firstInnerDrawable=i,this.lastDrawable=this.lastInnerDrawable=n},updateSelfDrawable:function(){if(this.node.isPainted()){const t=this.selfRenderer;if(!this.selfDrawable||0==(this.selfDrawable.renderer&t&jn.bitmaskRendererArea))return this.selfDrawable&&this.selfDrawable.markForDisposal(this.display),this.selfDrawable=jn.createSelfDrawable(this,this.node,t,this.fittability.ancestorsFittable),!0}return!1},updateIncompatibleChildInstance:function(t,e){this.display.markInstanceRootForDisposal(t);const i=Na.createFromPool(this.display,this.trail.copy().addDescendant(t.node,e),!1,!1);return this.replaceInstanceWithIndex(t,i,e),i},groupSyncTree:function(t){const e=this.groupRenderer,i=!!e!=!!this.groupDrawable||!t&&this.groupChanged||this.groupDrawable&&this.groupDrawable.renderer!==e;i&&(this.groupDrawable&&(this.groupDrawable.markForDisposal(this.display),this.groupDrawable=null),this.firstChangeInterval=this.lastChangeInterval=vo.newForDisplay(null,null,this.display)),e&&(this.firstDrawable&&Kn.disconnectBefore(this.firstDrawable,this.display),this.lastDrawable&&Kn.disconnectAfter(this.lastDrawable,this.display),this.isBackbone?(i&&(this.groupDrawable=xa.createFromPool(this.display,this,this.getTransformRootInstance(),e,this.isDisplayRoot),this.isTransformed&&this.display.markTransformRootDirty(this,!0)),this.firstChangeInterval&&this.groupDrawable.stitch(this.firstDrawable,this.lastDrawable,this.firstChangeInterval,this.lastChangeInterval)):this.isInstanceCanvasCache?(i&&(this.groupDrawable=Ea.createFromPool(e,this)),this.firstChangeInterval&&this.groupDrawable.stitch(this.firstDrawable,this.lastDrawable,this.firstChangeInterval,this.lastChangeInterval)):this.isSharedCanvasCacheSelf&&i&&(this.groupDrawable=Co.createFromPool(e,this)),this.groupDrawable.setFittable(this.fittability.ancestorsFittable),this.firstDrawable=this.lastDrawable=this.groupDrawable),i?this.firstChangeInterval=this.lastChangeInterval=vo.newForDisplay(null,null,this.display):e&&(this.firstChangeInterval=this.lastChangeInterval=null)},sharedSyncTree:function(){this.ensureSharedCacheInitialized();const t=this.sharedCacheRenderer;this.sharedCacheDrawable&&this.sharedCacheDrawable.renderer===t||(this.sharedCacheDrawable&&this.sharedCacheDrawable.markForDisposal(this.display),this.sharedCacheDrawable=new ka(this.trail,t,this,this.sharedCacheInstance),this.firstDrawable=this.sharedCacheDrawable,this.lastDrawable=this.sharedCacheDrawable,this.firstChangeInterval=this.lastChangeInterval=vo.newForDisplay(null,null,this.display))},prepareChildInstances:function(t){for(;this.instanceRemovalCheckList.length;){const t=this.instanceRemovalCheckList.pop();-1===t.addRemoveCounter&&(t.addRemoveCounter=0,this.display.markInstanceRootForDisposal(t))}if(t)for(let e=0;e<this.node.children.length;e++){const t=this.node.children[e];this.appendInstance(Na.createFromPool(this.display,this.trail.copy().addDescendant(t,e),!1,!1))}},ensureSharedCacheInitialized:function(){if(!this.sharedCacheInstance){const t=this.node.getId();this.sharedCacheInstance=this.display._sharedCanvasInstances[t],this.sharedCacheInstance||(this.sharedCacheInstance=Na.createFromPool(this.display,new Vs(this.node),!1,!0),this.sharedCacheInstance.syncTree(),this.display._sharedCanvasInstances[t]=this.sharedCacheInstance,this.display.markTransformRootDirty(this.sharedCacheInstance,!0)),this.sharedCacheInstance.externalReferenceCount++,this.isTransformed&&this.display.markTransformRootDirty(this,!0)}},shouldIncludeInParentDrawables:function(){return this.node.isVisible()||!this.node.isExcludeInvisible()},findPreviousDrawable:function(t){for(let e=t-1;e>=0;e--){const t=this.children[e].lastDrawable;if(null!==t)return t}return null},findNextDrawable:function(t){const e=this.children.length;for(let i=t+1;i<e;i++){const t=this.children[i].firstDrawable;if(null!==t)return t}return null},appendInstance:function(t){this.insertInstance(t,this.children.length)},insertInstance:function(t,e){t.stitchChangeFrame=this.display._frameId,this.stitchChangeOnChildren=this.display._frameId,this.children.splice(e,0,t),t.parent=this,t.oldParent=this,e<=this.beforeStableIndex&&(this.beforeStableIndex=e-1),e>this.afterStableIndex?this.afterStableIndex=e+1:this.afterStableIndex++,this.fittability.onInsert(t.fittability),this.relativeTransform.addInstance(t),this.markChildVisibilityDirty()},removeInstance:function(t){return this.removeInstanceWithIndex(t,_.indexOf(this.children,t))},removeInstanceWithIndex:function(t,e){const i=this.display._frameId;t.stitchChangeFrame=i,this.stitchChangeOnChildren=i,e-1>=0&&(this.children[e-1].stitchChangeAfter=i),e+1<this.children.length&&(this.children[e+1].stitchChangeBefore=i),this.children.splice(e,1),t.parent=null,t.oldParent=this,e<=this.beforeStableIndex&&(this.beforeStableIndex=e-1),e>=this.afterStableIndex?this.afterStableIndex=e:this.afterStableIndex--,this.fittability.onRemove(t.fittability),this.relativeTransform.removeInstance(t)},replaceInstanceWithIndex:function(t,e,i){this.removeInstanceWithIndex(t,i),this.insertInstance(e,i)},reorderInstances:function(t,e){const i=this.display._frameId;this.children.splice(t,e-t+1);for(let n=t;n<=e;n++){const s=this.findChildInstanceOnNode(this.node._children[n]);this.children.splice(n,0,s),s.stitchChangeFrame=i,n>t&&(s.stitchChangeAfter=i),n<e&&(s.stitchChangeBefore=i)}this.stitchChangeOnChildren=i,this.beforeStableIndex=Math.min(this.beforeStableIndex,t-1),this.afterStableIndex=Math.max(this.afterStableIndex,e+1)},findChildInstanceOnNode:function(t){const e=t.getInstances();for(let i=0;i<e.length;i++)if(e[i].oldParent===this)return e[i];return null},onChildInserted:function(t,e){let i=this.findChildInstanceOnNode(t);i?i.addRemoveCounter+=1:i=Na.createFromPool(this.display,this.trail.copy().addDescendant(t,e),!1,!1),this.insertInstance(i,e),this.markSkipPruning()},onChildRemoved:function(t,e){const i=this.findChildInstanceOnNode(t);i.addRemoveCounter-=1,this.instanceRemovalCheckList.push(i),this.removeInstanceWithIndex(i,e),this.markSkipPruning()},onChildrenReordered:function(t,e){this.reorderInstances(t,e),this.markSkipPruning()},onVisibilityChange:function(){this.stitchChangeFrame=this.display._frameId,this.parent&&this.parent.markSkipPruning(),this.visibilityDirty=!0,this.parent&&this.parent.markChildVisibilityDirty()},onOpacityChange:function(){this.markRenderStateDirty()},markChildVisibilityDirty:function(){this.childVisibilityDirty||(this.childVisibilityDirty=!0,this.parent&&this.parent.markChildVisibilityDirty())},updateDrawableFittability:function(t){this.selfDrawable&&this.selfDrawable.setFittable(t),this.groupDrawable&&this.groupDrawable.setFittable(t)},updateVisibility:function(t,e,i){this.visibilityDirty&&(i=!0);const n=this.node.isVisible(),s=this.visible,r=this.relativeVisible,o=this.selfVisible;this.visible=t&&n,this.relativeVisible=e&&n,this.selfVisible=!!this.isVisibilityApplied||this.relativeVisible;const a=this.children.length;for(let l=0;l<a;l++){const t=this.children[l];(i||t.visibilityDirty||t.childVisibilityDirty)&&t.updateVisibility(this.visible,!!this.isVisibilityApplied||this.relativeVisible,i)}this.visibilityDirty=!1,this.childVisibilityDirty=!1,this.visible!==s&&this.visibleEmitter.emit(),this.relativeVisible!==r&&this.relativeVisibleEmitter.emit(),this.selfVisible!==o&&this.selfVisibleEmitter.emit()},getDescendantCount:function(){let t=this.children.length;for(let e=0;e<this.children.length;e++)t+=this.children[e].getDescendantCount();return t},addSVGGroup:function(t){this.svgGroups.push(t)},removeSVGGroup:function(t){const e=_.indexOf(this.svgGroups,t);this.svgGroups.splice(e,1)},lookupSVGGroup:function(t){const e=this.svgGroups.length;for(let i=0;i<e;i++){const e=this.svgGroups[i];if(e.block===t)return e}return null},getFilterRootInstance:function(){return this.isBackbone||this.isInstanceCanvasCache||!this.parent?this:this.parent.getFilterRootInstance()},getTransformRootInstance:function(){return this.isTransformed||!this.parent?this:this.parent.getTransformRootInstance()},getVisibilityRootInstance:function(){return this.isVisibilityApplied||!this.parent?this:this.parent.getVisibilityRootInstance()},attachNodeListeners:function(){this.relativeTransform.attachNodeListeners(),this.isSharedCanvasCachePlaceholder||(this.node.childInsertedEmitter.addListener(this.childInsertedListener),this.node.childRemovedEmitter.addListener(this.childRemovedListener),this.node.childrenReorderedEmitter.addListener(this.childrenReorderedListener),this.node.visibleProperty.lazyLink(this.visibilityListener),this.node.opacityProperty.lazyLink(this.markRenderStateDirtyListener),this.node.clipAreaProperty.lazyLink(this.markRenderStateDirtyListener),this.node.instanceRefreshEmitter.addListener(this.markRenderStateDirtyListener))},detachNodeListeners:function(){this.relativeTransform.detachNodeListeners(),this.isSharedCanvasCachePlaceholder||(this.node.childInsertedEmitter.removeListener(this.childInsertedListener),this.node.childRemovedEmitter.removeListener(this.childRemovedListener),this.node.childrenReorderedEmitter.removeListener(this.childrenReorderedListener),this.node.visibleProperty.unlink(this.visibilityListener),this.node.opacityProperty.unlink(this.markRenderStateDirtyListener),this.node.clipAreaProperty.unlink(this.markRenderStateDirtyListener),this.node.instanceRefreshEmitter.removeListener(this.markRenderStateDirtyListener))},markRenderStateDirty:function(){this.renderStateDirtyFrame=this.display._frameId,this.parent&&this.parent.markSkipPruning()},markSkipPruning:function(){this.skipPruningFrame=this.display._frameId,this.parent&&this.parent.markSkipPruning()},getBranchIndexTo:function(t){const e=this.branchIndexMap[t.id];if(void 0!==e)return e;const i=this.trail.getBranchIndexTo(t.trail);return this.branchIndexMap[t.id]=i,t.branchIndexMap[this.id]=i,this.branchIndexReferences.push(t),t.branchIndexReferences.push(this),i},dispose:function(){for(this.active=!1;this.branchIndexReferences.length;){const t=this.branchIndexReferences.pop();delete this.branchIndexMap[t.id],delete t.branchIndexMap[this.id],q(t.branchIndexReferences,this)}this.groupDrawable&&this.groupDrawable.disposeImmediately(this.display),this.sharedCacheDrawable&&this.sharedCacheDrawable.disposeImmediately(this.display),this.selfDrawable&&this.selfDrawable.disposeImmediately(this.display);const t=this.children.length;for(let e=0;e<t;e++)this.children[e].dispose();for(;this.instanceRemovalCheckList.length;){const t=this.instanceRemovalCheckList.pop();t.active&&t.dispose()}this.stateless||this.detachNodeListeners(),this.node.removeInstance(this),this.sharedCacheInstance&&(this.sharedCacheInstance.externalReferenceCount--,0===this.sharedCacheInstance.externalReferenceCount&&(delete this.display._sharedCanvasInstances[this.node.getId()],this.sharedCacheInstance.dispose())),this.cleanInstance(null,null),this.visibleEmitter.removeAllListeners(),this.relativeVisibleEmitter.removeAllListeners(),this.selfVisibleEmitter.removeAllListeners(),this.freeToPool()},audit:function(t,e){0},auditVisibility:function(t){0},auditChangeIntervals:function(t,e,i,n){if(t){let i=t;for(;i!==e;)i=i.oldNextDrawable}if(i){let t=i;for(;t!==n;)t=t.nextDrawable}},toString:function(){return this.id+"#"+(this.node?(this.node.constructor.name?this.node.constructor.name:"?")+"#"+this.node.id:"-")}}),Pe.mixInto(Na,{initialize:Na.prototype.initialize});var Ra=Na;const Ma=f.byKeys(["DRAG","MULTI_DRAG","KEYBOARD_DRAG"]);function Ba(t,e,i){this.point=t,this.type=i,this.trail=null,this.isDownProperty=new ne(e),this.attachedProperty=new ne(!1),this._listeners=[],this._attachedListener=null,this._cursor=null,this.lastDOMEvent=null,this._intents=[],this._listenerForDragReserve=null,this._listenerForKeyboardDragReserve=null}zn.register("Pointer",Ba),R(Object,Ba,{setCursor:function(t){return this._cursor=t,this},set cursor(t){return this.setCursor(t)},getCursor:function(){return this._cursor},get cursor(){return this.getCursor()},getListeners:function(){return this._listeners.slice()},get listeners(){return this.getListeners()},addInputListener:function(t,e){this._listeners.push(t),e&&this.attach(t)},removeInputListener:function(t){const e=_.indexOf(this._listeners,t);this.isAttached()&&t===this._attachedListener&&this.detach(t),this._listeners.splice(e,1)},isAttached:function(){return this.attachedProperty.value},set isDown(t){this.isDownProperty.value=t},get isDown(){return this.isDownProperty.value},interruptAttached:function(){this.isAttached()&&this._attachedListener.interrupt()},interruptAll:function(){const t=this._listeners.slice();for(let e=0;e<t.length;e++){const i=t[e];i.interrupt&&i.interrupt()}},attach:function(t){this.attachedProperty.value=!0,this._attachedListener=t},detach:function(t){this.attachedProperty.value=!1,this._attachedListener=null},hasPointChanged:function(t){return!(this.point===t||t&&this.point&&this.point.equals(t))},addIntent:function(t){this._intents.includes(t)||this._intents.push(t)},removeIntent:function(t){if(this._intents.includes(t)){const e=this._intents.indexOf(t);this._intents.splice(e,1)}},hasIntent:function(t){return this._intents.includes(t)},reserveForDrag:function(){if(!this._intents.includes(Ma.DRAG)){this.addIntent(Ma.DRAG);const t={up:t=>{this.removeIntent(Ma.DRAG),this.removeInputListener(this._listenerForDragReserve),this._listenerForDragReserve=null}};this._listenerForDragReserve=t,this.addInputListener(this._listenerForDragReserve)}},reserveForKeyboardDrag:function(){if(!this._intents.includes(Ma.KEYBOARD_DRAG)){this.addIntent(Ma.KEYBOARD_DRAG);const t={keyup:t=>e(),blur:t=>e()},e=()=>{this.removeIntent(Ma.KEYBOARD_DRAG),this.removeInputListener(this._listenerForKeyboardDragReserve),this._listenerForKeyboardDragReserve=null};this._listenerForKeyboardDragReserve=t,this.addInputListener(this._listenerForKeyboardDragReserve)}},dispose:function(){this._listeners.indexOf(this._listenerForDragReserve)>=0&&this.removeInputListener(this._listenerForDragReserve),this._listeners.indexOf(this._listenerForKeyboardDragReserve)>=0&&this.removeInputListener(this._listenerForKeyboardDragReserve)}},{Intent:Ma});var Fa=Ba;function Va(){Fa.call(this,null,!1,"mouse"),this.id=null,this.leftDown=!1,this.middleDown=!1,this.rightDown=!1,this.wheelDelta=new qe(0,0,0),this.wheelDeltaMode=0}zn.register("Mouse",Va),R(Fa,Va,{down:function(t,e){const i=this.hasPointChanged(t);switch(this.point=t,this.isDown=!0,e.button){case 0:this.leftDown=!0;break;case 1:this.middleDown=!0;break;case 2:this.rightDown=!0}return i},up:function(t,e){const i=this.hasPointChanged(t);switch(this.point=t,this.isDown=!1,e.button){case 0:this.leftDown=!1;break;case 1:this.middleDown=!1;break;case 2:this.rightDown=!1}return i},move:function(t,e){const i=this.hasPointChanged(t);return this.point=t,i},over:function(t,e){const i=this.hasPointChanged(t);return this.point=t,i},out:function(t,e){const i=this.hasPointChanged(t);return this.point=null,i},wheel:function(t){this.wheelDelta.setXYZ(t.deltaX,t.deltaY,t.deltaZ),this.wheelDeltaMode=t.deltaMode},toString:function(){return"Mouse"}});var Ha=Va;function za(t,e,i){Fa.call(this,e,!0,"pen"),this.id=t}zn.register("Pen",za),R(Fa,za,{move:function(t,e){const i=this.hasPointChanged(t);return this.point=t,i},end:function(t,e){const i=this.hasPointChanged(t);return this.point=t,this.isDown=!1,i},cancel:function(t,e){const i=this.hasPointChanged(t);return this.point=t,this.isDown=!1,i},toString:function(){return"Pen#"+this.id}});var Ga=za;function qa(t,e,i){Fa.call(this,e,!0,"touch"),this.id=t}zn.register("Touch",qa),R(Fa,qa,{move:function(t,e){const i=this.hasPointChanged(t);return this.point=t,i},end:function(t,e){const i=this.hasPointChanged(t);return this.point=t,this.isDown=!1,i},cancel:function(t,e){const i=this.hasPointChanged(t);return this.point=t,this.isDown=!1,i},toString:function(){return"Touch#"+this.id}});var Ya=qa;function Ua(t){this.node=t,this.selfPruned=!1,this.selfInclusive=!1,this.subtreePrunable=!0,this.subtreePickableCount=0,this.mouseInclusiveBounds=Ke.NOTHING.copy(),this.mouseExclusiveBounds=Ke.NOTHING.copy(),this.touchInclusiveBounds=Ke.NOTHING.copy(),this.touchExclusiveBounds=Ke.NOTHING.copy(),this.mouseInclusiveDirty=!0,this.mouseExclusiveDirty=!0,this.touchInclusiveDirty=!0,this.touchExclusiveDirty=!0,this.scratchVector=new je(0,0)}zn.register("Picker",Ua),R(Object,Ua,{hitTest:function(t,e,i){const n=this.selfInclusive;return e?n?this.validateMouseInclusive():this.validateMouseExclusive():i?n?this.validateTouchInclusive():this.validateTouchExclusive():this.node.validateBounds(),this.recursiveHitTest(t,e,i,!1)},recursiveHitTest:function(t,e,i,n){if(n=n||this.selfInclusive,this.selfPruned||!n&&this.subtreePrunable)return null;let s;if(s=e?n?this.mouseInclusiveBounds:this.mouseExclusiveBounds:i?n?this.touchInclusiveBounds:this.touchExclusiveBounds:this.node.bounds,!s.containsPoint(t))return null;const r=this.node._transform.getInverse().multiplyVector2(this.scratchVector.set(t));if(this.node.hasClipArea()&&!this.node.clipArea.containsPoint(r))return null;for(let o=this.node._children.length-1;o>=0;o--){const t=this.node._children[o]._picker.recursiveHitTest(r,e,i,n);if(t)return t.addAncestor(this.node,o)}return e&&this.node._mouseArea?this.node._mouseArea.containsPoint(r)?new Vs(this.node):null:i&&this.node._touchArea?this.node._touchArea.containsPoint(r)?new Vs(this.node):null:this.node.selfBounds.containsPoint(r)&&this.node.containsPointSelf(r)?new Vs(this.node):null},invalidate:function(t,e){let i=!!e||!this.mouseInclusiveDirty||!this.touchInclusiveDirty;if(this.mouseInclusiveDirty=!0,this.touchInclusiveDirty=!0,t&&(i=i||!this.mouseExclusiveDirty||!this.touchExclusiveDirty,this.mouseExclusiveDirty=!0,this.touchExclusiveDirty=!0),!this.selfPruned&&i){const e=this.node._parents;for(let i=0;i<e.length;i++)e[i]._picker.invalidate(t||this.selfInclusive,!1)}},validateMouseInclusive:function(){if(!this.mouseInclusiveDirty)return;this.mouseInclusiveBounds.set(this.node.selfBounds);const t=this.node._children;for(let e=0;e<t.length;e++){const i=t[e]._picker;i.selfPruned||(i.validateMouseInclusive(),this.mouseInclusiveBounds.includeBounds(i.mouseInclusiveBounds))}this.applyAreasAndTransform(this.mouseInclusiveBounds,this.node._mouseArea),this.mouseInclusiveDirty=!1},validateMouseExclusive:function(){if(!this.mouseExclusiveDirty)return;this.mouseExclusiveBounds.set(this.node.selfBounds);const t=this.node._children;for(let e=0;e<t.length;e++){const i=t[e]._picker;i.subtreePrunable||(i.selfInclusive?(i.validateMouseInclusive(),this.mouseExclusiveBounds.includeBounds(i.mouseInclusiveBounds)):(i.validateMouseExclusive(),this.mouseExclusiveBounds.includeBounds(i.mouseExclusiveBounds)))}this.applyAreasAndTransform(this.mouseExclusiveBounds,this.node._mouseArea),this.mouseExclusiveDirty=!1},validateTouchInclusive:function(){if(!this.touchInclusiveDirty)return;this.touchInclusiveBounds.set(this.node.selfBounds);const t=this.node._children;for(let e=0;e<t.length;e++){const i=t[e]._picker;i.selfPruned||(i.validateTouchInclusive(),this.touchInclusiveBounds.includeBounds(i.touchInclusiveBounds))}this.applyAreasAndTransform(this.touchInclusiveBounds,this.node._touchArea),this.touchInclusiveDirty=!1},validateTouchExclusive:function(){if(!this.touchExclusiveDirty)return;this.touchExclusiveBounds.set(this.node.selfBounds);const t=this.node._children;for(let e=0;e<t.length;e++){const i=t[e]._picker;i.subtreePrunable||(i.selfInclusive?(i.validateTouchInclusive(),this.touchExclusiveBounds.includeBounds(i.touchInclusiveBounds)):(i.validateTouchExclusive(),this.touchExclusiveBounds.includeBounds(i.touchExclusiveBounds)))}this.applyAreasAndTransform(this.touchExclusiveBounds,this.node._touchArea),this.touchExclusiveDirty=!1},applyAreasAndTransform:function(t,e){if(e&&t.includeBounds(e.isBounds?e:e.bounds),this.node.hasClipArea()){const e=this.node.clipArea.bounds;t.minX=Math.max(t.minX,e.minX),t.minY=Math.max(t.minY,e.minY),t.maxX=Math.min(t.maxX,e.maxX),t.maxY=Math.min(t.maxY,e.maxY)}this.node.transformBoundsFromLocalToParent(t)},onInsertChild:function(t){if(!t._picker.selfPruned){const e=t._picker.subtreePickableCount>0;e&&this.changePickableCount(1),this.invalidate(e,!0)}},onRemoveChild:function(t){if(!t._picker.selfPruned){const e=t._picker.subtreePickableCount>0;e&&this.changePickableCount(-1),this.invalidate(e,!0)}},onAddInputListener:function(){this.checkSelfInclusive(),this.checkSubtreePrunable(),this.changePickableCount(1)},onRemoveInputListener:function(){this.checkSelfInclusive(),this.checkSubtreePrunable(),this.changePickableCount(-1)},onPickableChange:function(t,e){this.checkSelfPruned(),this.checkSelfInclusive(),this.checkSubtreePrunable();const i=(!0===t?-1:0)+(!0===e?1:0);i&&this.changePickableCount(i)},onVisibilityChange:function(){this.checkSelfPruned(),this.checkSubtreePrunable()},onMouseAreaChange:function(){this.invalidate(!0)},onTouchAreaChange:function(){this.invalidate(!0)},onTransformChange:function(){this.invalidate(!0)},onSelfBoundsDirty:function(){this.invalidate(!0)},onClipAreaChange:function(){this.invalidate(!0)},checkSelfPruned:function(){const t=!1===this.node.pickableProperty.value||!this.node.isVisible();if(this.selfPruned!==t){this.selfPruned=t;const e=this.node._parents;for(let t=0;t<e.length;t++){const i=e[t]._picker;this.subtreePickableCount>0?(i.invalidate(!0,!0),i.changePickableCount(this.selfPruned?-1:1)):i.invalidate(!1,!0)}}},checkSelfInclusive:function(){const t=!0===this.node.pickableProperty.value||this.node._inputListeners.length>0;this.selfInclusive!==t&&(this.selfInclusive=t,this.invalidate(!0,!0))},checkSubtreePrunable:function(){const t=!1===this.node.pickableProperty.value||!this.node.isVisible()||!0!==this.node.pickableProperty.value&&0===this.subtreePickableCount;this.subtreePrunable!==t&&(this.subtreePrunable=t,this.invalidate(!0,!0))},changePickableCount:function(t){if(0===t)return;const e=0===this.subtreePickableCount;this.subtreePickableCount+=t;const i=0===this.subtreePickableCount;if(this.checkSubtreePrunable(),!this.selfPruned&&e!==i){const t=this.node._parents.length;for(let i=0;i<t;i++)this.node._parents[i]._picker.changePickableCount(e?1:-1)}},audit:function(){0}});var ja=Ua;const Wa=[jn.bitmaskCanvas,jn.bitmaskSVG,jn.bitmaskDOM,jn.bitmaskWebGL,jn.bitmaskSingleCanvas,jn.bitmaskSingleSVG,jn.bitmaskNotPainted,jn.bitmaskBoundsValid,jn.bitmaskNotAccessible,jn.bitmaskLacksCanvas,jn.bitmaskLacksSVG,jn.bitmaskLacksDOM,jn.bitmaskLacksWebGL],Xa=Wa.length;let Ka=0;for(let _=0;_<Xa;_++)Ka|=Wa[_];function Qa(t){this.node=t,this._counts={};for(let i=0;i<Xa;i++)this._counts[Wa[i]]=0;this.bitmask=Ka,this.selfBitmask=Qa.summaryBitmaskForNodeSelf(t),this.summaryChange(this.bitmask,this.selfBitmask);const e=this.selfChange.bind(this);this.node.opacityProperty.lazyLink(e),this.node.clipAreaProperty.lazyLink(e),this.node.rendererSummaryRefreshEmitter.addListener(e)}zn.register("RendererSummary",Qa),R(Object,Qa,{summaryChange:function(t,e){const i=t^e;let n=0,s=0;for(let r=0;r<Xa;r++){const t=Wa[r];t&i&&(t&e?(this._counts[t]--,0===this._counts[t]&&(s|=t)):(this._counts[t]++,1===this._counts[t]&&(n|=t)))}if(n||s){const t=this.bitmask;for(let i=0;i<Xa;i++){const t=Wa[i];s&t&&(this.bitmask|=t),n&t&&(this.bitmask^=t)}this.node.instanceRefreshEmitter.emit(),this.node.onSummaryChange(t,this.bitmask);const e=this.node._parents.length;for(let i=0;i<e;i++)this.node._parents[i]._rendererSummary.summaryChange(n,s)}},selfChange:function(){const t=this.selfBitmask,e=Qa.summaryBitmaskForNodeSelf(this.node);t!==e&&(this.summaryChange(t,e),this.selfBitmask=e)},computeBitmask:function(){let t=0;for(let e=0;e<Xa;e++)0===this._counts[Wa[e]]&&(t|=Wa[e]);return t},isSubtreeFullyCompatible:function(t){return!!(t&this.bitmask)},isSubtreeContainingCompatible:function(t){return!(t<<jn.bitmaskLacksShift&this.bitmask)},isSingleCanvasSupported:function(){return!!(jn.bitmaskSingleCanvas&this.bitmask)},isSingleSVGSupported:function(){return!!(jn.bitmaskSingleSVG&this.bitmask)},isNotPainted:function(){return!!(jn.bitmaskNotPainted&this.bitmask)},isNotAccessible:function(){return!!(jn.bitmaskNotAccessible&this.bitmask)},areBoundsValid:function(){return!!(jn.bitmaskBoundsValid&this.bitmask)},isSubtreeRenderedExclusivelySVG:function(t){if(!this.isSingleSVGSupported())return!1;for(let e=0;e<jn.numActiveRenderers;e++){const i=jn.bitmaskOrder(t,e);if(jn.bitmaskSVG&i)return!0;if(this.isSubtreeContainingCompatible(i))return!1}return!1},isSubtreeRenderedExclusivelyCanvas:function(t){if(!this.isSingleCanvasSupported())return!1;for(let e=0;e<jn.numActiveRenderers;e++){const i=jn.bitmaskOrder(t,e);if(jn.bitmaskCanvas&i)return!0;if(this.isSubtreeContainingCompatible(i))return!1}return!1},audit:function(){0},toString:function(){let t=Qa.bitmaskToString(this.bitmask);for(let e=0;e<Xa;e++){const i=Wa[e],n=this._counts[i];0!==n&&(t+=" "+Qa.bitToString(i)+":"+n)}return t}},{bitmaskAll:Ka,summaryBitmaskForNodeSelf:function(t){let e=t._rendererBitmask;t.isPainted()?e|=(t._rendererBitmask&jn.bitmaskCurrentRendererArea^jn.bitmaskCurrentRendererArea)<<jn.bitmaskLacksShift:e|=jn.bitmaskCurrentRendererArea<<jn.bitmaskLacksShift;const i=t._hints.requireElement||t._hints.cssTransform||t._hints.layerSplit,n=t._hints.renderer;return i||!jn.isSVG(t._rendererBitmask)||n&&!jn.isSVG(n)||(e|=jn.bitmaskSingleSVG),i||!jn.isCanvas(t._rendererBitmask)||n&&!jn.isCanvas(n)||(e|=jn.bitmaskSingleCanvas),t.isPainted()||(e|=jn.bitmaskNotPainted),t.areSelfBoundsValid()&&(e|=jn.bitmaskBoundsValid),t.accessibleContent||t.hasAccessibleOrder()||(e|=jn.bitmaskNotAccessible),e},bitToString:function(t){return t===jn.bitmaskCanvas?"Canvas":t===jn.bitmaskSVG?"SVG":t===jn.bitmaskDOM?"DOM":t===jn.bitmaskWebGL?"WebGL":t===jn.bitmaskLacksCanvas?"(-Canvas)":t===jn.bitmaskLacksSVG?"(-SVG)":t===jn.bitmaskLacksDOM?"(-DOM)":t===jn.bitmaskLacksWebGL?"(-WebGL)":t===jn.bitmaskSingleCanvas?"SingleCanvas":t===jn.bitmaskSingleSVG?"SingleSVG":t===jn.bitmaskNotPainted?"NotPainted":t===jn.bitmaskBoundsValid?"BoundsValid":t===jn.bitmaskNotAccessible?"NotAccessible":"?"},bitmaskToString:function(t){let e="";for(let i=0;i<Xa;i++){const n=Wa[i];t&n&&(e+=Qa.bitToString(n)+" ")}return e}});var Za=Qa;class $a extends Yt{constructor(t,e,i,n){n=h({readOnly:!1},n),super(t[i],n),this.node=t,this.property=e,this.attribute=i,this.nodePropertyReadOnly=n.readOnly,this.changeListener=()=>this.set(t[i]),this.property.lazyLink(this.changeListener)}dispose(){this.property.unlink(this.changeListener),super.dispose(),this.node=null}setPropertyValue(t){this.nodePropertyReadOnly||(this.node[this.attribute]=t),super.setPropertyValue(t)}}zn.register("NodeProperty",$a);var Ja=$a;class tl extends T{constructor(t,e){super(t,e);const i=new Ja(t,t.pickableProperty,"pickable",h({phetioReadOnly:t.phetioReadOnly,tandem:t.tandem.createTandem("pickableProperty"),phetioType:te(kt(D)),phetioDocumentation:"Sets whether the node will be pickable (and hence interactive), see the NodeIO documentation for more details"},t.phetioComponentOptions,t.phetioComponentOptions.pickableProperty)),n=new Ce(t.opacity,h({phetioReadOnly:t.phetioReadOnly,tandem:t.tandem.createTandem("opacityProperty"),range:new ge(0,1),phetioDocumentation:"Opacity of the parent NodeIO, between 0 (invisible) and 1 (fully visible)"},t.phetioComponentOptions,t.phetioComponentOptions.opacityProperty));n.link((function(e){t.opacity=e})),t.opacityProperty.lazyLink(()=>{n.value=t.opacity}),this.disposeNodeIO=function(){i.dispose(),n.dispose()}}dispose(){this.disposeNodeIO()}}tl.methods={moveForward:{returnType:Qt,parameterTypes:[],implementation:function(){return this.phetioObject.moveForward()},documentation:"Move this node one index forward in each of its parents.  If the node is already at the front, this is a no-op."},moveBackward:{returnType:Qt,parameterTypes:[],implementation:function(){return this.phetioObject.moveBackward()},documentation:"Move this node one index backward in each of its parents.  If the node is already at the back, this is a no-op."}},tl.validator={valueType:zn.Node},tl.documentation='The base type for graphical and potentially interactive objects.  NodeIO has nested PropertyIO values for visibility, pickability and opacity.<br><br>Pickable can take one of three values:<br><ul><li>null: pass-through behavior. Nodes with input listeners are pickable, but nodes without input listeners won\'t block events for nodes behind it.</li><li>false: The node cannot be interacted with, and it blocks events for nodes behind it.</li><li>true: The node can be interacted with (if it has an input listener).</li></ul>For more about Scenery node pickability, please see <a href="http://phetsims.github.io/scenery/doc/implementation-notes#pickability">http://phetsims.github.io/scenery/doc/implementation-notes#pickability</a>',tl.typeName="NodeIO",T.validateSubtype(tl),zn.register("NodeIO",tl);var el=tl;const il=Be.clamp;let nl=1;const sl=Ke.NOTHING.copy(),rl=new oi,ol={visible:!0,opacity:1,pickable:null,inputEnabled:!0,clipArea:null,mouseArea:null,touchArea:null,cursor:null,transformBounds:!1,maxWidth:null,maxHeight:null,renderer:null,usesOpacity:!1,layerSplit:!1,cssTransform:!1,excludeInvisible:!1,webglScale:null,preventFit:!1};function al(t){this._id=nl++,this._instances=[],this._rootedDisplays=[],this._drawables=[],this._visibleProperty=new ks(ol.visible),this._visibleProperty.lazyLink(this.onVisiblePropertyChange.bind(this)),this.opacityProperty=new qn(ol.opacity),this.pickableProperty=new qn(ol.pickable),this.inputEnabledProperty=new qn(ol.inputEnabled),this.clipAreaProperty=new qn(ol.clipArea),this._mouseArea=ol.mouseArea,this._touchArea=ol.touchArea,this._cursor=ol.cursor,this._children=[],this._parents=[],this._transformBounds=ol.transformBounds,this._transform=new hi,this._transformListener=this.onTransformChange.bind(this),this._transform.changeEmitter.addListener(this._transformListener),this._maxWidth=ol.maxWidth,this._maxHeight=ol.maxHeight,this._appliedScaleFactor=1,this._inputListeners=[];const e=this.onBoundsListenersAddedOrRemoved.bind(this),i=this.validateBounds.bind(this),n=this.validateSelfBounds.bind(this);this.boundsProperty=new Os(Ke.NOTHING.copy()),this.boundsProperty.onAccessAttempt=i,this.boundsProperty.changeCount=e,this.localBoundsProperty=new Os(Ke.NOTHING.copy()),this.localBoundsProperty.onAccessAttempt=i,this.localBoundsProperty.changeCount=e,this.childBoundsProperty=new Os(Ke.NOTHING.copy()),this.childBoundsProperty.onAccessAttempt=i,this.childBoundsProperty.changeCount=e,this.selfBoundsProperty=new Os(Ke.NOTHING.copy()),this.selfBoundsProperty.onAccessAttempt=n,this._localBoundsOverridden=!1,this._excludeInvisibleChildrenFromBounds=!1,this._boundsDirty=!0,this._localBoundsDirty=!0,this._selfBoundsDirty=!0,this._childBoundsDirty=!0,this._hints={renderer:null===ol.renderer?0:jn.fromName(ol.renderer),usesOpacity:ol.usesOpacity,layerSplit:ol.layerSplit,cssTransform:ol.cssTransform,fullResolution:!1,excludeInvisible:ol.excludeInvisible,webglScale:ol.webglScale,preventFit:ol.preventFit},this.childrenChangedEmitter=new C,this.childInsertedEmitter=new C,this.childRemovedEmitter=new C,this.childrenReorderedEmitter=new C,this.transformEmitter=new C,this.instanceRefreshEmitter=new C,this.rendererSummaryRefreshEmitter=new C,this.accessibleDisplaysEmitter=new C,this.focusHighlightChangedEmitter=new C,this.changedInstanceEmitter=new C,this.initializeAccessibility(),this._rendererBitmask=jn.bitmaskNodeDefault,this._rendererSummary=new Za(this),this._boundsEventCount=0,this._boundsEventSelfCount=0,this._picker=new ja(this),this._isGettingRemovedFromParent=!1,Et.call(this),t&&this.mutate(t)}zn.register("Node",al),R(Et,al,{_mutatorKeys:["children","cursor","visibleProperty","visible","pickable","inputEnabled","inputListeners","opacity","matrix","translation","x","y","rotation","scale","excludeInvisibleChildrenFromBounds","localBounds","maxWidth","maxHeight","leftTop","centerTop","rightTop","leftCenter","center","rightCenter","leftBottom","centerBottom","rightBottom","left","right","top","bottom","centerX","centerY","renderer","layerSplit","usesOpacity","cssTransform","excludeInvisible","webglScale","preventFit","mouseArea","touchArea","clipArea","transformBounds"],drawableMarkFlags:[],insertChild:function(t,e,i){return this._picker.onInsertChild(e),this.changeBoundsEventCount(e._boundsEventCount>0?1:0),this._rendererSummary.summaryChange(Za.bitmaskAll,e._rendererSummary.bitmask),e._parents.push(this),this._children.splice(t,0,e),e._rendererSummary.isNotAccessible()||this.onAccessibleAddChild(e),e.invalidateBounds(),this._boundsDirty=!0,this.childInsertedEmitter.emit(e,t),!i&&this.childrenChangedEmitter.emit(),this},addChild:function(t,e){return this.insertChild(this._children.length,t,e),this},removeChild:function(t,e){const i=_.indexOf(this._children,t);return this.removeChildWithIndex(t,i,e),this},removeChildAt:function(t,e){const i=this._children[t];return this.removeChildWithIndex(i,t,e),this},removeChildWithIndex:function(t,e,i){const n=_.indexOf(t._parents,this);t._isGettingRemovedFromParent=!0,t._rendererSummary.isNotAccessible()||this.onAccessibleRemoveChild(t),this._picker.onRemoveChild(t),this.changeBoundsEventCount(t._boundsEventCount>0?-1:0),this._rendererSummary.summaryChange(t._rendererSummary.bitmask,Za.bitmaskAll),t._parents.splice(n,1),this._children.splice(e,1),t._isGettingRemovedFromParent=!1,this.invalidateBounds(),this._childBoundsDirty=!0,this.childRemovedEmitter.emit(t,e),!i&&this.childrenChangedEmitter.emit()},moveChildToIndex:function(t,e){const i=this.indexOfChild(t);return this._children[e]!==t&&(this._children.splice(i,1),this._children.splice(e,0,t),this._rendererSummary.isNotAccessible()||this.onAccessibleReorderedChildren(),this.childrenReorderedEmitter.emit(Math.min(i,e),Math.max(i,e)),this.childrenChangedEmitter.emit()),this},removeAllChildren:function(){return this.setChildren([]),this},setChildren:function(t){const e=[],i=[],n=[];let s;for(Rs(t,this._children,i,e,n),s=e.length-1;s>=0;s--)this.removeChild(e[s],!0);let r=-1,o=-1;for(s=0;s<n.length;s++){const t=n[s];this._children[s]!==t&&(this._children[s]=t,-1===r&&(r=s),o=s)}const a=-1!==r;if(a&&(this._rendererSummary.isNotAccessible()||this.onAccessibleReorderedChildren(),this.childrenReorderedEmitter.emit(r,o)),i.length){let e=0,n=i[e];for(s=0;s<t.length;s++)t[s]===n&&(this.insertChild(s,n,!0),n=i[++e])}return(0!==e.length||0!==i.length||a)&&this.childrenChangedEmitter.emit(),this},set children(t){this.setChildren(t)},getChildren:function(){return this._children.slice(0)},get children(){return this.getChildren()},getChildrenCount:function(){return this._children.length},getParents:function(){return this._parents.slice(0)},get parents(){return this.getParents()},getParent:function(){return this._parents.length?this._parents[0]:null},get parent(){return this.getParent()},getChildAt:function(t){return this._children[t]},indexOfParent:function(t){return _.indexOf(this._parents,t)},indexOfChild:function(t){return _.indexOf(this._children,t)},moveToFront:function(){const t=this;return _.each(this._parents.slice(),(function(e){e.moveChildToFront(t)})),this},moveChildToFront:function(t){return this.moveChildToIndex(t,this._children.length-1)},moveForward:function(){return this._parents.forEach(t=>t.moveChildForward(this)),this},moveChildForward:function(t){const e=this.indexOfChild(t);return e<this.getChildrenCount()-1&&this.moveChildToIndex(t,e+1),this},moveBackward:function(){return this._parents.forEach(t=>t.moveChildBackward(this)),this},moveChildBackward:function(t){const e=this.indexOfChild(t);return e>0&&this.moveChildToIndex(t,e-1),this},moveToBack:function(){const t=this;return _.each(this._parents.slice(),(function(e){e.moveChildToBack(t)})),this},moveChildToBack:function(t){return this.moveChildToIndex(t,0)},replaceChild:function(t,e){const i=this.indexOfChild(t),n=t.focused;return this.removeChild(t,!0),this.insertChild(i,e,!0),this.childrenChangedEmitter.emit(),n&&e.focusable&&e.focus(),this},detach:function(){const t=this;return _.each(this._parents.slice(0),(function(e){e.removeChild(t)})),this},changeBoundsEventCount:function(t){if(0!==t){const e=0===this._boundsEventCount;if(this._boundsEventCount+=t,e!==(0===this._boundsEventCount)){const t=e?1:-1,i=this._parents.length;for(let e=0;e<i;e++)this._parents[e].changeBoundsEventCount(t)}}},validateSelfBounds:function(){if(this._selfBoundsDirty){const t=sl.set(this.selfBoundsProperty._value),e=this.updateSelfBounds();return this._selfBoundsDirty=!1,e&&this.selfBoundsProperty.notifyListeners(t),!0}return!1},validateBounds:function(){let t;let e=this.validateSelfBounds();const i=this.childBoundsProperty._value,n=this.localBoundsProperty._value,s=this.selfBoundsProperty._value,r=this.boundsProperty._value;if(this._childBoundsDirty){for(e=!0,t=this._children.length;t--;)this._children[t].validateBounds();const n=sl.set(i);for(i.set(Ke.NOTHING),t=this._children.length;t--;){const e=this._children[t];this._excludeInvisibleChildrenFromBounds&&!e.isVisible()||i.includeBounds(e.bounds)}this._childBoundsDirty=!1,i.equals(n)||i.equalsEpsilon(n,1e-13)||this.childBoundsProperty.notifyListeners(n)}if(this._localBoundsDirty&&!this._localBoundsOverridden){e=!0,this._localBoundsDirty=!1;const t=sl.set(n);n.set(s).includeBounds(i),this.hasClipArea()&&n.constrainBounds(this.clipArea.bounds),n.equals(t)||(n.equalsEpsilon(t,1e-13)||this.localBoundsProperty.notifyListeners(t),this._boundsDirty=!0),null===this._maxWidth&&null===this._maxHeight||this.updateMaxDimension(n)}if(this._boundsDirty){e=!0,this._boundsDirty=!1;const i=sl.set(r);if(this._transformBounds&&!this._transform.getMatrix().isAxisAligned()){const t=rl.set(this.getMatrix());r.set(Ke.NOTHING),this._includeTransformedSubtreeBounds(t,r),this.hasClipArea()&&r.constrainBounds(this.clipArea.getBoundsWithTransform(t))}else r.set(n),this.transformBoundsFromLocalToParent(r);if(!r.equals(i)){for(t=this._parents.length;t--;)this._parents[t].invalidateBounds();r.equalsEpsilon(i,1e-13)||this.boundsProperty.notifyListeners(i)}}return(this._childBoundsDirty||this._boundsDirty)&&this.validateBounds(),e},_includeTransformedSubtreeBounds:function(t,e){this.selfBounds.isEmpty()||e.includeBounds(this.getTransformedSelfBounds(t));const i=this._children.length;for(let n=0;n<i;n++){const i=this._children[n];t.multiplyMatrix(i._transform.getMatrix()),i._includeTransformedSubtreeBounds(t,e),t.multiplyMatrix(i._transform.getInverse())}return e},validateWatchedBounds:function(){for(;this.watchedBoundsScan(););},watchedBoundsScan:function(){if(0!==this._boundsEventSelfCount)return this.validateBounds();if(this._boundsEventCount>0&&this._childBoundsDirty){let t=!1;const e=this._children.length;for(let i=0;i<e;i++)t=this._children[i].watchedBoundsScan()||t;return t}return!1},invalidateBounds:function(){this._boundsDirty=!0,this._localBoundsDirty=!0;let t=this._parents.length;for(;t--;)this._parents[t].invalidateChildBounds()},invalidateChildBounds:function(){if(!this._childBoundsDirty){this._childBoundsDirty=!0,this._localBoundsDirty=!0;let t=this._parents.length;for(;t--;)this._parents[t].invalidateChildBounds()}},invalidateSelf:function(t){const e=this.selfBoundsProperty._value;if(t){if(this._selfBoundsDirty=!1,!e.equals(t)){const i=sl.set(e);this.invalidateBounds(),this._picker.onSelfBoundsDirty(),e.set(t),this.selfBoundsProperty.notifyListeners(i)}}else this._selfBoundsDirty=!0,this.invalidateBounds(),this._picker.onSelfBoundsDirty()},updateSelfBounds:function(){return!1},hasChild:function(t){const e=_.includes(this._children,t);return e},getSelfShape:function(){return this.selfBounds.isEmpty()?new En:En.bounds(this.selfBounds)},getSelfBounds:function(){return this.selfBoundsProperty.value},get selfBounds(){return this.getSelfBounds()},getSafeSelfBounds:function(){return this.selfBoundsProperty.value},get safeSelfBounds(){return this.getSafeSelfBounds()},getChildBounds:function(){return this.childBoundsProperty.value},get childBounds(){return this.getChildBounds()},getLocalBounds:function(){return this.localBoundsProperty.value},get localBounds(){return this.getLocalBounds()},setLocalBounds:function(t){const e=this.localBoundsProperty._value;if(null===t)this._localBoundsOverridden&&(this._localBoundsOverridden=!1,this.invalidateBounds());else{const i=!t.equals(e)||!this._localBoundsOverridden;i&&e.set(t),this._localBoundsOverridden||(this._localBoundsOverridden=!0),i&&this.invalidateBounds()}return this},set localBounds(t){return this.setLocalBounds(t)},getTransformedSelfBounds:function(t){return this.selfBounds.transformed(t)},getTransformedSafeSelfBounds:function(t){return this.safeSelfBounds.transformed(t)},getSafeTransformedVisibleBounds:function(t){const e=(t||oi.IDENTITY).timesMatrix(this.matrix),i=Ke.NOTHING.copy();if(this.visibleProperty.value&&(this.selfBounds.isEmpty()||i.includeBounds(this.getTransformedSafeSelfBounds(e)),this._children.length))for(let n=0;n<this._children.length;n++)i.includeBounds(this._children[n].getSafeTransformedVisibleBounds(e));return i},get safeTransformedVisibleBounds(){return this.getSafeTransformedVisibleBounds()},setTransformBounds:function(t){return this._transformBounds!==t&&(this._transformBounds=t,this.invalidateBounds()),this},set transformBounds(t){return this.setTransformBounds(t)},getTransformBounds:function(){return this._transformBounds},get transformBounds(){return this.getTransformBounds()},getBounds:function(){return this.boundsProperty.value},get bounds(){return this.getBounds()},getVisibleLocalBounds:function(){const t=this.selfBounds.copy();let e=this._children.length;for(;e--;){const i=this._children[e];i.isVisible()&&t.includeBounds(i.getVisibleBounds())}return t},get visibleLocalBounds(){return this.getVisibleLocalBounds()},getVisibleBounds:function(){return this.getVisibleLocalBounds().transform(this.getMatrix())},get visibleBounds(){return this.getVisibleBounds()},hitTest:function(t,e,i){return this._picker.hitTest(t,!!e,!!i)},trailUnderPointer:function(t){return this.hitTest(t.point,t instanceof Ha,t instanceof Ya||t instanceof Ga)},containsPoint:function(t){return null!==this.hitTest(t)},containsPointSelf:function(t){return this.selfBounds.containsPoint(t)},intersectsBoundsSelf:function(t){return this.selfBounds.intersectsBounds(t)},isPainted:function(){return!1},areSelfBoundsValid:function(){return!0},hasParent:function(){return 0!==this._parents.length},hasChildren:function(){return this._children.length>0},isChildIncludedInLayout:function(t){return t.bounds.isValid()&&(!this._excludeInvisibleChildrenFromBounds||t.visible)},walkDepthFirst:function(t){t(this);const e=this._children.length;for(let i=0;i<e;i++)this._children[i].walkDepthFirst(t)},addInputListener:function(t){return _.includes(this._inputListeners,t)||(this._inputListeners.push(t),this._picker.onAddInputListener()),this},removeInputListener:function(t){const e=_.indexOf(this._inputListeners,t);return e>=0&&(this._inputListeners.splice(e,1),this._picker.onRemoveInputListener()),this},hasInputListener:function(t){for(let e=0;e<this._inputListeners.length;e++)if(this._inputListeners[e]===t)return!0;return!1},interruptInput:function(){const t=this.inputListeners;for(let e=0;e<t.length;e++){const i=t[e];i.interrupt&&i.interrupt()}return this},interruptSubtreeInput:function(){this.interruptInput();const t=this._children.slice();for(let e=0;e<t.length;e++)t[e].interruptSubtreeInput();return this},translate:function(t,e,i){if("number"==typeof t){if(!t&&!e)return;i?this.prependTranslation(t,e):this.appendMatrix(rl.setToTranslation(t,e))}else{const i=t;if(!i.x&&!i.y)return;this.translate(i.x,i.y,e)}},scale:function(t,e,i){if("number"==typeof t)if(void 0===e||"boolean"==typeof e)this.scale(t,t,e);else{if(1===t&&1===e)return;i?this.prependMatrix(oi.scaling(t,e)):this.appendMatrix(oi.scaling(t,e))}else{const i=t;this.scale(i.x,i.y,e)}},rotate:function(t,e){t%(2*Math.PI)!=0&&(e?this.prependMatrix(oi.rotation2(t)):this.appendMatrix(oi.rotation2(t)))},rotateAround:function(t,e){let i=oi.translation(-t.x,-t.y);return i=oi.rotation2(e).timesMatrix(i),i=oi.translation(t.x,t.y).timesMatrix(i),this.prependMatrix(i),this},setX:function(t){return this.translate(t-this.getX(),0,!0),this},set x(t){this.setX(t)},getX:function(){return this._transform.getMatrix().m02()},get x(){return this.getX()},setY:function(t){return this.translate(0,t-this.getY(),!0),this},set y(t){this.setY(t)},getY:function(){return this._transform.getMatrix().m12()},get y(){return this.getY()},setScaleMagnitude:function(t,e){const i=this.getScaleVector();return"number"==typeof t?(void 0===e&&(e=t),this.appendMatrix(oi.scaling(t/i.x,e/i.y))):this.appendMatrix(oi.scaling(t.x/i.x,t.y/i.y)),this},getScaleVector:function(){return this._transform.getMatrix().getScaleVector()},setRotation:function(t){return this.appendMatrix(rl.setToRotationZ(t-this.getRotation())),this},set rotation(t){this.setRotation(t)},getRotation:function(){return this._transform.getMatrix().getRotation()},get rotation(){return this.getRotation()},setTranslation:function(t,e){const i=this._transform.getMatrix(),n=i.m02(),s=i.m12();let r,o;return"number"==typeof t?(r=t-n,o=e-s):(r=t.x-n,o=t.y-s),this.translate(r,o,!0),this},set translation(t){this.setTranslation(t)},getTranslation:function(){const t=this._transform.getMatrix();return new je(t.m02(),t.m12())},get translation(){return this.getTranslation()},appendMatrix:function(t){this._transform.append(t)},prependMatrix:function(t){this._transform.prepend(t)},prependTranslation:function(t,e){(t||e)&&this._transform.prependTranslation(t,e)},setMatrix:function(t){this._transform.setMatrix(t)},set matrix(t){this.setMatrix(t)},getMatrix:function(){return this._transform.getMatrix()},get matrix(){return this.getMatrix()},getTransform:function(){return this._transform},get transform(){return this.getTransform()},resetTransform:function(){this.setMatrix(oi.IDENTITY)},onTransformChange:function(){this.invalidateBounds(),this._picker.onTransformChange(),this.transformEmitter.emit()},onSummaryChange:function(t,e){this._accessibleDisplaysInfo.onSummaryChange(t,e)},updateMaxDimension:function(t){const e=this._appliedScaleFactor;let i=1;if(null!==this._maxWidth){const e=t.width;e>this._maxWidth&&(i=Math.min(i,this._maxWidth/e))}if(null!==this._maxHeight){const e=t.height;e>this._maxHeight&&(i=Math.min(i,this._maxHeight/e))}const n=i/e;1!==n&&(this.scale(n),this._appliedScaleFactor=i)},onMaxDimensionChange:function(t,e){null===t&&null!==e?(this.changeBoundsEventCount(1),this._boundsEventSelfCount++):null!==t&&null===e&&(this.changeBoundsEventCount(-1),this._boundsEventSelfCount--)},setMaxWidth:function(t){this._maxWidth!==t&&(this.onMaxDimensionChange(this._maxWidth,t),this._maxWidth=t,this.updateMaxDimension(this.localBoundsProperty.value))},set maxWidth(t){this.setMaxWidth(t)},getMaxWidth:function(){return this._maxWidth},get maxWidth(){return this.getMaxWidth()},setMaxHeight:function(t){this._maxHeight!==t&&(this.onMaxDimensionChange(this._maxHeight,t),this._maxHeight=t,this.updateMaxDimension(this.localBoundsProperty.value))},set maxHeight(t){this.setMaxHeight(t)},getMaxHeight:function(){return this._maxHeight},get maxHeight(){return this.getMaxHeight()},setLeft:function(t){const e=this.getLeft();return isFinite(e)&&this.translate(t-e,0,!0),this},set left(t){this.setLeft(t)},getLeft:function(){return this.getBounds().minX},get left(){return this.getLeft()},setRight:function(t){const e=this.getRight();return isFinite(e)&&this.translate(t-e,0,!0),this},set right(t){this.setRight(t)},getRight:function(){return this.getBounds().maxX},get right(){return this.getRight()},setCenterX:function(t){const e=this.getCenterX();return isFinite(e)&&this.translate(t-e,0,!0),this},set centerX(t){this.setCenterX(t)},getCenterX:function(){return this.getBounds().getCenterX()},get centerX(){return this.getCenterX()},setCenterY:function(t){const e=this.getCenterY();return isFinite(e)&&this.translate(0,t-e,!0),this},set centerY(t){this.setCenterY(t)},getCenterY:function(){return this.getBounds().getCenterY()},get centerY(){return this.getCenterY()},setTop:function(t){const e=this.getTop();return isFinite(e)&&this.translate(0,t-e,!0),this},set top(t){this.setTop(t)},getTop:function(){return this.getBounds().minY},get top(){return this.getTop()},setBottom:function(t){const e=this.getBottom();return isFinite(e)&&this.translate(0,t-e,!0),this},set bottom(t){this.setBottom(t)},getBottom:function(){return this.getBounds().maxY},get bottom(){return this.getBottom()},setLeftTop:function(t){const e=this.getLeftTop();return e.isFinite()&&this.translate(t.minus(e),!0),this},set leftTop(t){this.setLeftTop(t)},getLeftTop:function(){return this.getBounds().getLeftTop()},get leftTop(){return this.getLeftTop()},setCenterTop:function(t){const e=this.getCenterTop();return e.isFinite()&&this.translate(t.minus(e),!0),this},set centerTop(t){this.setCenterTop(t)},getCenterTop:function(){return this.getBounds().getCenterTop()},get centerTop(){return this.getCenterTop()},setRightTop:function(t){const e=this.getRightTop();return e.isFinite()&&this.translate(t.minus(e),!0),this},set rightTop(t){this.setRightTop(t)},getRightTop:function(){return this.getBounds().getRightTop()},get rightTop(){return this.getRightTop()},setLeftCenter:function(t){const e=this.getLeftCenter();return e.isFinite()&&this.translate(t.minus(e),!0),this},set leftCenter(t){this.setLeftCenter(t)},getLeftCenter:function(){return this.getBounds().getLeftCenter()},get leftCenter(){return this.getLeftCenter()},setCenter:function(t){const e=this.getCenter();return e.isFinite()&&this.translate(t.minus(e),!0),this},set center(t){this.setCenter(t)},getCenter:function(){return this.getBounds().getCenter()},get center(){return this.getCenter()},setRightCenter:function(t){const e=this.getRightCenter();return e.isFinite()&&this.translate(t.minus(e),!0),this},set rightCenter(t){this.setRightCenter(t)},getRightCenter:function(){return this.getBounds().getRightCenter()},get rightCenter(){return this.getRightCenter()},setLeftBottom:function(t){const e=this.getLeftBottom();return e.isFinite()&&this.translate(t.minus(e),!0),this},set leftBottom(t){this.setLeftBottom(t)},getLeftBottom:function(){return this.getBounds().getLeftBottom()},get leftBottom(){return this.getLeftBottom()},setCenterBottom:function(t){const e=this.getCenterBottom();return e.isFinite()&&this.translate(t.minus(e),!0),this},set centerBottom(t){this.setCenterBottom(t)},getCenterBottom:function(){return this.getBounds().getCenterBottom()},get centerBottom(){return this.getCenterBottom()},setRightBottom:function(t){const e=this.getRightBottom();return e.isFinite()&&this.translate(t.minus(e),!0),this},set rightBottom(t){this.setRightBottom(t)},getRightBottom:function(){return this.getBounds().getRightBottom()},get rightBottom(){return this.getRightBottom()},getWidth:function(){return this.getBounds().getWidth()},get width(){return this.getWidth()},getHeight:function(){return this.getBounds().getHeight()},get height(){return this.getHeight()},getId:function(){return this._id},get id(){return this.getId()},onVisiblePropertyChange:function(t){this._picker.onVisibilityChange(),this._accessibleDisplaysInfo.onVisibilityChange(t);for(let e=0;e<this._parents.length;e++){const t=this._parents[e];t._excludeInvisibleChildrenFromBounds&&t.invalidateChildBounds()}},linkVisibleProperty(t){this.addLinkedElement(t,{tandem:this.tandem.createTandem("visibleProperty")})},set visibleProperty(t){this.visibleProperty.forwardingProperty&&this.visibleProperty.forwardingProperty.isPhetioInstrumented();this._visibleProperty.setForwardingProperty(t),this.phetioVisibleProperty&&(this.phetioVisibleProperty.dispose(),this.phetioVisibleProperty=null,this.linkVisibleProperty(t))},get visibleProperty(){return this._visibleProperty},setVisible:function(t){return this.visibleProperty.set(t),this},set visible(t){this.setVisible(t)},isVisible:function(){return this.visibleProperty.value},get visible(){return this.isVisible()},swapVisibility:function(t){const e=this.visible?this:t,i=this.visible?t:this,n=e.focused;return e.visible=!1,i.visible=!0,n&&i.focusable&&i.focus(),this},setOpacity:function(t){this.opacityProperty.value=il(t,0,1)},set opacity(t){this.setOpacity(t)},getOpacity:function(){return this.opacityProperty.value},get opacity(){return this.getOpacity()},setPickable:function(t){if(this.pickable!==t){const e=this.pickable;this.pickableProperty.setPropertyValue(t),this._picker.onPickableChange(e,t),this.pickableProperty.notifyListeners(e)}},set pickable(t){this.setPickable(t)},isPickable:function(){return this.pickableProperty.value},get pickable(){return this.isPickable()},setInputEnabled:function(t){this.inputEnabledProperty.value=t},set inputEnabled(t){this.setInputEnabled(t)},isInputEnabled:function(){return this.inputEnabledProperty.value},get inputEnabled(){return this.isInputEnabled()},setInputListeners:function(t){for(;this._inputListeners.length;)this.removeInputListener(this._inputListeners[0]);for(let e=0;e<t.length;e++)this.addInputListener(t[e]);return this},set inputListeners(t){this.setInputListeners(t)},getInputListeners:function(){return this._inputListeners.slice(0)},get inputListeners(){return this.getInputListeners()},setCursor:function(t){this._cursor="auto"===t?null:t},set cursor(t){this.setCursor(t)},getCursor:function(){return this._cursor},get cursor(){return this.getCursor()},setMouseArea:function(t){this._mouseArea!==t&&(this._mouseArea=t,this._picker.onMouseAreaChange())},set mouseArea(t){this.setMouseArea(t)},getMouseArea:function(){return this._mouseArea},get mouseArea(){return this.getMouseArea()},setTouchArea:function(t){this._touchArea!==t&&(this._touchArea=t,this._picker.onTouchAreaChange())},set touchArea(t){this.setTouchArea(t)},getTouchArea:function(){return this._touchArea},get touchArea(){return this.getTouchArea()},setClipArea:function(t){this.clipArea!==t&&(this.clipAreaProperty.value=t,this.invalidateBounds(),this._picker.onClipAreaChange())},set clipArea(t){this.setClipArea(t)},getClipArea:function(){return this.clipAreaProperty.value},get clipArea(){return this.getClipArea()},hasClipArea:function(){return null!==this.clipArea},setRendererBitmask:function(t){t!==this._rendererBitmask&&(this._rendererBitmask=t,this._rendererSummary.selfChange(),this.instanceRefreshEmitter.emit())},invalidateSupportedRenderers:function(){},invalidateHint:function(){this.rendererSummaryRefreshEmitter.emit(),this.instanceRefreshEmitter.emit()},setRenderer:function(t){let e=0;"canvas"===t?e=jn.bitmaskCanvas:"svg"===t?e=jn.bitmaskSVG:"dom"===t?e=jn.bitmaskDOM:"webgl"===t&&(e=jn.bitmaskWebGL),this._hints.renderer!==e&&(this._hints.renderer=e,this.invalidateHint())},set renderer(t){this.setRenderer(t)},getRenderer:function(){return 0===this._hints.renderer?null:this._hints.renderer===jn.bitmaskCanvas?"canvas":this._hints.renderer===jn.bitmaskSVG?"svg":this._hints.renderer===jn.bitmaskDOM?"dom":this._hints.renderer===jn.bitmaskWebGL?"webgl":this._hints.renderer},get renderer(){return this.getRenderer()},setLayerSplit:function(t){t!==this._hints.layerSplit&&(this._hints.layerSplit=t,this.invalidateHint())},set layerSplit(t){this.setLayerSplit(t)},isLayerSplit:function(){return this._hints.layerSplit},get layerSplit(){return this.isLayerSplit()},setUsesOpacity:function(t){t!==this._hints.usesOpacity&&(this._hints.usesOpacity=t,this.invalidateHint())},set usesOpacity(t){this.setUsesOpacity(t)},getUsesOpacity:function(){return this._hints.usesOpacity},get usesOpacity(){return this.getUsesOpacity()},setCSSTransform:function(t){t!==this._hints.cssTransform&&(this._hints.cssTransform=t,this.invalidateHint())},set cssTransform(t){this.setCSSTransform(t)},isCSSTransformed:function(){return this._hints.cssTransform},get cssTransform(){return this._hints.cssTransform},setExcludeInvisible:function(t){t!==this._hints.excludeInvisible&&(this._hints.excludeInvisible=t,this.invalidateHint())},set excludeInvisible(t){this.setExcludeInvisible(t)},isExcludeInvisible:function(){return this._hints.excludeInvisible},get excludeInvisible(){return this.isExcludeInvisible()},setExcludeInvisibleChildrenFromBounds:function(t){t!==this._excludeInvisibleChildrenFromBounds&&(this._excludeInvisibleChildrenFromBounds=t,this.invalidateBounds())},set excludeInvisibleChildrenFromBounds(t){this.setExcludeInvisibleChildrenFromBounds(t)},isExcludeInvisibleChildrenFromBounds:function(){return this._excludeInvisibleChildrenFromBounds},get excludeInvisibleChildrenFromBounds(){return this.isExcludeInvisibleChildrenFromBounds()},setPreventFit:function(t){t!==this._hints.preventFit&&(this._hints.preventFit=t,this.invalidateHint())},set preventFit(t){this.setPreventFit(t)},isPreventFit:function(){return this._hints.preventFit},get preventFit(){return this.isPreventFit()},setWebGLScale:function(t){t!==this._hints.webglScale&&(this._hints.webglScale=t,this.invalidateHint())},set webglScale(t){this.setWebGLScale(t)},getWebGLScale:function(){return this._hints.webglScale},get webglScale(){return this.getWebGLScale()},getUniqueTrail:function(t){if(t){const e=this.getTrails(t);return e[0]}{const t=new Vs;let e=this;for(;e;)t.addAncestor(e),e=e._parents[0];return t}},getUniqueTrailTo:function(t){return this.getUniqueTrail((function(e){return t===e}))},getTrails:function(t){t=t||al.defaultTrailPredicate;const e=[],i=new Vs(this);return Vs.appendAncestorTrailsWithPredicate(e,i,t),e},getTrailsTo:function(t){return this.getTrails((function(e){return e===t}))},getLeafTrails:function(t){t=t||al.defaultLeafTrailPredicate;const e=[],i=new Vs(this);return Vs.appendDescendantTrailsWithPredicate(e,i,t),e},getLeafTrailsTo:function(t){return this.getLeafTrails((function(e){return e===t}))},getUniqueLeafTrail:function(t){const e=this.getLeafTrails(t);return e[0]},getUniqueLeafTrailTo:function(t){return this.getUniqueLeafTrail((function(e){return e===t}))},getConnectedNodes:function(){const t=[];let e=this._children.concat(this._parents).concat(this);for(;e.length;){const i=e.pop();_.includes(t,i)||(t.push(i),e=e.concat(i._children,i._parents))}return t},getSubtreeNodes:function(){const t=[];let e=this._children.concat(this);for(;e.length;){const i=e.pop();_.includes(t,i)||(t.push(i),e=e.concat(i._children))}return t},getTopologicallySortedNodes:function(){const t={},e=[],i=[];let n;function s(i){delete t[n.id][i.id],_.every(t,(function(t){return!t[i.id]}))&&e.push(i)}for(_.each(this.getConnectedNodes(),(function(i){t[i.id]={},_.each(i._children,(function(e){t[i.id][e.id]=!0})),i.parents.length||e.push(i)}));e.length;)n=e.pop(),i.push(n),_.each(n._children,s);return i},canAddChild:function(t){if(this===t||_.includes(this._children,t))return!1;const e={},i=[],n=[];let s;function r(t){delete e[s.id][t.id],_.every(e,(function(e){return!e[t.id]}))&&i.push(t)}for(_.each(this.getConnectedNodes().concat(t.getConnectedNodes()),(function(n){e[n.id]={},_.each(n._children,(function(t){e[n.id][t.id]=!0})),n.parents.length||n===t||i.push(n)})),e[this.id][t.id]=!0;i.length;)s=i.pop(),n.push(s),_.each(s._children,r),s===this&&r(t);return _.every(e,(function(t){return _.every(t,(function(t){return!1}))}))},canvasPaintSelf:function(t,e){},renderToCanvasSelf:function(t,e){this.isPainted()&&this._rendererBitmask&jn.bitmaskCanvas&&this.canvasPaintSelf(t,e)},renderToCanvasSubtree:function(t,e){e=e||oi.identity(),t.resetStyles(),this.renderToCanvasSelf(t,e);for(let i=0;i<this._children.length;i++){const n=this._children[i];if(n.isVisible()){const i=1!==n.opacity||n.clipArea;if(t.context.save(),e.multiplyMatrix(n._transform.getMatrix()),e.canvasSetTransform(t.context),i){const i=document.createElement("canvas");i.width=t.canvas.width,i.height=t.canvas.height;const s=i.getContext("2d"),r=new wo(i,s);e.canvasSetTransform(s),n.renderToCanvasSubtree(r,e),t.context.save(),n.clipArea&&(t.context.beginPath(),n.clipArea.writeToContext(t.context),t.context.clip()),t.context.setTransform(1,0,0,1,0,0),t.context.globalAlpha=n.opacity,t.context.drawImage(i,0,0),t.context.restore()}else n.renderToCanvasSubtree(t,e);e.multiplyMatrix(n._transform.getInverse()),t.context.restore()}}},renderToCanvas:function(t,e,i,n){t.width=t.width,n&&(e.fillStyle=n,e.fillRect(0,0,t.width,t.height));const s=new wo(t,e);this.renderToCanvasSubtree(s,oi.identity()),i&&i()},toCanvas:function(t,e,i,n,s){const r=this.getBounds().union(this.localToParentBounds(this.getSafeSelfBounds()));e=void 0!==e?e:Math.ceil(2-r.minX),i=void 0!==i?i:Math.ceil(2-r.minY),n=void 0!==n?n:Math.ceil(r.getWidth()+4),s=void 0!==s?s:Math.ceil(r.getHeight()+4);const o=document.createElement("canvas");o.width=n,o.height=s;const a=o.getContext("2d");a.translate(e,i),this._transform.getMatrix().canvasAppendTransform(a);const l=new wo(o,a);this.renderToCanvasSubtree(l,oi.translation(e,i).timesMatrix(this._transform.getMatrix())),t(o,e,i,n,s)},toDataURL:function(t,e,i,n,s){this.toCanvas((function(e,i,n,s,r){t(e.toDataURL(),i,n,s,r)}),e,i,n,s)},toImage:function(t,e,i,n,s){this.toDataURL((function(e,i,n){const s=document.createElement("img");s.onload=function(){t(s,i,n);try{delete s.onload}catch(e){}},s.src=e}),e,i,n,s)},toImageNodeAsynchronous:function(t,e,i,n,s){this.toImage((function(e,i,n){t(new al({children:[new zn.Image(e,{x:-i,y:-n})]}))}),e,i,n,s)},toCanvasNodeSynchronous:function(t,e,i,n){let s=null;return this.toCanvas((function(t,e,i){s=new al({children:[new zn.Image(t,{x:-e,y:-i})]})}),t,e,i,n),s},toDataURLImageSynchronous:function(t,e,i,n){let s;return this.toDataURL((function(t,e,i,n,r){s=new zn.Image(t,{x:-e,y:-i,initialWidth:n,initialHeight:r})}),t,e,i,n),s},toDataURLNodeSynchronous:function(t,e,i,n){return new al({children:[this.toDataURLImageSynchronous(t,e,i,n)]})},rasterized:function(t){const e=(t=h({resolution:1,sourceBounds:null,useTargetBounds:!0,wrap:!0,useCanvas:!1},t)).resolution,i=t.sourceBounds;const n=new al({scale:e,children:[this]});let s,r=i||this.getSafeTransformedVisibleBounds().dilated(2).roundedOut();1!==e&&(r=new Ke(e*r.minX,e*r.minY,e*r.maxX,e*r.maxY),r.width%1!=0&&(r.maxX+=1-r.width%1),r.height%1!=0&&(r.maxY+=1-r.height%1)),n.toCanvas((function(i,n,r,o,a){const l=t.useCanvas?i:i.toDataURL();s=new zn.Image(l,h(t,{x:-n,y:-r,initialWidth:o,initialHeight:a})),s.scale(1/e,1/e,!0)}),-r.minX,-r.minY,r.width,r.height),n.dispose();let o=this.getVisibleBounds();if(i&&(o=i.intersection(o)),t.wrap){const e=new al({children:[s]});return t.useTargetBounds&&(e.localBounds=o),e}return t.useTargetBounds&&(s.localBounds=s.parentToLocalBounds(o)),s},createDOMDrawable:function(t,e){throw new Error("createDOMDrawable is abstract. The subtype should either override this method, or not support the DOM renderer")},createSVGDrawable:function(t,e){throw new Error("createSVGDrawable is abstract. The subtype should either override this method, or not support the DOM renderer")},createCanvasDrawable:function(t,e){throw new Error("createCanvasDrawable is abstract. The subtype should either override this method, or not support the DOM renderer")},createWebGLDrawable:function(t,e){throw new Error("createWebGLDrawable is abstract. The subtype should either override this method, or not support the DOM renderer")},getInstances:function(){return this._instances},get instances(){return this.getInstances()},addInstance:function(t){this._instances.push(t),this.changedInstanceEmitter.emit(t,!0)},removeInstance:function(t){const e=_.indexOf(this._instances,t);this._instances.splice(e,1),this.changedInstanceEmitter.emit(t,!1)},wasDisplayed:function(t){for(let e=0;e<this._instances.length;e++){const i=this._instances[e];if(i.display===t&&i.visible)return!0}return!1},getRootedDisplays:function(){return this._rootedDisplays},get rootedDisplays(){return this.getRootedDisplays()},addRootedDisplay:function(t){this._rootedDisplays.push(t),this._accessibleDisplaysInfo.onAddedRootedDisplay(t)},removeRootedDisplay:function(t){const e=_.indexOf(this._rootedDisplays,t);this._rootedDisplays.splice(e,1),this._accessibleDisplaysInfo.onRemovedRootedDisplay(t)},localToParentPoint:function(t){return this._transform.transformPosition2(t)},localToParentBounds:function(t){return this._transform.transformBounds2(t)},parentToLocalPoint:function(t){return this._transform.inversePosition2(t)},parentToLocalBounds:function(t){return this._transform.inverseBounds2(t)},transformBoundsFromLocalToParent:function(t){return t.transform(this._transform.getMatrix())},transformBoundsFromParentToLocal:function(t){return t.transform(this._transform.getInverse())},getLocalToGlobalMatrix:function(){let t=this;const e=[];for(;t;)e.push(t._transform.getMatrix()),t=t._parents[0];const i=oi.identity();for(let n=e.length-1;n>=0;n--)i.multiplyMatrix(e[n]);return i},getUniqueTransform:function(){return new hi(this.getLocalToGlobalMatrix())},getGlobalToLocalMatrix:function(){return this.getLocalToGlobalMatrix().invert()},localToGlobalPoint:function(t){let e=this;const i=t.copy();for(;e;)e._transform.getMatrix().multiplyVector2(i),e=e._parents[0];return i},globalToLocalPoint:function(t){let e=this;const i=[];for(;e;)i.push(e._transform),e=e._parents[0];const n=t.copy();for(let s=i.length-1;s>=0;s--)i[s].getInverse().multiplyVector2(n);return n},localToGlobalBounds:function(t){return t.transformed(this.getLocalToGlobalMatrix())},globalToLocalBounds:function(t){return t.transformed(this.getGlobalToLocalMatrix())},parentToGlobalPoint:function(t){return this.parents.length?this.parents[0].localToGlobalPoint(t):t},parentToGlobalBounds:function(t){return this.parents.length?this.parents[0].localToGlobalBounds(t):t},globalToParentPoint:function(t){return this.parents.length?this.parents[0].globalToLocalPoint(t):t},globalToParentBounds:function(t){return this.parents.length?this.parents[0].globalToLocalBounds(t):t},getGlobalBounds:function(){return this.parentToGlobalBounds(this.getBounds())},get globalBounds(){return this.getGlobalBounds()},boundsOf:function(t){return this.globalToLocalBounds(t.getGlobalBounds())},boundsTo:function(t){return t.globalToLocalBounds(this.getGlobalBounds())},attachDrawable:function(t){return this._drawables.push(t),this},detachDrawable:function(t){const e=_.indexOf(this._drawables,t);return this._drawables.splice(e,1),this},mutate:function(t){if(!t)return this;const e=this;return _.each(this._mutatorKeys,(function(i){if(void 0!==t[i]){const n=Object.getOwnPropertyDescriptor(al.prototype,i);n&&"function"==typeof n.value?e[i](t[i]):e[i]=t[i]}})),this.initializePhetioObject({phetioType:el,phetioState:!1},t),this},initializePhetioObject:function(t,e){const i=this.isPhetioInstrumented();if(Et.prototype.initializePhetioObject.call(this,t,e),!i&&this.isPhetioInstrumented())if(this.visibleProperty.forwardingProperty)this.linkVisibleProperty(this.visibleProperty.forwardingProperty);else{const t=new ne(this.visible,h({phetioReadOnly:this.phetioReadOnly,tandem:this.tandem.createTandem("visibleProperty"),phetioDocumentation:"Controls whether the Node will be visible (and interactive), see the NodeIO documentation for more details."},this.phetioComponentOptions,this.phetioComponentOptions.visibleProperty,e.visiblePropertyOptions));this.visibleProperty=t,this.phetioVisibleProperty=t}},getDebugHTMLExtras:function(){return""},inspect:function(){localStorage.scenerySnapshot=JSON.stringify({type:"Subtree",rootNodeId:this.id,nodes:zn.serializeConnectedNodes(this)})},toString:function(t,e){return this.constructor.name+"#"+this.id},auditInstanceSubtreeForDisplay:function(t){0},onBoundsListenersAddedOrRemoved:function(t){this.changeBoundsEventCount(t),this._boundsEventSelfCount+=t},dispose:function(){this.disposeAccessibility(),this.removeAllChildren(),this.detach(),this.phetioVisibleProperty&&(this.phetioVisibleProperty.dispose(),this.phetioVisibleProperty=null),Et.prototype.dispose.call(this)},disposeSubtree:function(){if(!this.isDisposed){const t=this.children;this.dispose();for(let e=0;e<t.length;e++)t[e].disposeSubtree()}}},{DEFAULT_OPTIONS:ol,defaultTrailPredicate:function(t){return 0===t._parents.length},defaultLeafTrailPredicate:function(t){return 0===t._children.length}}),to.compose(al);var ll=al;const hl=function(t,e){0};a.register("assertHasProperties",hl);var ul=hl,cl={isPaintDef:function(t){return null===t||"string"==typeof t||t instanceof rs||t instanceof ls||t instanceof Yt&&(null===t.value||"string"==typeof t.value||t.value instanceof rs)},toColor:function(t){if("string"==typeof t)return new rs(t);if(t instanceof rs)return t.copy();if(t instanceof Yt)return cl.toColor(t.value);if(t instanceof us){let e=rs.TRANSPARENT;const i=0;return t.stops.forEach((function(t){e=e.blend(cl.toColor(t.color),1/(i+1))})),e}return rs.TRANSPARENT}};zn.register("PaintDef",cl);const dl=Xs.safari5,fl=Xs.ie9,pl=["fill","fillPickable","stroke","strokePickable","lineWidth","lineCap","lineJoin","miterLimit","lineDash","lineDashOffset","cachedPaints"],ml={fill:null,fillPickable:!0,stroke:null,strokePickable:!1,lineWidth:Qi.DEFAULT_OPTIONS.lineWidth,lineCap:Qi.DEFAULT_OPTIONS.lineCap,lineJoin:Qi.DEFAULT_OPTIONS.lineJoin,lineDashOffset:Qi.DEFAULT_OPTIONS.lineDashOffset,miterLimit:Qi.DEFAULT_OPTIONS.miterLimit},gl={mixInto:function(t){const e=t.prototype;function i(){this.invalidateSupportedRenderers();const t=this._drawables.length;for(let e=0;e<t;e++)this._drawables[e].markDirtyFill()}if(O(e,{drawableMarkFlags:e.drawableMarkFlags.concat(["fill","stroke","lineWidth","lineOptions","cachedPaints"]),_mutatorKeys:pl.concat(e._mutatorKeys),initializePaintable:function(){ul(this,["_drawables"]),this._fill=ml.fill,this._fillPickable=ml.fillPickable,this._stroke=ml.stroke,this._strokePickable=ml.strokePickable,this._cachedPaints=[],this._lineDrawingStyles=new Qi},setFill:function(t){return this._fill!==t&&(this._fill=t,this.invalidateFill()),this},set fill(t){this.setFill(t)},getFill:function(){return this._fill},get fill(){return this.getFill()},hasFill:function(){return null!==this._fill},getFillValue:function(){let t=this.getFill();return t instanceof Yt&&(t=t.get()),t},get fillValue(){return this.getFillValue()},setStroke:function(t){return this._stroke!==t&&(this._stroke=t,this.invalidateStroke()),this},set stroke(t){this.setStroke(t)},getStroke:function(){return this._stroke},get stroke(){return this.getStroke()},hasStroke:function(){return null!==this._stroke},hasPaintableStroke:function(){return this.hasStroke()&&this.getLineWidth()>0},getStrokeValue:function(){let t=this.getStroke();return t instanceof Yt&&(t=t.get()),t},get strokeValue(){return this.getStrokeValue()},setFillPickable:function(t){return this._fillPickable!==t&&(this._fillPickable=t,this.invalidateFill()),this},set fillPickable(t){this.setFillPickable(t)},isFillPickable:function(){return this._fillPickable},get fillPickable(){return this.isFillPickable()},setStrokePickable:function(t){return this._strokePickable!==t&&(this._strokePickable=t,this.invalidateStroke()),this},set strokePickable(t){this.setStrokePickable(t)},isStrokePickable:function(){return this._strokePickable},get strokePickable(){return this.isStrokePickable()},setLineWidth:function(t){if(this.getLineWidth()!==t){this._lineDrawingStyles.lineWidth=t,this.invalidateStroke();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyLineWidth()}return this},set lineWidth(t){this.setLineWidth(t)},getLineWidth:function(){return this._lineDrawingStyles.lineWidth},get lineWidth(){return this.getLineWidth()},setLineCap:function(t){if(this._lineDrawingStyles.lineCap!==t){this._lineDrawingStyles.lineCap=t,this.invalidateStroke();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyLineOptions()}return this},set lineCap(t){this.setLineCap(t)},getLineCap:function(){return this._lineDrawingStyles.lineCap},get lineCap(){return this.getLineCap()},setLineJoin:function(t){if(this._lineDrawingStyles.lineJoin!==t){this._lineDrawingStyles.lineJoin=t,this.invalidateStroke();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyLineOptions()}return this},set lineJoin(t){this.setLineJoin(t)},getLineJoin:function(){return this._lineDrawingStyles.lineJoin},get lineJoin(){return this.getLineJoin()},setMiterLimit:function(t){if(this._lineDrawingStyles.miterLimit!==t){this._lineDrawingStyles.miterLimit=t,this.invalidateStroke();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyLineOptions()}return this},set miterLimit(t){this.setMiterLimit(t)},getMiterLimit:function(){return this._lineDrawingStyles.miterLimit},get miterLimit(){return this.getMiterLimit()},setLineDash:function(t){if(this._lineDrawingStyles.lineDash!==t){this._lineDrawingStyles.lineDash=t||[],this.invalidateStroke();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyLineOptions()}return this},set lineDash(t){this.setLineDash(t)},getLineDash:function(){return this._lineDrawingStyles.lineDash},get lineDash(){return this.getLineDash()},hasLineDash:function(){return!!this._lineDrawingStyles.lineDash.length},setLineDashOffset:function(t){if(this._lineDrawingStyles.lineDashOffset!==t){this._lineDrawingStyles.lineDashOffset=t,this.invalidateStroke();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyLineOptions()}return this},set lineDashOffset(t){this.setLineDashOffset(t)},getLineDashOffset:function(){return this._lineDrawingStyles.lineDashOffset},get lineDashOffset(){return this.getLineDashOffset()},setLineStyles:function(t){return this._lineDrawingStyles=t,this.invalidateStroke(),this},set lineStyles(t){this.setLineStyles(t)},getLineStyles:function(){return this._lineDrawingStyles},get lineStyles(){return this.getLineStyles()},setCachedPaints:function(t){this._cachedPaints=t.filter((function(t){return t&&t.isPaint}));const e=this._drawables.length;for(let i=0;i<e;i++)this._drawables[i].markDirtyCachedPaints();return this},set cachedPaints(t){this.setCachedPaints(t)},getCachedPaints:function(){return this._cachedPaints},get cachedPaints(){return this.getCachedPaints()},addCachedPaint:function(t){if(t&&t.isPaint){this._cachedPaints.push(t);const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyCachedPaints()}},removeCachedPaint:function(t){if(t&&t.isPaint){q(this._cachedPaints,t);const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyCachedPaints()}},beforeCanvasFill:function(t){const e=this.getFillValue();t.setFillStyle(e),e.transformMatrix&&(t.context.save(),e.transformMatrix.canvasAppendTransform(t.context))},afterCanvasFill:function(t){this.getFillValue().transformMatrix&&t.context.restore()},beforeCanvasStroke:function(t){const e=this.getStrokeValue();t.setStrokeStyle(this._stroke),t.setLineWidth(this.getLineWidth()),t.setLineCap(this.getLineCap()),t.setLineJoin(this.getLineJoin()),t.setMiterLimit(this.getMiterLimit()),t.setLineDash(this.getLineDash()),t.setLineDashOffset(this.getLineDashOffset()),e.transformMatrix&&(t.context.save(),e.transformMatrix.canvasAppendTransform(t.context))},afterCanvasStroke:function(t){this.getStrokeValue().transformMatrix&&t.context.restore()},getCSSFill:function(){const t=this.getFillValue();return t?t.toCSS?t.toCSS():t:"transparent"},getSimpleCSSStroke:function(){const t=this.getStrokeValue();return t?t.toCSS?t.toCSS():t:"transparent"},appendFillablePropString:function(t,e){return this._fill&&(e&&(e+=",\n"),"string"==typeof this.getFillValue()?e+=t+"fill: '"+this.getFillValue()+"'":e+=t+"fill: "+this.getFillValue().toString()),e},appendStrokablePropString:function(t,e){const i=this;function n(i,n,s){e&&(e+=",\n"),e+=s||"string"!=typeof n?t+i+": "+n:t+i+": '"+n+"'"}if(this._stroke){const t=new Qi;"string"==typeof this.getStrokeValue()?n("stroke",this.getStrokeValue()):n("stroke",this.getStrokeValue().toString(),!0),_.each(["lineWidth","lineCap","miterLimit","lineJoin","lineDashOffset"],(function(e){i[e]!==t[e]&&n(e,i[e])})),this.lineDash.length&&n("lineDash",JSON.stringify(this.lineDash),!0)}return e},getFillRendererBitmask:function(){let t=0;return dl&&this._fill&&this._fill.isGradient||(t|=jn.bitmaskSVG),t|=jn.bitmaskCanvas,this.hasFill()&&(this._fill.isPattern||this._fill.isGradient)||(t|=jn.bitmaskDOM,t|=jn.bitmaskWebGL),t},getStrokeRendererBitmask:function(){let t=0;return fl&&this.hasStroke()&&this.hasLineDash()||(t|=jn.bitmaskCanvas),t|=jn.bitmaskSVG,this.hasStroke()||(t|=jn.bitmaskDOM,t|=jn.bitmaskWebGL),t}}),e.invalidateFill){const t=e.invalidateFill;e.invalidateFill=function(){t.call(this),i.call(this)}}else e.invalidateFill=i;function n(){this.invalidateSupportedRenderers();const t=this._drawables.length;for(let e=0;e<t;e++)this._drawables[e].markDirtyStroke()}if(e.invalidateStroke){const t=e.invalidateStroke;e.invalidateStroke=function(){t.call(this),n.call(this)}}else e.invalidateStroke=n}};zn.register("Paintable",gl),gl.DEFAULT_OPTIONS=ml;var yl=gl;const bl={shape:null,boundsMethod:"accurate"};function vl(t,e){this._shape=bl.shape,this._strokedShape=null,this._boundsMethod=bl.boundsMethod,this._invalidShapeListener=this.invalidateShape.bind(this),this._invalidShapeListenerAttached=!1,ll.call(this),this.initializePaintable(),this.invalidateSupportedRenderers(),e=kn({shape:t},e),this.mutate(e)}zn.register("Path",vl),R(ll,vl,{_mutatorKeys:["boundsMethod","shape"].concat(ll.prototype._mutatorKeys),drawableMarkFlags:ll.prototype.drawableMarkFlags.concat(["shape"]),setShape:function(t){return this._shape!==t&&(this._invalidShapeListenerAttached&&this.detachShapeListener(),"string"==typeof t&&(t=new En(t)),this._shape=t,this.invalidateShape(),this._shape&&!this._shape.isImmutable()&&this.attachShapeListener()),this},set shape(t){this.setShape(t)},getShape:function(){return this._shape},get shape(){return this.getShape()},getStrokedShape:function(){return this._strokedShape||(this._strokedShape=this.getShape().getStrokedShape(this._lineDrawingStyles)),this._strokedShape},getPathRendererBitmask:function(){return jn.bitmaskCanvas|jn.bitmaskSVG},invalidateSupportedRenderers:function(){this.setRendererBitmask(this.getFillRendererBitmask()&this.getStrokeRendererBitmask()&this.getPathRendererBitmask())},invalidateShape:function(){this.invalidatePath();const t=this._drawables.length;for(let e=0;e<t;e++)this._drawables[e].markDirtyShape();this._invalidShapeListenerAttached&&this._shape&&this._shape.isImmutable()&&this.detachShapeListener()},invalidatePath:function(){this._strokedShape=null,this.invalidateSelf()},attachShapeListener:function(){this.isDisposed||(this._shape.invalidatedEmitter.addListener(this._invalidShapeListener),this._invalidShapeListenerAttached=!0)},detachShapeListener:function(){this._shape.invalidatedEmitter.removeListener(this._invalidShapeListener),this._invalidShapeListenerAttached=!1},updateSelfBounds:function(){const t=this.hasShape()?this.computeShapeBounds():Ke.NOTHING,e=!t.equals(this.selfBoundsProperty._value);return e&&this.selfBoundsProperty._value.set(t),e},setBoundsMethod:function(t){return this._boundsMethod!==t&&(this._boundsMethod=t,this.invalidatePath(),this.rendererSummaryRefreshEmitter.emit()),this},set boundsMethod(t){this.setBoundsMethod(t)},getBoundsMethod:function(){return this._boundsMethod},get boundsMethod(){return this.getBoundsMethod()},computeShapeBounds:function(){if("none"===this._boundsMethod)return Ke.NOTHING;if(this.hasPaintableStroke()&&"unstroked"!==this._boundsMethod){if("accurate"===this._boundsMethod)return this.getShape().getStrokedBounds(this.getLineStyles());{let t;return t="safePadding"===this._boundsMethod&&"miter"===this.getLineJoin()?this.getMiterLimit():"square"===this.getLineCap()?Math.SQRT2:1,this.getShape().bounds.dilated(t*this.getLineWidth()/2)}}return this.getShape().bounds},areSelfBoundsValid:function(){return"accurate"===this._boundsMethod||"safePadding"===this._boundsMethod||"none"!==this._boundsMethod&&!this.hasStroke()},getTransformedSelfBounds:function(t){return(this._stroke?this.getStrokedShape():this.getShape()).getBoundsWithTransform(t)},getTransformedSafeSelfBounds:function(t){return this.getTransformedSelfBounds(t)},invalidateStroke:function(){this.invalidatePath(),this.rendererSummaryRefreshEmitter.emit()},hasShape:function(){return!!this._shape},canvasPaintSelf:function(t,e){gs.prototype.paintCanvas(t,this,e)},createSVGDrawable:function(t,e){return Is.createFromPool(t,e)},createCanvasDrawable:function(t,e){return gs.createFromPool(t,e)},isPainted:function(){return!0},containsPointSelf:function(t){let e=!1;return this.hasShape()?(this._fillPickable&&(e=this.getShape().containsPoint(t)),!e&&this._strokePickable&&(e=this.getStrokedShape().containsPoint(t)),e):e},getSelfShape:function(){return En.union([...this.hasShape()&&this._fillPickable?[this.getShape()]:[],...this.hasShape()&&this._strokePickable?[this.getStrokedShape()]:[]])},intersectsBoundsSelf:function(t){return!!this.hasShape()&&this._shape.intersectsBounds(t)},requiresSVGBoundsWorkaround:function(){if(!this._stroke||!this._stroke.isPaint||!this.hasShape())return!1;const t=this.computeShapeBounds();return t.x*t.y==0},getDebugHTMLExtras:function(){return this._shape?" (<span style=\"color: #88f\" onclick=\"window.open( 'data:text/plain;charset=utf-8,' + encodeURIComponent( '"+this._shape.getSVGPath()+"' ) );\">path</span>)":""},dispose:function(){this._invalidShapeListenerAttached&&this.detachShapeListener(),ll.prototype.dispose.call(this)}}),vl.DEFAULT_OPTIONS=h({},ll.DEFAULT_OPTIONS,bl),yl.mixInto(vl);var _l=vl,wl=new r("sceneryPhet");function Al(t,e,i,n,s){s=h({tailWidth:5,headWidth:10,headHeight:10,doubleHead:!1,isHeadDynamic:!1,scaleTailToo:!1,fractionalHeadHeight:.5},s);const r=this;if(En.call(this),i!==t||n!==e){const o=Al.getArrowShapePoints(t,e,i,n,[],s);this.moveTo(o[0].x,o[0].y);const a=_.tail(o);_.each(a,(function(t){r.lineTo(t.x,t.y)})),this.close()}}wl.register("ArrowShape",Al),R(En,Al,{},{getArrowShapePoints:function(t,e,i,n,s,r){if(s||(s=[]),i===t&&n===e)s.length=0;else{const o=new je(i-t,n-e),a=o.magnitude;let l=r.headWidth,h=r.headHeight,u=r.tailWidth;if(r.isHeadDynamic){const t=r.fractionalHeadHeight*a;r.headHeight>t&&(h=t,r.scaleTailToo&&(l=r.headWidth*h/r.headHeight,u=r.tailWidth*h/r.headHeight))}else h=Math.min(r.headHeight,r.doubleHead?.35*a:.99*a);let c=0;const d=o.normalized(),f=d.rotated(Math.PI/2),p=function(i,n){const r=d.x*i+f.x*n+t,o=d.y*i+f.y*n+e;s[c]?(s[c].x=r,s[c].y=o):s.push(new je(r,o)),c++};r.doubleHead?(p(0,0),p(h,l/2),p(h,u/2)):p(0,u/2),p(a-h,u/2),p(a-h,l/2),p(a,0),p(a-h,-l/2),p(a-h,-u/2),r.doubleHead?(p(h,-u/2),p(h,-l/2)):p(0,-u/2),c<s.length&&(s.length=c)}return s}});var xl=Al;function Tl(t,e,i,n,s){s=h({headHeight:10,headWidth:10,tailWidth:5,isHeadDynamic:!1,scaleTailToo:!1,fractionalHeadHeight:.5,doubleHead:!1,fill:"black",stroke:"black",lineWidth:1,tandem:ot.OPTIONAL},s),_l.call(this,null),this.options=s,this.shapePoints=[],this.tailX=t,this.tailY=e,this.tipX=i,this.tipY=n,this.setTailAndTip(t,e,i,n),this.mutate(s)}wl.register("ArrowNode",Tl),R(_l,Tl,{updateShapePoints:function(){const t=this.shapePoints.length;return this.shapePoints=xl.getArrowShapePoints(this.tailX,this.tailY,this.tipX,this.tipY,this.shapePoints,this.options),this.shapePoints.length!==t},updateShape:function(){const t=new En;if(this.shapePoints.length>1){t.moveToPoint(this.shapePoints[0]);for(let e=1;e<this.shapePoints.length;e++)t.lineToPoint(this.shapePoints[e]);t.close()}this.shape=t},setTailAndTip:function(t,e,i,n){this.tailX=t,this.tailY=e,this.tipX=i,this.tipY=n;const s=this.updateShapePoints();!this.shape||s?this.updateShape():this.shape.invalidatePoints()},setTail:function(t,e){this.setTailAndTip(t,e,this.tipX,this.tipY)},setTip:function(t,e){this.setTailAndTip(this.tailX,this.tailY,t,e)},setTailWidth:function(t){this.options.tailWidth=t,this.updateShapePoints(),this.updateShape()},setDoubleHead:function(t){this.options.doubleHead=t,this.updateShapePoints(),this.updateShape()}});var Sl=Tl;class Dl extends T{static toStateObject(t){return A(t,this.validator),{style:t.getStyle(),variant:t.getVariant(),weight:t.getWeight(),stretch:t.getStretch(),size:t.getSize(),lineHeight:t.getLineHeight(),family:t.getFamily()}}static fromStateObject(t){return new zn.Font(t)}}Dl.validator={valueType:zn.Font},Dl.documentation="Font handling for text drawing. Options:<ul><li><strong>style:</strong> normal      &mdash; normal | italic | oblique </li><li><strong>variant:</strong> normal    &mdash; normal | small-caps </li><li><strong>weight:</strong> normal     &mdash; normal | bold | bolder | lighter | 100 | 200 | 300 | 400 | 500 | 600 | 700 | 800 | 900 </li><li><strong>stretch:</strong> normal    &mdash; normal | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded </li><li><strong>size:</strong> 10px         &mdash; absolute-size | relative-size | length | percentage -- unitless number interpreted as px. absolute suffixes: cm, mm, in, pt, pc, px. relative suffixes: em, ex, ch, rem, vw, vh, vmin, vmax. </li><li><strong>lineHeight:</strong> normal &mdash; normal | number | length | percentage -- NOTE: Canvas spec forces line-height to normal </li><li><strong>family:</strong> sans-serif &mdash; comma-separated list of families, including generic families (serif, sans-serif, cursive, fantasy, monospace). ideally escape with double-quotes</li></ul>",Dl.typeName="FontIO",T.validateSubtype(Dl),zn.register("FontIO",Dl);var El=Dl;const Cl=["normal","italic","oblique"],Il=["normal","small-caps"],Pl=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],kl=["normal","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded","ultra-expanded"];function Ll(t){t=h({style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"10px",lineHeight:"normal",family:"sans-serif",phetioType:El,tandem:ot.OPTIONAL},t),this._style=t.style,this._variant=t.variant,this._weight=""+t.weight,this._stretch=t.stretch,this._size=Ll.castSize(t.size),this._lineHeight=t.lineHeight,this._family=t.family,this._font=this.computeShorthand(),Et.call(this,t)}zn.register("Font",Ll),R(Et,Ll,{getFont:function(){return this._font},get font(){return this.getFont()},getStyle:function(){return this._style},get style(){return this.getStyle()},getVariant:function(){return this._variant},get variant(){return this.getVariant()},getWeight:function(){return this._weight},get weight(){return this.getWeight()},getStretch:function(){return this._stretch},get stretch(){return this.getStretch()},getSize:function(){return this._size},get size(){return this.getSize()},getNumericSize:function(){const t=this._size.match(/^(\d+)px$/);if(t)return parseInt(t[1],10);const e=this._size.match(/^(\d+)pt$/);if(e)return.75*parseInt(e[1],10);const i=this._size.match(/^(\d+)em$/);return i?parseInt(i[1],10)/16:12},get numericSize(){return this.getNumericSize()},getLineHeight:function(){return this._lineHeight},get lineHeight(){return this.getLineHeight()},getFamily:function(){return this._family},get family(){return this.getFamily()},copy:function(t){return new Ll(h({style:this._style,variant:this._variant,weight:this._weight,stretch:this._stretch,size:this._size,lineHeight:this._lineHeight,family:this._family},t))},computeShorthand:function(){let t="";return"normal"!==this._style&&(t+=this._style+" "),"normal"!==this._variant&&(t+=this._variant+" "),"normal"!==this._weight&&(t+=this._weight+" "),"normal"!==this._stretch&&(t+=this._stretch+" "),t+=this._size,"normal"!==this._lineHeight&&(t+="/"+this._lineHeight),t+=" "+this._family,t},toCSS:function(){return this.getFont()}},{castSize:function(t){return"number"==typeof t?t+"px":t},fromCSS:function(t){const e={},i=_.filter(t.split(/[\x09\x0A\x0C\x0D\x20]/),(function(t){return t.length>0}));for(let n=0;n<i.length;n++){const t=i[n];if("normal"===t);else if(_.includes(Cl,t))e.style=t;else if(_.includes(Il,t))e.variant=t;else if(_.includes(Pl,t))e.weight=t;else{if(!_.includes(kl,t)){const s=t.split(/\//);e.size=s[0],s[1]&&(e.lineHeight=s[1]),e.family=i.slice(n+1).join(" ");break}e.stretch=t}}return new Ll(e)}}),Ll.DEFAULT=new Ll;var Ol=Ll;function Nl(t){"number"!=typeof t&&"string"!=typeof t||(t={size:t}),(t=h({family:"Arial"},t)).family=t.family+", sans-serif",Ol.call(this,t)}wl.register("PhetFont",Nl),R(Ol,Nl);var Rl=Nl;const Ml={vertical:"top",horizontal:"left"},Bl={vertical:"height",horizontal:"width"},Fl={vertical:{left:"left",center:"centerX",right:"right",origin:"x"},horizontal:{top:"top",center:"centerY",bottom:"bottom",origin:"y"}};function Vl(t){t=h({excludeInvisibleChildrenFromBounds:!0},t),this._orientation="vertical",this._spacing=0,this._align="center",this._resize=!0,ll.call(this),this._updateLayoutListener=this.updateLayoutAutomatically.bind(this),this._updateLayoutLocked=!1,this.childInsertedEmitter.addListener(this.onLayoutBoxChildInserted.bind(this)),this.childRemovedEmitter.addListener(this.onLayoutBoxChildRemoved.bind(this)),this.childrenChangedEmitter.addListener(this.onLayoutBoxChildrenChanged.bind(this)),this._layoutMutating=!0,this.mutate(t),this._layoutMutating=!1}zn.register("LayoutBox",Vl),R(ll,Vl,{_mutatorKeys:["orientation","spacing","align","resize"].concat(ll.prototype._mutatorKeys),getAlignmentBounds:function(){let t=Number.NEGATIVE_INFINITY,e=Number.NEGATIVE_INFINITY;for(let i=0;i<this._children.length;i++){const n=this._children[i];this.isChildIncludedInLayout(n)&&(t=Math.max(t,n.width),e=Math.max(e,n.height))}return new Ke(0,0,t,e)},layout:function(){const t=this._children,e=Ml[this._orientation],i=Bl[this._orientation],n=Fl[this._orientation][this._align],s=this.getAlignmentBounds();let r=0;for(let o=0;o<t.length;o++){const a=t[o];this.isChildIncludedInLayout(a)&&(a[e]=r,a[n]="origin"===this._align?0:s[n],r+=a[i]+this._spacing)}},updateLayout:function(){this._updateLayoutLocked||(this._updateLayoutLocked=!0,this.layout(),this._updateLayoutLocked=!1)},updateLayoutAutomatically:function(){(this._layoutMutating||this._resize)&&this.updateLayout()},onLayoutBoxChildInserted:function(t){this._resize&&(t.boundsProperty.lazyLink(this._updateLayoutListener),t.visibleProperty.lazyLink(this._updateLayoutListener))},onLayoutBoxChildRemoved:function(t){this._resize&&(t.boundsProperty.unlink(this._updateLayoutListener),t.visibleProperty.unlink(this._updateLayoutListener))},onLayoutBoxChildrenChanged:function(){this._resize&&this.updateLayoutAutomatically()},setChildren:function(t){if(this._updateLayoutLocked)return ll.prototype.setChildren.call(this,t);const e=this.getChildren();return this._updateLayoutLocked=!0,ll.prototype.setChildren.call(this,t),this._updateLayoutLocked=!1,_.isEqual(e,t)||this.updateLayoutAutomatically(),this},setExcludeInvisibleChildrenFromBounds:function(t){ll.prototype.setExcludeInvisibleChildrenFromBounds.call(this,t),_.some(this._children,t=>!t.visible)&&this.updateLayoutAutomatically()},setOrientation:function(t){return this._orientation!==t&&(this._orientation=t,this.updateLayout()),this},set orientation(t){this.setOrientation(t)},getOrientation:function(){return this._orientation},get orientation(){return this.getOrientation()},setSpacing:function(t){return this._spacing!==t&&(this._spacing=t,this.updateLayout()),this},set spacing(t){this.setSpacing(t)},getSpacing:function(){return this._spacing},get spacing(){return this.getSpacing()},setAlign:function(t){return this._align!==t&&(this._align=t,this.updateLayout()),this},set align(t){this.setAlign(t)},getAlign:function(){return this._align},get align(){return this.getAlign()},setResize:function(t){if(this._resize!==t){this._resize=t;for(let e=0;e<this._children.length;e++){const i=this._children[e];t?(i.boundsProperty.lazyLink(this._updateLayoutListener),i.visibleProperty.lazyLink(this._updateLayoutListener)):(i.boundsProperty.unlink(this._updateLayoutListener),i.visibleProperty.unlink(this._updateLayoutListener))}this.updateLayoutAutomatically()}return this},set resize(t){this.setResize(t)},isResize:function(){return this._resize},get resize(){return this.isResize()}});var Hl=Vl;function zl(t){(t=t||{}).orientation="horizontal",Hl.call(this,t)}zn.register("HBox",zl),R(Hl,zl);var Gl=zl;function ql(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}a.register("escapeHTML",ql);var Yl=ql;function Ul(t,e){this.initializeCanvasSelfDrawable(t,e),this.initializePaintableStateless(t,e)}zn.register("TextCanvasDrawable",Ul),R(Jn,Ul,{paintCanvas:function(t,e,i){const n=t.context;(e.hasFill()||e.hasPaintableStroke())&&(t.setFont(e._font.getFont()),t.setDirection("ltr")),e.hasFill()&&(e.beforeCanvasFill(t),n.fillText(e.renderedText,0,0),e.afterCanvasFill(t)),e.hasPaintableStroke()&&(e.beforeCanvasStroke(t),n.strokeText(e.renderedText,0,0),e.afterCanvasStroke(t))},markDirtyText:function(){this.markPaintDirty()},markDirtyFont:function(){this.markPaintDirty()},markDirtyBounds:function(){this.markPaintDirty()},dispose:function(){Jn.prototype.dispose.call(this),this.disposePaintableStateless()}}),ps.mixInto(Ul),Pe.mixInto(Ul);var jl=Ul;function Wl(t,e){throw this.initializeDOMSelfDrawable(t,e),new Error("Should use initialization and pooling")}zn.register("DOMSelfDrawable",Wl),R(Zn,Wl,{initializeDOMSelfDrawable:function(t,e){return this.transformListener=this.transformListener||this.markTransformDirty.bind(this),this.initializeSelfDrawable(t,e),this.forceAcceleration=!1,this.markTransformDirty(),this.visibilityDirty=!0,e.relativeTransform.addListener(this.transformListener),e.relativeTransform.addPrecompute(),this},markTransformDirty:function(){this.transformDirty=!0,this.markDirty()},getTransformMatrix:function(){return this.instance.relativeTransform.validate(),this.instance.relativeTransform.matrix},update:function(){return!!Zn.prototype.update.call(this)&&(this.updateDOM(),this.visibilityDirty&&(this.visibilityDirty=!1,this.domElement.style.visibility=this.visible?"":"hidden"),this.cleanPaintableState&&this.cleanPaintableState(),!0)},updateDOM:function(){},updateSelfVisibility:function(){Zn.prototype.updateSelfVisibility.call(this),this.visibilityDirty||(this.visibilityDirty=!0,this.markDirty())},dispose:function(){this.instance.relativeTransform.removeListener(this.transformListener),this.instance.relativeTransform.removePrecompute(),Zn.prototype.dispose.call(this)}});var Xl=Wl;const Kl={mixInto:function(t){const e=t.prototype;e.initializeState=function(t,e){return this.paintDirty=!0,this.dirtyText=!0,this.dirtyFont=!0,this.dirtyBounds=!0,this.initializePaintableState(t,e),this},e.disposeState=function(){this.disposePaintableState()},e.markPaintDirty=function(){this.paintDirty=!0,this.markDirty()},e.markDirtyText=function(){this.dirtyText=!0,this.markPaintDirty()},e.markDirtyFont=function(){this.dirtyFont=!0,this.markPaintDirty()},e.markDirtyBounds=function(){this.dirtyBounds=!0,this.markPaintDirty()},e.setToCleanState=function(){this.paintDirty=!1,this.dirtyText=!1,this.dirtyFont=!1,this.dirtyBounds=!1},Ss.mixInto(t)}};zn.register("TextStatefulDrawable",Kl);var Ql=Kl;const Zl=oi.dirtyFromPool();function $l(t,e){this.initializeDOMSelfDrawable(t,e),this.initializeState(t,e),this.domElement||(this.domElement=document.createElement("div"),this.domElement.style.display="block",this.domElement.style.position="absolute",this.domElement.style.pointerEvents="none",this.domElement.style.left="0",this.domElement.style.top="0",this.domElement.setAttribute("dir","ltr")),mo.prepareForTransform(this.domElement,this.forceAcceleration)}zn.register("TextDOMDrawable",$l),R(Xl,$l,{updateDOM:function(){const t=this.node,e=this.domElement;if(this.paintDirty&&(this.dirtyFont&&(e.style.font=t.getFont()),this.dirtyStroke&&(e.style.color=t.getCSSFill()),this.dirtyBounds&&(e.style.width=t.getSelfBounds().width+"px",e.style.height=t.getSelfBounds().height+"px"),this.dirtyText&&(e.textContent=t.renderedText)),this.transformDirty||this.dirtyText||this.dirtyFont||this.dirtyBounds){const i=t.getSelfBounds().minY;Zl.set(this.getTransformMatrix());const n=oi.translation(0,i);Zl.multiplyMatrix(n),n.freeToPool(),mo.applyPreparedTransform(Zl,e,this.forceAcceleration)}this.setToCleanState(),this.cleanPaintableState(),this.transformDirty=!1},dispose:function(){this.disposeState(),Xl.prototype.dispose.call(this)}}),Ql.mixInto($l),Pe.mixInto($l);var Jl=$l;const th=!Xs.ie&&!Xs.edge;function eh(t,e){if(this.initializeSVGSelfDrawable(t,e,!0,!0),this.hasLength=!1,!this.svgElement){const t=document.createElementNS(bs,"text");this.svgElement=t,t.appendChild(document.createTextNode("")),t.setAttribute("dominant-baseline","alphabetic"),t.setAttribute("text-rendering","geometricPrecision"),t.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.setAttribute("direction","ltr")}}zn.register("TextSVGDrawable",eh),R(xs,eh,{updateSVGSelf:function(){const t=this.svgElement;if(this.dirtyFont&&(t.setAttribute("font-family",this.node._font.getFamily()),t.setAttribute("font-size",this.node._font.getSize()),t.setAttribute("font-style",this.node._font.getStyle()),t.setAttribute("font-weight",this.node._font.getWeight()),t.setAttribute("font-stretch",this.node._font.getStretch())),this.dirtyText&&(t.lastChild.nodeValue=this.node.renderedText),this.dirtyBounds&&th){"accurate"!==this.node._boundsMethod&&isFinite(this.node.selfBounds.width)?(this.hasLength||(this.hasLength=!0,t.setAttribute("lengthAdjust","spacingAndGlyphs")),t.setAttribute("textLength",this.node.selfBounds.width)):this.hasLength&&(this.hasLength=!1,t.removeAttribute("lengthAdjust"),t.removeAttribute("textLength"))}this.updateFillStrokeStyle(t)}}),Ql.mixInto(eh),Pe.mixInto(eh);var ih=eh;let nh,sh;const rh={};let oh=!1;var ah={approximateSVGBounds:function(t,e){if(!nh.parentNode){if(!document.body)throw new Error("No document.body and trying to get approximate SVG bounds of a Text node");document.body.appendChild(nh)}ah.setSVGTextAttributes(sh,t,e);const i=sh.getBBox();return 0===i.width&&0===i.height&&e.length>0?(oh||(oh=!0,console.log("WARNING: Guessing text bounds, is the simulation hidden? See https://github.com/phetsims/chipper/issues/768")),ah.guessSVGBounds(t,e)):new Ke(i.x,i.y,i.x+i.width,i.y+i.height)},guessSVGBounds:function(t,e){const i=t.getNumericSize(),n="bold"===t.weight;return new Ke(0,-.9*i,(n?.435:.4)*i*e.length,.22*i)},accurateCanvasBounds:function(t){const e=ah.approximateSVGBounds(t._font,t.renderedText);if(!t.renderedText.length||0===e.width)return e;const i=mo.canvasAccurateBounds((function(e){if(e.font=t._font.toCSS(),e.direction="ltr",e.fillText(t.renderedText,0,0),t.hasPaintableStroke()){const i=new wo(null,e);t.beforeCanvasStroke(i),e.strokeText(t.renderedText,0,0),t.afterCanvasStroke(i)}}),{precision:.5,resolution:128,initialScale:32/Math.max(Math.abs(e.minX),Math.abs(e.minY),Math.abs(e.maxX),Math.abs(e.maxY))});return i.isFinite()?i:e},getVerticalBounds:function(t){const e=t.toCSS();let i=rh[e];return i||(i=rh[e]=ah.approximateSVGBounds(t,"m")),i},approximateCanvasWidth:function(t,e){const i=zn.scratchContext;return i.font=t.toCSS(),i.direction="ltr",i.measureText(e).width},approximateHybridBounds:function(t,e){const i=ah.getVerticalBounds(t),n=ah.approximateCanvasWidth(t,e);return new Ke(0,i.minY,n,i.maxY)},approximateDOMBounds:function(t,e){const i=document.createElement("div");$(i).css({position:"absolute",left:0,top:0,padding:"0 !important",margin:"0 !important",display:"hidden"});const n=document.createElement("span");$(n).css("font",t.toCSS()),n.appendChild(e),n.setAttribute("direction","ltr");const s=document.createElement("div");$(s).css({"vertical-align":"baseline",display:"inline-block",width:0,height:"1024px",margin:"0 !important",padding:"0 !important"}),i.appendChild(n),i.appendChild(s),document.body.appendChild(i);const r=n.getBoundingClientRect(),o=i.getBoundingClientRect(),a=new Ke(r.left,r.top-1024,r.right+1,r.bottom-1024).shifted(-o.left,-o.top);return document.body.removeChild(i),a},approximateImprovedDOMBounds:function(t,e){const i=document.createElement("div");i.style.display="inline-block",i.style.font=t.toCSS(),i.style.color="transparent",i.style.padding="0 !important",i.style.margin="0 !important",i.style.position="absolute",i.style.left="0",i.style.top="0",i.setAttribute("direction","ltr"),i.appendChild(e),document.body.appendChild(i);const n=new Ke(i.offsetLeft,i.offsetTop,i.offsetLeft+i.offsetWidth+1,i.offsetTop+i.offsetHeight+1);document.body.removeChild(i);const s=ah.getVerticalBounds(t);return n.shiftedY(s.minY)},setSVGTextAttributes:function(t,e,i){t.setAttribute("direction","ltr"),t.setAttribute("font-family",e.getFamily()),t.setAttribute("font-size",e.getSize()),t.setAttribute("font-style",e.getStyle()),t.setAttribute("font-weight",e.getWeight()),t.setAttribute("font-stretch",e.getStretch()),t.lastChild.nodeValue=i},initializeTextBounds:function(){nh=document.getElementById("sceneryTextSizeContainer"),nh||(nh=document.createElementNS(bs,"svg"),nh.setAttribute("width","2"),nh.setAttribute("height","2"),nh.setAttribute("id","sceneryTextSizeContainer"),nh.setAttribute("style","visibility: hidden; pointer-events: none; position: absolute; left: -65535px; right: -65535px;")),sh=document.getElementById("sceneryTextSizeElement"),sh||(sh=document.createElementNS(bs,"text"),sh.appendChild(document.createTextNode("")),sh.setAttribute("dominant-baseline","alphabetic"),sh.setAttribute("text-rendering","geometricPrecision"),sh.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),sh.setAttribute("id","sceneryTextSizeElement"),nh.appendChild(sh))}};zn.register("TextBounds",ah);var lh=ah;class hh extends el{constructor(t,e){super(t,e);const i=new Ja(t,t.textProperty,"text",h({phetioReadOnly:t.phetioReadOnly,phetioType:te(Ae),tandem:t.tandem.createTandem("textProperty"),phetioDocumentation:"Property for the displayed text"},t.phetioComponentOptions,t.phetioComponentOptions.textProperty));this.disposeTextIO=function(){i.dispose()}}dispose(){this.disposeTextIO(),el.prototype.dispose.call(this)}}hh.methods={setFontOptions:{returnType:Qt,parameterTypes:[El],implementation:function(t){this.phetioObject.setFont(t)},documentation:"Sets font options for this TextIO instance, e.g. {size: 16, weight: bold}. If increasing the font size does not make the text size larger, you may need to increase the maxWidth of the TextIO also.",invocableForReadOnlyElements:!1},getFontOptions:{returnType:El,parameterTypes:[],implementation:function(){return this.phetioObject.getFont()},documentation:"Gets font options for this TextIO instance as an object"},setMaxWidth:{returnType:Qt,parameterTypes:[_e],implementation:function(t){this.phetioObject.setMaxWidth(t)},documentation:"Sets the maximum width of text box. If the text width exceeds maxWidth, it is scaled down to fit.",invocableForReadOnlyElements:!1},getMaxWidth:{returnType:_e,parameterTypes:[],implementation:function(){return this.phetioObject.maxWidth},documentation:"Gets the maximum width of text box"}},hh.documentation="Text that is displayed in the simulation. TextIO has a nested PropertyIO.&lt;String&gt; for the current string value.",hh.validator={valueType:zn.Text},hh.typeName="TextIO",T.validateSubtype(hh),zn.register("TextIO",hh);var uh=hh;const ch=-1!==window.navigator.userAgent.indexOf("like Gecko) Version/5")&&-1!==window.navigator.userAgent.indexOf("Safari/");function dh(t,e){this.textProperty=new qn(""),this._font=Ol.DEFAULT,this._boundsMethod="hybrid",this._isHTML=void 0!==this._isHTML&&this._isHTML,this._cachedRenderedText=null,e=kn({fill:"#000000",text:t,tandem:ot.OPTIONAL,phetioType:uh},e),this.textTandem=e.tandem,ll.call(this),this.initializePaintable(),this.mutate(e),this.invalidateSupportedRenderers()}zn.register("Text",dh),R(ll,dh,{_mutatorKeys:["boundsMethod","text","font","fontWeight","fontFamily","fontStretch","fontStyle","fontSize"].concat(ll.prototype._mutatorKeys),drawableMarkFlags:ll.prototype.drawableMarkFlags.concat(["text","font","bounds"]),setText:function(t){if((t=""+t)!==this.text){const e=this.text;this.textProperty.setPropertyValue(t),this._cachedRenderedText=null;const i=this._drawables.length;for(let t=0;t<i;t++)this._drawables[t].markDirtyText();this.invalidateText(),this.textProperty.notifyListeners(e)}return this},set text(t){this.setText(t)},getText:function(){return this.textProperty.value},get text(){return this.getText()},getRenderedText:function(){return null===this._cachedRenderedText&&(this._cachedRenderedText=this.text.replace(" "," "),Xs.edge&&(this._cachedRenderedText=dh.simplifyEmbeddingMarks(this._cachedRenderedText))),this._cachedRenderedText},get renderedText(){return this.getRenderedText()},setBoundsMethod:function(t){if(t!==this._boundsMethod){this._boundsMethod=t,this.invalidateSupportedRenderers();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyBounds();this.invalidateText(),this.rendererSummaryRefreshEmitter.emit()}return this},set boundsMethod(t){this.setBoundsMethod(t)},getBoundsMethod:function(){return this._boundsMethod},get boundsMethod(){return this.getBoundsMethod()},getTextRendererBitmask:function(){let t=0;return"fast"===this._boundsMethod||this._isHTML||(t|=jn.bitmaskCanvas),this._isHTML||(t|=jn.bitmaskSVG),t|=jn.bitmaskDOM,t},invalidateSupportedRenderers:function(){this.setRendererBitmask(this.getFillRendererBitmask()&this.getStrokeRendererBitmask()&this.getTextRendererBitmask())},invalidateText:function(){this.invalidateSelf();const t=this._drawables.length;for(let e=0;e<t;e++)this._drawables[e].markDirtyBounds();this.invalidateSupportedRenderers()},updateSelfBounds:function(){let t;t=this._isHTML||ch&&"accurate"!==this._boundsMethod?lh.approximateDOMBounds(this._font,this.getDOMTextNode()):"hybrid"===this._boundsMethod?lh.approximateHybridBounds(this._font,this.renderedText):"accurate"===this._boundsMethod?lh.accurateCanvasBounds(this):lh.approximateSVGBounds(this._font,this.renderedText),this.hasStroke()&&t.dilate(this.getLineWidth()/2);const e=!t.equals(this.selfBoundsProperty._value);return e&&this.selfBoundsProperty._value.set(t),e},invalidateStroke:function(){this.invalidateText()},invalidateFill:function(){this.invalidateText()},canvasPaintSelf:function(t,e){jl.prototype.paintCanvas(t,this,e)},createDOMDrawable:function(t,e){return Jl.createFromPool(t,e)},createSVGDrawable:function(t,e){return ih.createFromPool(t,e)},createCanvasDrawable:function(t,e){return jl.createFromPool(t,e)},getDOMTextNode:function(){if(this._isHTML){const t=document.createElement("span");return t.innerHTML=this.text,t}return document.createTextNode(this.renderedText)},getSafeSelfBounds:function(){const t=this.getSelfBounds();return t.dilatedXY(1*t.width,1*t.height)},setFont:function(t){if(t!==("string"==typeof t?this._font.toCSS():this._font)){this._font="string"==typeof t?Ol.fromCSS(t):t;const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyFont();this.invalidateText()}return this},set font(t){this.setFont(t)},getFont:function(){return this._font.getFont()},get font(){return this.getFont()},setFontWeight:function(t){return this.setFont(this._font.copy({weight:t}))},set fontWeight(t){this.setFontWeight(t)},getFontWeight:function(){return this._font.getWeight()},get fontWeight(){return this.getFontWeight()},setFontFamily:function(t){return this.setFont(this._font.copy({family:t}))},set fontFamily(t){this.setFontFamily(t)},getFontFamily:function(){return this._font.getFamily()},get fontFamily(){return this.getFontFamily()},setFontStretch:function(t){return this.setFont(this._font.copy({stretch:t}))},set fontStretch(t){this.setFontStretch(t)},getFontStretch:function(){return this._font.getStretch()},get fontStretch(){return this.getFontStretch()},setFontStyle:function(t){return this.setFont(this._font.copy({style:t}))},set fontStyle(t){this.setFontStyle(t)},getFontStyle:function(){return this._font.getStyle()},get fontStyle(){return this.getFontStyle()},setFontSize:function(t){return this.setFont(this._font.copy({size:t}))},set fontSize(t){this.setFontSize(t)},getFontSize:function(){return this._font.getSize()},get fontSize(){return this.getFontSize()},isPainted:function(){return!0},areSelfBoundsValid:function(){return"accurate"===this._boundsMethod},getDebugHTMLExtras:function(){return' "'+Yl(this.renderedText)+'"'+(this._isHTML?" (html)":"")}}),yl.mixInto(dh);dh.embeddedDebugString=function(t){return t.replace(/\u202a/g,"[LTR]").replace(/\u202b/g,"[RTL]").replace(/\u202c/g,"[POP]")},dh.simplifyEmbeddingMarks=function(t){const e={dir:null,children:[],parent:null};let i=e;for(let n=0;n<t.length;n++){const e=t.charAt(n);if("‪"===e||"‫"===e){const t={dir:e,children:[],parent:i};i.children.push(t),i=t}else"‬"===e?i=i.parent:i.children.push(e)}return function t(e){if("string"==typeof e)return e;const i=e.children.map(t).join("");return e.dir?e.dir+i+"‬":i}(function t(e){if("string"!=typeof e){for(let i=0;i<e.children.length;i++)t(e.children[i]);return function(t){1===t.children.length&&t.children[0].dir&&(t.dir=t.children[0].dir,t.children=t.children[0].children)}(e),function(t){for(let e=t.children.length-1;e>=0;e--){const i=t.children[e];t.dir===i.dir&&Array.prototype.splice.apply(t.children,[e,1].concat(i.children))}}(e),function t(e){for(let i=e.children.length-1;i>=1;i--){const n=e.children[i-1],s=e.children[i];s.dir&&n.dir===s.dir&&(n.children=n.children.concat(s.children),e.children.splice(i,1),t(n))}}(e),e}}(e))},lh.initializeTextBounds();var fh=dh;function ph(t){(t=t||{}).orientation="vertical",Hl.call(this,t)}zn.register("VBox",ph),R(Hl,ph);var mh=ph,gh=new r("miscworks");function yh(t,e){return t[0]===e?t[1]:t[0]}window.scenery=zn,window.kite=Je,window.dot=pe,window.phetCore=a,window.axon=c,window.miscworks=gh,gh.register("other",yh);var bh=yh;class vh{constructor(t){this.duration=t}}const _h=f.byMap({SWAP:new vh(0),SELECTION_LEFT:new vh(.08),SELECTION_RIGHT:new vh(.08),SELECTION_OUT:new vh(.08),SELECTION_IN:new vh(.08),SELECT:new vh(0),SHIFT_LEFT:new vh(.08),SHIFT_RIGHT:new vh(.08),SHIFT_UP:new vh(.08),SHIFT_DOWN:new vh(.08),APPLY:new vh(0),CANCEL:new vh(0),RESET:new vh(0)});gh.register("RingAction",_h);var wh=_h;const Ah={ROWS:12,RINGS:4,LIGHT_BACKGROUND:new rs(180,180,180),DARK_BACKGROUND:new rs(100,100,100),HEART_FOREGROUND:new rs(15667216),HEART_BACKGROUND:new rs(5898240),STAR_FOREGROUND:new rs(14605824),STAR_BACKGROUND:new rs(5392896),DIAMOND_FOREGROUND:new rs(14031103),DIAMOND_BACKGROUND:new rs(4325516),DOWN_TRIANGLE_FOREGROUND:new rs(3761151),DOWN_TRIANGLE_BACKGROUND:new rs(148),UP_TRIANGLE_FOREGROUND:new rs(61423),UP_TRIANGLE_BACKGROUND:new rs(27499),CIRCLE_FOREGROUND:new rs(59136),CIRCLE_BACKGROUND:new rs(23040),INNER_RADIUS:70,OUTER_RADIUS:200};Ah.HALF_ROWS=Ah.ROWS/2,Ah.PIECE_RADIUS=(Ah.OUTER_RADIUS-Ah.INNER_RADIUS)/Ah.RINGS,Ah.PIECE_ANGLE=2*Math.PI/Ah.ROWS,Ah.MIN_RINGY=-.5,Ah.MAX_RINGY=Ah.RINGS-.5,Ah.mod=(t,e)=>{const i=t%e;return i<0?i+e:i},Ah.rowRingDelta=(t,e,i)=>(t+=i.x,(e+=i.y)<0&&(e=1+e,t+=Ah.HALF_ROWS),e>=Ah.RINGS&&(e=2*Ah.RINGS-e-1,t+=Ah.HALF_ROWS),new je(Ah.mod(t,Ah.ROWS),Ah.mod(e,Ah.RINGS))),Ah.rowToTheta=t=>(t+.5)*Ah.PIECE_ANGLE-Math.PI/2,Ah.ringToRadius=t=>Ah.INNER_RADIUS+(t+.5)*Ah.PIECE_RADIUS,Ah.rowRingToPlanar=(t,e)=>je.createPolar(Ah.ringToRadius(e),Ah.rowToTheta(t)),Ah.sameRow=(t,e)=>0===Be.moduloBetweenDown(t-e,0,Ah.ROWS),Ah.sameOrOppositeRow=(t,e)=>0===Be.moduloBetweenDown(t-e,0,Ah.HALF_ROWS),gh.register("RingConstants",Ah);var xh=Ah;const Th=f.byKeys(["NONE","HEART","STAR","DIAMOND","DOWN_TRIANGLE","UP_TRIANGLE","CIRCLE"]);gh.register("RingContent",Th);var Sh=Th;const Dh=f.byKeys(["HAMMER","JUMP"]);gh.register("RingMatchType",Dh);var Eh=Dh;class Ch{constructor(t,e){this.type=t,this.row=e,this.filter=e=>t===Eh.HAMMER?(e.row===this.row||e.row===(this.row+1)%xh.ROWS)&&e.ring<=1:e.row===this.row}toString(){return`(${this.type} ${this.row})`}}gh.register("RingMatch",Ch);var Ih=Ch;const Ph=f.byKeys(["RING","ROW"]);gh.register("RingSliceType",Ph);var kh=Ph;class Lh{constructor(t,e){this.slice=t,this.direction=e}getDelta(t,e){return this.slice.includes(t,e)?this.slice.type===kh.RING?new je(this.direction,0):xh.sameRow(this.slice.index,t)?new je(0,this.direction):new je(0,-this.direction):je.ZERO}toString(){return`(${this.slice} ${this.direction})`}}gh.register("RingMove",Lh);var Oh=Lh;class Nh{constructor(t,e,i,n){this.row=t,this.ring=e,this.content=i,this.backgroundColor=n}apply(t){if(t.slice.includes(this.row,this.ring)){const e=xh.rowRingDelta(this.row,this.ring,t.getDelta(this.row,this.ring));return new Nh(e.x,e.y,this.content,this.backgroundColor)}return this}withContent(t){return new Nh(this.row,this.ring,t,this.backgroundColor)}static filterFrom(t){return e=>_.some(t,t=>e.row===t.row&&e.ring===t.ring)}}gh.register("RingPiece",Nh);var Rh=Nh;class Mh{constructor(t,e){this.type=t,this.index=e}includes(t,e){return this.type===kh.RING?this.index===e:xh.sameOrOppositeRow(this.index,t)}equals(t){return this.type===t.type&&this.index===t.index}toString(){return`(${this.type} ${this.index})`}}gh.register("RingSlice",Mh);var Bh=Mh;class Fh{constructor(t){this.pieces=t}apply(t){return new Fh(Fh.moveMap(this.pieces,t,e=>e.apply(t)))}map(t){return new Fh(this.pieces.map(t))}withContent(t,e){return this.map(i=>e(i)?i.withContent(t):i)}get emptyPieces(){return this.pieces.filter(t=>t.content===Sh.NONE)}getFourRandomPieces(){const t=this.emptyPieces;return _.shuffle(t).slice(0,4)}attemptRandomAddition(t){const e=this.getFourRandomPieces(),i=_.sample(t);return 0===this.withContent(i,Rh.filterFrom(e)).getMatches().length?{content:i,pieces:e}:null}findRandomAddition(t){for(let e=0;e<15;e++){const e=this.attemptRandomAddition(t);if(e)return e}return null}getMatches(){let t=[];const e=[];for(let r=0;r<xh.ROWS;r++){const i=this.getJumpMatchAt(r);i&&(e.push(new Ih(Eh.JUMP,r)),t=t.concat(i))}const i=_.range(0,xh.ROWS).filter(e=>{const i=this.getHammerMatchAt(e);return i&&_.every(i,e=>!t.includes(e))}),n=_.find(_.range(0,xh.ROWS),t=>!i.includes(t));let s;return s=null==n?i:i.filter(t=>t>n).concat(i.filter(t=>t<n)),s.forEach(i=>{const n=this.getHammerMatchAt(i);_.every(n,e=>!t.includes(e))&&(e.push(new Ih(Eh.HAMMER,i)),t=t.concat(n))}),e}getJumpMatchPieces(t){return _.range(0,xh.RINGS).map(e=>this.pieces[Fh.getIndex(t,e)])}getHammerMatchPieces(t){return[this.pieces[Fh.getIndex(t,0)],this.pieces[Fh.getIndex(t,1)],this.pieces[Fh.getIndex((t+1)%xh.ROWS,0)],this.pieces[Fh.getIndex((t+1)%xh.ROWS,1)]]}hasMatchWithPieces(t){const e=t[0].content;return e!==Sh.NONE&&_.every(t,t=>t.content===e)}getJumpMatchAt(t){const e=this.getJumpMatchPieces(t);return this.hasMatchWithPieces(e)?e:null}getHammerMatchAt(t){const e=this.getHammerMatchPieces(t);return this.hasMatchWithPieces(e)?e:null}static getIndex(t,e){return t+e*xh.ROWS}static moveMap(t,e,i=_.identity){const n=[];return _.range(0,xh.RINGS).forEach(s=>_.range(0,xh.ROWS).forEach(r=>{const o=t[Fh.getIndex(r,s)];if(e.slice.includes(r,s)){const t=xh.rowRingDelta(r,s,e.getDelta(r,s));n[Fh.getIndex(t.x,t.y)]=i(o,t.x,t.y,r,s)}else n[Fh.getIndex(r,s)]=i(o,r,s,r,s)})),n}static generatePuzzle(t){let e=null;for(;!e;)e=Fh.generatePuzzleAttempt(t);return e}static generatePuzzleAttempt(t){let e=Fh.START;t.hammerContents.forEach(t=>{const i=_.range(0,xh.ROWS).filter(t=>_.every(e.getHammerMatchPieces(t),t=>t.content===Sh.NONE)),n=_.sample(i);e=e.withContent(t,Rh.filterFrom(e.getHammerMatchPieces(n)))}),t.jumpContents.forEach(t=>{const i=_.range(0,xh.ROWS).filter(t=>_.every(e.getJumpMatchPieces(t),t=>t.content===Sh.NONE)),n=_.sample(i);e=e.withContent(t,Rh.filterFrom(e.getJumpMatchPieces(n)))});let i=null;return t.sliceTypes.forEach(t=>{let n=_.range(0,t===kh.RING?xh.RINGS:xh.HALF_ROWS).map(e=>new Bh(t,e));if(i&&(n=n.filter(t=>!t.equals(i))),0===n.length)return null;const s=_.sample(n);i=s;const r=new Oh(s,1),o=_.sample(_.range(1,t===kh.RING?xh.ROWS:2*xh.RINGS-1));_.times(o,()=>{e=e.apply(r)})}),e.getMatches().length?null:e}}Fh.START=new Fh(_.flatten(_.range(0,xh.RINGS).map(t=>_.range(0,xh.ROWS).map(e=>new Rh(e,t,Sh.NONE,(e+t)%2==0?xh.LIGHT_BACKGROUND:xh.DARK_BACKGROUND))))),gh.register("RingBoard",Fh);var Vh=Fh;class Hh{constructor(){this.currentSliceIndices={[kh.ROW]:0,[kh.RING]:0},this.currentSlice=new Bh(kh.RING,this.currentSliceIndices[kh.RING]),this.nextSlice=null,this.selected=!1,this.currentBoard=Vh.START,this.savedBoard=Vh.START,this.nextBoard=null,this.currentAction=null,this.pendingActions=[],this.currentRemainingDuration=0,this.currentMove=null,this.beforeEmitter=new C,this.afterEmitter=new C,this.receivedEmitter=new C,this.ratioEmitter=new C,this.appliedEmitter=new C,this.contentChangedEmitter=new C,this.flashEmitter=new C,this.modificationTimeEmitter=new C}appendAction(t){this.pendingActions.push(t),this.receivedEmitter.emit(t)}setContent(t,e){const i=this.currentBoard.pieces.filter(e);this.currentBoard=this.currentBoard.withContent(t,e),this.contentChangedEmitter.emit(t,i)}addContent(t,e){this.setContent(t,e),this.flash(rs.BLACK,e)}clearContent(t){this.setContent(Sh.NONE,t),this.flash(rs.WHITE,t)}flash(t,e){this.flashEmitter.emit(t,this.currentBoard.pieces.filter(e))}addRandomFour(t){const e=this.currentBoard.findRandomAddition(t);e&&this.addContent(e.content,Rh.filterFrom(e.pieces))}changeToBoard(t){this.clearContent(t=>t.content!==Sh.NONE),Sh.VALUES.forEach(e=>{e!==Sh.NONE&&this.addContent(e,i=>t.pieces[Vh.getIndex(i.row,i.ring)].content===e)})}step(t){let e=t;for(;(this.currentAction||this.pendingActions.length)&&e;)this.currentAction||(this.currentAction=this.pendingActions.shift(),this.before(this.currentAction),this.currentRemainingDuration=this.currentAction.duration),e>=this.currentRemainingDuration?(e-=this.currentRemainingDuration,this.after(this.currentAction),this.currentAction=null,this.currentRemainingDuration=0,this.modificationTimeEmitter.emit()):(this.currentRemainingDuration-=e,e=0,this.ratioEmitter.emit(Be.clamp((this.currentAction.duration-this.currentRemainingDuration)/this.currentAction.duration,0,1)));this.currentAction||this.modificationTimeEmitter.emit()}before(t){if(t===wh.SWAP){const t=bh(kh.VALUES,this.currentSlice.type);this.nextSlice=new Bh(t,this.currentSliceIndices[t])}t===wh.SELECTION_LEFT&&this.currentSlice.type===kh.ROW&&(this.nextSlice=new Bh(this.currentSlice.type,xh.mod(this.currentSlice.index-1,xh.HALF_ROWS))),t===wh.SELECTION_RIGHT&&this.currentSlice.type===kh.ROW&&(this.nextSlice=new Bh(this.currentSlice.type,xh.mod(this.currentSlice.index+1,xh.HALF_ROWS))),t===wh.SELECTION_OUT&&this.currentSlice.type===kh.RING&&this.currentSlice.index+1<xh.RINGS&&(this.nextSlice=new Bh(this.currentSlice.type,this.currentSlice.index+1)),t===wh.SELECTION_IN&&this.currentSlice.type===kh.RING&&this.currentSlice.index>0&&(this.nextSlice=new Bh(this.currentSlice.type,this.currentSlice.index-1)),this.nextSlice&&(this.currentSliceIndices[this.nextSlice.type]=this.nextSlice.index),t===wh.SHIFT_LEFT&&(this.currentSlice.type,kh.RING,this.currentMove=new Oh(this.currentSlice,-1)),t===wh.SHIFT_RIGHT&&(this.currentSlice.type,kh.RING,this.currentMove=new Oh(this.currentSlice,1)),t===wh.SHIFT_UP&&this.currentSlice.type===kh.ROW&&(this.currentMove=new Oh(this.currentSlice,this.currentSlice.index<xh.HALF_ROWS/2?1:-1)),t===wh.SHIFT_DOWN&&this.currentSlice.type===kh.ROW&&(this.currentMove=new Oh(this.currentSlice,this.currentSlice.index<xh.HALF_ROWS/2?-1:1)),[wh.SHIFT_LEFT,wh.SHIFT_RIGHT,wh.SHIFT_UP,wh.SHIFT_DOWN].includes(t)&&this.currentMove&&(this.nextBoard=this.currentBoard.apply(this.currentMove)),this.beforeEmitter.emit(t)}after(t){[wh.SWAP,wh.SELECTION_LEFT,wh.SELECTION_RIGHT,wh.SELECTION_OUT,wh.SELECTION_IN].includes(t)&&this.nextSlice&&(this.currentSlice=this.nextSlice,this.nextSlice=null),t===wh.SELECT&&(this.savedBoard=this.currentBoard,this.selected=!0),[wh.SHIFT_LEFT,wh.SHIFT_RIGHT,wh.SHIFT_UP,wh.SHIFT_DOWN].includes(t)&&(this.nextBoard&&(this.currentBoard=this.nextBoard),this.currentMove=null,this.nextBoard=null),t===wh.APPLY&&(this.savedBoard=null,this.selected=!1,this.appliedEmitter.emit()),t===wh.CANCEL&&(this.savedBoard&&(this.currentBoard=this.savedBoard),this.savedBoard=null,this.selected=!1),this.afterEmitter.emit(t)}}gh.register("Ring",Hh);var zh=Hh;class Gh extends zh{constructor(t){super(),this.specificationGenerator=t,this.puzzleMovesTakenProperty=new Ce(0),this.specificationProperty=new Yt(t()),this.startingBoardProperty=new de([this.specificationProperty],t=>Vh.generatePuzzle(t)),this.startingBoardProperty.link(t=>{this.changeToBoard(t)}),this.afterEmitter.addListener(t=>{t===wh.SELECT&&(this.puzzleMovesTakenProperty.value+=1)})}after(t){t===wh.RESET&&(this.selected=!1,this.savedBoard=null,this.resetPuzzle()),super.after(t)}nextPuzzle(){this.specificationProperty.value=this.specificationGenerator(),this.resetPuzzle()}resetPuzzle(){this.puzzleMovesTakenProperty.reset(),this.changeToBoard(this.startingBoardProperty.value)}}gh.register("PuzzleRing",Gh);var qh=Gh;function Yh(t,e){this.initializeCanvasSelfDrawable(t,e),this.initializePaintableStateless(t,e)}zn.register("CircleCanvasDrawable",Yh),R(Jn,Yh,{paintCanvas:function(t,e,i){const n=t.context;n.beginPath(),n.arc(0,0,e._radius,0,2*Math.PI,!1),n.closePath(),e.hasFill()&&(e.beforeCanvasFill(t),n.fill(),e.afterCanvasFill(t)),e.hasPaintableStroke()&&(e.beforeCanvasStroke(t),n.stroke(),e.afterCanvasStroke(t))},markDirtyRadius:function(){this.markPaintDirty()},dispose:function(){Jn.prototype.dispose.call(this),this.disposePaintableStateless()}}),ps.mixInto(Yh),Pe.mixInto(Yh);var Uh=Yh;const jh={mixInto:function(t){const e=t.prototype;e.initializeState=function(t,e){return this.paintDirty=!0,this.dirtyRadius=!0,this.initializePaintableState(t,e),this},e.disposeState=function(){this.disposePaintableState()},e.markPaintDirty=function(){this.paintDirty=!0,this.markDirty()},e.markDirtyRadius=function(){this.dirtyRadius=!0,this.markPaintDirty()},e.setToCleanState=function(){this.paintDirty=!1,this.dirtyRadius=!1},Ss.mixInto(t)}};zn.register("CircleStatefulDrawable",jh);var Wh=jh;function Xh(t,e){if(this.initializeDOMSelfDrawable(t,e),this.initializeState(t,e),this.matrix=this.matrix||oi.dirtyFromPool(),!this.fillElement||!this.strokeElement){const t=document.createElement("div");this.fillElement=t;const e=document.createElement("div");this.strokeElement=e,t.style.display="block",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.pointerEvents="none",e.style.display="block",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.pointerEvents="none",t.appendChild(e)}this.domElement=this.fillElement,mo.prepareForTransform(this.domElement,this.forceAcceleration)}zn.register("CircleDOMDrawable",Xh),R(Xl,Xh,{updateDOM:function(){const t=this.node,e=this.fillElement,i=this.strokeElement;if(this.paintDirty&&(this.dirtyRadius&&(e.style.width=2*t._radius+"px",e.style.height=2*t._radius+"px",e.style[lo.borderRadius]=t._radius+"px"),this.dirtyFill&&(e.style.backgroundColor=t.getCSSFill()),this.dirtyStroke&&(t.hasStroke()?i.style.borderStyle="solid":i.style.borderStyle="none"),t.hasStroke())){const e=!this.hadStroke;(e||this.dirtyLineWidth||this.dirtyRadius)&&(i.style.width=2*t._radius-t.getLineWidth()+"px",i.style.height=2*t._radius-t.getLineWidth()+"px",i.style[lo.borderRadius]=t._radius+t.getLineWidth()/2+"px"),(e||this.dirtyLineWidth)&&(i.style.left=-t.getLineWidth()/2+"px",i.style.top=-t.getLineWidth()/2+"px",i.style.borderWidth=t.getLineWidth()+"px"),(e||this.dirtyStroke)&&(i.style.borderColor=t.getSimpleCSSStroke())}if(this.transformDirty||this.dirtyRadius){this.matrix.set(this.getTransformMatrix());const e=oi.translation(-t._radius,-t._radius);this.matrix.multiplyMatrix(e),e.freeToPool(),mo.applyPreparedTransform(this.matrix,this.fillElement,this.forceAcceleration)}this.setToCleanState(),this.cleanPaintableState(),this.transformDirty=!1},dispose:function(){this.disposeState(),Xl.prototype.dispose.call(this)}}),Wh.mixInto(Xh),Pe.mixInto(Xh);var Kh=Xh;function Qh(t,e){this.initializeSVGSelfDrawable(t,e,!0,!0),this.svgElement=this.svgElement||document.createElementNS(bs,"circle")}zn.register("CircleSVGDrawable",Qh),R(xs,Qh,{updateSVGSelf:function(){const t=this.svgElement;this.dirtyRadius&&t.setAttribute("r",this.node._radius),this.updateFillStrokeStyle(t)}}),Wh.mixInto(Qh),Pe.mixInto(Qh);var Zh=Qh;function $h(t,e){this._radius=0,e="object"==typeof t?t:kn({radius:t},e),_l.call(this,null,e)}zn.register("Circle",$h),R(_l,$h,{_mutatorKeys:["radius"].concat(_l.prototype._mutatorKeys),drawableMarkFlags:_l.prototype.drawableMarkFlags.concat(["radius"]).filter((function(t){return"shape"!==t})),getStrokeRendererBitmask:function(){let t=_l.prototype.getStrokeRendererBitmask.call(this);return this.hasStroke()&&!this.getStroke().isGradient&&!this.getStroke().isPattern&&this.getLineWidth()<=this.getRadius()&&(t|=jn.bitmaskDOM),t},getPathRendererBitmask:function(){return jn.bitmaskCanvas|jn.bitmaskSVG|(lo.borderRadius?jn.bitmaskDOM:0)},invalidateCircle:function(){this._shape=null,this.invalidatePath()},createCircleShape:function(){return En.circle(0,0,this._radius).makeImmutable()},intersectsBoundsSelf:function(t){let e=Math.abs(t.centerX),i=Math.abs(t.centerY);const n=t.maxX-e,s=t.maxY-i;return!(e>n+this._radius||i>s+this._radius)&&(e<=n||i<=s||(e-=n,i-=s,e*e+i*i<=this._radius*this._radius))},canvasPaintSelf:function(t,e){Uh.prototype.paintCanvas(t,this,e)},createDOMDrawable:function(t,e){return Kh.createFromPool(t,e)},createSVGDrawable:function(t,e){return Zh.createFromPool(t,e)},createCanvasDrawable:function(t,e){return Uh.createFromPool(t,e)},setRadius:function(t){if(this._radius!==t){this._radius=t,this.invalidateCircle();const e=this._drawables.length;for(let t=0;t<e;t++)this._drawables[t].markDirtyRadius()}return this},set radius(t){return this.setRadius(t)},getRadius:function(){return this._radius},get radius(){return this.getRadius()},computeShapeBounds:function(){let t=new Ke(-this._radius,-this._radius,this._radius,this._radius);return this._stroke&&(t=t.dilated(this.getLineWidth()/2)),t},containsPointSelf:function(t){const e=t.x*t.x+t.y*t.y;let i,n=!0;if(this._strokePickable){i=this.getLineWidth()/2;const t=this._radius+i;n=n&&e<=t*t}if(this._fillPickable)return this._strokePickable?n:e<=this._radius*this._radius;if(this._strokePickable){const t=this._radius-i;return n&&e>=t*t}return!1},setShape:function(t){if(null!==t)throw new Error("Cannot set the shape of a Circle to something non-null");this.invalidatePath()},getShape:function(){return this._shape||(this._shape=this.createCircleShape()),this._shape},hasShape:function(){return!0}});var Jh=$h,tu=new r("utteranceQueue");const eu={isValidValue:t=>"string"==typeof t||Array.isArray(t)&&_.every(t,t=>"string"==typeof t)};class iu{constructor(t){t=h({alert:null,loopAlerts:!1,predicate:function(){return!0},alertStableDelay:200,alertMaximumDelay:Number.MAX_VALUE},t),this._alert=t.alert,this.loopAlerts=t.loopAlerts,this.numberOfTimesAlerted=0,this.predicate=t.predicate,this.timeInQueue=0,this.stableTime=0,this.alertStableDelay=t.alertStableDelay,this.alertMaximumDelay=t.alertMaximumDelay}getTextToAlert(){let t;if("string"==typeof this._alert)t=this._alert;else if(this.loopAlerts)t=this._alert[this.numberOfTimesAlerted%this._alert.length];else{const e=Math.min(this.numberOfTimesAlerted,this._alert.length-1);t=this._alert[e]}return this.numberOfTimesAlerted++,t}set alert(t){A(t,eu),this._alert=t}get alert(){return this._alert}setAlertStableDelay(t){this.alertStableDelay=t}resetTimingVariables(){this.timeInQueue=0,this.stableTime=0}reset(){this.numberOfTimesAlerted=0,this.resetTimingVariables()}}tu.register("Utterance",iu);var nu=iu;const su={isAlertableDef:function(t){let e=!0;if(Array.isArray(t))for(let i=0;i<t.length&&(e=ru(t[i]),e);i++);else e=ru(t);return e}};var ru=function(t){return"string"==typeof t||"number"==typeof t||t instanceof nu};tu.register("AlertableDef",su);let ou=1;class au{constructor(){this.elementIndex=0,this.announcingEmitter=new $o({parameters:[{valueType:"string"}]}),this.ariaLiveContainer=document.createElement("div"),this.ariaLiveContainer.setAttribute("id","aria-live-elements-"+ou),this.ariaLiveContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; width: 0px; height: 0px; clip: rect(0px 0px 0px 0px); pointer-events: none;");for(let t=1;t<=4;t++){const e=document.createElement("p");e.setAttribute("id",`elements-${ou}-polite-${t}`),e.setAttribute("aria-live","polite"),this.ariaLiveContainer.appendChild(e)}this.ariaLiveElements=Array.from(this.ariaLiveContainer.children),this.announcingEmitter.addListener(t=>{const e=this.ariaLiveElements[this.elementIndex];this.updateLiveElement(e,t),this.elementIndex=(this.elementIndex+1)%this.ariaLiveElements.length}),ou++}announcePolite(t){this.announcingEmitter.emit(t)}updateLiveElement(t,e){t.textContent="",t.hidden=!1,P.setTimeout(()=>{Ar.setTextContent(t,e),P.setTimeout(()=>{t.hidden=!0},200)},0)}}tu.register("AriaHerald",au);var lu=au;class hu extends T{}hu.methods={addToBack:{returnType:Qt,parameterTypes:[Ae],implementation:function(t){return this.phetioObject.addToBack(t)},documentation:"Add the utterance (string) to the end of the queue.",invocableForReadOnlyElements:!1},addToFront:{returnType:Qt,parameterTypes:[Ae],implementation:function(t){return this.phetioObject.addToFront(t)},documentation:"Add the utterance (string) to the beginning of the queue.",invocableForReadOnlyElements:!1},setMuted:{returnType:Qt,parameterTypes:[D],implementation:function(t){this.phetioObject.muted(t)},documentation:"Set whether the utteranceQueue will be muted or not. If muted, utterances still move through the queue but will not be read by screen readers.",invocableForReadOnlyElements:!1},getMuted:{returnType:D,parameterTypes:[Qt],implementation:function(){return this.phetioObject.muted()},documentation:"Get whether the utteranceQueue is muted. If muted, utterances still move through the queue but will not be read by screen readers."},setEnabled:{returnType:Qt,parameterTypes:[D],implementation:function(t){this.phetioObject.enabled(t)},documentation:"Set whether the utteranceQueue will be enabled or not. When enabled, Utterances cannot be added to the queue, and the Queue cannot be cleared. Also nothing will be sent to assistive technology.",invocableForReadOnlyElements:!1},getEnabled:{returnType:D,parameterTypes:[Qt],implementation:function(){return this.phetioObject.enabled()},documentation:"Get whether the utteranceQueue is enabled. When enabled, Utterances cannot be added to the queue, and the Queue cannot be cleared. Also nothing will be sent to assistive technology."}},hu.documentation="Manages a queue of Utterances that are read in order by a screen reader.",hu.events=["announced"],hu.validator={valueType:Object},hu.typeName="UtteranceQueueIO",T.validateSubtype(hu),tu.register("UtteranceQueueIO",hu);var uu=hu;class cu extends Et{constructor(t=!1){let e=null;t||(e={tandem:ot.GENERAL_VIEW.createTandem("utteranceQueue"),phetioType:uu,phetioState:!1}),super(e),this._initialized=!t,this.queue=[],this._muted=!1,this._enabled=!0,this.ariaHerald=new lu,this._initialized&&P.addListener(this.stepQueue.bind(this))}getAriaLiveContainer(){return this.ariaHerald.ariaLiveContainer}addToBack(t){this.initializedAndEnabled&&(t=this.prepareUtterance(t),this.queue.push(t))}addToBackIfDefined(t){null!=t&&this.addToBack(t)}addToFront(t){this.initializedAndEnabled&&(t=this.prepareUtterance(t),this.queue.unshift(t))}prepareUtterance(t){return"string"==typeof t&&(t=new nu({alert:t})),this.removeUtterance(t,{assertExists:!1}),t.stableTime=0,t}removeUtterance(t,e){e=h({assertExists:!0},e),_.remove(this.queue,e=>e===t)}get initializedAndEnabled(){return this._enabled&&this._initialized}canAlertUtterance(t){return!this._muted&&t.predicate()}getNextUtterance(){let t=null;for(let e=0;e<this.queue.length;e++){const i=this.queue[e];if(i.stableTime>i.alertStableDelay||i.timeInQueue>i.alertMaximumDelay){t=i,this.queue.splice(e,1);break}}return t}hasUtterance(t){return _.includes(this.queue,t)}clear(){this.queue=[]}setMuted(t){this._muted=t}set muted(t){this.setMuted(t)}getMuted(){return this._muted}get muted(){return this.getMuted()}setEnabled(t){this._enabled=t}set enabled(t){this.setEnabled(t)}getEnabled(){return this._enabled}get enabled(){return this.getEnabled()}stepQueue(t){if(!this._enabled)return;t*=1e3;for(let i=0;i<this.queue.length;i++)this.queue[i].timeInQueue+=t,this.queue[i].stableTime+=t;const e=this.getNextUtterance();if(e&&this.canAlertUtterance(e)){const t=e.getTextToAlert();this.phetioStartEvent("announced",{data:{utterance:t}}),this.ariaHerald.announcePolite(t),e.timeInQueue=0,this.phetioEndEvent()}}static fromFactory(){const t=new cu,e=t.getAriaLiveContainer();document.body?document.body.appendChild(e):document.children[0].appendChild(e);const i=t=>{phet.axon.timer.emit(t/1e3),window.requestAnimationFrame(i)};return window.requestAnimationFrame(i),t}}tu.register("UtteranceQueue",cu);var du=cu;function fu(t,e){this.display=t,this.trail=e}zn.register("Focus",fu),R(Object,fu);var pu=fu;class mu extends T{static toStateObject(t){A(t,this.validator);const e=[];return t.trail.nodes.forEach((function(t,i){t.isPhetioInstrumented()&&e.push(t.tandem.phetioID)})),{focusedPhetioElement:e}}}mu.validator={valueType:pu},mu.documentation="A IO type for the instance in the simulation which currently has keyboard focus. FocusIO is serialized into and Object with key `focusedPhetioElement` that is a list of PhET-iO elements, from parent-most to child-most cooresponding to the PhET-iO element that was instrumented.",mu.typeName="FocusIO",T.validateSubtype(mu),zn.register("FocusIO",mu);var gu=mu;var yu={KEY_SPACE:32,KEY_ENTER:13,KEY_TAB:9,KEY_RIGHT_ARROW:39,KEY_LEFT_ARROW:37,KEY_UP_ARROW:38,KEY_DOWN_ARROW:40,KEY_SHIFT:16,KEY_CTRL:17,KEY_ALT:18,KEY_ESCAPE:27,KEY_DELETE:46,KEY_BACKSPACE:8,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_PRINT_SCREEN:44,KEY_0:48,KEY_9:57,KEY_A:65,KEY_D:68,KEY_C:67,KEY_H:72,KEY_J:74,KEY_N:78,KEY_S:83,KEY_W:87,KEY_K:75,KEY_L:76,KEY_EQUALS:Xs.firefox?61:187,KEY_PLUS:Xs.firefox?61:187,KEY_MINUS:Xs.firefox?173:189,ARROW_KEYS:[39,37,39,40],isArrowKey:function(t){return t===yu.KEY_RIGHT_ARROW||t===yu.KEY_LEFT_ARROW||t===yu.KEY_UP_ARROW||t===yu.KEY_DOWN_ARROW},isRangeKey:function(t){return t>=yu.KEY_PAGE_UP&&t<=yu.KEY_DOWN_ARROW},isNumberKey:function(t){return t>yu.KEY_0&&t<yu.KEY_9},isWASDKey:function(t){return t===yu.KEY_W||t===yu.KEY_A||t===yu.KEY_S||t===yu.KEY_D}};zn.register("KeyboardUtils",yu);var bu=yu;class vu{constructor(){this.keyState={},this.attachedToDocument=!1,this.documentKeyupListener=null,this.documentKeydownListener=null,this.keydownEmitter=new $o({parameters:[{valueType:Event}]}),this.keyupEmitter=new $o({parameters:[{valueType:Event}]});const t=this.step.bind(this);P.addListener(t),this._disposeKeystateTracker=()=>{P.removeListener(t),this.attachedToDocument&&this.detachFromDocument()}}keydownUpdate(t){this.correctModifierKeys(t),this.isKeyDown(t.keyCode)||(this.keyState[t.keyCode]={keyDown:!0,keyCode:t.keyCode,timeDown:0}),this.keydownEmitter.emit(t)}correctModifierKeys(t){t.shiftKey&&!this.shiftKeyDown&&(this.keyState[bu.KEY_SHIFT]={keyDown:!0,keyCode:t.keyCode,timeDown:0}),t.altKey&&!this.altKeyDown&&(this.keyState[bu.KEY_ALT]={keyDown:!0,keyCode:t.keyCode,timeDown:0}),t.ctrlKey&&!this.ctrlKeyDown&&(this.keyState[bu.KEY_CTRL]={keyDown:!0,keyCode:t.keyCode,timeDown:0}),!t.shiftKey&&this.shiftKeyDown&&delete this.keyState[bu.KEY_SHIFT],!t.altKey&&this.altKeyDown&&delete this.keyState[bu.KEY_ALT],!t.ctrlKey&&this.ctrlKeyDown&&delete this.keyState[bu.KEY_CTRL]}keyupUpdate(t){const e=t.keyCode;this.correctModifierKeys(t),this.isKeyDown(e)&&delete this.keyState[e],this.keyupEmitter.emit(t)}get movementKeysDown(){return this.rightMovementKeysDown()||this.leftMovementKeysDown()||this.upMovementKeysDown()||this.downMovementKeysDown()}isKeyDown(t){return!!this.keyState[t]&&this.keyState[t].keyDown}isAnyKeyInListDown(t){for(let e=0;e<t.length;e++)if(this.isKeyDown(t[e]))return!0;return!1}areKeysDown(t){for(let e=0;e<t.length;e++)if(!this.isKeyDown(t[e]))return!1;return!0}keysAreDown(){return!!Object.keys(this.keyState).length>0}get enterKeyDown(){return this.isKeyDown(bu.KEY_ENTER)}get shiftKeyDown(){return this.isKeyDown(bu.KEY_SHIFT)}get altKeyDown(){return this.isKeyDown(bu.KEY_ALT)}get ctrlKeyDown(){return this.isKeyDown(bu.KEY_CTRL)}timeDownForKey(t){return this.keyState[t].timeDown}clearState(){this.keyState={}}step(t){if(this.keysAreDown()){const e=1e3*t;for(const t in this.keyState)this.keyState.hasOwnProperty(t)&&this.keyState[t].keyDown&&(this.keyState[t].timeDown+=e)}}attachToDocument(){this.documentKeydownListener=t=>{this.blockTrustedEvents&&t.isTrusted||this.keydownUpdate(t)},this.documentKeyupListener=t=>{this.blockTrustedEvents&&t.isTrusted||this.keyupUpdate(t)};const t=()=>{window.addEventListener("keyup",this.documentKeyupListener,!0),window.addEventListener("keydown",this.documentKeydownListener,!0),this.attachedToDocument=!0};if(document)t();else{const e=i=>{t(),window.removeEventListener("load",e)};window.addEventListener("load",e)}}detachFromDocument(){window.removeEventListener("keyuop",this.documentKeyupListener),window.removeEventListener("keydown",this.documentKeydownListener),this.documentKeyupListener=null,this.documentKeydownListener=null,this.attachedToDocument=!1}dispose(){this._disposeKeystateTracker()}}zn.register("KeyStateTracker",vu);var _u=vu;class wu extends T{static toStateObject(t){return A(t,this.validator),t.toStateObject()}static fromStateObject(t){return je.fromStateObject(t)}}wu.documentation="A numerical object with x and y properties, like {x:3,y:4}",wu.validator={valueType:je},wu.typeName="Vector2IO",T.validateSubtype(wu),pe.register("Vector2IO",wu);var Au=wu;function xu(t,e,i){this.domEvent=t,this.type=e,this.callback=i}zn.register("BatchedDOMEvent",xu),xu.POINTER_TYPE=1,xu.MS_POINTER_TYPE=2,xu.TOUCH_TYPE=3,xu.MOUSE_TYPE=4,xu.WHEEL_TYPE=5,R(Object,xu,{run:function(t){const e=this.domEvent,i=this.callback;if(t.validatePointers(),this.type===xu.POINTER_TYPE)i.call(t,e.pointerId,e.pointerType,t.pointFromEvent(e),e);else if(this.type===xu.MS_POINTER_TYPE)i.call(t,e.pointerId,Bu.msPointerType(e),t.pointFromEvent(e),e);else if(this.type===xu.TOUCH_TYPE)for(let n=0;n<e.changedTouches.length;n++){const s=e.changedTouches.item(n);i.call(t,s.identifier,t.pointFromEvent(s),e)}else if(this.type===xu.MOUSE_TYPE)i.call(t,t.pointFromEvent(e),e);else{if(this.type!==xu.WHEEL_TYPE)throw new Error("bad type value: "+this.type);i.call(t,e)}},dispose:function(){this.domEvent=null,this.callback=null,this.freeToPool()}}),xu.fromPointerEvent=function(t,e){return xu.createFromPool(t,e(t),t.pointerId)},Pe.mixInto(xu);var Tu=xu;const Su=function(){};var Du={addDisplay:function(t,e,i){this.attachedDisplays.push(t),e?1===this.attachedDisplays.length&&this.connectWindowListeners(i):this.addOrRemoveListeners(t.domElement,!0,i),t.domElement.addEventListener("wheel",this.onwheel,Du.getEventOptions(i,!0))},removeDisplay:function(t,e,i){q(this.attachedDisplays,t),e?0===this.attachedDisplays.length&&this.disconnectWindowListeners(i):this.addOrRemoveListeners(t.domElement,!1,i),t.domElement.removeEventListener("wheel",this.onwheel,Du.getEventOptions(i,!0))},getEventOptions:function(t,e){return!(!lo.passive||null===t)&&(e?{useCapture:!1,passive:t}:{passive:t})},listenersAttachedToWindow:0,listenersAttachedToElement:0,attachedDisplays:[],canUsePointerEvents:!!(window.navigator&&window.navigator.pointerEnabled||window.PointerEvent)&&!Xs.firefox,canUseMSPointerEvents:window.navigator&&window.navigator.msPointerEnabled,pointerListenerTypes:["pointerdown","pointerup","pointermove","pointerover","pointerout","pointercancel"],msPointerListenerTypes:["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerOver","MSPointerOut","MSPointerCancel"],touchListenerTypes:["touchstart","touchend","touchmove","touchcancel"],mouseListenerTypes:["mousedown","mouseup","mousemove","mouseover","mouseout"],wheelListenerTypes:["wheel"],getNonWheelUsedTypes:function(){let t;return t=this.canUsePointerEvents?this.pointerListenerTypes:this.canUseMSPointerEvents?this.msPointerListenerTypes:this.touchListenerTypes.concat(this.mouseListenerTypes),t},connectWindowListeners:function(t){this.addOrRemoveListeners(window,!0,t)},disconnectWindowListeners:function(t){this.addOrRemoveListeners(window,!1,t)},addOrRemoveListeners:function(t,e,i){const n=t===window,s=e?1:-1;n?this.listenersAttachedToWindow+=s:this.listenersAttachedToElement+=s;const r=e?"addEventListener":"removeEventListener",o=this.getNonWheelUsedTypes();for(let a=0;a<o.length;a++){const e=o[a];n&&document[r](e,Su,Du.getEventOptions(i,!1));const s=this["on"+e];t[r](e,s,Du.getEventOptions(i,!0))}},batchWindowEvent:function(t,e,i,n){for(let s=0;s<this.attachedDisplays.length;s++){const r=this.attachedDisplays[s]._input;r.batchEvent(t,e,r[i],n)}},onpointerdown:function(t){"mouse"===t.pointerType&&_c.userGestureEmitter.emit(),Du.batchWindowEvent(t,Tu.POINTER_TYPE,"pointerDown",!1)},onpointerup:function(t){_c.userGestureEmitter.emit(),Du.batchWindowEvent(t,Tu.POINTER_TYPE,"pointerUp",!0)},onpointermove:function(t){Du.batchWindowEvent(t,Tu.POINTER_TYPE,"pointerMove",!1)},onpointerover:function(t){Du.batchWindowEvent(t,Tu.POINTER_TYPE,"pointerOver",!1)},onpointerout:function(t){Du.batchWindowEvent(t,Tu.POINTER_TYPE,"pointerOut",!1)},onpointercancel:function(t){Du.batchWindowEvent(t,Tu.POINTER_TYPE,"pointerCancel",!1)},onMSPointerDown:function(t){Du.batchWindowEvent(t,Tu.MS_POINTER_TYPE,"pointerDown",!1)},onMSPointerUp:function(t){Du.batchWindowEvent(t,Tu.MS_POINTER_TYPE,"pointerUp",!0)},onMSPointerMove:function(t){Du.batchWindowEvent(t,Tu.MS_POINTER_TYPE,"pointerMove",!1)},onMSPointerOver:function(t){Du.batchWindowEvent(t,Tu.MS_POINTER_TYPE,"pointerOver",!1)},onMSPointerOut:function(t){Du.batchWindowEvent(t,Tu.MS_POINTER_TYPE,"pointerOut",!1)},onMSPointerCancel:function(t){Du.batchWindowEvent(t,Tu.MS_POINTER_TYPE,"pointerCancel",!1)},ontouchstart:function(t){Du.batchWindowEvent(t,Tu.TOUCH_TYPE,"touchStart",!1)},ontouchend:function(t){_c.userGestureEmitter.emit(),Du.batchWindowEvent(t,Tu.TOUCH_TYPE,"touchEnd",!0)},ontouchmove:function(t){Du.batchWindowEvent(t,Tu.TOUCH_TYPE,"touchMove",!1)},ontouchcancel:function(t){Du.batchWindowEvent(t,Tu.TOUCH_TYPE,"touchCancel",!1)},onmousedown:function(t){_c.userGestureEmitter.emit(),Du.batchWindowEvent(t,Tu.MOUSE_TYPE,"mouseDown",!1)},onmouseup:function(t){_c.userGestureEmitter.emit(),Du.batchWindowEvent(t,Tu.MOUSE_TYPE,"mouseUp",!0)},onmousemove:function(t){Du.batchWindowEvent(t,Tu.MOUSE_TYPE,"mouseMove",!1)},onmouseover:function(t){Du.batchWindowEvent(t,Tu.MOUSE_TYPE,"mouseOver",!1)},onmouseout:function(t){Du.batchWindowEvent(t,Tu.MOUSE_TYPE,"mouseOut",!1)},onwheel:function(t){Du.batchWindowEvent(t,Tu.WHEEL_TYPE,"wheel",!1)}};zn.register("BrowserEvents",Du);var Eu=Du;class Cu extends T{static toStateObject(t){return A(t,this.validator),zn.Input.serializeDomEvent(t)}static fromStateObject(t){return zn.Input.deserializeDomEvent(t)}}Cu.documentation="A DOM Event",Cu.validator={valueType:window.Event},Cu.typeName="EventIO",T.validateSubtype(Cu),zn.register("EventIO",Cu);var Iu=Cu;class Pu extends Fa{constructor(t){super(null,!1,"a11y"),this.display=t,this.initializeListeners(),this.blockTrustedEvents=!1,this.keydownTargetNode=null}initializeListeners(){this.addInputListener({focus:()=>{this.trail.lastNode().focusable&&(_c.focus=new pu(this.display,Hr.guessVisualTrail(this.trail,this.display.rootNode)),this.display.pointerFocus=null)},blur:t=>{_c.focus=null,this.keydownTargetNode=null},keydown:t=>{this.blockTrustedEvents&&t.domEvent.isTrusted||(this.keydownTargetNode=t.target)},keyup:t=>{this.blockTrustedEvents&&t.domEvent.isTrusted||this.keydownTargetNode!==t.target&&t.abort()}})}updateTrail(t){if(this.trail&&this.trail.getUniqueId()===t)return this.trail;const e=Vs.fromUniqueId(this.display.rootNode,t);return this.trail=e,e}invalidateTrail(t){null!==this.trail&&this.trail.uniqueId===t||(this.trail=Vs.fromUniqueId(this.display.rootNode,t))}}zn.register("PDOMPointer",Pu);var ku=Pu;class Lu{constructor(t,e,i,n){this.handled=!1,this.aborted=!1,this.trail=t,this.type=e,this.pointer=i,this.domEvent=n,this.currentTarget=null,this.target=t.lastNode(),this.isPrimary=!(i instanceof Ha&&n&&0!==n.button),n&&(i.lastDOMEvent=n)}handle(){this.handled=!0}abort(){this.aborted=!0}isFromPDOM(){return this.pointer instanceof ku}canStartPress(){return!(this.pointer.isAttached()||this.pointer instanceof Ha&&0!==this.domEvent.button)}}zn.register("SceneryEvent",Lu);var Ou=Lu;const Nu={type:!0,button:!0,keyCode:!0,deltaX:!0,deltaY:!0,deltaZ:!0,deltaMode:!0,pointerId:!0,pointerType:!0,charCode:!0,which:!0,clientX:!0,clientY:!0,changedTouches:!0,target:!0,ctrlKey:!0,shiftKey:!0,altKey:!0,metaKey:!0},Ru=["focus","blur","focusin","focusout"];class Mu{constructor(t,e,i,n,s,r){if(r=h({tandem:ot.OPTIONAL},r),this.display=t,this.rootNode=t.rootNode,this.attachToWindow=e,this.batchDOMEvents=i,this.assumeFullWindow=n,this.passiveEvents=s,this.batchedEvents=[],this.a11yPointer=null,this.mouse=null,this.pointers=[],this.pointerAddedListeners=[],this.currentlyFiringEvents=!1,this.validatePointersAction=new Uo(()=>{let t=this.pointers.length;for(;t--;){const e=this.pointers[t];e.point&&this.branchChangeEvents(e,e.lastDOMEvent,!1)}},{phetioPlayback:!0,tandem:r.tandem.createTandem("validatePointersAction"),phetioHighFrequency:!0}),this.mouseUpAction=new Uo((t,e)=>{this.mouse||this.initMouse();const i=this.mouse.up(t,e);this.upEvent(this.mouse,e,i)},{phetioPlayback:!0,tandem:r.tandem.createTandem("mouseUpAction"),parameters:[{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a mouse button is released."}),this.mouseDownAction=new Uo((t,e)=>{this.mouse||this.initMouse();const i=this.mouse.down(t,e);this.downEvent(this.mouse,e,i)},{phetioPlayback:!0,tandem:r.tandem.createTandem("mouseDownAction"),parameters:[{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a mouse button is pressed."}),this.mouseMoveAction=new Uo((t,e)=>{this.mouse||this.initMouse(),this.mouse.move(t,e),this.moveEvent(this.mouse,e)},{phetioPlayback:!0,tandem:r.tandem.createTandem("mouseMoveAction"),parameters:[{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the mouse is moved.",phetioHighFrequency:!0}),this.mouseOverAction=new Uo((t,e)=>{this.mouse||this.initMouse(),this.mouse.over(t,e)},{phetioPlayback:!0,tandem:r.tandem.createTandem("mouseOverAction"),parameters:[{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the mouse is moved while on the sim."}),this.mouseOutAction=new Uo((t,e)=>{this.mouse||this.initMouse(),this.mouse.out(t,e)},{phetioPlayback:!0,tandem:r.tandem.createTandem("mouseOutAction"),parameters:[{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the mouse moves out of the display."}),this.wheelScrollAction=new Uo(t=>{if(this.mouse||this.initMouse(),this.mouse.wheel(t),this.mouse.point){const e=this.rootNode.trailUnderPointer(this.mouse)||new Vs(this.rootNode);this.dispatchEvent(e,"wheel",this.mouse,t,!0)}},{phetioPlayback:!0,tandem:r.tandem.createTandem("wheelScrollAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the mouse wheel scrolls.",phetioHighFrequency:!0}),this.touchStartAction=new Uo((t,e,i)=>{const n=new Ya(t,e,i);this.addPointer(n),this.downEvent(n,i,!1)},{phetioPlayback:!0,tandem:r.tandem.createTandem("touchStartAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a touch begins."}),this.touchEndAction=new Uo((t,e,i)=>{const n=this.findPointerById(t);if(n){const t=n.end(e,i);this.upEvent(n,i,t),this.removePointer(n)}},{phetioPlayback:!0,tandem:r.tandem.createTandem("touchEndAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a touch ends."}),this.touchMoveAction=new Uo((t,e,i)=>{const n=this.findPointerById(t);n&&(n.move(e,i),this.moveEvent(n,i))},{phetioPlayback:!0,tandem:r.tandem.createTandem("touchMoveAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a touch moves.",phetioHighFrequency:!0}),this.touchCancelAction=new Uo((t,e,i)=>{const n=this.findPointerById(t);if(n){const t=n.cancel(e,i);this.cancelEvent(n,i,t),this.removePointer(n)}},{phetioPlayback:!0,tandem:r.tandem.createTandem("touchCancelAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a touch is canceled."}),this.penStartAction=new Uo((t,e,i)=>{const n=new Ga(t,e,i);this.addPointer(n),this.downEvent(n,i,!1)},{phetioPlayback:!0,tandem:r.tandem.createTandem("penStartAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a pen touches the screen."}),this.penEndAction=new Uo((t,e,i)=>{const n=this.findPointerById(t);if(n){const t=n.end(e,i);this.upEvent(n,i,t),this.removePointer(n)}},{phetioPlayback:!0,tandem:r.tandem.createTandem("penEndAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a pen is lifted."}),this.penMoveAction=new Uo((t,e,i)=>{const n=this.findPointerById(t);n&&(n.move(e,i),this.moveEvent(n,i))},{phetioPlayback:!0,tandem:r.tandem.createTandem("penMoveAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a pen is moved.",phetioHighFrequency:!0}),this.penCancelAction=new Uo((t,e,i)=>{const n=this.findPointerById(t);if(n){const t=n.cancel(e,i);this.cancelEvent(n,i,t),this.removePointer(n)}},{phetioPlayback:!0,tandem:r.tandem.createTandem("penCancelAction"),parameters:[{name:"id",phetioType:_e},{name:"point",phetioType:Au},{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when a pen is canceled."}),this.display._accessible){let t=!1;this.focusinAction=new Uo(e=>{if(this.display.blockFocusCallbacks)return;if(t)return void(t=!1);const i=this.updateTrailForPDOMDispatch(e);this.dispatchA11yEvent(i,"focus",e,!1),this.dispatchA11yEvent(i,"focusin",e,!0)},{phetioPlayback:!0,tandem:r.tandem.createTandem("focusinAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the focusin DOM event."}),this.focusoutAction=new Uo(e=>{if(this.display.blockFocusCallbacks)return;this.a11yPointer||this.initA11yPointer(),this.a11yPointer.invalidateTrail(this.getTrailId(e));const i=this.updateTrailForPDOMDispatch(e);if(this.dispatchA11yEvent(i,"blur",e,!1),this.dispatchA11yEvent(i,"focusout",e,!0),this.a11yPointer.trail=null,e.relatedTarget){const i=this.isTargetUnderPDOM(document.activeElement);Ar.isElementFocusable(e.relatedTarget)&&!i&&(Xs.ie&&(t=!0),e.relatedTarget.focus())}},{phetioPlayback:!0,tandem:r.tandem.createTandem("focusoutAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the focusout DOM event."}),this.clickAction=new Uo(t=>{const e=this.updateTrailForPDOMDispatch(t);this.dispatchA11yEvent(e,"click",t,!0)},{phetioPlayback:!0,tandem:r.tandem.createTandem("clickAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the click DOM event."}),this.inputAction=new Uo(t=>{const e=this.updateTrailForPDOMDispatch(t);this.dispatchA11yEvent(e,"input",t,!0)},{phetioPlayback:!0,tandem:r.tandem.createTandem("inputAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the input DOM event."}),this.changeAction=new Uo(t=>{const e=this.updateTrailForPDOMDispatch(t);this.dispatchA11yEvent(e,"change",t,!0)},{phetioPlayback:!0,tandem:r.tandem.createTandem("changeAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the change DOM event."}),this.keydownAction=new Uo(t=>{const e=this.updateTrailForPDOMDispatch(t);this.dispatchA11yEvent(e,"keydown",t,!0)},{phetioPlayback:!0,tandem:r.tandem.createTandem("keydownAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the keydown DOM event."}),this.keyupAction=new Uo(t=>{const e=this.updateTrailForPDOMDispatch(t);this.dispatchA11yEvent(e,"keyup",t,!0)},{phetioPlayback:!0,tandem:r.tandem.createTandem("keyupAction"),parameters:[{name:"event",phetioType:Iu}],phetioEventType:z.USER,phetioDocumentation:"Emits when the PDOM root gets the keyup DOM event."});const e=!!lo.passive&&{useCapture:!1,passive:!1};Ar.DOM_EVENTS.forEach(t=>{const i=t+"Action";this.display.accessibleDOMElement.addEventListener(t,t=>{this[i].execute(t)},e)}),document.body.addEventListener("keydown",this.handleDocumentKeydown.bind(this))}}interruptPointers(){_.each(this.pointers,t=>{t.interruptAll()})}batchEvent(t,e,i,n){this.display.interactive&&(this.batchedEvents.push(Tu.createFromPool(t,e,i)),!n&&this.batchDOMEvents||this.fireBatchedEvents()),!0!==this.passiveEvents&&(i!==this.mouseDown||Xs.ie||Xs.edge)&&t.preventDefault()}fireBatchedEvents(){if(!this.currentlyFiringEvents&&this.batchedEvents.length){this.currentlyFiringEvents=!0;const t=this.batchedEvents;for(let e=0;e<t.length;e++){const i=t[e];i.run(this),i.dispose()}ci(t),this.currentlyFiringEvents=!1}}clearBatchedEvents(){this.batchedEvents.length=0}validatePointers(){this.validatePointersAction.execute()}removeTemporaryPointers(){const t={};for(let e=this.pointers.length-1;e>=0;e--){const i=this.pointers[e];if(!(i instanceof Ha)){this.pointers.splice(e,1);const n=i.trail||new Vs(this.rootNode);this.exitEvents(i,t,n,0,!0)}}}connectListeners(){Eu.addDisplay(this.display,this.attachToWindow,this.passiveEvents)}disconnectListeners(){Eu.removeDisplay(this.display,this.attachToWindow,this.passiveEvents)}pointFromEvent(t){const e=je.createFromPool(t.clientX,t.clientY);if(!this.assumeFullWindow){const t=this.display.domElement.getBoundingClientRect();t.width>0&&t.height>0&&(e.subtractXY(t.left,t.top),t.width===this.display.width&&t.height===this.display.height||(e.x*=this.display.width/t.width,e.y*=this.display.height/t.height))}return e}addPointer(t){if(this.pointers.push(t),this.pointerAddedListeners.length)for(let e=0;e<this.pointerAddedListeners.length;e++)this.pointerAddedListeners[e](t)}addPointerAddedListener(t){this.pointerAddedListeners.push(t)}removePointerAddedListener(t){const e=this.pointerAddedListeners.indexOf(t);-1!==e&&this.pointerAddedListeners.splice(e,e+1)}removePointer(t){for(let e=this.pointers.length-1;e>=0;e--)this.pointers[e]===t&&this.pointers.splice(e,1);t.dispose()}findPointerById(t){let e=this.pointers.length;for(;e--;){const i=this.pointers[e];if(i.id===t)return i}return null}initMouse(){this.mouse=new Ha,this.addPointer(this.mouse)}initA11yPointer(){this.a11yPointer=new ku(this.display),this.addPointer(this.a11yPointer)}dispatchA11yEvent(t,e,i,n){_c.userGestureEmitter.emit();const s=t.isPickable()||Ru.includes(e);i.target&&i.target.hasAttribute(Ar.DATA_EXCLUDE_FROM_INPUT)||!s||(ot.PHET_IO_ENABLED&&phet.phetio.dataStream.pushNonPlaybackable(),this.dispatchEvent(t,e,this.a11yPointer,i,n),ot.PHET_IO_ENABLED&&phet.phetio.dataStream.popNonPlaybackable())}updateTrailForPDOMDispatch(t){return this.a11yPointer||this.initA11yPointer(),this.a11yPointer.updateTrail(this.getTrailId(t))}getTrailId(t){return t.targetSubstitute?t.targetSubstitute[Ar.DATA_TRAIL_ID]:t.target.getAttribute(Ar.DATA_TRAIL_ID)}mouseDown(t,e){this.mouseDownAction.execute(t,e)}mouseUp(t,e){this.mouseUpAction.execute(t,e)}mouseMove(t,e){this.mouseMoveAction.execute(t,e)}mouseOver(t,e){this.mouseOverAction.execute(t,e)}mouseOut(t,e){this.mouseOutAction.execute(t,e)}wheel(t){this.wheelScrollAction.execute(t)}touchStart(t,e,i){this.isTargetUnderPDOM(i.target)||this.touchStartAction.execute(t,e,i)}touchEnd(t,e,i){this.isTargetUnderPDOM(i.target)||this.touchEndAction.execute(t,e,i)}touchMove(t,e,i){this.touchMoveAction.execute(t,e,i)}touchCancel(t,e,i){this.touchCancelAction.execute(t,e,i)}penStart(t,e,i){this.penStartAction.execute(t,e,i)}penEnd(t,e,i){this.penEndAction.execute(t,e,i)}penMove(t,e,i){this.penMoveAction.execute(t,e,i)}penCancel(t,e,i){this.penCancelAction.execute(t,e,i)}pointerDown(t,e,i,n){const s=this.attachToWindow?document.body:this.display.domElement;switch(s.setPointerCapture&&n.pointerId&&s.setPointerCapture(n.pointerId),e=this.handleUnknownPointerType(e,t)){case"mouse":this.mouseDown(i,n),this.mouse.id=t;break;case"touch":this.touchStart(t,i,n);break;case"pen":this.penStart(t,i,n);break;default:0}}pointerUp(t,e,i,n){switch(e=this.handleUnknownPointerType(e,t)){case"mouse":this.mouseUp(i,n),this.mouse.id=null;break;case"touch":this.touchEnd(t,i,n);break;case"pen":this.penEnd(t,i,n);break;default:0}}pointerCancel(t,e,i,n){switch(e=this.handleUnknownPointerType(e,t)){case"mouse":console&&console.log&&console.log("WARNING: Pointer mouse cancel was received");break;case"touch":this.touchCancel(t,i,n);break;case"pen":this.penCancel(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}}pointerMove(t,e,i,n){switch(e=this.handleUnknownPointerType(e,t)){case"mouse":this.mouseMove(i,n);break;case"touch":this.touchMove(t,i,n);break;case"pen":this.penMove(t,i,n);break;default:console.log&&console.log("Unknown pointer type: "+e)}}pointerOver(t,e,i,n){}pointerOut(t,e,i,n){}pointerEnter(t,e,i,n){}pointerLeave(t,e,i,n){}handleUnknownPointerType(t,e){return""!==t?t:this.mouse&&this.mouse.id===e?"mouse":"touch"}getPointerTrail(t){return this.rootNode.trailUnderPointer(t)||new Vs(this.rootNode)}upEvent(t,e,i){if(this.isTargetUnderPDOM(e.target))return;const n=this.branchChangeEvents(t,e,i);this.dispatchEvent(n,"up",t,e,!0),t instanceof Ya&&this.exitEvents(t,e,n,0,!0)}downEvent(t,e,i){if(this.isTargetUnderPDOM(e.target))return;const n=this.branchChangeEvents(t,e,i);let s=null;if(!n.rootNode()._rendererSummary.isNotAccessible()){if(this.display.bounds.containsPoint(t.point)){for(let t=n.nodes.length-1;t>=0;t--)if(n.nodes[t].focusable){s=n.nodes[t];break}this.display.pointerFocus=s,_c.focus=null}}this.dispatchEvent(n,"down",t,e,!0)}moveEvent(t,e){this.branchChangeEvents(t,e,!0)}cancelEvent(t,e,i){const n=this.branchChangeEvents(t,e,i);this.dispatchEvent(n,"cancel",t,e,!0),t instanceof Ya&&this.exitEvents(t,e,n,0,!0)}branchChangeEvents(t,e,i){const n=this.getPointerTrail(t),s=t.trail||new Vs(this.rootNode),r=s.lastNode()!==n.lastNode(),o=Vs.branchIndex(n,s),a=o!==n.length||o!==s.length;return i&&this.dispatchEvent(n,"move",t,e,!0),a&&(this.exitEvents(t,e,s,o,r),this.enterEvents(t,e,n,o,r)),t.trail=n,n}enterEvents(t,e,i,n,s){if(i.length>n)for(let r=i.length-1;r>=n;r--)this.dispatchEvent(i.slice(0,r+1),"enter",t,e,!1);s&&this.dispatchEvent(i,"over",t,e,!0)}exitEvents(t,e,i,n,s){if(s&&this.dispatchEvent(i,"out",t,e,!0),i.length>n)for(let r=n;r<i.length;r++)this.dispatchEvent(i.slice(0,r+1),"exit",t,e,!1)}dispatchEvent(t,e,i,n,s){const r=new Ou(t,e,i,n);this.dispatchToListeners(i,i.getListeners(),e,r),this.dispatchToTargets(t,e,i,r,s),this.dispatchToListeners(i,this.display.getInputListeners(),e,r)}dispatchToListeners(t,e,i,n){if(n.handled)return;const s=t.type+i;for(let r=0;r<e.length;r++){const t=e[r];!n.aborted&&t[s]&&t[s](n),!n.aborted&&t[i]&&t[i](n)}}dispatchToTargets(t,e,i,n,s){if(!n.aborted&&!n.handled)for(let r=t.getLastInputEnabledIndex();r>=0;s?r--:r=-1){const s=t.nodes[r];if(!s.isDisposed&&(n.currentTarget=s,this.dispatchToListeners(i,s.getInputListeners(),e,n),n.aborted||n.handled))return}}isTargetUnderPDOM(t){return this.display._accessible&&this.display.accessibleDOMElement.contains(t)}handleDocumentKeydown(t){if(or.isFullScreen()&&t.keyCode===bu.KEY_TAB){const e=this.display.accessibleDOMElement;(t.shiftKey?Ar.getPreviousFocusable(e):Ar.getNextFocusable(e))===t.target&&t.preventDefault()}if(this.display.pointerFocus||this.display.activeNode){const e=this.display.pointerFocus||this.display.activeNode;1===e.getAccessibleInstances().length&&e.focusable&&e.accessibleInstances[0].trail.isVisible()&&t.keyCode===bu.KEY_TAB&&(t.preventDefault(),e.focus(),this.display.pointerFocus=null,this.display.activeNode=null)}}static serializeDomEvent(t){const e={};for(const i in t)if(Nu[i]){const n=t[i];if("touches"===i||"targetTouches"===i||"changedTouches"===i){const t=[];for(let e=0;e<n.length;e++){const i=n.item&&"function"==typeof n.item?n.item(e):n[e];t.push(Mu.serializeDomEvent(i))}e[i]=t}"target"===i&&null!==n&&"function"==typeof n.getAttribute&&n.hasAttribute(Ar.DATA_TRAIL_ID)?(e[i]={},e[i][Ar.DATA_TRAIL_ID]=n.getAttribute(Ar.DATA_TRAIL_ID)):e[i]="object"==typeof n&&null!==n?{}:JSON.parse(JSON.stringify(n))}return e}static deserializeDomEvent(t){const e=Xs.ie?document.createEvent("Event"):new window.Event("Event");for(const i in t)t.hasOwnProperty(i)&&"type"!==i&&("target"===i?e.targetSubstitute=t[i]:e[i]=t[i]);return e}static debugText(t,e){let i=e.timeStamp+" "+e.type;return null!==t&&(i=t.x+","+t.y+" "+i),i}static msPointerType(t){return t.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?"touch":t.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_PEN?"pen":t.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?"mouse":t.pointerType}}Mu.BASIC_EVENT_TYPES=()=>["down","up","cancel","move","wheel","enter","exit","over","out"],Mu.A11Y_EVENT_TYPES=()=>["focus","blur","click","input","change","keydown","keyup","focusin","focusout"],Mu.EVENT_PREFIXES=()=>["","mouse","touch","pen"],Mu.ALL_EVENT_TYPES=()=>Mu.EVENT_PREFIXES.map(t=>Mu.BASIC_EVENT_TYPES.map(e=>t+e)).concat([Mu.A11Y_EVENT_TYPES]),zn.register("Input",Mu);var Bu=Mu;const Fu=[];function Vu(t,e){this.initializeCanvasSelfDrawable(t,e)}zn.register("CanvasNodeDrawable",Vu),R(Jn,Vu,{paintCanvas:function(t,e,i){if(!e.selfBounds.isEmpty()){const i=t.context;i.save(),i.fillStyle="black",i.strokeStyle="black",i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.lineDash=Fu,i.lineDashOffset=0,i.miterLimit=10,e.paintCanvas(i),i.restore()}}}),Pe.mixInto(Vu);var Hu=Vu;function zu(t){ll.call(this,t),this.setRendererBitmask(jn.bitmaskCanvas)}zn.register("CanvasNode",zu),R(ll,zu,{_mutatorKeys:["canvasBounds"].concat(ll.prototype._mutatorKeys),setCanvasBounds:function(t){this.invalidateSelf(t)},set canvasBounds(t){this.setCanvasBounds(t)},getCanvasBounds:function(){return this.getSelfBounds()},get canvasBounds(){return this.getCanvasBounds()},isPainted:function(){return!0},paintCanvas:function(t){throw new Error("CanvasNode needs paintCanvas implemented")},invalidatePaint:function(){const t=this._drawables.length;for(let e=0;e<t;e++)this._drawables[e].markDirty()},canvasPaintSelf:function(t,e){this.paintCanvas(t.context)},containsPointSelf:function(t){return!1},getSelfShape:function(){return new En},createCanvasDrawable:function(t,e){return Hu.createFromPool(t,e)}});var Gu=zu;function qu(t,e,i){this.display=t,this.rootNode=e;const n=document.createElementNS(bs,"svg");n.style.position="absolute",n.setAttribute("class",i),n.style.top=0,n.style.left=0,n.style["pointer-events"]="none",this.svg=n,t.sizeProperty.link((function(t){var e,i;e=t.width,i=t.height,n.setAttribute("width",e),n.setAttribute("height",i),n.style.clip="rect(0px,"+e+"px,"+i+"px,0px)"})),this.domElement=n}zn.register("ShapeBasedOverlay",qu),R(Object,qu,{addShape:function(t,e,i){const n=document.createElementNS(bs,"path");let s=t.getSVGPath();s||(s="M0 0"),s?n.setAttribute("d",s):n.hasAttribute("d")&&n.removeAttribute("d"),n.setAttribute("style","fill: none; stroke: "+e+"; stroke-dasharray: 5, 3; stroke-dashoffset: "+(i?5:0)+"; stroke-width: 3;"),this.svg.appendChild(n)},update:function(){for(;this.svg.childNodes.length;)this.svg.removeChild(this.svg.childNodes[this.svg.childNodes.length-1]);this.addShapes()},addShapes:function(){},dispose:function(){}});var Yu=qu;function Uu(t,e){Yu.call(this,t,e,"canvasNodeBoundsOverlay")}zn.register("CanvasNodeBoundsOverlay",Uu),R(Yu,Uu,{addShapes:function(){const t=this;new Vs(this.rootNode).eachTrailUnder((function(e){const i=e.lastNode();if(!i.isVisible())return!0;if(i instanceof Gu&&e.isVisible()){const n=e.getTransform();t.addShape(n.transformShape(En.bounds(i.selfBounds)),"rgba(0,255,0,0.8)",!0)}}))}});var ju=Uu;function Wu(t,e){Yu.call(this,t,e,"canvasNodeBoundsOverlay")}zn.register("FittedBlockBoundsOverlay",Wu),R(Yu,Wu,{addShapes:function(){const t=this;function e(e,n){e.willApplyTransform&&(n=n.timesMatrix(e.backboneInstance.relativeTransform.matrix)),e.blocks.forEach((function(e){!function(e,n){e.fitBounds&&!e.fitBounds.isEmpty()&&t.addShape(En.bounds(e.fitBounds).transformed(n),"rgba(255,0,0,0.8)",!0);if(e.firstDrawable&&e.lastDrawable){for(let t=e.firstDrawable;t!==e.lastDrawable;t=t.nextDrawable)i(t,n);i(e.lastDrawable,n)}}(e,n)}))}function i(t,i){t.backboneInstance&&e(t,i)}e(this.display._rootBackbone,oi.IDENTITY)}});var Xu=Wu;const Ku=new rs("rgba(212,19,106,0.5)"),Qu=new rs("rgba(250,40,135,0.9)"),Zu=new rs("rgba(233,113,166,1.0)"),$u=new rs("rgba(233,113,166,1.0)"),Ju=new rs("rgba(159,15,80,1.0)"),tc=new rs("rgba(159,15,80,1.0)");function ec(t,e){e=h({outerStroke:Ku,innerStroke:Qu,outerLineWidth:null,innerLineWidth:null,transformSourceNode:null,lineDash:[],lineCap:Qi.DEFAULT_OPTIONS.lineCap,lineJoin:Qi.DEFAULT_OPTIONS.lineJoin,miterLimit:Qi.DEFAULT_OPTIONS.miterLimit,lineDashOffset:Qi.DEFAULT_OPTIONS.lineDashOffset},e),this._innerHighlightColor=e.innerStroke,this._outerHighlightColor=e.outerStroke,this.highlightChangedEmitter=new $o,_l.call(this,t),this.options=e,this.transformSourceNode=e.transformSourceNode;const i=h({stroke:e.outerStroke},e);this.mutate(i),this.innerHighlightPath=new _l(t,{stroke:e.innerStroke,lineDash:e.lineDash,lineCap:e.lineCap,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDashOffset:e.lineDashOffset}),this.addChild(this.innerHighlightPath),this.updateLineWidth()}zn.register("FocusHighlightPath",ec),R(_l,ec,{mutateWithInnerHighlight:function(t){_l.prototype.mutate.call(this,t),this.innerHighlightPath&&this.innerHighlightPath.mutate(t),this.highlightChangedEmitter.emit()},makeDashed:function(){this.mutateWithInnerHighlight({lineDash:[7,7]})},setShape:function(t){_l.prototype.setShape.call(this,t),this.innerHighlightPath&&this.innerHighlightPath.setShape(t),this.highlightChangedEmitter.emit()},updateLineWidth:function(t){t=t||this,this.lineWidth=this.getOuterLineWidth(t),this.innerHighlightPath.lineWidth=this.getInnerLineWidth(t),this.highlightChangedEmitter.emit()},getOuterLineWidth:function(t){return this.options.outerLineWidth?this.options.outerLineWidth:ec.getOuterLineWidthFromNode(t)},getInnerLineWidth:function(t){return this.options.innerLineWidth?this.options.innerLineWidth:ec.getInnerLineWidthFromNode(t)},setInnerHighlightColor:function(t){this._innerHighlightColor=t,this.innerHighlightPath.setStroke(t),this.highlightChangedEmitter.emit()},set innerHighlightColor(t){this.setInnerHighlightColor(t)},getInnerHighlightColor:function(){return this._innerHighlightColor},get innerHighlightColor(){return this.getInnerHighlightColor()},setOuterHighlightColor:function(t){this._outerHighlightColor=t,this.setStroke(t),this.highlightChangedEmitter.emit()},set outerHighlightColor(t){this.setOuterHighlightColor(t)},getOuterHighlightColor:function(){return this._outerHighlightColor},get outerHighlightColor(){return this.getOuterHighlightColor()},getUniqueHighlightTrail:function(){return this.transformSourceNode.getUniqueTrail()}},{OUTER_FOCUS_COLOR:Ku,INNER_FOCUS_COLOR:Qu,INNER_LIGHT_GROUP_FOCUS_COLOR:Zu,OUTER_LIGHT_GROUP_FOCUS_COLOR:$u,INNER_DARK_GROUP_FOCUS_COLOR:Ju,OUTER_DARK_GROUP_FOCUS_COLOR:tc,GROUP_OUTER_LINE_WIDTH:2,GROUP_INNER_LINE_WIDTH:2,getInnerLineWidthFromNode:function(t){return 2.5/ec.getWidthMagnitudeFromTransform(t)},getOuterLineWidthFromNode:function(t){return 4/ec.getWidthMagnitudeFromTransform(t)},getWidthMagnitudeFromTransform:function(t){return t.transform.transformDelta2(je.X_UNIT).magnitude},getDilationCoefficient:function(t){return.75*ec.getOuterLineWidthFromNode(t)},getGroupDilationCoefficient:function(t){return 1.9*ec.getOuterLineWidthFromNode(t)}});var ic=ec;function nc(t,e){e=h({useLocalBounds:!0,transformSourceNode:t,outerLineWidth:null,innerLineWidth:null,dilationCoefficient:null,useGroupDilation:!1},e),this.useLocalBounds=e.useLocalBounds,this.useGroupDilation=e.useGroupDilation,this.dilationCoefficient=e.dilationCoefficient,ic.call(this,null,e),this.outerLineWidth=e.outerLineWidth,this.innerLineWidth=e.innerLineWidth,this.observedBoundsProperty=null,this.boundsListener=null,t&&this.setShapeFromNode(t)}zn.register("FocusHighlightFromNode",nc),R(ic,nc,{setShapeFromNode:function(t){this.observedBoundsProperty&&this.observedBoundsProperty.unlink(this.boundsListener),this.observedBoundsProperty=this.useLocalBounds?t.localBoundsProperty:t.boundsProperty,this.boundsListener=e=>{if(this.observedBoundsProperty.get(),!e.isFinite())return;let i=this.dilationCoefficient;null===this.dilationCoefficient&&(i=this.useGroupDilation?ic.getGroupDilationCoefficient(t):ic.getDilationCoefficient(t));const n=e.dilated(i);this.updateLineWidthFromNode(t),this.setShape(En.bounds(n))},this.observedBoundsProperty.link(this.boundsListener)},updateLineWidthFromNode:function(t){this.lineWidth=this.outerLineWidth||ic.getOuterLineWidthFromNode(t),this.innerHighlightPath.lineWidth=this.innerLineWidth||ic.getInnerLineWidthFromNode(t)}});var sc=nc;let rc=ic.OUTER_FOCUS_COLOR,oc=ic.INNER_FOCUS_COLOR,ac=ic.INNER_LIGHT_GROUP_FOCUS_COLOR,lc=ic.OUTER_LIGHT_GROUP_FOCUS_COLOR;function hc(t,e){this.display=t,this.focusRootNode=e,this.trail=null,this.node=null,this.mode=null,this.groupMode=null,this.groupHighlightNode=null,this.transformTracker=null,this.groupTransformTracker=null,this.nodeFocusHighlight=null,this.transformDirty=!0,this.highlightNode=new ll,this.focusRootNode.addChild(this.highlightNode),this.focusDisplay=new _c(this.focusRootNode,{width:this.width,height:this.height,allowWebGL:t._allowWebGL,allowCSSHacks:!1,accessibility:!1,interactive:!1}),this.domElement=this.focusDisplay.domElement,this.domElement.style.pointerEvents="none",this.shapeFocusHighlightPath=new ic(null),this.boundsFocusHighlightPath=new sc(null,{useLocalBounds:!0}),this.groupFocusHighlightPath=new sc(null,{useLocalBounds:!0,useGroupDilation:!0,outerLineWidth:ic.GROUP_OUTER_LINE_WIDTH,innerLineWidth:ic.GROUP_INNER_LINE_WIDTH,innerStroke:ic.FOCUS_COLOR}),this.highlightNode.addChild(this.shapeFocusHighlightPath),this.highlightNode.addChild(this.boundsFocusHighlightPath),this.focusRootNode.addChild(this.groupFocusHighlightPath),this.boundsListener=this.onBoundsChange.bind(this),this.transformListener=this.onTransformChange.bind(this),this.focusListener=this.onFocusChange.bind(this),this.focusHighlightListener=this.onFocusHighlightChange.bind(this),_c.focusProperty.link(this.focusListener)}zn.register("FocusOverlay",hc),R(Object,hc,{dispose:function(){this.hasHighlight()&&this.deactivateHighlight(),_c.focusProperty.unlink(this.focusListener)},hasHighlight:function(){return!!this.trail},activateHighlight:function(t){this.trail=t,this.node=t.lastNode();const e=this.node.focusHighlight;let i=t;"invisible"===e?this.mode="invisible":e instanceof En?(this.mode="shape",this.shapeFocusHighlightPath.visible=!0,this.shapeFocusHighlightPath.setShape(e)):e instanceof ll?(this.mode="node",e.transformSourceNode&&(i=e.getUniqueHighlightTrail()),this.nodeFocusHighlight=e,this.node.focusHighlightLayerable?this.nodeFocusHighlight.visible=!0:(this.nodeFocusHighlight.visible=!0,this.highlightNode.addChild(this.nodeFocusHighlight))):(this.mode="bounds",this.boundsFocusHighlightPath.setShapeFromNode(this.node),this.boundsFocusHighlightPath.visible=!0,this.node.localBoundsProperty.lazyLink(this.boundsListener),this.onBoundsChange()),this.node.focusHighlightChangedEmitter.addListener(this.focusHighlightListener),this.transformTracker=new Qs(i,{isStatic:!0}),this.transformTracker.addListener(this.transformListener),this.activateGroupHighlights(),this.updateHighlightColors(),this.transformDirty=!0},deactivateHighlight:function(){"shape"===this.mode?this.shapeFocusHighlightPath.visible=!1:"node"===this.mode?this.node.focusHighlightLayerable?this.node.focusHighlight.visible=!1:(this.highlightNode.removeChild(this.nodeFocusHighlight),this.nodeFocusHighlight=null):"bounds"===this.mode&&(this.boundsFocusHighlightPath.visible=!1,this.node.localBoundsProperty.unlink(this.boundsListener)),this.node.focusHighlightChangedEmitter.removeListener(this.focusHighlightListener),this.deactivateGroupHighlights(),this.trail=null,this.node=null,this.mode=null,this.transformTracker.removeListener(this.transformListener),this.transformTracker.dispose()},activateGroupHighlights:function(){const t=this.trail;for(let e=0;e<t.length;e++){const i=t.nodes[e],n=i.groupFocusHighlight;if(n){const e=t.upToNode(i);this.groupTransformTracker=new Qs(e),this.groupTransformTracker.addListener(this.transformListener),"boolean"==typeof n?(this.groupFocusHighlightPath.setShapeFromNode(i),this.groupFocusHighlightPath.visible=!0,this.groupHighlightNode=this.groupFocusHighlightPath,this.groupMode="bounds"):n instanceof ll&&(this.groupHighlightNode=n,this.focusRootNode.addChild(n),this.groupMode="node");break}}},updateHighlightColors:function(){"shape"===this.mode?(this.shapeFocusHighlightPath.innerHighlightColor!==hc.innerHighlightColor&&this.shapeFocusHighlightPath.setInnerHighlightColor(hc.innerHighlightColor),this.shapeFocusHighlightPath.outerHighlightColor!==hc.outerHighlightColor&&this.shapeFocusHighlightPath.setOuterHighlightColor(hc.outerHighlightColor)):"bounds"===this.mode&&(this.boundsFocusHighlightPath.innerHighlightColor!==hc.innerHighlightColor&&this.boundsFocusHighlightPath.setInnerHighlightColor(hc.innerHighlightColor),this.boundsFocusHighlightPath.outerHighlightColor!==hc.outerHighlightColor&&this.boundsFocusHighlightPath.setOuterHighlightColor(hc.outerHighlightColor)),this.groupMode&&(this.groupFocusHighlightPath.innerHighlightColor!==hc.innerGroupHighlightColor&&this.groupFocusHighlightPath.setInnerHighlightColor(hc.innerGroupHighlightColor),this.groupFocusHighlightPath.outerHighlightColor!==hc.outerGroupHighlightColor&&this.groupFocusHighlightPath.setOuterHighlightColor(hc.outerGroupHighlightColor))},deactivateGroupHighlights:function(){this.groupMode&&("bounds"===this.groupMode?this.groupFocusHighlightPath.visible=!1:"node"===this.groupMode&&this.focusRootNode.removeChild(this.groupHighlightNode),this.groupMode=null,this.groupHighlightNode=null,this.groupTransformTracker.removeListener(this.transformListener),this.groupTransformTracker.dispose())},afterTransform:function(){"shape"===this.mode?this.shapeFocusHighlightPath.updateLineWidth():"bounds"===this.mode?this.boundsFocusHighlightPath.updateLineWidth():"node"===this.mode&&this.node.focusHighlight.updateLineWidth&&this.node.focusHighlight.updateLineWidth(this.node)},onTransformChange:function(){this.transformDirty=!0},onBoundsChange:function(){this.boundsFocusHighlightPath.setShapeFromNode(this.node)},onFocusChange:function(t){const e=t&&t.display===this.display?t.trail:null;this.hasHighlight()&&this.deactivateHighlight(),e&&this.activateHighlight(e)},onFocusHighlightChange:function(){this.onFocusChange(_c.focus)},update:function(){this.hasHighlight()&&this.transformDirty&&(this.transformDirty=!1,this.highlightNode.setMatrix(this.transformTracker.matrix),this.groupHighlightNode&&this.groupHighlightNode.setMatrix(this.groupTransformTracker.matrix),this.afterTransform()),this.display.size.equals(this.focusDisplay.size)||this.focusDisplay.setWidthHeight(this.display.width,this.display.height),this.focusDisplay.updateDisplay()}},{setInnerHighlightColor:function(t){oc=t},set innerHighlightColor(t){this.setInnerHighlightColor(t)},getInnerHighlightColor:function(){return oc},get innerHighlightColor(){return this.getInnerHighlightColor()},setOuterHilightColor:function(t){rc=t},set outerHighlightColor(t){this.setOuterHilightColor(t)},getOuterHighlightColor:function(){return rc},get outerHighlightColor(){return this.getOuterHighlightColor()},setInnerGroupHighlightColor:function(t){ac=t},set innerGroupHighlightColor(t){this.setInnerGroupHighlightColor(t)},getInnerGroupHighlightColor:function(){return ac},get innerGroupHighlightColor(){return this.getInnerGroupHighlightColor()},setOuterGroupHighlightColor:function(t){lc=t},set outerGroupHighlightColor(t){this.setOuterGroupHighlightColor(t)},getOuterGroupHighlightColor:function(){return lc},get outerGroupHighlightColor(){return this.getOuterGroupHighlightColor()}});var uc=hc;class cc extends Yu{constructor(t,e){super(t,e,"hitAreaOverlay")}addShapes(){new Vs(this.rootNode).eachTrailUnder(t=>{const e=t.lastNode();if(!e.isVisible()||!1===e.pickable)return!0;if(e.inputListeners.length&&t.isVisible()){const i=cc.getLocalMouseShape(e),n=cc.getLocalTouchShape(e),s=t.getMatrix();i.bounds.isEmpty()||this.addShape(i.transformed(s),"rgba(0,0,255,0.8)",!0),n.bounds.isEmpty()||this.addShape(n.transformed(s),"rgba(255,0,0,0.8)",!1)}})}static getLocalMouseShape(t){let e=En.union([t.mouseArea?t.mouseArea instanceof En?t.mouseArea:En.bounds(t.mouseArea):t.getSelfShape(),...t.children.filter(e=>t.visible&&!1!==t.pickable).map(t=>cc.getLocalMouseShape(t).transformed(t.matrix))]);return t.hasClipArea()&&(e=e.shapeIntersection(t.clipArea)),e}static getLocalTouchShape(t){let e=En.union([t.touchArea?t.touchArea instanceof En?t.touchArea:En.bounds(t.touchArea):t.getSelfShape(),...t.children.filter(e=>t.visible&&!1!==t.pickable).map(t=>cc.getLocalTouchShape(t).transformed(t.matrix))]);return t.hasClipArea()&&(e=e.shapeIntersection(t.clipArea)),e}}zn.register("HitAreaOverlay",cc);var dc=cc;function fc(t,e){Yu.call(this,t,e,"mouseTouchAreaOverlay")}zn.register("PointerAreaOverlay",fc),R(Yu,fc,{addShapes:function(){const t=this;new Vs(this.rootNode).eachTrailUnder((function(e){const i=e.lastNode();if(!i.isVisible())return!0;if((i.mouseArea||i.touchArea)&&e.isVisible()){const n=e.getTransform();i.mouseArea&&t.addShape(n.transformShape(i.mouseArea.isBounds?En.bounds(i.mouseArea):i.mouseArea),"rgba(0,0,255,0.8)",!0),i.touchArea&&t.addShape(n.transformShape(i.touchArea.isBounds?En.bounds(i.touchArea):i.touchArea),"rgba(255,0,0,0.8)",!1)}}))}});var pc=fc;function mc(t,e){const i=this;this.display=t,this.rootNode=e,this.pointerSVGContainer=document.createElement("div"),this.pointerSVGContainer.style.position="absolute",this.pointerSVGContainer.style.top=0,this.pointerSVGContainer.style.left=0,this.pointerSVGContainer.style["pointer-events"]="none";t.sizeProperty.lazyLink((function(t){i.pointerSVGContainer.setAttribute("width",t.width),i.pointerSVGContainer.setAttribute("height",t.height),i.pointerSVGContainer.style.clip="rect(0px,"+t.width+"px,"+t.height+"px,0px)"}));const n=oi.IDENTITY.copy();this.pointerAdded=function(t){if(t.isKey)return;const e=document.createElementNS(bs,"svg");e.style.position="absolute",e.style.top=0,e.style.left=0,e.style["pointer-events"]="none",mo.prepareForTransform(e,!1),e.setAttribute("width",21),e.setAttribute("height",21);const s=document.createElementNS(bs,"circle");s.setAttribute("cx",10.5),s.setAttribute("cy",10.5),s.setAttribute("r",10),s.setAttribute("style","fill:black;"),s.setAttribute("style","stroke:white;"),s.setAttribute("opacity","0.4");const r=function(){t instanceof Ya&&(i.pointerSVGContainer.removeChild(e),t.removeInputListener(o))};var o={move:function(){t.point&&mo.applyPreparedTransform(n.setToTranslation(t.point.x-10.5,t.point.y-10.5),e,!1)},up:r,cancel:r};t.addInputListener(o),o.move(),e.appendChild(s),i.pointerSVGContainer.appendChild(e)},t._input.addPointerAddedListener(this.pointerAdded),t._input&&t._input.mouse&&this.pointerAdded(t._input.mouse),this.domElement=this.pointerSVGContainer}zn.register("PointerOverlay",mc),R(Object,mc,{dispose:function(){this.display._input.removePointerAddedListener(this.pointerAdded)},update:function(){}});var gc=mc;function yc(t,e){this.initializeDOMSelfDrawable(t,e),this.domElement=this.node._container,mo.prepareForTransform(this.domElement,this.forceAcceleration)}zn.register("DOMDrawable",yc),R(Xl,yc,{updateDOM:function(){this.transformDirty&&!this.node._preventTransform&&mo.applyPreparedTransform(this.getTransformMatrix(),this.domElement,this.forceAcceleration),this.transformDirty=!1},dispose:function(){Xl.prototype.dispose.call(this),this.domElement=null}}),Pe.mixInto(yc);var bc=yc;function vc(t,e){if(e=h({width:e&&e.container&&e.container.clientWidth||640,height:e&&e.container&&e.container.clientHeight||480,allowCSSHacks:!0,allowSceneOverflow:!1,defaultCursor:"default",backgroundColor:null,preserveDrawingBuffer:!1,allowWebGL:!0,accessibility:!0,interactive:!0,listenToOnlyElement:!1,batchDOMEvents:!1,assumeFullWindow:!1,aggressiveContextRecreation:!0,passiveEvents:!Xs.safari&&null,allowBackingScaleAntialiasing:!0},e),this.options=e,this._accessible=e.accessibility,this._allowWebGL=e.allowWebGL,this.sizeProperty=new qn(new sa(this.options.width,this.options.height),{useDeepEquality:!0}),this._currentSize=new sa(-1,-1),this._rootNode=t,this._rootNode.addRootedDisplay(this),this._rootBackbone=null,this._domElement=e&&e.container?xa.repurposeBackboneContainer(e.container):xa.createDivBackbone(),this._sharedCanvasInstances={},this._baseInstance=null,this._frameId=0,this._dirtyTransformRoots=[],this._dirtyTransformRootsWithoutPass=[],this._instanceRootsToDispose=[],this._drawablesToDispose=[],this._drawablesToChangeBlock=[],this._drawablesToUpdateLinks=[],this._changeIntervalsToDispose=[],this._lastCursor=null,this._currentBackgroundCSS=null,this._backgroundColor=null,this._requestAnimationFrameID=0,this._input=null,this._inputListeners=[],this._interactive=this.options.interactive,this._listenToOnlyElement=e.listenToOnlyElement,this._batchDOMEvents=e.batchDOMEvents,this._assumeFullWindow=e.assumeFullWindow,this._passiveEvents=e.passiveEvents,this._aggressiveContextRecreation=e.aggressiveContextRecreation,this._allowBackingScaleAntialiasing=e.allowBackingScaleAntialiasing,this._overlays=[],this._pointerOverlay=null,this._pointerAreaOverlay=null,this._hitAreaOverlay=null,this._canvasAreaBoundsOverlay=null,this._fittedBlockBoundsOverlay=null,this.applyCSSHacks(),this.setBackgroundColor(this.options.backgroundColor),this.scenery=zn,this.utteranceQueue=new du(!this.options.accessibility),this.options.accessibility){this._focusRootNode=new ll,this._focusOverlay=new uc(this,this._focusRootNode),this.addOverlay(this._focusOverlay),this._unsortedAccessibleInstances=[],this.pointerFocus=null,this.activeNode=null,this.blockFocusCallbacks=!1,this._focusedNodeOnRemoveTrail,this._rootAccessibleInstance=Hr.createFromPool(null,this,new Vs),Ur.rebuildInstanceTree(this._rootAccessibleInstance),this._domElement.appendChild(this._rootAccessibleInstance.peer.primarySibling);const t=this.utteranceQueue.getAriaLiveContainer();this._domElement.appendChild(t),t.style[lo.userSelect]="none"}}zn.register("Display",vc),R(Object,vc,O({getDOMElement:function(){return this._domElement},get domElement(){return this.getDOMElement()},updateDisplay:function(){if(window.sceneryDebugPause)return;const t=!!this._baseInstance;for(this._input&&this._input.validatePointers(),this._accessible&&this._rootAccessibleInstance.peer.updateSubtreePositioning(),this._rootNode.validateWatchedBounds(),this._baseInstance=this._baseInstance||Ra.createFromPool(this,new Vs(this._rootNode),!0,!1),this._baseInstance.baseSyncTree(),t&&this.markTransformRootDirty(this._baseInstance,this._baseInstance.isTransformed);this._drawablesToUpdateLinks.length;)this._drawablesToUpdateLinks.pop().updateLinks();for(;this._changeIntervalsToDispose.length;)this._changeIntervalsToDispose.pop().dispose();for(this._rootBackbone=this._rootBackbone||this._baseInstance.groupDrawable;this._drawablesToChangeBlock.length;){this._drawablesToChangeBlock.pop().updateBlock();0}for(0,this.updateDirtyTransformRoots(),this._baseInstance.updateVisibility(!0,!0,!1);this._instanceRootsToDispose.length;)this._instanceRootsToDispose.pop().dispose();for(0;this._drawablesToDispose.length;)this._drawablesToDispose.pop().dispose();if(this._rootBackbone.update(),this.updateCursor(),this.updateBackgroundColor(),this.updateSize(),this._overlays.length){let t=this._rootBackbone.lastZIndex;for(let e=0;e<this._overlays.length;e++){const i=this._overlays[e];i.domElement.style.zIndex=t++,i.update()}}this._frameId++,Ur.auditAccessibleDisplays(this.rootNode)},updateSize:function(){let t=!1;this.size.width!==this._currentSize.width&&(t=!0,this._currentSize.width=this.size.width,this._domElement.style.width=this.size.width+"px"),this.size.height!==this._currentSize.height&&(t=!0,this._currentSize.height=this.size.height,this._domElement.style.height=this.size.height+"px"),t&&!this.options.allowSceneOverflow&&(this._domElement.style.clip="rect(0px,"+this.size.width+"px,"+this.size.height+"px,0px)")},getRootNode:function(){return this._rootNode},get rootNode(){return this.getRootNode()},getSize:function(){return this.sizeProperty.value},get size(){return this.getSize()},getBounds:function(){return this.size.toBounds()},get bounds(){return this.getBounds()},setSize:function(t){this.sizeProperty.value=t},setWidthHeight:function(t,e){this.setSize(new sa(t,e))},getWidth:function(){return this.size.width},get width(){return this.getWidth()},setWidth:function(t){this.getWidth()!==t&&this.setSize(new sa(t,this.getHeight()))},set width(t){this.setWidth(t)},getHeight:function(){return this.size.height},get height(){return this.getHeight()},setHeight:function(t){this.getHeight()!==t&&this.setSize(new sa(this.getWidth(),t))},set height(t){this.setHeight(t)},setBackgroundColor:function(t){this._backgroundColor=t},set backgroundColor(t){this.setBackgroundColor(t)},getBackgroundColor:function(){return this._backgroundColor},get backgroundColor(){return this.getBackgroundColor()},get interactive(){return this._interactive},set interactive(t){this._interactive=t,!this._interactive&&this._input&&(this._input.interruptPointers(),this._input.clearBatchedEvents(),this._input.removeTemporaryPointers(),this._rootNode.interruptSubtreeInput()),this.options.accessibility&&(this._interactive||(this.activeNode=vc.focusedNode,this.activeNode&&this.activeNode.blur()),this.accessibleDOMElement.hidden=!this._interactive)},addOverlay:function(t){this._overlays.push(t),this._domElement.appendChild(t.domElement),t.domElement.setAttribute("aria-hidden",!0)},removeOverlay:function(t){this._domElement.removeChild(t.domElement),this._overlays.splice(_.indexOf(this._overlays,t),1)},markUnsortedAccessibleInstance:function(t){this._unsortedAccessibleInstances.push(t)},sortAccessibleInstances:function(){const t=vc.focusedNode;for(;this._unsortedAccessibleInstances.length;)this._unsortedAccessibleInstances.pop().sortChildren();t&&t.focus()},getAccessibleDOMElement:function(){return this._rootAccessibleInstance.peer.primarySibling},get accessibleDOMElement(){return this.getAccessibleDOMElement()},getUsedRenderersBitmask:function(){return function t(e){let i=0;return _.each(e.blocks,(function(e){e instanceof Po&&e.domDrawable instanceof xa?i|=t(e.domDrawable):i|=e.renderer})),i}(this._rootBackbone)&jn.bitmaskRendererArea},markTransformRootDirty:function(t,e){e?this._dirtyTransformRoots.push(t):this._dirtyTransformRootsWithoutPass.push(t)},updateDirtyTransformRoots:function(){for(;this._dirtyTransformRoots.length;)this._dirtyTransformRoots.pop().relativeTransform.updateTransformListenersAndCompute(!1,!1,this._frameId,!0);for(;this._dirtyTransformRootsWithoutPass.length;)this._dirtyTransformRootsWithoutPass.pop().relativeTransform.updateTransformListenersAndCompute(!1,!1,this._frameId,!1)},markDrawableChangedBlock:function(t){this._drawablesToChangeBlock.push(t)},markInstanceRootForDisposal:function(t){this._instanceRootsToDispose.push(t)},markDrawableForDisposal:function(t){this._drawablesToDispose.push(t)},markDrawableForLinksUpdate:function(t){this._drawablesToUpdateLinks.push(t)},markChangeIntervalToDispose:function(t){this._changeIntervalsToDispose.push(t)},updateBackgroundColor:function(){const t=null===this._backgroundColor?"":this._backgroundColor.toCSS?this._backgroundColor.toCSS():this._backgroundColor;t!==this._currentBackgroundCSS&&(this._currentBackgroundCSS=t,this._domElement.style.backgroundColor=t)},updateCursor:function(){if(this._input&&this._input.mouse&&this._input.mouse.point){if(this._input.mouse.cursor)return this.setSceneCursor(this._input.mouse.cursor);const t=this._rootNode.trailUnderPointer(this._input.mouse);if(t)for(let e=t.getCursorCheckIndex();e>=0;e--){const i=t.nodes[e],n=i.getCursor();if(n)return this.setSceneCursor(n)}}return this.setSceneCursor(this.options.defaultCursor)},setElementCursor(t){this._domElement.style.cursor=t,this._assumeFullWindow&&(document.body.style.cursor=t)},setSceneCursor:function(t){if(t!==this._lastCursor){this._lastCursor=t;const e=vc.customCursors[t];if(e)for(let t=e.length-1;t>=0;t--)this.setElementCursor(e[t]);else this.setElementCursor(t)}},applyCSSHacks:function(){this.options.allowSceneOverflow||(this._domElement.style.overflow="hidden"),document.onselectstart=function(){return!1},this._domElement.style.msTouchAction="none",document.body.style.msContentZooming="none",lo.setStyle(this._domElement,lo.fontSmoothing,"antialiased"),this.options.allowCSSHacks&&(lo.setStyle(this._domElement,lo.userDrag,"none"),lo.setStyle(this._domElement,lo.userSelect,"none"),lo.setStyle(this._domElement,lo.touchAction,"none"),lo.setStyle(this._domElement,lo.touchCallout,"none"),lo.setStyle(this._domElement,lo.tapHighlightColor,"rgba(0,0,0,0)"))},canvasDataURL:function(t){this.canvasSnapshot((function(e){t(e.toDataURL())}))},canvasSnapshot:function(t){const e=document.createElement("canvas");e.width=this.size.width,e.height=this.size.height;const i=e.getContext("2d");this._rootNode.renderToCanvas(e,i,(function(){t(e,i.getImageData(0,0,e.width,e.height))}),this.domElement.style.backgroundColor)},setPointerDisplayVisible:function(t){t!==!!this._pointerOverlay&&(t?(this._pointerOverlay=new gc(this,this._rootNode),this.addOverlay(this._pointerOverlay)):(this.removeOverlay(this._pointerOverlay),this._pointerOverlay.dispose(),this._pointerOverlay=null))},setPointerAreaDisplayVisible:function(t){t!==!!this._pointerAreaOverlay&&(t?(this._pointerAreaOverlay=new pc(this,this._rootNode),this.addOverlay(this._pointerAreaOverlay)):(this.removeOverlay(this._pointerAreaOverlay),this._pointerAreaOverlay.dispose(),this._pointerAreaOverlay=null))},setHitAreaDisplayVisible:function(t){t!==!!this._hitAreaOverlay&&(t?(this._hitAreaOverlay=new dc(this,this._rootNode),this.addOverlay(this._hitAreaOverlay)):(this.removeOverlay(this._hitAreaOverlay),this._hitAreaOverlay.dispose(),this._hitAreaOverlay=null))},setCanvasNodeBoundsVisible:function(t){t!==!!this._canvasAreaBoundsOverlay&&(t?(this._canvasAreaBoundsOverlay=new ju(this,this._rootNode),this.addOverlay(this._canvasAreaBoundsOverlay)):(this.removeOverlay(this._canvasAreaBoundsOverlay),this._canvasAreaBoundsOverlay.dispose(),this._canvasAreaBoundsOverlay=null))},setFittedBlockBoundsVisible:function(t){t!==!!this._fittedBlockBoundsOverlay&&(t?(this._fittedBlockBoundsOverlay=new Xu(this,this._rootNode),this.addOverlay(this._fittedBlockBoundsOverlay)):(this.removeOverlay(this._fittedBlockBoundsOverlay),this._fittedBlockBoundsOverlay.dispose(),this._fittedBlockBoundsOverlay=null))},resizeOnWindowResize:function(){const t=this,e=function(){t.setWidthHeight(window.innerWidth,window.innerHeight)};window.addEventListener("resize",e),e()},updateOnRequestAnimationFrame:function(t){let e=0,i=0;const n=this;!function s(){n._requestAnimationFrameID=window.requestAnimationFrame(s,n._domElement);const r=Date.now();0!==e&&(i=(r-e)/1e3),e=r,P.emit(i),t&&t(i),n.updateDisplay()}()},cancelUpdateOnRequestAnimationFrame:function(){window.cancelAnimationFrame(this._requestAnimationFrameID)},initializeEvents:function(t){const e=new Bu(this,!this._listenToOnlyElement,this._batchDOMEvents,this._assumeFullWindow,this._passiveEvents,t);this._input=e,e.connectListeners()},detachEvents:function(){this._input.disconnectListeners(),this._input=null},addInputListener:function(t){return _.includes(this._inputListeners,t)||this._inputListeners.push(t),this},removeInputListener:function(t){return this._inputListeners.splice(_.indexOf(this._inputListeners,t),1),this},hasInputListener:function(t){for(let e=0;e<this._inputListeners.length;e++)if(this._inputListeners[e]===t)return!0;return!1},getInputListeners:function(){return this._inputListeners.slice(0)},get inputListeners(){return this.getInputListeners()},interruptInput:function(){const t=this.inputListeners;for(let e=0;e<t.length;e++){const i=t[e];i.interrupt&&i.interrupt()}return this},ensureNotPainting:function(){},loseWebGLContexts:function(){!function t(e){e.blocks&&e.blocks.forEach((function(e){e.gl&&mo.loseContext(e.gl);for(let i=e.firstDrawable;null!==i&&(t(i),i!==e.lastDrawable);i=i.nextDrawable);}))}(this._rootBackbone)},inspect:function(){localStorage.scenerySnapshot=JSON.stringify(zn.serialize(this))},getDebugHTML:function(){const t="font-weight: bold; font-size: 120%; margin-top: 5px;";let e=0,i="";i+='<div style="'+t+'">Display Summary</div>',i+=this.size.toString()+" frame:"+this._frameId+" input:"+!!this._input+" cursor:"+this._lastCursor+"<br/>",i+="Nodes: "+function t(e){let i=1;for(let n=0;n<e.children.length;n++)i+=t(e.children[n]);return i}(this._rootNode)+"<br/>",i+=this._baseInstance?"Instances: "+function t(e){let i=1;for(let n=0;n<e.children.length;n++)i+=t(e.children[n]);return i}(this._baseInstance)+"<br/>":"",i+=this._rootBackbone?"Drawables: "+function t(e){let i=1;if(e.blocks)_.each(e.blocks,(function(e){i+=t(e)}));else if(e.firstDrawable&&e.lastDrawable){for(let n=e.firstDrawable;n!==e.lastDrawable;n=n.nextDrawable)i+=t(n);i+=t(e.lastDrawable)}return i}(this._rootBackbone)+"<br/>":"";const n={};function s(t){const e=t.constructor.name;n[e]?n[e]++:n[e]=1}i+=this._baseInstance?"Retained Drawables: "+function t(e){let i=0;e.selfDrawable&&(s(e.selfDrawable),i++),e.groupDrawable&&(s(e.groupDrawable),i++),e.sharedCacheDrawable&&(s(e.sharedCacheDrawable),i++);for(let n=0;n<e.children.length;n++)i+=t(e.children[n]);return i}(this._baseInstance)+"<br/>":"";for(const h in n)i+="&nbsp;&nbsp;&nbsp;&nbsp;"+h+": "+n[h]+"<br/>";function r(t){if(!t.firstDrawable||!t.lastDrawable)return;const i=t.domDrawable&&t.domDrawable.blocks;let n='<div style="margin-left: '+20*e+'px">';if(n+=t.toString(),i||(n+=" ("+t.drawableCount+" drawables)"),n+="</div>",e+=1,i)for(let e=0;e<t.domDrawable.blocks.length;e++)n+=r(t.domDrawable.blocks[e]);return e-=1,n}if(this._rootBackbone){i+='<div style="'+t+'">Block Summary</div>';for(let t=0;t<this._rootBackbone.blocks.length;t++)i+=r(this._rootBackbone.blocks[t])}function o(t){let e="";function i(t){e+=' <span style="color: #008">'+t+"</span>"}const n=t.node;e+=t.id,e+=" "+(n.constructor.name?n.constructor.name:"?"),e+=' <span style="font-weight: '+(n.isPainted()?"bold":"normal")+'">'+n.id+"</span>",e+=n.getDebugHTMLExtras(),n.visible||i("invis"),t.visible||i("I-invis"),t.relativeVisible||i("I-rel-invis"),t.selfVisible||i("I-self-invis"),t.fittability.ancestorsFittable||i("nofit-ancestor"),t.fittability.selfFittable||i("nofit-self"),!0===n.pickable&&i("pickable"),!1===n.pickable&&i("unpickable"),t.trail.isPickable()&&i('<span style="color: #808">hits</span>'),n.clipArea&&i("clipArea"),n.mouseArea&&i("mouseArea"),n.touchArea&&i("touchArea"),n.getInputListeners().length&&i("inputListeners"),n.getRenderer()&&i("renderer:"+n.getRenderer()),n.isLayerSplit()&&i("layerSplit"),n.opacity<1&&i("opacity:"+n.opacity),n._boundsEventCount>0&&i('<span style="color: #800">boundsListen:'+n._boundsEventCount+":"+n._boundsEventSelfCount+"</span>");let s="";switch(n.transform.getMatrix().type){case oi.Types.IDENTITY:s="";break;case oi.Types.TRANSLATION_2D:s="translated";break;case oi.Types.SCALING:s="scale";break;case oi.Types.AFFINE:s="affine";break;case oi.Types.OTHER:s="other";break;default:throw new Error("invalid matrix type: "+n.transform.getMatrix().type)}var r;return s&&(e+=' <span style="color: #88f" title="'+n.transform.getMatrix().toString().replace("\n","&#10;")+'">'+s+"</span>"),e+=' <span style="color: #888">[Trail '+t.trail.indices.join(".")+"]</span>",e+=' <span style="color: #c88">'+(((r=t.state)?r.toString():r+"")+"</span>"),e+=' <span style="color: #8c8">'+n._rendererSummary.bitmask.toString(16)+(n._rendererBitmask!==jn.bitmaskNodeDefault?" ("+n._rendererBitmask.toString(16)+")":"")+"</span>",e}function a(t){let e=t.toString();return t.visible&&(e="<strong>"+e+"</strong>"),t.dirty&&(e+=t.dirty?' <span style="color: #c00;">[x]</span>':""),t.fittable||(e+=t.dirty?' <span style="color: #0c0;">[no-fit]</span>':""),e}function l(t){let n='<div style="margin-left: '+20*e+'px">';function s(t,e){n+=' <span style="color: #888">'+t+":"+a(e)+"</span>"}n+=o(t),t.selfDrawable&&s("self",t.selfDrawable),t.groupDrawable&&s("group",t.groupDrawable),t.sharedCacheDrawable&&s("sharedCache",t.sharedCacheDrawable),n+="</div>",i+=n,e+=1,_.each(t.children,(function(t){l(t)})),e-=1}return this._baseInstance&&(i+='<div style="'+t+'">Root Instance Tree</div>',l(this._baseInstance)),_.each(this._sharedCanvasInstances,(function(e){i+='<div style="'+t+'">Shared Canvas Instance Tree</div>',l(e)})),this._rootBackbone&&(i+='<div style="font-weight: bold;">Root Drawable Tree</div>',function t(n){let s='<div style="margin-left: '+20*e+'px">';if(s+=a(n),n.instance?(s+=' <span style="color: #0a0;">('+n.instance.trail.toPathString()+")</span>",s+="&nbsp;&nbsp;&nbsp;"+o(n.instance)):n.backboneInstance&&(s+=' <span style="color: #a00;">('+n.backboneInstance.trail.toPathString()+")</span>",s+="&nbsp;&nbsp;&nbsp;"+o(n.backboneInstance)),s+="</div>",i+=s,n.blocks)e+=1,_.each(n.blocks,(function(e){t(e)})),e-=1;else if(n.firstDrawable&&n.lastDrawable){e+=1;for(let e=n.firstDrawable;e!==n.lastDrawable;e=e.nextDrawable)t(e);t(n.lastDrawable),e-=1}}(this._rootBackbone)),i},getDebugURI(){return"data:text/html;charset=utf-8,"+encodeURIComponent('<!DOCTYPE html><html lang="en"><head><title>Scenery Debug Snapshot</title></head><body style="font-size: 12px;">'+this.getDebugHTML()+"</body></html>")},popupDebug(){window.open(this.getDebugURI())},iframeDebug(){const t=document.createElement("iframe");t.width=window.innerWidth,t.height=window.innerHeight,t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.zIndex="10000",document.body.appendChild(t),t.contentWindow.document.open(),t.contentWindow.document.write(this.getDebugHTML()),t.contentWindow.document.close(),t.contentWindow.document.body.style.background="white";const e=document.createElement("button");e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.zIndex="10001",document.body.appendChild(e),e.textContent="close",["pointerdown","click","touchdown"].forEach(i=>{e.addEventListener(i,()=>{document.body.removeChild(t),document.body.removeChild(e)},!0)})},getAccessibleDebugHTML:function(){let t="";const e="font-weight: bold; font-size: 120%; margin-top: 5px;",i="&nbsp;&nbsp;&nbsp;&nbsp;";t+='<div style="'+e+'">Accessible Instances</div><br>',function e(n,s){t+=s+Yl((n.isRootInstance?"":n.node.tagName)+" "+n.toString())+"<br>",n.children.forEach((function(t){e(t,s+i)}))}(this._rootAccessibleInstance,""),t+='<br><div style="'+e+'">Parallel DOM</div><br>';let n=this._rootAccessibleInstance.peer.primarySibling.outerHTML;n=n.replace(/></g,">\n<");const s=n.split("\n");let r="";for(let o=0;o<s.length;o++){const e=s[o],n="</"===e.slice(0,2);n&&(r=r.slice(i.length)),t+=r+Yl(e)+"<br>",n||(r+=i)}return t},foreignObjectRasterization:function(t){const e={};let i=0;function n(t){t.id||(t.id="unknown-canvas-"+i++),e[t.id]=t.toDataURL()}!function t(e){if(e.blocks)_.each(e.blocks,(function(e){t(e)}));else if(e.firstDrawable&&e.lastDrawable){for(let i=e.firstDrawable;i!==e.lastDrawable;i=i.nextDrawable)t(i);t(e.lastDrawable),e.canvas&&e.canvas instanceof window.HTMLCanvasElement&&n(e.canvas)}bc&&e instanceof bc&&(e.domElement instanceof window.HTMLCanvasElement&&n(e.domElement),Array.prototype.forEach.call(e.domElement.getElementsByTagName("canvas"),(function(t){n(t)})))}(this._rootBackbone);const s=document.implementation.createHTMLDocument("");s.documentElement.innerHTML=this.domElement.outerHTML,s.documentElement.setAttribute("xmlns",s.documentElement.namespaceURI);let r=s.documentElement.getElementsByTagName("canvas");r=Array.prototype.slice.call(r);for(let p=0;p<r.length;p++){const t=r[p],i=t.style.cssText,n=s.createElement("img"),o=e[t.id];n.src=o,n.setAttribute("style",i),t.parentNode.replaceChild(n,t)}const o=this.width,a=this.height,l=function(){vc.elementToSVGDataURL(s.documentElement,o,a,t)};let h=0,u=!1;const c=Array.prototype.slice.call(s.documentElement.getElementsByTagName("image"));for(let p=0;p<c.length;p++){var d=c[p],f=d.getAttribute("xlink:href");"data:"!==f.slice(0,5)&&(h++,u=!0,function(){const t=new window.Image,e=d;t.onload=function(){const i=document.createElement("canvas");i.width=t.width,i.height=t.height,i.getContext("2d").drawImage(t,0,0),e.setAttribute("xlink:href",i.toDataURL()),0==--h&&l()},t.onerror=function(){0==--h&&l()},t.src=f}())}u||l()},popupRasterization:function(){this.foreignObjectRasterization(window.open)},dispose:function(){this._input&&this.detachEvents(),this._rootNode.removeRootedDisplay(this),this._accessible&&this._rootAccessibleInstance.dispose()}}),{elementToSVGDataURL:function(t,e,i,n){const s=document.createElement("canvas"),r=s.getContext("2d");s.width=e,s.height=i;const o='<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+i+'"><foreignObject width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml">'+(new window.XMLSerializer).serializeToString(t)+"</div></foreignObject></svg>",a=new window.Image;a.onload=function(){r.drawImage(a,0,0),n(s.toDataURL())},a.onerror=function(){n(null)};const l=new window.TextEncoderLite("utf-8").encode(o),h=window.fromByteArray(l);a.src="data:image/svg+xml;base64,"+h},set focus(t){let e;this.focusProperty.value&&(e=this.focusedNode),this.focusProperty.value=t,e&&!t&&e.blur()},get focus(){return this.focusProperty.value},getFocusedNode:function(){let t=null;const e=this.focusProperty.get();return e&&(t=e.trail.lastNode()),t},get focusedNode(){return this.getFocusedNode()}}),vc.customCursors={"scenery-grab-pointer":["grab","-moz-grab","-webkit-grab","pointer"],"scenery-grabbing-pointer":["grabbing","-moz-grabbing","-webkit-grabbing","pointer"]},vc.focusProperty=new Yt(null,{tandem:ot.GENERAL_MODEL.createTandem("focusProperty"),phetioDocumentation:"Stores the current focus in the simulation, null if there is nothing focused. This is not updated based on mouse or touch input, only keyboard and other alternative inputs. Note that this only applies to simulations that support alternative input.",phetioType:te(kt(gu)),phetioState:!1,phetioFeatured:!0,phetioReadOnly:!0}),vc.userGestureEmitter=new $o,vc.keyStateTracker=new _u,vc.keyStateTracker.attachToDocument(),vc.assertSubtreeDisposed=function(t){0};var _c=vc;const wc={CLICK:new Howl({src:["../audio/click_04.mp3"],volume:.2}),CHIME:new Howl({src:["../audio/chime_bell_ding.mp3"],volume:.2}),MARIMBA:new Howl({src:["../audio/music_marimba_chord.mp3"],volume:.2}),PLINK:new Howl({src:["../audio/digi_plink.mp3"],volume:.2}),DRIP:new Howl({src:["../audio/pop_drip.mp3"],volume:.2}),BEEP_ON:new Howl({src:["../audio/beep_short_on.mp3"],volume:.4}),BEEP_OFF:new Howl({src:["../audio/beep_short_off.mp3"],volume:.4}),ZIPPER:new Howl({src:["../audio/tap-zipper.mp3"],volume:.4}),ARRRR:new Howl({src:["../audio/ta-snes_gargantua_blargg.wav"],volume:.4}),BACKGROUND:new Howl({src:["../audio/music-breeze-stage.mp3"],volume:.3,loop:!0}),BACKGROUND_CRITICAL:new Howl({src:["../audio/music-breeze-stage-critical.mp3"],volume:0,loop:!0}),setCritical(t){const e=t?.3:0,i=t?0:.3;wc.BACKGROUND.fade(e,i,1e3),wc.BACKGROUND_CRITICAL.fade(i,e,1e3)}};gh.register("RingAudio",wc);var Ac=wc;function xc(t){const e=this;t=h({outerRadius:15,innerRadius:7.5,numberStarPoints:5},t),En.call(this);const i=2*t.numberStarPoints;_.times(i,(function(n){const s=n/i*Math.PI*2-Math.PI/2,r=n%2==0?t.outerRadius:t.innerRadius;e.lineTo(r*Math.cos(s),r*Math.sin(s))})),this.close(),this.makeImmutable()}wl.register("StarShape",xc),R(En,xc);var Tc=xc;const Sc=(new En).moveTo(0,0).lineTo(-5,-5).cubicCurveTo(-10,-10,-2,-14,0,-8).cubicCurveTo(2,-14,10,-10,5,-5).close().transformed(oi.affine(1.6,0,0,0,1.6,10)),Dc=new Tc({outerRadius:12,innerRadius:6}),Ec=En.rect(-7,-7,14,14).transformed(oi.rotation2(Math.PI/4)),Cc=(new En).moveTo(0,10).lineTo(-9,-8).lineTo(9,-8).close(),Ic=Cc.transformed(oi.rotation2(Math.PI)),Pc={[Sh.NONE]:new ll,[Sh.HEART]:new _l(Sc,{fill:xh.HEART_FOREGROUND,stroke:"black"}),[Sh.STAR]:new _l(Dc,{fill:xh.STAR_FOREGROUND,stroke:"black"}),[Sh.DIAMOND]:new _l(Ec,{fill:xh.DIAMOND_FOREGROUND,stroke:"black"}),[Sh.DOWN_TRIANGLE]:new _l(Cc,{fill:xh.DOWN_TRIANGLE_FOREGROUND,stroke:"black"}),[Sh.UP_TRIANGLE]:new _l(Ic,{fill:xh.UP_TRIANGLE_FOREGROUND,stroke:"black"}),[Sh.CIRCLE]:new Jh(12,{fill:xh.CIRCLE_FOREGROUND,stroke:"black"})};class kc extends ll{constructor(t,e,i){super(),this.positionProperty=new Yt(new je(t,e)),this.contentProperty=new Yt(i),this.mainContainer=new ll,this.oppositeContainer=new ll,this.children=[this.mainContainer,this.oppositeContainer],Yt.multilink([this.positionProperty,this.contentProperty],(t,e)=>{if(e!==Sh.NONE){this.mainContainer.translation=xh.rowRingToPlanar(t.x,t.y);const e=t.y<0||t.y>xh.RINGS-1;this.oppositeContainer.visible=e,e&&(this.oppositeContainer.translation=xh.rowRingToPlanar(t.x+xh.HALF_ROWS,t.y<0?-1-t.y:2*xh.RINGS-t.y-1))}}),this.contentProperty.link(t=>{const e=kc.getIcon(t);this.mainContainer.children=[e],this.oppositeContainer.children=[e]})}static getIcon(t){return Pc[t]}}gh.register("RingContentNode",kc);var Lc=kc;function Oc(){}new r("twixt").register("Easing",Oc),R(Object,Oc,{value:function(t){throw new Error("Unimplemented easing value")},derivative:function(t){throw new Error("Unimplemented easing derivative")},secondDerivative:function(t){throw new Error("Unimplemented easing secondDerivative")}}),Oc.polynomialEaseInValue=function(t,e){return Math.pow(e,t)},Oc.polynomialEaseOutValue=function(t,e){return 1-Math.pow(1-e,t)},Oc.polynomialEaseInOutValue=function(t,e){return e<=.5?.5*Math.pow(2*e,t):1-Oc.polynomialEaseInOutValue(t,1-e)},Oc.polynomialEaseInDerivative=function(t,e){return t*Math.pow(e,t-1)},Oc.polynomialEaseOutDerivative=function(t,e){return t*Math.pow(1-e,t-1)},Oc.polynomialEaseInOutDerivative=function(t,e){return e<=.5?Math.pow(2,t-1)*t*Math.pow(e,t-1):Oc.polynomialEaseInOutDerivative(t,1-e)},Oc.polynomialEaseInSecondDerivative=function(t,e){return(t-1)*t*Math.pow(e,t-2)},Oc.polynomialEaseOutSecondDerivative=function(t,e){return-(t-1)*t*Math.pow(1-e,t-2)},Oc.polynomialEaseInOutSecondDerivative=function(t,e){return e<=.5?Math.pow(2,t-1)*(t-1)*t*Math.pow(e,t-2):-Oc.polynomialEaseInOutSecondDerivative(t,1-e)},Oc.polynomialEaseIn=function(t){const e=new Oc;return e.value=Oc.polynomialEaseInValue.bind(e,t),e.derivative=Oc.polynomialEaseInDerivative.bind(e,t),e.secondDerivative=Oc.polynomialEaseInSecondDerivative.bind(e,t),e},Oc.polynomialEaseOut=function(t){const e=new Oc;return e.value=Oc.polynomialEaseOutValue.bind(e,t),e.derivative=Oc.polynomialEaseOutDerivative.bind(e,t),e.secondDerivative=Oc.polynomialEaseOutSecondDerivative.bind(e,t),e},Oc.polynomialEaseInOut=function(t){const e=new Oc;return e.value=Oc.polynomialEaseInOutValue.bind(e,t),e.derivative=Oc.polynomialEaseInOutDerivative.bind(e,t),e.secondDerivative=Oc.polynomialEaseInOutSecondDerivative.bind(e,t),e},Oc.LINEAR=Oc.polynomialEaseIn(1),Oc.QUADRATIC_IN=Oc.polynomialEaseIn(2),Oc.QUADRATIC_OUT=Oc.polynomialEaseOut(2),Oc.QUADRATIC_IN_OUT=Oc.polynomialEaseInOut(2),Oc.CUBIC_IN=Oc.polynomialEaseIn(3),Oc.CUBIC_OUT=Oc.polynomialEaseOut(3),Oc.CUBIC_IN_OUT=Oc.polynomialEaseInOut(3),Oc.QUARTIC_IN=Oc.polynomialEaseIn(4),Oc.QUARTIC_OUT=Oc.polynomialEaseOut(4),Oc.QUARTIC_IN_OUT=Oc.polynomialEaseInOut(4),Oc.QUINTIC_IN=Oc.polynomialEaseIn(5),Oc.QUINTIC_OUT=Oc.polynomialEaseOut(5),Oc.QUINTIC_IN_OUT=Oc.polynomialEaseInOut(5);var Nc=Oc;const Rc={[Sh.HEART]:xh.HEART_BACKGROUND,[Sh.STAR]:xh.STAR_BACKGROUND,[Sh.DIAMOND]:xh.DIAMOND_BACKGROUND,[Sh.DOWN_TRIANGLE]:xh.DOWN_TRIANGLE_BACKGROUND,[Sh.UP_TRIANGLE]:xh.UP_TRIANGLE_BACKGROUND,[Sh.CIRCLE]:xh.CIRCLE_BACKGROUND};class Mc extends ll{constructor(t,e,i,n){super(),this.positionProperty=new Yt(new je(t,e)),this.contentProperty=new Yt(i),this.backgroundColorProperty=new Yt(n),this.flashRatioProperty=new Ce(1),this.flashColor=rs.WHITE,this.backgroundPath=new _l(null,{stroke:"black",fill:new de([this.contentProperty,this.backgroundColorProperty,this.flashRatioProperty],(t,e,i)=>{let n=Rc[t]||e;return i<1&&(n=this.flashColor.blend(n,Nc.QUADRATIC_OUT.value(i))),n})}),this.addChild(this.backgroundPath),this.positionProperty.link(t=>{this.backgroundPath.shape=Mc.drawWrappedPolarRect(new En,t.x-.5,t.x+.5,t.y-.5,t.y+.5)})}flash(t){this.flashColor=t,this.flashRatioProperty.value=0}step(t){this.flashRatioProperty.value=Math.min(1,this.flashRatioProperty.value+t/.2)}static drawWrappedPolarRect(t,e,i,n,s){const r=Math.max(n,xh.MIN_RINGY),o=Math.min(s,xh.MAX_RINGY);return Mc.drawPolarRect(t,e,i,r,o),n<xh.MIN_RINGY&&(t.newSubpath(),Mc.drawPolarRect(t,e+xh.HALF_ROWS,i+xh.HALF_ROWS,xh.MIN_RINGY,2*xh.MIN_RINGY-n)),s>xh.MAX_RINGY&&(t.newSubpath(),Mc.drawPolarRect(t,e+xh.HALF_ROWS,i+xh.HALF_ROWS,2*xh.MAX_RINGY-s,xh.MAX_RINGY)),t}static drawPolarRect(t,e,i,n,s,r=0){const o=xh.ringToRadius(n)-r,a=xh.ringToRadius(s)+r,l=xh.rowToTheta(e),h=xh.rowToTheta(i),u=r/o,c=r/a;return t.arc(0,0,o,l-u,h+u,!1),t.arc(0,0,a,h+c,l-c,!0),t.close(),t}}gh.register("RingPieceNode",Mc);var Bc=Mc;const Fc=new rs(16441600,.3),Vc=new rs(16441600,1),Hc=new rs(0,.1),zc=new rs(0,.3);class Gc extends ll{constructor(t,e){super(),e=h({preventFit:!0},e),this.addChild(new Jh(xh.OUTER_RADIUS+50,{fill:"#333",stroke:"black"})),this.localBounds=this.localBounds,this.addChild(new Jh(xh.INNER_RADIUS,{fill:"#ddd"})),this.addChild(new Jh(xh.INNER_RADIUS-5,{fill:"#333",stroke:"black"})),this.addChild(new fh("Hey you <3",{center:je.ZERO,fill:"#eee",font:new Ol({size:50,family:"Brush Script MT, cursive"}),maxWidth:100}));let i=t.currentBoard.pieces.map(t=>new Bc(t.row,t.ring,t.content,t.backgroundColor));i.forEach(t=>this.addChild(t));const n=Bc.drawPolarRect(Bc.drawPolarRect(new En,-.5,.5,-.5,xh.RINGS-.5,-2).newSubpath(),-.5+xh.HALF_ROWS,.5+xh.HALF_ROWS,-.5,xh.RINGS-.5,-2),s=new _l(n),r=new _l(n,{lineWidth:4}),o=new _l(null),a=new _l(null,{lineWidth:4}),l=new ll;this.addChild(l);const u=new ll;this.addChild(u),u.clipArea=(new En).arc(0,0,xh.OUTER_RADIUS-1,0,2*Math.PI,!1).close().newSubpath().arc(0,0,xh.INNER_RADIUS+1,2*Math.PI,0,!0).close();const c=new ll;this.addChild(c);let d=t.currentBoard.pieces.map(t=>new Lc(t.row,t.ring,t.content));d.forEach(t=>u.addChild(t));let f=null,p=null;const m=e=>{const i=t.currentSlice.type;s.fill=i===kh.ROW?Fc:Hc,o.fill=i===kh.RING?Fc:Hc,r.stroke=i===kh.ROW?Vc:zc,a.stroke=i===kh.RING?Vc:zc,l.children=i===kh.ROW?[o,a,s]:[s,r,o],c.children=i===kh.ROW?[r]:[a],(i===kh.ROW?s:o).moveToFront();const n=t.currentSlice.index,h=t.nextSlice?t.nextSlice.index:n,u=(1-e)*n+e*(Math.abs(n-h)>1?h<n?n+1:n-1:h);if(t.currentSlice.type===kh.ROW)s.rotation=u*xh.PIECE_ANGLE,r.rotation=u*xh.PIECE_ANGLE;else{const t=xh.ringToRadius(u-.5)+2,e=xh.ringToRadius(u+.5)-2,i=(new En).arc(0,0,e,0,2*Math.PI,!1).close().newSubpath().arc(0,0,t,2*Math.PI,0,!0).close();o.shape=i,a.shape=i}};m(1);t.beforeEmitter.addListener(e=>{[wh.SHIFT_LEFT,wh.SHIFT_RIGHT,wh.SHIFT_UP,wh.SHIFT_DOWN].includes(e)&&(f=t.currentMove,f&&(p=_.flatten(_.range(0,xh.RINGS).map(t=>_.range(0,xh.ROWS).map(e=>f.getDelta(e,t))))),Ac.PLINK.play()),[wh.SELECTION_LEFT,wh.SELECTION_RIGHT,wh.SELECTION_OUT,wh.SELECTION_IN].includes(e)&&Ac.CLICK.play(),e===wh.SWAP&&Ac.DRIP.play(),e===wh.RESET&&Ac.BEEP_ON.play()}),t.afterEmitter.addListener(e=>{[wh.SHIFT_LEFT,wh.SHIFT_RIGHT,wh.SHIFT_UP,wh.SHIFT_DOWN].includes(e)&&(f&&(i=Vh.moveMap(i,f,(t,e,i)=>(t.positionProperty.value=new je(e,i),t)),d=Vh.moveMap(d,f,(t,e,i)=>(t.positionProperty.value=new je(e,i),t))),f=null,p=null),[wh.SELECTION_LEFT,wh.SELECTION_RIGHT,wh.SELECTION_OUT,wh.SELECTION_IN,wh.SWAP].includes(t.currentAction)&&m(1)}),t.ratioEmitter.addListener(e=>{if(p){const n=t.currentBoard;_.range(0,xh.RINGS*xh.ROWS).forEach(t=>{const s=p[t];if(s.x||s.y){const r=n.pieces[t],o=r.row+s.x*e,a=r.ring+s.y*e,l=new je(o,a);i[t].positionProperty.value=l,d[t].positionProperty.value=l}})}[wh.SELECTION_LEFT,wh.SELECTION_RIGHT,wh.SELECTION_OUT,wh.SELECTION_IN].includes(t.currentAction)&&m(e)}),t.appliedEmitter.addListener(()=>{}),t.contentChangedEmitter.addListener((t,e)=>{e.forEach(e=>{const n=Vh.getIndex(e.row,e.ring);i[n].contentProperty.value=t,d[n].contentProperty.value=t})}),t.flashEmitter.addListener((t,e)=>{e.forEach(e=>{const n=Vh.getIndex(e.row,e.ring);i[n].flash(t)})}),this.mutate(e),this.step=t=>{i.forEach(e=>e.step(t))}}static getResizeHandler(t,e){let i=!0;const n=()=>{i=!0};return $(window).resize(n),window.addEventListener("resize",n),window.addEventListener("orientationchange",n),window.visualViewport&&window.visualViewport.addEventListener("resize",n),()=>{i&&(i=!1,t.width=window.innerWidth,t.height=window.innerHeight,e.maxWidth=window.innerWidth-20,e.maxHeight=window.innerHeight-20,e.centerX=window.innerWidth/2,e.centerY=window.innerHeight/2)}}static setupDisplay(t,e){const i=new ll({children:[t]}),n=new _c(i,{width:1024,height:1024,backgroundColor:new rs("#666"),passiveEvents:!0,allowSceneOverflow:!1,assumeFullWindow:!0,accessibility:!1});document.body.appendChild(n.domElement);const s=Gc.getResizeHandler(n,t);n.updateDisplay(),n.initializeEvents(),n.updateOnRequestAnimationFrame(t=>{s(),e(t)})}}gh.register("RingNode",Gc);var qc=Gc;class Yc extends qc{constructor(t,e){super(t,e=h({remainingCountSide:"right"},e));const i=new de([t.puzzleMovesTakenProperty,t.specificationProperty],(t,e)=>e.sliceCount-t),n=new fh("",{font:new Rl({size:23})}),s=new Jh(25,{stroke:"black",lineWidth:2,fill:"#eee",[e.remainingCountSide]:this.localBounds[e.remainingCountSide],top:this.localBounds.top});i.link(t=>{n.text=t>=0?t:":/",n.center=s.center}),this.addChild(s),this.addChild(n)}}gh.register("PuzzleRingNode",Yc);var Uc=Yc;const jc=87,Wc=65,Xc=83,Kc=68,Qc=81,Zc=69,$c=32,Jc=37,td=38,ed=39,id=40,nd=13,sd=191;class rd{constructor(t,e){this.ringProperty=t,this.callback=e,this.listener=t=>{40!==t.keyCode&&38!==t.keyCode&&32!==t.keyCode||t.preventDefault(),e(t,this.ringProperty.value)},this.inApplyMode=!1,this.isRingType=!0}start(){return document.addEventListener("keydown",this.listener),this}stop(){return document.removeEventListener("keydown",this.listener),this}}rd.LEFT_KEYMAP={LEFT:Wc,RIGHT:Kc,UP:jc,DOWN:Xc,SWAP:$c,RESET:Qc},rd.RIGHT_KEYMAP={LEFT:Jc,RIGHT:ed,UP:td,DOWN:id,SWAP:nd,RESET:sd},rd.getPuzzleStyle=t=>{let e=!1;return new rd(t,(t,i)=>{t.keyCode===$c&&(e?(e=!1,i.appendAction(wh.APPLY)):(e=!0,i.appendAction(wh.SELECT))),t.keyCode===jc&&i.appendAction(e?wh.SHIFT_UP:wh.SELECTION_OUT),t.keyCode===Xc&&i.appendAction(e?wh.SHIFT_DOWN:wh.SELECTION_IN),t.keyCode===Wc&&i.appendAction(e?wh.SHIFT_LEFT:wh.SELECTION_LEFT),t.keyCode===Kc&&i.appendAction(e?wh.SHIFT_RIGHT:wh.SELECTION_RIGHT),t.keyCode===Qc&&(e||i.appendAction(wh.SWAP)),t.keyCode===Zc&&e&&(i.appendAction(wh.CANCEL),e=!1)})},rd.getQuickStyle=(t,e)=>{const i=new rd(t,(t,n)=>{const s=()=>{i.inApplyMode&&(n.appendAction(wh.APPLY),i.inApplyMode=!1)},r=()=>{i.inApplyMode||(n.appendAction(wh.SELECT),i.inApplyMode=!0)};t.keyCode===e.SWAP&&(i.inApplyMode&&(n.appendAction(wh.APPLY),i.inApplyMode=!1),n.appendAction(wh.SWAP),i.isRingType=!i.isRingType),t.keyCode!==e.UP&&t.keyCode!==e.DOWN||(i.isRingType?(s(),n.appendAction(t.keyCode===e.UP?wh.SELECTION_OUT:wh.SELECTION_IN)):(r(),n.appendAction(t.keyCode===e.UP?wh.SHIFT_UP:wh.SHIFT_DOWN))),t.keyCode!==e.LEFT&&t.keyCode!==e.RIGHT||(i.isRingType?(r(),n.appendAction(t.keyCode===e.LEFT?wh.SHIFT_LEFT:wh.SHIFT_RIGHT)):(s(),n.appendAction(t.keyCode===e.LEFT?wh.SELECTION_LEFT:wh.SELECTION_RIGHT))),t.keyCode===e.RESET&&(i.inApplyMode=!1,n.appendAction(wh.RESET))});return i},gh.register("RingController",rd);var od=rd;class ad{constructor(t,e,i){this.jumpContents=t,this.hammerContents=e,this.sliceTypes=i,this.matchCount=t.length+e.length,this.sliceCount=i.length}static fromParameters(t,e,i){e=Math.min(t-1,e);let n=[Sh.HEART,Sh.STAR,Sh.DIAMOND,Sh.DOWN_TRIANGLE,Sh.UP_TRIANGLE,Sh.CIRCLE];n=_.shuffle(n).slice(0,t-e);let s=n.slice();for(;s.length<t;)s.push(_.sample(n));s=_.shuffle(s);const r=_.sample(_.range(0,s.length+1));return new ad(s.slice(0,r),s.slice(r),_.range(0,i).map(()=>_.sample(kh.VALUES)))}}gh.register("RingPuzzleSpecification",ad);var ld=ad;Ac.BACKGROUND.play(),Ac.BACKGROUND_CRITICAL.play();let hd=!1;const ud=new Ce(0),cd=new Ce(0),dd=new de([ud,cd],(t,e)=>t-e);dd.link(t=>{Math.abs(t)>=5&&(hd=!0,(t>0?vd:bd).opacity=.5)});const fd=new qh(()=>ld.fromParameters(2,0,2)),pd=new qh(()=>ld.fromParameters(2,0,2)),md=od.getQuickStyle(new Yt(fd),od.LEFT_KEYMAP).start(),gd=od.getQuickStyle(new Yt(pd),od.RIGHT_KEYMAP).start(),yd=new ne(!1);yd.lazyLink(t=>Ac.setCritical(t)),setInterval(()=>{yd.value=Math.abs(dd.value)>=3},5e3);const bd=new Uc(fd,{remainingCountSide:"left"}),vd=new Uc(pd);fd.afterEmitter.addListener(()=>{fd.currentBoard.getMatches().length===fd.specificationProperty.value.matchCount&&fd.puzzleMovesTakenProperty.value<=fd.specificationProperty.value.sliceCount&&(fd.nextPuzzle(),md.inApplyMode=!1,ud.value++,Ac.MARIMBA.play())}),pd.afterEmitter.addListener(()=>{pd.currentBoard.getMatches().length===pd.specificationProperty.value.matchCount&&pd.puzzleMovesTakenProperty.value<=pd.specificationProperty.value.sliceCount&&(pd.nextPuzzle(),gd.inApplyMode=!1,cd.value++,Ac.MARIMBA.play())});const _d=new Sl(0,0,0,100,{fill:new de([dd],t=>new rs(t>0?16441600:3802618)),headHeight:25,headWidth:25,tailWidth:10}),wd=new fh("",{font:new Rl({size:16,weight:"bold"})}),Ad=new ll({children:[_d,wd],localBounds:_d.bounds});dd.link(t=>{const e=0!==t;_d.visible=e,wd.visible=e,e&&(_d.setTailAndTip(0,0,0,-t*xh.OUTER_RADIUS/5),wd.text=t>0?"+"+t:t,wd.centerX=0,t>0?wd.bottom=_d.top-5:wd.top=_d.bottom+5)}),qc.setupDisplay(new mh({spacing:15,children:[new Gl({spacing:75,align:"origin",children:[bd,Ad,vd]})]}),t=>{hd||(fd.step(t),pd.step(t),bd.step(t),vd.step(t))})}]);
  </script>
</body>
</html>